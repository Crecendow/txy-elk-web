!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fishTopoBpmn=e():t.fishTopoBpmn=e()}(this,function(){return i=[function(t,e,n){t.exports=n(1)},function(t,e,n){t.exports=n(2),n(159)},function(t,e,n){var a=n(3),i=n(63),y=n(64),r=n(11),o=n(65),K=n(4),s=n(26),tt=n(76),et=n(77),h=n(82),l=n(79),c=n(110),u=n(111),p=n(114),f=n(105),g=n(25),d=n(117),nt=n(118),v=n(119),it=n(104),m=27;function _(t,e){this.id,this.group,this._dom=t,this._zr=o.init(t,{renderer:e.renderer||"canvas",devicePixelRatio:e.devicePixelRatio}),this.allNodes=[],this.subProcessNode=[],this.domArray=[],this.overlapArray=[],this.selectedNode=null,this.isNode=!1,this.nowZoom=1,this.rect,this.operationNode,this.step=0,this.stepJson=[],this.opts=e,this.selectedNodes=[],this.lineOpt={},this._api=new i(this),this.conPointsGroup=new a.Group,this.conControlsGroup=new a.Group,this.forbidEdit=void 0!==e.forbidEdit&&e.forbidEdit,this.mouseMode="default",this.connectionManager=new p,this.lineOperationManager=new d(this.connectionManager,this._api),this.model=new h({}),this.model.set(it.RESOURCE_ID,et.getUUID()),this.model.set(it.BPMN_TYPE,it.TEMPLATE),this.cursorMap={tl:"nw-resize",tr:"ne-resize",bl:"sw-resize",br:"se-resize",mtr:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAYFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD6T+iNAAAAH3RSTlMA7sUMoYXnEkYYzaaTjQiAQCweBcG7fvnULh2ZdjMy6Fzd7wAAALJJREFUGNN1kFkOwzAIBQHvW/Y6Sbfc/5Y1ltqoljIf2BohBA8qU096xeV5L/+uFH4SpsGAGSKmThCyMz64Ud38Te0meIpHcTP1ndTKvqzSUuQILFMQJAUwIngBLCd0UrJhSRGqzHHU3FcHBVMokqxS38YNGQLQbhmgZZ23sVEXnXVmS467Fq0892SSLaW5SHrN9rz9bXv9EHIB+E9pdMG7Ys48Z2cjxo7FL3k8kPIE13wAmEUIO2ML9YMAAAAASUVORK5CYII=) 10 10, auto"},this.cursorMaps=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],this.cursorOffset={tr:1,br:3,bl:5,tl:7},r.call(this)}n(158),tt.registerBPMNNode();var x=_.prototype;x.getDom=function(){return this._dom},x.getZr=function(){return this._zr},x.getWidth=function(){return this._zr.getWidth()},x.getHeight=function(){return this._zr.getHeight()},x.isDisposed=function(){return this._disposed},x.dispose=function(){this._disposed=!0,this._zr.dispose(),w[this.id]=null},x.resize=function(t,e){this.getDom().style.width=t+"px",this.getDom().style.height=e+"px",this._zr.resize(),this._zr.remove(this.group),this.group=new a.Group,1!=this.opts.showGridLine&&"true"!=this.opts.showGridLine||(this.gridLine(),this._zr.add(this.group))},x.init=function(){this.group=new a.Group,1!=this.opts.showGridLine&&"true"!=this.opts.showGridLine||(this.gridLine(),this._zr.add(this.group)),this._zr.on("mouseup",function(t){var e=t.target;e&&e.connector instanceof f||(this.connectionManager.clearSelectCon(),e&&e._isLineOperationIcon&&e._isLineOperationIcon)}.bind(this)),this._zr.on("click",function(t){var e=(t.target||{}).type;if("ConnectControlLine"!==e&&"ConnectControl"!==e){this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),this.lineOperationManager.hideAllLineOperation();var n=t.target;if(n&&n.parent&&n.parent.resourceId)return;var i={};i.event=t,i.type="click",(i.target=this)._api.trigger(i.type,i)}}.bind(this)),this._zr.on("mousedown",function(t){"drag-select"===this.mouseMode&&(!t.target||t.target&&"grid-line"===t.target.type||t.target&&"subprocess-rect"===t.target.name)&&this._dragSelect(t.target,t.offsetX,t.offsetY)}.bind(this)),this.on("conPointsGroup:click",function(t){this.lineOperationManager.bindOperation(t.lineNode)}.bind(this))},x._releaseSelectNode=function(t){if(this.dragSelectRect){for(var e=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name}),n=this.dragSelectRect.position[0],i=this.dragSelectRect.position[1],r=0;r<e.length;r++){var o=e[r],s=it.isFlow(o)?0:o.getRect().x,a=it.isFlow(o)?0:o.getRect().y;this.dragSelectRect.remove(o),o.originParent&&!t?o.originParent.add(o):this._zr.add(o),it.isFlow(o)||(o.originParent&&!t?o.setPosition(s+n-tt.parentX(o.originParent),a+i-tt.parentY(o.originParent)):o.setPosition(s+n,a+i),this.connectionManager.refreshLineByNode(o)),o.originParent&&(o.originParent=null)}this.dragSelectRect.off("mousedown"),this._zr.remove(this.dragSelectRect)}},x._dragSelect=function(e,o,s){this._releaseSelectNode(),this.dragSelectRect=new c({shape:{width:0,height:0},position:[o,s],style:{lineDash:[2,2],fill:"rgba(239,222,221,0.7)",stroke:"rgba(0, 0, 0, 1)"}}),this.dragSelectRect.type="dragSelect",this._zr.add(this.dragSelectRect),this.dragSelectRect.on("mousedown",function(t){this.newDrag(this.dragSelectRect,t.event.clientX,t.event.clientY),t.cancelBubble=!0}.bind(this));var n=function(t){if(!(Math.abs(t.offsetX-o)<=1&&Math.abs(t.offsetY-s)<=1)){var e=o<=t.offsetX?o:t.offsetX,n=s<=t.offsetY?s:t.offsetY,i=Math.abs(t.offsetX-o),r=Math.abs(t.offsetY-s);this.dragSelectRect.setProperties({shape:{width:i,height:r},position:[e,n]})}}.bind(this);this._zr.on("mousemove",n);var i=function(t){if(this._zr.off("mousemove",n),this._zr.off("mouseup",i),this._zr.off("globalout",i),Math.abs(t.offsetX-o)<=1&&Math.abs(t.offsetY-s)<=1)e&&e.parent&&it.isSubProcess(e.parent)&&(this.nodeClickHandler(e.parent),this._trigger("selectNode",{target:e.parent}));else{var h=this,l=this.dragSelectRect.position[0],c=this.dragSelectRect.position[1],u=this.dragSelectRect.options.shape.width,p=this.dragSelectRect.options.shape.height,d=0;this.allNodes.forEach(function(t){var e=t.getRect(),n=e.width,i=e.height,r=t.parent?e.x+tt.parentX(t.parent):e.x,o=t.parent?e.y+tt.parentY(t.parent):e.y;if((it.isEvent(t)||it.isGateway(t))&&l<=r-n&&c<=o-n&&r+n<=l+u&&o+n<=c+p||!it.isEvent(t)&&!it.isGateway(t)&&l<=r-n/2&&c<=o-i/2&&r+n/2<=l+u&&o+i/2<=c+p){if(t.slotEvent&&0<t.slotEvent.length)for(var s=0;s<t.slotEvent.length;s++){var a=[t.slotEvent[s].position[0]+(r-l)-K.clone(t.position[0])-t.getBoundingRect().width/2,t.slotEvent[s].position[1]+(o-c)-K.clone(t.position[1])-t.getBoundingRect().height/2];t.slotEvent[s].attr("position",a),that.connectionManager.refreshLineByNode(t.slotEvent[s])}t.parent?(t.originParent=t.parent,t.parent.remove(t)):h._zr.remove(t),h.dragSelectRect.add(t),h.selectedNodes.push(t),t.setPosition(r-l,o-c),d++}}),d?(this.dragSelectRect.childOfName("GROUP_RECT_NAME").attr("style",{fill:"rgba(0,0,0,0)"}),this.connectionManager.connectors.forEach(function(e){var t=h.dragSelectRect.children().find(function(t){return t.id===e.startNode.id}),n=h.dragSelectRect.children().find(function(t){return t.id===e.endNode.id});t&&n&&(h._zr.remove(e),h.dragSelectRect.add(e),h.connectionManager.refreshLineByNode(e.startNode))})):(this.dragSelectRect.off("mousedown"),this._zr.remove(this.dragSelectRect))}}.bind(this);this._zr.on("mouseup",i),this._zr.on("globalout",i)},x.setShapeModel=function(t,e,n,i){!0!==this.forbidEdit&&(it.isTemplate(t)?(this.model.mergeOption(e),0<n&&0<i&&this.resize(n,i)):it.isFlow(t)?this.connectionManager.setModel(t,e):(-1!==t.bpmnInfo.name.indexOf("Task")&&(e.properties.position="center"),"Comment"===t.bpmnInfo.name&&(e.properties.position="left"),t.setModel(e)))},x._getParentZr=function(t){return t&&t.parent?t.parent:this._zr},x.clear=function(t){this.allNodes=[],this.subProcessNode=[],this.domArray=[],this.overlapArray=[],this.hideConnectorPoint(),this.selectedNode=null,this.rect=null,this.connectionManager.connectors=[],this._zr.clear(),this._zr.add(this.group),1!=t&&this.stepCounter()},x.forbidGridLine=function(t){this.opts.showGridLine=!t,1==t?this._zr.remove(this.group):(this._zr.remove(this.group),this.group=new a.Group,this.gridLine(.2),this._zr.add(this.group))},x.toJson=function(){return tt.toJson(this.model,this.allNodes,this.connectionManager.connectors)},x.fromJson=function(t){tt.fromJson(this,t)},x.gridLine=function(){for(var t=this.opts.gridLineSpacing,e=parseInt(this.getWidth()/t),n=0;n<=e;n++){var i=new a.Line({shape:{x1:n*t,y1:0,x2:n*t,y2:this.getHeight()},style:{stroke:0===n||(n+1)%4==0||n===e-1?"#dddddd":"#ddddddb8"},z:-1,draggable:!1,cursor:"default"});i.type="grid-line",this.group.add(i)}for(var r=parseInt(this.getHeight()/t,t),o=0;o<=r;o++){var s=new a.Line({shape:{x1:0,y1:o*t,x2:this.getWidth(),y2:o*t},style:{stroke:0===o||(o+1)%4==0||o===r-1?"#dddddd":"#ddddddb8"},z:-1,draggable:!1,cursor:"default"});s.type="grid-line",this.group.add(s)}},x._removeOperationNode=function(){this.operationNode&&(this._zr.remove(this.operationNode),this.operationNode.cleanup(),this.operationNode=null)},x.addNode=function(t,e,n,i){var r=this;if(0<=e&&0<=n){var o=new h({});o.set(it.BPMN_TYPE,t),o.set("bounds.upperLeft",{x:e,y:n}),i&&o.set("properties",i),this._triggerAsync("beforeCreateNode",{target:null},o).then(function(t){t&&r.asyncAddNodeByModel(o,!0)})}},x.addShapes=function(t,e,n){if(!(e<0||n<0)){for(var i=JSON.parse(JSON.stringify(t)),r=this.toJson(),o=JSON.parse(JSON.stringify(r.childShapes)),s=[],a=[],h=[],l=[],c=0;c<i.length;c++){(S=i[c]).stencil.type!==it.SEQUENCE_FLOW&&(s.push(S.bounds.upperLeft.x),a.push(S.bounds.upperLeft.y),h.push(S.bounds.lowerRight.x),l.push(S.bounds.lowerRight.y))}var u=Math.min.apply(Math,s),p=Math.min.apply(Math,a),d=Math.max.apply(Math,h)-u,f=Math.max.apply(Math,l)-p,g="canvas",v=function t(e,n,i){if(0<e.length)for(var r=0;r<e.length;r++)if(n>tt.parentX(e[r])&&n<tt.parentX(e[r])+e[r].getRect().width&&i>tt.parentY(e[r])&&i<tt.parentY(e[r])+e[r].getRect().height){if(e[r].children()&&0<e[r].children().length)var o=t(e[r].children().filter(function(t){return t.bpmnInfo&&"SubProcess"===t.nodeType}),n,i);return o||e[r]}return null}(this.subProcessNode,e,n);v&&(g=v.resourceId);var y=[];if("canvas"===g){for(c=0;c<i.length;c++){(x=i[c]).stencil.type!==it.SEQUENCE_FLOW?(x.bounds.upperLeft.x=x.bounds.upperLeft.x-u+e,x.bounds.lowerRight.x=x.bounds.lowerRight.x-u+e,x.bounds.upperLeft.y=x.bounds.upperLeft.y-p+n,x.bounds.lowerRight.y=x.bounds.lowerRight.y-p+n):x.dockers=[]}if(0<o.length)for(var m=0;m<o.length;m++){(S=o[m]).stencil.type!==it.SEQUENCE_FLOW?S.bounds.lowerRight.x>=e&&S.bounds.lowerRight.y>=n&&(S.bounds.upperLeft.x<=e?(S.bounds.upperLeft.y=S.bounds.upperLeft.y+f,S.bounds.lowerRight.y=S.bounds.lowerRight.y+f):(S.bounds.upperLeft.x=S.bounds.upperLeft.x+d,S.bounds.lowerRight.x=S.bounds.lowerRight.x+d)):S.dockers=[]}y=o.concat(i),r.childShapes=y}else{for(var _=0;_<i.length;_++){var x;(x=i[_]).stencil.type!==it.SEQUENCE_FLOW?(x.bounds.upperLeft.x=x.bounds.upperLeft.x-u+(e-tt.parentX(v)),x.bounds.lowerRight.x=x.bounds.lowerRight.x-u+(e-tt.parentX(v)),x.bounds.upperLeft.y=x.bounds.upperLeft.y-p+(n-tt.parentY(v)),x.bounds.lowerRight.y=x.bounds.lowerRight.y-p+(n-tt.parentY(v))):x.dockers=[]}for(var b,w,C=0;C<o.length;C++){(S=o[C]).resourceId===g&&(b=S.bounds.upperLeft.x,w=S.bounds.upperLeft.y,S.bounds.lowerRight.x-e<d&&(S.bounds.lowerRight.x=d+e+10),S.bounds.lowerRight.y-n<f&&(S.bounds.lowerRight.y=f+n+10),S.childShapes=[].concat(i))}for(var P=0;P<o.length;P++){var S;(S=o[P]).resourceId!==g&&(S.stencil.type!==it.SEQUENCE_FLOW?S.bounds.lowerRight.x>=b&&S.bounds.lowerRight.y>=w&&(S.bounds.upperLeft.x<=b?(S.bounds.upperLeft.y=S.bounds.upperLeft.y+f,S.bounds.lowerRight.y=S.bounds.lowerRight.y+f):(S.bounds.upperLeft.x=S.bounds.upperLeft.x+d,S.bounds.lowerRight.x=S.bounds.lowerRight.x+d)):S.dockers=[])}r.childShapes=o}this.fromJson(r),this.stepCounter()}},x._JudgeNodeInWhichSubProcess=function(t,e){if(0<t.length)for(var n=0;n<t.length;n++){if(new s(tt.parentX(t[n]),tt.parentY(t[n]),t[n].getRect().width,t[n].getRect().height).contain(e.x,e.y)){var i;if(t[n].children()&&0<t[n].children().length){var r=t[n].children().filter(function(t){return t.bpmnInfo&&"SubProcess"===t.nodeType});i=this._JudgeNodeInWhichSubProcess(r,e)}return i||t[n]}}return null},x.addNodeByModel=function(t,e,n){var i=l.getClass(t.get(it.BPMN_TYPE));if(i){var r=new i(t,this._api),o=this._JudgeNodeInWhichSubProcess(this.subProcessNode,{x:r.getRect().x,y:r.getRect().y});return this.addNodeToShape(r,e,n,o),r}},x.asyncAddNodeByModel=function(t,e,n){var i=this,r=l.getClass(t.get(it.BPMN_TYPE));if(r){var o=new r(t,this._api),s=i._JudgeNodeInWhichSubProcess(i.subProcessNode,{x:o.getRect().x,y:o.getRect().y});this._triggerAsync("beforeAddNode",{target:s},o).then(function(t){t&&i.addNodeToShape(o,e,n,s)})}},x.addNodeToShape=function(o,t,e,n){var i,r=this;if(0==r.subProcessNode.length)r._zr.add(o),i={id:o.id,position:[o.getRect().x,o.getRect().y],width:o.getRect().width,height:o.getRect().height},it.isSlotEvent(o)||r.overlapArray.push(i);else if(r._zr.add(o),i={id:o.id,position:[o.getRect().x,o.getRect().y],width:o.getRect().width,height:o.getRect().height},it.isSlotEvent(o)||r.overlapArray.push(i),t){var s=0,a=0;if(n){n.parent&&it.isSubProcess(n.parent)&&(s=tt.parentX(n.parent),a=tt.parentY(n.parent));var h=n.getRect().width/2+(o.getRect().x-(n.getRect().x+s)),l=n.getRect().height/2+(o.getRect().y-(n.getRect().y+a));o.setPosition(h,l),n.add(o),r._zr.remove(o);for(var c=0;c<r.overlapArray.length;c++)o.id==r.overlapArray[c].id&&r.overlapArray.splice(c,1)}}it.isSubProcess(o)&&r.subProcessNode.push(o),r.allNodes.push(o),i.position=[o.getRect().x,o.getRect().y],i.points=r._getControlsOfNode(o),i.rotation=o.rotation,r.domArray.push(i),o.on("mousedown",function(t){1==r.forbidEdit||this.parent&&"dragSelect"===this.parent.type||"drag-select"===r.mouseMode&&it.isSubProcess(this)||r.newDrag(this,t.event.clientX,t.event.clientY),it.isSlotEvent(this)&&r.bindEventNode(),"drag-select"!==r.mouseMode&&(t.cancelBubble=!0)}),o.on("click",function(t){r.nodeClickHandler(this),r._trigger("selectNode",{target:o}),t.cancelBubble=!0}),it.isActivity(o)&&r.creatTip(o),o.on("mouseover",function(){if(this.alarm&&1==this.alarm.isShow){this.alarm.show(),this.alarm.eachChild(function(t){t.show()});var t=this.alarm.childOfName("Text"),e=t.getBoundingRect().width+4,n=t.getBoundingRect().height+8,i=[[0,0],[e,0],[e,n],[e/2-3,n],[e/2,n+3],[e/2+3,n],[0,n],[0,0]];this.alarm.childOfName("Polyline").attr("shape",{points:i});var r=[tt.parentX(o)+o.getBoundingRect().width-this.alarm.getBoundingRect().width/2,tt.parentY(o)-this.alarm.getBoundingRect().height-3];this.alarm.attr("position",r)}}),o.on("mouseout",function(){this.alarm&&(this.alarm.hide(),this.alarm.eachChild(function(t){t.hide()}))}),1!=e&&r.stepCounter(),r._trigger("afterCreateNode",{target:o})},x.selectNode=function(t){t&&(this.nodeClickHandler(t),this._trigger("selectNode",{target:t}))},x.childOfName=function(t){for(var e=[],n=0;n<this.allNodes.length;n++)this.allNodes[n].model.get("properties.name")==t&&e.push(this.allNodes[n]);return 1<e.length?e:e[0]},x.findElements=function(t,e){for(var n=this.allNodes,i=this.connectionManager.connectors,r=[],o=0;o<n.length;o++){var s=n[o];t.call(e,s,o)&&r.push(s)}for(var a=0;a<i.length;a++){var h=i[a];t.call(e,h,a)&&r.push(h)}return r},x.addConnectorByModel=function(e,t){var n=null,i=null;if(K.each(this.allNodes,function(t){-1!==t.model.get("outgoing").indexOf(e.get("resourceId"))&&(n=t),-1!==e.get("outgoing").indexOf(t.resourceId)&&(i=t)}),n&&i){var r=this.connectionManager.connectorCreateByOptions(n,i,{model:e,isFromModel:!0},this._api);t?t.add(r):this._zr.add(r),this.connectionManager.connectorForbidEdit(this.forbidEdit),this._createConnectorDragEvents(r),r.on("mousedown",function(t){this.lineOperationManager.isEdit=!this.forbidEdit,this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),this.isNode=!1}.bind(this))}},x.addIcon=function(t,e){this.lineOperationManager.addIcon(t,e)},x.bindLineDelete=function(t,e){this.lineOperationManager.addDeleteIcon(t,e)},x.checkLineNode=function(t){for(var e=[],n=[],i=this.connectionManager.connectors,r=0,o=i.length;r<o;r++)i[r].startNode==t&&n.push(i[r].endNode);for(var s=0,a=i.length;s<a;s++)i[s].endNode==t&&e.push(i[s].startNode);return[e,n]},x.calculateNodeRectInGroup=function(t){var e=et.getRect(t);return t.parent&&it.isSubProcess(t.parent)&&(e.boundingRect.x+=tt.parentX(t.parent),e.boundingRect.y+=tt.parentY(t.parent),e.x+=tt.parentX(t.parent),e.y+=tt.parentY(t.parent)),{rect:e,parentNode:tt.getParentNode(t)}},x.calculateRect=function(t,e){if((e=e||this.calculateNodeRectInGroup(t).rect).rotation?e.rotation+=t.rotation:e.rotation=t.rotation,t.parent&&it.isSubProcess(t.parent)){var n=t.parent.rotation;if(0<Math.abs(n)){var i=this.calculateNodeRectInGroup(t.parent).rect,r={x:e.x,y:e.y},o=et.calculatePoints(r,i,n);e.x=o.x,e.y=o.y,e.boundingRect.x=e.x-e.width/2,e.boundingRect.y=e.y-e.height/2}return this.calculateRect(t.parent,e)}return e},x.createConnectorPoint=function(t,e,n){var i=this,r=new a.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:2,cursor:"crosshair",draggable:!0,lineType:n});r.type="ConnectPoint",r.pos=e;K.each(["dragstart","drag","dragend"],function(n){r.on(n,function(t){var e={};e.event=t,e.type="ConnectPoint:"+n,i.conPointsGroup.trigger(e.type,e)})}),this.conPointsGroup.add(r)},x.hideConnectorPoint=function(){this.conPointsGroup.removeAll(),this.conPointsGroup.off(),this._zr.remove(this.conPointsGroup)},x.filterConnectPoint=function(t,i){var r=this;t.forEach(function(t){var e=r.calculateRect(t),n=et.getConnectorPoints(e,{rotation:e.rotation});r.createConnectorPoint(n.left,"left",i),r.createConnectorPoint(n.right,"right",i),r.createConnectorPoint(n.top,"top",i),r.createConnectorPoint(n.bottom,"bottom",i)})},x.showConnectorPoint=function(t,e,s){var l=this;this.hideConnectorPoint(),e&&(this.lineOpt=e),t&&(this.lineType=t),this.lineType||(this.lineType="jagged");var n=(s=s||!1)?[l.selectedNode]:l.allNodes;this.filterConnectPoint(n,this.lineType),this.conPointsGroup.on("ConnectPoint:dragstart",function(t){s&&l.filterConnectPoint(l.allNodes,l.lineType);var e=t.event.offsetX,n=t.event.offsetY,i=t.event.target;l.startPos=i.pos,l.selectConnNode=function(i,r,o,s){var a,h=null;return l.allNodes.forEach(function(t){var e=l.calculateRect(t),n=et.getConnectorPoints(e,{rotation:e.rotation});s?Math.abs(n[s].x-i)<=o&&Math.abs(n[s].y-r)<=o&&(a=t):Math.abs(n.left.x-i)<=o&&Math.abs(n.left.y-r)<=o?(h="left",a=t):Math.abs(n.top.x-i)<=o&&Math.abs(n.top.y-r)<=o?(h="top",a=t):Math.abs(n.right.x-i)<=o&&Math.abs(n.right.y-r)<=o?(h="right",a=t):Math.abs(n.bottom.x-i)<=o&&Math.abs(n.bottom.y-r)<=o&&(h="bottom",a=t)}),{node:a,endPos:h}}(i.shape.cx,i.shape.cy,0,l.startPos).node,i.hide(),l.lineOperationManager.hideAllLineOperation(),l.reverseConnect=!1,l.originNode=null;var r=new y(e,n),o=l.connectionManager.manageTempConnector(l.selectConnNode,r,i.lineType,l.startPos);l._zr.add(o)}),this.conPointsGroup.on("ConnectPoint:drag",function(t){var e=t.event.target;l._handleLineDrag("drag",t,e.lineType)}),this.conPointsGroup.on("ConnectPoint:dragend",function(t){var e=t.event.target;l._handleLineDrag("dragend",t,e.lineType)}),this._zr.add(this.conPointsGroup)},x._handleLineDrag=function(t,e,n){var l=this,i=e.event.offsetX,r=e.event.offsetY;function o(i,r,o,s){var a,h=null;return l.allNodes.forEach(function(t){var e=l.calculateRect(t),n=et.getConnectorPoints(e,{rotation:e.rotation});s?Math.abs(n[s].x-i)<=o&&Math.abs(n[s].y-r)<=o&&(a=t):Math.abs(n.left.x-i)<=o&&Math.abs(n.left.y-r)<=o?(h="left",a=t):Math.abs(n.top.x-i)<=o&&Math.abs(n.top.y-r)<=o?(h="top",a=t):Math.abs(n.right.x-i)<=o&&Math.abs(n.right.y-r)<=o?(h="right",a=t):Math.abs(n.bottom.x-i)<=o&&Math.abs(n.bottom.y-r)<=o&&(h="bottom",a=t)}),{node:a,endPos:h}}var s=new y(i,r);if("drag"===t&&(l.reverseConnect?l.connectionManager.manageReverseTempConnector(s,l.selectConnNode,n,l.endPos):l.connectionManager.manageTempConnector(l.selectConnNode,s,n,l.startPos),l.conPointsGroup.children().forEach(function(t){if(t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy],cursor:"crosshair"}),Math.abs(t.shape.cx-i)<=10&&Math.abs(t.shape.cy-r)<=10){var e=o(i,r,10);l.reverseConnect?l.connectionManager.manageReverseTempConnector(s,l.selectConnNode,n,l.endPos,e.endPos,e.node):l.connectionManager.manageTempConnector(l.selectConnNode,s,n,l.startPos,e.endPos,e.node),t.attr({style:{fill:"#ff0000"},scale:[1.5,1.5],origin:[t.shape.cx,t.shape.cy],cursor:"pointer"})}})),"dragend"===t){var a,h,c,u=o(i,r,10),p=u.node,d=u.endPos||"left",f=!1;if(l.connectionManager.removeTempConnector(l._zr),l.selectConnNode.parent&&it.isSubProcess(l.selectConnNode.parent)?(p&&it.isSlotEvent(l.selectConnNode)&&(f=!0),p&&p.parent&&it.isSubProcess(p.parent)&&p.parent.id===l.selectConnNode.parent.id&&(f=!0)):(p&&!p.parent&&(f=!0),p&&p.parent&&it.isSubProcess(p.parent)&&it.isSlotEvent(p)&&(f=!0)),f&&l.selectConnNode.id!==p.id){var g={style:{lineType:n}},v=et.mergeOpt(g,l.lineOpt,!0);a=l.reverseConnect?p:l.selectConnNode,h=l.reverseConnect?l.selectConnNode:p,c=l.reverseConnect?d:l.startPos,d=l.reverseConnect?l.endPos:d,l._createConnectorByNodes(a,h,v,c,d),l.hideConnectorPoint(),l.hideConnectorControl()}else l.originNode?(a=l.reverseConnect?l.originNode:l.selectConnNode,h=l.reverseConnect?l.selectConnNode:l.originNode,c=l.reverseConnect?l.originPos:l.startPos,d=l.reverseConnect?l.endPos:l.originPos,l._createConnectorByNodes(a,h,{style:l.lineOpt},c,d),l.hideConnectorPoint()):l.conPointsGroup.children().forEach(function(t){t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy],cursor:"crosshair"})})}},x.showConnectorControl=function(){var O=this;this.hideConnectorControl();var t=this.calculateRect(this.selectedNode),e={id:this.selectedNode.id,rotation:t.rotation},n=et.getConnectorControls(t,e),i=this.returnConnectorControlParam(this.selectedNode);i.scaleable&&(O.createConnectorControl(n.tl,"tl",e),O.createConnectorControl(n.tr,"tr",e),O.createConnectorControl(n.bl,"bl",e),O.createConnectorControl(n.br,"br",e)),i.rotatable&&(O.createConnectorControl(n.mtr,"mtr",e),O.createConnectorControl({top:n.mtr,bottom:n.tc},"mtr,tc",e)),this.conControlsGroup.on("ConnectControl:dragstart",function(t){var e=t.event.target.cursor,n=t.event.target.pos,i={tl:"br",tr:"bl",bl:"tr",br:"tl"};if(O.selectConnNode=function(e){var n=null;return O.allNodes.forEach(function(t){t.id===e&&(n=t)}),n}(t.nodeId),e&&"mtr"!==n){var r=O.conControlsGroup.children().find(function(t){return t.pos===i[n]}),o=O.conControlsGroup.children().find(function(t){return t.pos===n}),s=O.selectConnNode.getBoundingRect();O.oppositeShape=K.clone(r.shape),O.currentShape=K.clone(o.shape);var a=K.clone(O.calculateRect(O.selectConnNode)),h=Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2));O.diagonal=h,O.originRect=K.clone(a),O.ifPointCenter=s.x<-1,O.selectConnNode.selectStyle&&O._api.getZr().removeHover(O.selectConnNode)}nt.createGuidelines(O._zr)}),this.conControlsGroup.on("ConnectControl:drag",function(t){var e=O.opts.showGridLine?O.opts.gridLineSpacing:1,n=t.event.target.cursor,i=t.event.target.pos,r=O.selectConnNode,o=(t.event.offsetX-O.group.position[0])/O.nowZoom,s=(t.event.offsetY-O.group.position[1])/O.nowZoom,a=et.getRect(r,!0);if("mtr"===i){r.parent&&it.isSubProcess(r.parent)&&(o-=tt.parentX(r.parent),s-=tt.parentY(r.parent));var h=e*parseInt((o-r.position[0])/e,10),l=e*parseInt((s-r.position[1])/e,10),c={x:a.x-r.position[0],y:a.y-r.position[1]},u=Math.atan2(l,h);O.selectedNode.attr({origin:[c.x,c.y],rotation:-u});var p=O.calculateRect(O.selectedNode),d=et.getConnectorPoints(p,{rotation:p.rotation}),f=et.getConnectorControls(p,{rotation:p.rotation});O.conPointsGroup.children().forEach(function(t){var e=t.pos;"ConnectPoint"===t.type&&t.setShape({cx:d[e].x,cy:d[e].y})}),O.conControlsGroup.children().forEach(function(t){var e=t.pos;"ConnectControl"===t.type?("mtr"===e&&(t.attr("position",[0,0]),t.attr("rotation",0)),t.setShape({x:f[e].x-4,y:f[e].y-4}),t.attr({origin:[t.shape.x+4,t.shape.y+4],rotation:-u})):"ConnectControlLine"===t.type&&t.setShape({x1:f.mtr.x,x2:f.tc.x,y1:f.mtr.y,y2:f.tc.y})})}else{var g,v,y,m,_=1,x=[],b={tl:"br",tr:"bl",bl:"tr",br:"tl"},w=O.conControlsGroup.children().filter(function(t){return"ConnectControl"===t.type&&"mtr"!==t.pos}).find(function(t){return t.pos===i});if(o<=8&&(o=8),s<=8&&(s=8),["n-resize","s-resize"].includes(n)){var C=w.shape.y+4;m=Math.abs(s-O.oppositeShape.y-4)-Math.abs(C-O.oppositeShape.y),Math.abs(m)%e!=0&&(m=Math.round(m/e)*e),_=(Math.abs(C-O.oppositeShape.y)+m)/Math.abs(C-O.oppositeShape.y)}else{var P=w.shape.x+4;m=Math.abs(o-O.oppositeShape.x-4)-Math.abs(P-O.oppositeShape.x),Math.abs(m)%e!=0&&(m=Math.round(m/e)*e),_=(Math.abs(P-O.oppositeShape.x)+m)/Math.abs(P-O.oppositeShape.x)}/^[0-9]+.?[0-9]*/.test(_)||(_=1),r.updateShape(_);var S=et.getRect(r);g=O.ifPointCenter?{x:O.originRect.x,y:O.originRect.y}:{x:O.originRect.boundingRect.x,y:O.originRect.boundingRect.y};var T=Math.sqrt(Math.pow(S.width,2)+Math.pow(S.height,2));switch(n){case"n-resize":case"nw-resize":v=(O.oppositeShape.x+4-g.x)*T/O.diagonal,y=(O.oppositeShape.y+4-g.y)*T/O.diagonal,x.push(O.oppositeShape.x-v+4,O.oppositeShape.y-y+4);break;case"e-resize":case"ne-resize":v=(g.x-O.oppositeShape.x-4)*T/O.diagonal,y=(O.oppositeShape.y+4-g.y)*T/O.diagonal,x.push(O.oppositeShape.x+v+4,O.oppositeShape.y-y+4);break;case"s-resize":case"se-resize":v=(g.x-O.oppositeShape.x-4)*T/O.diagonal,y=(g.y-O.oppositeShape.y-4)*T/O.diagonal,x.push(O.oppositeShape.x+v+4,O.oppositeShape.y+y+4);break;case"w-resize":case"sw-resize":v=(O.oppositeShape.x+4-g.x)*T/O.diagonal,y=(g.y-O.oppositeShape.y-4)*T/O.diagonal,x.push(O.oppositeShape.x-v+4,O.oppositeShape.y+y+4)}if(r.parent&&it.isSubProcess(r.parent)){var E=O.calculateRect(r.parent),R=et.calculatePoints(x,E,-E.rotation);x=[R[0]-E.boundingRect.x,R[1]-E.boundingRect.y]}var N={x:S.x-x[0],y:S.y-x[1]};r.attr({position:x,origin:[N.x,N.y]});var M=O.calculateRect(r),k=et.getConnectorPoints(M,{rotation:M.rotation}),A=et.getConnectorControls(M,{rotation:M.rotation});O.conControlsGroup.children().forEach(function(t){var e=t.pos;e===i&&t.attr("position",[0,0]),"ConnectControl"===t.type&&e!==b[i]?(t.setShape({x:A[e].x-4,y:A[e].y-4}),t.attr("origin",[A[e].x,A[e].y])):"ConnectControlLine"===t.type&&t.setShape({x1:A.mtr.x,x2:A.tc.x,y1:A.mtr.y,y2:A.tc.y})}),O.conPointsGroup.children().forEach(function(t){var e=t.pos;"ConnectPoint"===t.type&&t.setShape({cx:k[e].x,cy:k[e].y})})}var L=O.calculateRect(O.selectedNode);O.operationNode.refreshPostion(O.selectedNode,L),O.selectedNode.slotEvent&&0<O.selectedNode.slotEvent.length&&O.updateSlotEvent(O.selectedNode),O.connectionManager.refreshLineByNode(O.selectedNode),nt.judgeAlignment(O.selectedNode,[L.x,L.y],O.domArray,O.getWidth(),O.getHeight())}),this.conControlsGroup.on("ConnectControl:dragend",function(t){var e=t.event.target.pos,i=O.selectConnNode,n=O.opts.showGridLine?O.opts.gridLineSpacing:1,r=i.position,o=i.origin;O.selectConnNode.attr("position",[Math.round(r[0]/n)*n,Math.round(r[1]/n)*n]),Array.isArray(o)&&O.selectConnNode.attr("origin",[Math.round(o[0]/n)*n,Math.round(o[1]/n)*n]),"mtr"!==e&&i.updateShape(1,!0,n),i.slotEvent&&0<i.slotEvent.length&&O.updateSlotEvent(i),K.each(O.domArray,function(t,e){if(t.id===i.id){var n=et.getRect(i);t.rotation=i.rotation,t.position=[n.x,n.y],t.width=n.width,t.height=n.height,t.points=O._getControlsOfNode(i),O.domArray[e]=t}}),i.model&&(i.model.set("options.rotation",i.rotation),i.model.set("options.origin",i.origin),"Image"===i.model.option.elementType?i.model.set("options.style",i.style):i.model.set("options.shape",i.shape));nt.resetLines(),O.nodeClickHandler(i),O.stepCounter(),O.oppositeShape=null,O.currentShape=null,O.diagonal=null,O.originRect=null,O.ifPointCenter=null}),this._zr.add(this.conControlsGroup)},x.getRotatedCornerCursor=function(t,e){var n=t.rotation;if("mtr"===e)return this.cursorMap[e];if(0<Math.abs(n)){var i=-n/(Math.PI/180),r=Math.round(i%360/45);return r<0&&(r+=8),r+=this.cursorOffset[e],r%=8,this.cursorMaps[r]}return this.cursorMap[e]},x.createConnectorControl=function(t,e,i){var r=this;if(e.split(",").length<2){var o=r.getRotatedCornerCursor(i,e),s=new a.Rect({shape:{x:t.x-4,y:t.y-4,width:8,height:8},style:{fill:"#ffffff",stroke:"#000000"},z:2,rotation:i.rotation,origin:[t.x,t.y],cursor:o,draggable:!0});s.type="ConnectControl",s.pos=e;K.each(["dragstart","drag","dragend"],function(n){s.on(n,function(t){var e={};e.event=t,e.type="ConnectControl:"+n,e.nodeId=i.id,e.cursor=o,r.conControlsGroup.trigger(e.type,e)})}),this.conControlsGroup.add(s)}else{var n=new a.Line({shape:{x1:t.top.x,y1:t.top.y,x2:t.bottom.x,y2:t.bottom.y},style:{lineWidth:1},z:1,draggable:!1,cursor:"default"});n.type="ConnectControlLine",n.nodeId=i.id,this.conControlsGroup.add(n)}},x._getControlsOfNode=function(t){var e=this.calculateRect(t),n=et.getConnectorControls(e,{rotation:e.rotation});return[n.tl,n.tr,n.bl,n.br]},x.returnConnectorControlParam=function(t){var e=!1,n=!1;return this.opts.scaleable&&(e=!0),e=!!t.model.get("properties.scaleable"),t.scaleable?e=!0:t.scaleable||t.model.get("properties.scaleable")||(e=!1),this.opts.rotatable&&(n=!0),n=!!t.model.get("properties.rotatable"),t.rotatable?n=!0:t.rotatable||t.model.get("properties.rotatable")||(n=!1),{scaleable:e,rotatable:n}},x.ifShowConnectorPoint=function(t){return t&&"boolean"==typeof t.connectable?t.connectable:this.opts.connectable},x.hideConnectorControl=function(){this.conControlsGroup.removeAll(),this.conControlsGroup.off(),this._zr.remove(this.conControlsGroup)},x.createLineConnectorPoint=function(t,e,n){var i=new a.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:4,draggable:!0,lineType:n});i.type="ConnectPoint",i.pos=e,this.conPointsGroup.add(i)},x.initOperationNode=function(t){var d=this;function f(r,o,s,a){var h,l=null;return d.allNodes.forEach(function(t){var e=!1;if(t!==d.selectedNode&&(d.selectedNode.parent&&it.isSubProcess(d.selectedNode.parent)?(t.parent&&it.isSubProcess(t.parent)&&t.parent.id===d.selectedNode.parent.id&&(e=!0),it.isSlotEvent(d.selectedNode)&&(e=!0)):(t.parent&&it.isSubProcess(t.parent)||(e=!0),t.parent&&it.isSubProcess(t.parent)&&it.isSlotEvent(t)&&(e=!0))),e){var n=d.calculateRect(t),i=et.getConnectorPoints(n,{rotation:n.rotation});a?Math.abs(i[a].x-r)<=s&&Math.abs(i[a].y-o)<=s&&(h=t):Math.abs(i.left.x-r)<=s&&Math.abs(i.left.y-o)<=s?(l="left",h=t):Math.abs(i.top.x-r)<=s&&Math.abs(i.top.y-o)<=s?(l="top",h=t):Math.abs(i.right.x-r)<=s&&Math.abs(i.right.y-o)<=s?(l="right",h=t):Math.abs(i.bottom.x-r)<=s&&Math.abs(i.bottom.y-o)<=s&&(l="bottom",h=t)}}),{node:h,endPos:l}}this.operationNode=new u(t,this._zr,this._api,this.forbidEdit),this.operationNode.on(u.ARROW_DRAGSTART,function(t){d.hideConnectorPoint(),d.filterConnectPoint(d.allNodes,t.event.target.lineType),d._zr.add(d.conPointsGroup);var e=t.event.offsetX,n=t.event.offsetY,i=t.event.target;t.data&&(d.lineOpt=t.data),i.hide();var r=new y(e,n),o=d.connectionManager.manageTempConnector(d.selectedNode,r,i.lineType);d._zr.add(o)}),this.operationNode.on(u.ARROW_DRAG,function(t){var n=t.event.offsetX,i=t.event.offsetY,r=new y(n,i),o=t.event.target;d.connectionManager.manageTempConnector(d.selectedNode,r,o.lineType),d.conPointsGroup.children().forEach(function(t){if(t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy],cursor:"crosshair"}),Math.abs(t.shape.cx-n)<=10&&Math.abs(t.shape.cy-i)<=10){var e=f(n,i,10);d.connectionManager.manageTempConnector(d.selectedNode,r,o.lineType,"right",e.endPos,e.node),t.attr({style:{fill:"#ff0000"},scale:[1.5,1.5],origin:[t.shape.cx,t.shape.cy],cursor:"pointer"})}})}),this.operationNode.on(u.ARROW_DRAGEND,function(t){var e,n=t.event.offsetX,i=t.event.offsetY,r=t.event.target;r.show();var o,s,a,h=f(n,i,10),l=h.endPos||"left",c=!1;e=h.node,r=t.event.target,d.connectionManager.removeTempConnector(d._zr),d.selectedNode.parent&&it.isSubProcess(d.selectedNode.parent)?(e&&it.isSlotEvent(d.selectedNode)&&(c=!0),e&&e.parent&&it.isSubProcess(e.parent)&&e.parent.id===d.selectedNode.parent.id&&(c=!0)):(e&&!e.parent&&(c=!0),e&&e.parent&&it.isSubProcess(e.parent)&&it.isSlotEvent(e)&&(c=!0)),c&&d.selectedNode.id!==e.id&&(o=d.selectedNode,s=e,a=t.data?t.data:{style:{lineType:r.lineType}},d._createConnectorByNodes(o,s,a,"right",l));d.hideConnectorPoint();var u=d.selectedNode,p=d.calculateRect(u);d.showConnectorPoint(void 0,void 0,!0),d.operationNode.refreshPostion(u,p)}),this.operationNode.on("OperationNode:deleteClick",function(){d.removeNode(d.selectedNode)}),this.operationNode.on("OperationNode:commentClick",function(){var e=d.selectedNode;if(!e.hasComment){var t,n;n=(t=-1!==e.bpmnInfo.name.indexOf("Event")||-1!==e.bpmnInfo.name.indexOf("Gateway")?e.position[0]+40:"SubProcess"===e.nodeType?e.position[0]+200:e.position[0]+120,e.position[1]-80);var i=new h({});i.set(it.BPMN_TYPE,"Comment"),i.set("bounds.upperLeft",{x:t,y:n}),i.set("properties",{name:"comment",operationIcons:[{name:"DEL",callback:function(t){e.hasComment=!1,d.remove(r)}}]});var r=d.addNodeByModel(i,!0);(i=new h({})).set("resourceId",et.getUUID()),i.set("style.lineType","straight"),i.set("style.lineDash",[3]),i.set("style.stroke","#000"),i.set("symbol.type","none"),i.set("stencil.type","SequenceFlow");var o=d.connectionManager.connectorCreateByOptions(e,r,{model:i},d._api);d._zr.add(o),e.hasComment=!0}}),this._zr.add(this.operationNode)},x.findNodeChildIds=function(t,e){e.push(t.id),t.children().filter(function(e){return-1!==this.allNodes.findIndex(function(t){return t.id===e.id})}.bind(this)).forEach(function(t){it.isSubProcess(t)?this.findNodeChildIds(t,e):e.push(t.id)}.bind(this))},x.remove=x.removeNode=function(h){var l=this._getParentZr(h),c=this;h instanceof f?this._triggerAsync("beforeDeleteLine",{target:h},h).then(function(t){t&&(K.each(h.icons,function(t){l.remove(t)}),c.connectionManager.deleteLine(l),c._trigger("afterDeleteLine",{target:h}),c.stepCounter())}):this._triggerAsync("beforeDeleteNode",{target:h},h).then(function(t){if(t){l.remove(h);var e=[];it.isSubProcess(h)?c.findNodeChildIds(h,e):e.push(h.id),c.allNodes=c.allNodes.filter(function(t){return-1===e.indexOf(t.id)}),c.domArray=c.domArray.filter(function(t){return-1===e.indexOf(t.id)});for(var n=0;n<c.overlapArray.length;n++)h.id==c.overlapArray[n].id&&c.overlapArray.splice(n,1);if(it.isSubProcess(h))for(var i=0;i<c.subProcessNode.length;i++)h.id==c.subProcessNode[i].id&&c.subProcessNode.splice(i,1);if(c._removeOperationNode(),c.connectionManager.deleteSelectCon(h,it.isSlotEvent(h)?c._zr:l),(it.isActivity(h)||it.isSubProcess(h))&&h.slotEvent&&0<h.slotEvent.length)for(i=0;i<h.slotEvent.length;i++){h.slotEvent[i].parent?it.isSubProcess(h.slotEvent[i].parent)&&h.slotEvent[i].parent.remove(h.slotEvent[i]):c._zr.remove(h.slotEvent[i]);for(var r=0;r<c.allNodes.length;r++)h.slotEvent[i].id==c.allNodes[r].id&&c.allNodes.splice(r,1);for(var o=0;o<c.domArray.length;o++)h.slotEvent[i].id==c.domArray[o].id&&c.domArray.splice(o,1)}if(it.isSlotEvent(h))for(var s=0;s<c.allNodes.length;s++)if(c.allNodes[s].isCanSlot&&c.allNodes[s].slotEvent&&0<c.allNodes[s].slotEvent.length)for(var a=0;a<c.allNodes[s].slotEvent.length;a++)h.id==c.allNodes[s].slotEvent[a].id&&c.allNodes[s].slotEvent.splice(a,1);c._trigger("afterDeleteNode",{target:h}),c.stepCounter()}})},x.removeSelectedNodes=function(){var r=this;if(this.selectedNodes.length){var o=r.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!it.isFlow(t)}),s=r.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&it.isFlow(t)});r.connectionManager.connectors.forEach(function(e){var t=o.find(function(t){return t.id===e.startNode.id}),n=o.find(function(t){return t.id===e.endNode.id}),i=s.findIndex(function(t){return t.id===e.id});(t||n)&&-1===i&&r.connectionManager.removeLine(e,e.parent?e.parent:r._zr)}),this.selectedNodes.forEach(function(t){r.removeNode(t)}),this.selectedNodes=[],this.dragSelectRect.off("mousedown"),this._zr.remove(this.dragSelectRect)}else r.removeNode(r.selectedNode)},x._createConnectorByNodes=function(n,i,r,o,s){var a=this;this._triggerAsync("beforeCreateLine",{target:n},[n,i]).then(function(t){if(t){var e=a.connectionManager.connectorCreate(n,i,r,a._api,o,s);return n.parent&&i.parent&&n.parent.resourceId===i.parent.resourceId?i.parent.add(e):a._zr.add(e),a.connectionManager.connectorForbidEdit(),a._createConnectorDragEvents(e),e.on("mousedown",K.bind(function(t){this.lineOperationManager.isEdit=!this.forbidEdit,this.isNode=!1,this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode()},a)),a._trigger("afterCreateLine",{target:e}),a.stepCounter(),e}})},x._createConnectorDragEvents=function(p){var d=this;p.on("dragstart",function(t){var e=t.event.offsetX,n=t.event.offsetY,i=this.opt,r=i.style.lineType,o=i.dockers,s=o[0],a=o[o.length-1],h=Math.abs(e-s.x)+Math.abs(n-s.y),l=Math.abs(e-a.x)+Math.abs(n-a.y);if(!(15<h&&15<l)){var c,u=new y(e,n);d.showConnectorPoint(void 0,void 0),d.reverseConnect=!1,d.selectConnNode=p.startNode,d.lineOpt=i.style,l<=15&&(d.selectConnNode=p.startNode,d.startPos=i.style.sPos,d.originNode=this.endNode,d.originPos=i.style.ePos),h<=15&&(d.reverseConnect=!0,d.selectConnNode=p.endNode,d.endPos=i.style.ePos,d.originNode=this.startNode,d.originPos=i.style.sPos),d.connectionManager.deleteByLine(this,d._zr),c=d.reverseConnect?d.connectionManager.manageReverseTempConnector(u,d.selectConnNode,r,d.endPos):d.connectionManager.manageTempConnector(d.selectConnNode,u,r,d.startPos),d._zr.add(c),c.setSelectedStyle()}}),p.on("drag",function(t){d._handleLineDrag("drag",t,this.opt.style.lineType)}),p.on("dragend",function(t){d._handleLineDrag("dragend",t,this.opt.style.lineType),d.hideConnectorPoint(),d.hideConnectorControl()})},x._triggerAsync=function(t,e,n){return this._trigger(t,e,n,!0)},x._trigger=function(t,e,n,i){var r=this.opts[t];return void 0===n&&(n={}),null===e?e={type:t,target:this}:e.type=t,e.data=n,this._api.trigger(e.type,e),i?v.resolve(!K.isFunction(r)||r.apply(this,[e].concat(n))).then(function(t){return!(!1===t)}).catch(function(t){console.log(t)}):!(K.isFunction(r)&&!1===r.apply(this,[e].concat(n)))},x.nodeClickHandler=function(t){var e="dragSelect"!==t.type&&this.ifShowConnectorPoint(t);if(t.parent&&"dragSelect"===t.parent.type&&(e=!1),this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),this._trigger("editOperationIcons",{target:t},t.operationIcons),!0!==this.forbidEdit){this.selectedNode=t;var n=this.calculateRect(t);if(this.operationNode||this.initOperationNode(t),this.rect&&this.rect.attr("style",{stroke:"rgba(0, 0, 0, 1)"}),e){this.showConnectorPoint(void 0,void 0,!0);var i=this.returnConnectorControlParam(t);(i.scaleable||i.rotatable)&&this.showConnectorControl()}this.operationNode.refreshPostion(t,n)}},x.initVirtualLine=function(t,e){nt.createGuidelines(this._zr),this.rect=new a.Polyline({position:[e.x,e.y],shape:{points:e.points},style:{lineDash:[2]},rotation:t.rotation,z:3}),this._zr.add(this.rect)},x.bindEventNode=function(){for(var t=0;t<this.allNodes.length;t++)this.allNodes[t].isCanSlot&&this.creatSlot(this.allNodes[t]);this._zr.on("mouseup",function(){for(var t=0;t<this.allNodes.length;t++)if(this.allNodes[t].isCanSlot&&this.allNodes[t].slot&&0<this.allNodes[t].slot.length)for(var e=0;e<this.allNodes[t].slot.length;e++)this.allNodes[t].remove(this.allNodes[t].slot[e])}.bind(this))},x.creatSlot=function(t){t.slot=[];for(var e=et.getSoltPoints(t),n=0;n<8;n++){var i=new a.Circle({position:e[n],shape:{cx:0,cy:0,r:10},style:{lineWidth:1,stroke:"rgba(0,0,0,0.6)",fill:"transparent"}});t.slot.push(i),t.add(i)}},x.updateSlotEvent=function(t){if(t.slotEvent&&0<t.slotEvent.length)for(var e=et.getSoltPoints(t),n=0;n<t.slotEvent.length;n++){var i=t.slotEvent[n].index,r=e[i];it.isSubProcess(t)||(r=[e[i][0]+t.position[0],e[i][1]+t.position[1]]),t.slotEvent[n].attr("position",r),this.connectionManager.refreshLineByNode(t.slotEvent[n])}},x._posInWhichSubprocess=function(t,e){if(0<t.length)for(var n=0;n<t.length;n++){var i=t[n],r=i.getRect(),o=r.width,s=r.height,a=tt.parentX(i),h=tt.parentY(i);if(e.x>=a&&e.y>=h&&e.x+e.width<=a+o&&e.y+e.height<=h+s){var l;if(i.children()&&0<i.children().length){var c=i.children().filter(function(t){return t.bpmnInfo&&"SubProcess"===t.nodeType});l=this._posInWhichSubprocess(c,e)}return l||i}}return null},x.getDragSelectContainer=function(){var s=[],a=[],h=[],l=[];return this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!it.isFlow(t)}).forEach(function(t){var e=t.getRect(),n=e.width,i=e.height,r=e.x,o=e.y;it.isEvent(t)||it.isGateway(t)?(s.push(r-n),a.push(o-i),h.push(r+n),l.push(o+i)):(s.push(r-n/2),a.push(o-i/2),h.push(r+n/2),l.push(o+i/2))}),{x:Math.min.apply(Math,s),y:Math.min.apply(Math,a),width:Math.max.apply(Math,h)-Math.min.apply(Math,s),height:newHeight=Math.max.apply(Math,l)-Math.min.apply(Math,a)}},x.newDrag=function(G,t,e){var V=this;V._removeOperationNode(),V.hideConnectorPoint(),V.hideConnectorControl(),V.selectedNode=G,V.isNode=!0;var b,w,C,P,S=this.opts.showGridLine?this.opts.gridLineSpacing:1,T=this.calculateRect(G),E=V.domArray;document.body.onkeydown=function(t){var e=t||window.event;if(46==e.keycode||46==e.charCode||46==e.which){if(1==V.isNode){V.selectedNode.off(),V.selectedNode.parent?it.isSubProcess(V.selectedNode.parent)&&V.selectedNode.parent.remove(V.selectedNode):V._zr.remove(V.selectedNode);for(var n=0;n<V.allNodes.length;n++)V.selectedNode.id==V.allNodes[n].id&&V.allNodes.splice(n,1);for(var i=0;i<E.length;i++)V.selectedNode.id==E[i].id&&E.splice(i,1);for(var r=0;r<V.overlapArray.length;r++)V.selectedNode.id==V.overlapArray[r].id&&V.overlapArray.splice(r,1);V.operationNode&&(V._zr.remove(V.operationNode),V.operationNode=null),V.connectionManager.deleteSelectCon(V.selectedNode,V._zr)}else V.connectionManager.deleteLine(V._zr);V.hideConnectorPoint(),V.hideConnectorControl(),V.stepCounter()}},b=t,w=e,C=T.x,P=T.y,V.rect?(V.rect.attr({position:[C,P],rotation:T.rotation||G.rotation}),V.rect.setShape({points:T.points}),V.rect.show()):(V.initVirtualLine(G,T),V.rect.attr("position",[C,P]));var Y,R,N,U,W,X,q=[C,P];"dragSelect"===G.type&&(U=this.getDragSelectContainer(),R=U.x+U.width/2+this.dragSelectRect.position[0],N=U.y+U.height/2+this.dragSelectRect.position[1],Y=[R,N],W=V.dragSelectRect.getRect(),X=V._posInWhichSubprocess(V.subProcessNode,{x:W.x-W.width/2,y:W.y-W.height/2,width:W.width,height:W.height}));var Q=0,Z=0,J=function(t){!function(t){for(var e=[V.getWidth()-(V.rect.shape.points[1][0]-V.rect.shape.points[0][0])/2,V.getHeight()-(V.rect.shape.points[2][1]-V.rect.shape.points[1][1])/2],n=[(V.rect.shape.points[1][0]-V.rect.shape.points[0][0])/2,(V.rect.shape.points[2][1]-V.rect.shape.points[1][1])/2],i=0;i<Math.abs(parseInt((t.event.clientX-b)/S));i++)Z=1,t.event.clientX-b<0?(q[0]=C-S*i,"dragSelect"===G.type&&(Y[0]=R-S*i)):(q[0]=C+S*i,"dragSelect"===G.type&&(Y[0]=R+S*i)),q[0]<n[0]&&(q[0]=n[0]),q[0]>e[0]&&(q[0]=e[0]);for(var r=0;r<Math.abs(parseInt((t.event.clientY-w)/S));r++)Z=1,t.event.clientY-w<0?(q[1]=P-S*r,"dragSelect"===G.type&&(Y[1]=N-S*r)):(q[1]=P+S*r,"dragSelect"===G.type&&(Y[1]=N+S*r)),q[1]<n[1]&&(q[1]=n[1]),q[1]>e[1]&&(q[1]=e[1]);function o(){Q=0,V.rect.attr("style",{stroke:"rgba(0, 0, 0, 1)"})}function s(){Q=1,V.rect.attr("style",{stroke:"rgba(255, 0, 0, 1)"})}function a(t,e){return!!e.parent&&(e.parent.id===t.id||a(t,e.parent))}if(V.rect.attr("position",q),V.containerNode=null,"dragSelect"===G.type){var h=V._posInWhichSubprocess(V.subProcessNode,{x:Y[0]-U.width/2,y:Y[1]-U.height/2,width:U.width,height:U.height}),l=V._JudgeNodeInWhichSubProcess(V.subProcessNode,{x:t.event.offsetX,y:t.event.offsetY});return!X&&l?s():o(),V.resetBackground(),X&&!h?(V.containerNode="zr",V.setBackground("#b6e3f5")):V.allNodes.filter(function(t){return it.isSubProcess(t)}).forEach(function(t){h&&h.id===t.id?(o(),V.containerNode=t,(!X||X&&X.id!==t.id)&&t.children().forEach(function(t){if("subprocess-rect"===t.name){if(!t.initStyle){var e=t.style.fill;t.attr("initStyle",e)}t.attr("style",{fill:"#b6e3f5"})}})):t.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}})})}nt.judgeAlignment(V.selectedNode,q,E,V.getWidth(),V.getHeight());for(var c=V._JudgeNodeInWhichSubProcess(V.subProcessNode,{x:q[0],y:q[1]}),u=0,p=V.allNodes.length;u<p;u++){var d,f,g=V.allNodes[u],v=g.getRect(),y=!0;if(o(),!(g.id===G.id||it.isSubProcess(G)&&a(G,g))&&(V.resetBackground(),it.isSubProcess(g)&&(g.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}}),c&&c.id===g.id&&(V.containerNode=g,(!G.parent||G.parent&&c.id!==G.parent.id)&&g.children().forEach(function(t){if("subprocess-rect"===t.name){if(!t.initStyle){var e=t.style.fill;t.attr("initStyle",e)}t.attr("style",{fill:"#b6e3f5"})}})),y=!1),G.parent&&!c&&(V.containerNode="zr",V.setBackground("#b6e3f5")),f=g.parent&&it.isSubProcess(g.parent)?(d=v.x+tt.parentX(g.parent),v.y+tt.parentY(g.parent)):(d=v.x,v.y),y))if(T.width>v.width)if(T.height>v.height){if(Math.abs(q[0]-d)<(v.width+T.width)/2&&Math.abs(q[1]-f)<(v.height+T.height)/2){s();break}o()}else{if(Math.abs(q[0]-d)<(v.width+T.width)/2&&Math.abs(q[1]-f)<(v.height+T.height)/2){s();break}o()}else if(T.height>v.height){if(Math.abs(q[0]-d)<(v.width+T.width)/2&&Math.abs(q[1]-f)<(v.height+T.height)/2){s();break}o()}else{if(Math.abs(q[0]-d)<(v.width+T.width)/2&&Math.abs(q[1]-f)<(v.height+T.height)/2){s();break}o()}}if(it.isSlotEvent(G))for(var m=0;m<V.allNodes.length;m++)if(V.allNodes[m].isCanSlot&&V.allNodes[m].slot&&0<V.allNodes[m].slot.length)for(var _=0;_<V.allNodes[m].slot.length;_++){var x=[V.allNodes[m].slot[_].position[0]+V.allNodes[m].position[0],V.allNodes[m].slot[_].position[1]+V.allNodes[m].position[1]];if(q[0]==x[0]&&q[1]==x[1]){V.rect.attr("style",{stroke:"rgba(0, 255, 0, 1)"}),Q=0;break}}}(t)},$=function(t){!function(){V._zr.off("mousemove",J),V._zr.off("mouseup",$),V._zr.off("globalout",$),G.parent&&G.parent.off("globalout",$);V.rect.hide(),nt.resetLines(),!V.containerNode&&G.parent&&it.isSubProcess(G.parent)?V.containerNode=G.parent:"zr"===V.containerNode&&(V.containerNode=null);var t=!1,e=null,n=null;if(0==Q){if(V.containerNode){var i=V.calculateRect(V.containerNode),r=-i.rotation,o=q;0<Math.abs(r)&&(o=et.calculatePoints(q,i,r)),e=o[0]-i.boundingRect.x,n=o[1]-i.boundingRect.y}var s="number"==typeof e?e:q[0],a="number"==typeof n?n:q[1];if(G.setPosition(s,a),V.updateSlotEvent(G),V.containerNode){if(G.parent&&V.containerNode.id!==G.parent.id)G.parent.remove(G),V.containerNode.add(G),t=!0;else if(G.parent||"dragSelect"===G.type){if("dragSelect"===G.type){var h=V.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!it.isFlow(t)}),l=V.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&it.isFlow(t)});V.connectionManager.connectors.forEach(function(e){var t=h.find(function(t){return t.id===e.startNode.id}),n=h.find(function(t){return t.id===e.endNode.id}),i=l.findIndex(function(t){return t.id===e.id});(t||n)&&-1===i&&V.connectionManager.removeLine(e,e.parent?e.parent:V._zr)}),l.forEach(function(t){V.dragSelectRect.remove(t),V.containerNode.add(t)});for(var c=X&&X.id===V.containerNode.id?W.width:U.width,u=X&&X.id===V.containerNode.id?W.height:U.height,p=0;p<h.length;p++){var d,f,g=h[p],v=g.getRect().x,y=g.getRect().y;f=X&&X.id===V.containerNode.id?(d=q[0],q[1]):(d=Y[0],Y[1]);var m=d-tt.parentX(V.containerNode)-c/2,_=f-tt.parentY(V.containerNode)-u/2,x=v+m,b=y+_;if(g.slotEvent&&0<g.slotEvent.length)for(var w=0;w<g.slotEvent.length;w++){var C=[g.slotEvent[w].position[0]+x-K.clone(g.position[0])-g.getBoundingRect().width/2,g.slotEvent[w].position[1]+b-K.clone(g.position[1])-g.getBoundingRect().height/2];g.slotEvent[w].attr("position",C),V.connectionManager.refreshLineByNode(g.slotEvent[w])}V.dragSelectRect.remove(g),V.containerNode.add(g),g.setPosition(x,b),g.originParent&&(g.originParent=null);for(var P=0;P<V.overlapArray.length;P++)g.id==V.overlapArray[P].id&&V.overlapArray.splice(P,1);for(w=0;w<V.domArray.length;w++)g.id==V.domArray[w].id&&(V.domArray[w].position=[v+(Y[0]-c/2),y+(Y[1]-u/2)]);V.connectionManager.refreshLineByNode(g)}V.dragSelectRect.off("mousedown"),V._zr.remove(V.dragSelectRect)}}else{V._zr.remove(G),V.containerNode.add(G),t=!0;for(var S=0;S<V.overlapArray.length;S++)G.id==V.overlapArray[S].id&&V.overlapArray.splice(S,1)}V.containerNode.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}})}else G.parent&&(G.parent.remove(G),V._zr.add(G),t=!0,it.isSlotEvent(G)||V.overlapArray.push({id:G.id,position:[q[0],q[1]],width:G.getRect().width,height:G.getRect().height}));if("dragSelect"!==G.type){for(var T=0;T<V.domArray.length;T++)G.id==V.domArray[T].id&&(V.domArray[T].position=[q[0],q[1]]);if(!V.containerNode&&!G.parent)for(S=0;S<V.overlapArray.length;S++)G.id==V.overlapArray[S].id&&(V.overlapArray[S]={id:G.id,position:[q[0],q[1]],width:G.getRect().width,height:G.getRect().height})}else if(!V.containerNode){var E=V.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!it.isFlow(t)});l=V.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&it.isFlow(t)});V.connectionManager.connectors.forEach(function(e){var t=E.find(function(t){return t.id===e.startNode.id}),n=E.find(function(t){return t.id===e.endNode.id}),i=l.findIndex(function(t){return t.id===e.id});(t||n)&&-1===i&&V.connectionManager.removeLine(e,e.parent?e.parent:V._zr)});var R=V.dragSelectRect.options.shape.width,N=V.dragSelectRect.options.shape.height;for(p=0;p<E.length;p++){for(var M=E[p],k=M.getRect().x,A=M.getRect().y,L=0;L<V.domArray.length;L++)M.id==V.domArray[L].id&&(V.domArray[L].position=[k+(q[0]-R/2),A+(q[1]-N/2)]);for(var O=0;O<V.overlapArray.length;O++)M.id==V.overlapArray[O].id&&(V.overlapArray[O].position=[k+(q[0]-R/2),A+(q[1]-N/2)])}X&&V._releaseSelectNode(!0)}}else V.containerNode&&V.containerNode.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}});V.resetBackground(),V.containerNode=null,1==Z&&(t?V.connectionManager.connectors.filter(function(t){return t.startNode.id===G.id||t.endNode.id===G.id}).forEach(function(t){V.connectionManager.removeLine(t,t.parent?t.parent:V._zr)}):V.connectionManager.refreshLineByNode(G),V.nodeClickHandler(G),V.stepCounter());if(it.isSlotEvent(G)&&0==Q){var z=[];G.parent?it.isSubProcess(G.parent)&&(z[0]=q[0]-tt.parentX(G.parent),z[1]=q[1]-tt.parentY(G.parent)):z=q;for(p=0;p<V.allNodes.length;p++)if(V.allNodes[p].isCanSlot&&V.allNodes[p].slot&&0<V.allNodes[p].slot.length){for(var I,F=!0,B=!1,j=0;j<V.allNodes[p].slot.length;j++){var D=[V.allNodes[p].slot[j].position[0]+V.allNodes[p].position[0],V.allNodes[p].slot[j].position[1]+V.allNodes[p].position[1]];if(q[0]==D[0]&&q[1]==D[1]){F=!1,I=j;break}}for(var H=0;H<V.allNodes[p].slotEvent.length;H++)G.id==V.allNodes[p].slotEvent[H].id&&(B=!0,V.allNodes[p].slotEvent[H].index=I,F&&V.allNodes[p].slotEvent.splice(H,1));B||F?B&&F&&delete G.index:(G.index=I,V.allNodes[p].slotEvent.push(G))}}}()};this._zr.on("mousemove",J),this._zr.on("mouseup",$),this._zr.on("globalout",$)},x.setBackground=function(t){this.zrBackground=new a.Rect({shape:{width:this._zr.getWidth(),height:this._zr.getHeight()},style:{fill:t},cursor:"default",z:-1}),this._zr.add(this.zrBackground)},x.resetBackground=function(){this.zrBackground&&this._zr.remove(this.zrBackground)},x.creatTip=function(t){var e=new a.Group;e.isShow=!1;var n,i=t.model.get("properties.name")||"";n=64<i.length?i.substr(0,64)+"..":i;var r=new a.Text({style:{text:n,textFont:"16px Microsoft YaHei",fill:"#000000",textBaseline:"top"},position:[2,0],z:2});r.name="Text",e.add(r);var o=new a.Polyline({style:{fill:"#f9f9f9",stroke:"#bbbbbb"},z:1});o.name="Polyline",e.add(o),this._zr.add(e),(t.alarm=e).hide(),e.eachChild(function(t){t.hide()})},x.stepCounter=function(){this.stepJson.splice(this.step,this.stepJson.length-this.step),this.step+=1;var t=this.toJson();this.stepJson.push(JSON.stringify(t))},x.zrScale=function(t){if("narrowing"==t){this.zoom(-.07,this._zr.getWidth()/2,this._zr.getHeight()/2)}if("enlarge"==t){this.zoom(.07,this._zr.getWidth()/2,this._zr.getHeight()/2)}if(!isNaN(t)&&this.group){var e=t/this._zoom;this._zoom=t,this.nowZoom=t,this.setScale(this._zr.getWidth()/2,this._zr.getHeight()/2,e)}},x.zoom=function(t,e,n){if(this.group){var i=this._zoom=this._zoom||1;i+=t;var r=(i=Number(i.toFixed(2)))/this._zoom;if(1.7<i||i<.3)return;this._zoom=i,this.nowZoom=i,this.setScale(e,n,r)}},x.setScale=function(t,e,n){var i=this.findElements(function(t){return!0}),r=this.group;i.push(r),i.forEach(function(t){t.position;var e=t.scale;e[0]*=n,e[1]*=n,t.attr("scale",[e[0],e[1]])})},x.nodeEdit=function(e){var t=e.childOfName("lineText");if(!0!==this.forbidEdit){var n=!1,i=et.getRect(e),r=this.createTextArea(),o=K.clone(e.model.get("properties.name")),s=e instanceof f&&t?g.getBoundingRect(t.style.text,"12px"):g.getBoundingRect(o,"12px"),a=.6*i.width,h=(0==s.width?a:e instanceof f&&60<s.width?1.2*s.width:2*s.width)*this.nowZoom,l=(2*s.height||24)*this.nowZoom;r.style.width=h+"px",r.style.height=l+"px";var c=1.2*i.width*this.nowZoom;r.style.maxWidth=c+"px",r.style.lineHeight=(1.2*s.lineHeight||14.4)+"px",r.style.border="1px dashed #2e2e2e",r.innerHTML=e.model.get("properties.name"),this.setShapeModel(e,{properties:{name:""}}),this._dom.appendChild(r),this._dom.style.position="relative";var u=0,p=0;if(e instanceof f)if(e.parent&&it.isSubProcess(e.parent)&&(u=tt.parentX(e.parent),p=tt.parentY(e.parent)),t)r.style.top=(t.position[1]+p+s.height/2-l/2)*this.nowZoom+this.group.position[1]+"px",r.style.left=(t.position[0]+u-h/2)*this.nowZoom+this.group.position[0]+"px";else{var d=e.middle();r.style.top=(d[1]+p+s.height/2-l/2)*this.nowZoom+this.group.position[1]+"px",r.style.left=(d[0]+u-h/2)*this.nowZoom+this.group.position[0]+"px"}else p=e.parent&&it.isSubProcess(e.parent)?(u=i.x+tt.parentX(e.parent),i.y+tt.parentY(e.parent)):(u=i.x,i.y),r.style.top=(p-l/2+0*(i.height-s.height/2))*this.nowZoom+this.group.position[1]+"px",r.style.left=(u-1*(h<c?h:c)/2)*this.nowZoom+this.group.position[0]+"px";r.focus(),r.select(),r.onkeyup=function(){if(event.keyCode==m)n=!0,r.blur();else{var t=g.getBoundingRect(r.value,"12px");this._textareaResize(t,r,r.style.maxWidth)}}.bind(this),r.onblur=function(){if(n)this.setShapeModel(e,{properties:{name:o}});else{var t=this.handleWrap(r.value,r.style.maxWidth);this.setShapeModel(e,{properties:{name:t}}),this._trigger("afterEditNode",{target:e})}r.remove()}.bind(this)}},x.createTextArea=function(){var t=document.createElement("textarea");return t.style.position="absolute",t.style.padding="6px",t.style.resize="none",t.style.whiteSpace="pre",t.style.lineHeight="125%",t.style.overflow="hidden",t.style.border="0",t.spellcheck=!1,t},x.handleWrap=function(t,a){var h=document.createElement("span");h.style.position="absolute",h.style.overflow="hidden",h.style.border="0",h.style.padding="0",h.style.left="0",h.style.top="0",this._dom.appendChild(h);var l=t.split("\n"),c="";return l.forEach(function(t,e){var n=t.length;if(0==n);else for(var i,r,o="",s=0;s<n;s++)i=t.charAt(s),h.innerHTML=h.innerHTML+i,r=h.clientWidth,Number(a.substring(0,a.length-2))<r?(c+=o,c+="\n",o=h.innerHTML=i):s==n-1?(c+=o+i,e<l.length-1&&(c+="\n"),o=h.innerHTML=""):o+=i}),this._dom.removeChild(h),c},x._textareaResize=function(t,e,n){var i=0;e.style.width=0,e.style.width=1.1*t.width*this.nowZoom+"px",i=n<60?n:60,t.width<=i&&(e.style.width=i+"px"),e.style.height="0px",e.style.height=e.scrollHeight+"px",e.scrollHeight<=0&&(e.style.height="12px")},K.mixin(_,r);var b=new Date-0,w={},C="_fishTopoBpmn_instance_",P={version:"3.2.0",dependencies:{zrender:"3.0.4"},init:function(t,e){if(!t)throw new Error("Initialize failed: invalid dom.");e=e||{},K.defaults(e,{type:"bpmn",showGridLine:!0,gridLineSpacing:10,beforeDeleteNode:null,beforeCreateNode:null,beforeDeleteLine:null,beforeCreateLine:null,connectable:!0,scaleable:!1,rotatable:!1});var n=new _(t,e);return n.init(),n.id="ft_"+b++,w[n.id]=n,t.setAttribute&&t.setAttribute(C,n.id),n},getInstanceByDom:function(t){var e=t.getAttribute(C);return w[e]},dispose:function(t){var e;K.isDom(t)?e=P.getInstanceByDom(t):"string"==typeof t&&(e=w[t]),e instanceof P&&!e.isDisposed()&&e.dispose()}};P.Bpmn=it,P.BPMNNode=l,P.graphic=a,P.BoundingRect=s,P.BPMNModel=h,P.util={},K.each(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend"],function(t){P.util[t]=K[t]}),t.exports=P},function(t,e,n){"use strict";var u=n(4),p=n(5),r=Math.round,i=n(6),a=n(19),o=n(13),s=n(14),h=n(41),d=n(42),l={};function c(t){if(!t.__isHover){if(t.__hoverStlDirty){var e=t.style.stroke,n=t.style.fill,i=t.__hoverStl,r=a.lift;i.fill=i.fill||n&&(n instanceof h?n:r(n,-.1)),i.stroke=i.stroke||e&&(e instanceof h?e:r(e,-.1));var o={};for(var s in i)i.hasOwnProperty(s)&&(o[s]=t.style[s]);t.__normalStl=o,t.__hoverStlDirty=!1}t.setStyle(t.__hoverStl),t.z2+=1,t.__isHover=!0}}function f(t){if(t.__isHover){var e=t.__normalStl;e&&t.setStyle(e),t.z2-=1,t.__isHover=!1}}function g(t){"group"===t.type||"GroupNode"===t.type?t.traverse(function(t){"group"!==t.type&&c(t)}):c(t)}function v(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&f(t)}):f(t)}function y(t,e){t.__hoverStl=t.hoverStyle||e||{},t.__hoverStlDirty=!0}function m(){this.__isEmphasis||g(this)}function _(){this.__isEmphasis||v(this)}function x(){this.__isEmphasis=!0,g(this)}function b(){this.__isEmphasis=!1,v(this)}function w(t,e,n,i,r){var o=t?"Update":"",s=i&&i.getShallow("animationDuration"+o),a=i&&i.getShallow("animationEasing"+o);i&&i.getShallow("animation")?e.animateTo(n,s,a,r):(e.attr(n),r&&r())}l.Util=u,l.Group=n(43),l.Image=n(44),l.Text=n(45),l.textContain=n(25),l.Circle=n(46),l.Sector=n(47),l.Ring=n(50),l.Polygon=n(51),l.Polyline=n(55),l.Rect=n(56),l.Line=n(57),l.BezierCurve=n(58),l.Arc=n(59),l.LinearGradient=n(60),l.RadialGradient=n(61),l.BoundingRect=n(26),l.States=n(62),l.extendShape=function(t){return i.extend(t)},l.extendPath=function(t,e){return p.extendFromString(t,e)},l.makePath=function(t,e,n,i){var r=p.createFromString(t,e);d.call(r);var o=r.getBoundingRect();if(n){var s=o.width/o.height;if("center"===i){var a,h=n.height*s;a=h<=n.width?n.height:(h=n.width)/s;var l=n.x+n.width/2,c=n.y+n.height/2;n.x=l-h/2,n.y=c-a/2,n.width=h,n.height=a}this.resizePath(r,n)}return u.inherits(r,d),r},l.mergePath=p.mergePath,l.resizePath=function(t,e){if(t.applyTransform){var n=t.getBoundingRect().calculateTransform(e);t.applyTransform(n)}},l.subPixelOptimizeLine=function(t){var e=l.subPixelOptimize,n=t.shape,i=t.style.lineWidth;return r(2*n.x1)===r(2*n.x2)&&(n.x1=n.x2=e(n.x1,i,!0)),r(2*n.y1)===r(2*n.y2)&&(n.y1=n.y2=e(n.y1,i,!0)),t},l.subPixelOptimizeRect=function(t){var e=l.subPixelOptimize,n=t.shape,i=t.style.lineWidth,r=n.x,o=n.y,s=n.width,a=n.height;return n.x=e(n.x,i,!0),n.y=e(n.y,i,!0),n.width=Math.max(e(r+s,i,!1)-n.x,0===s?0:1),n.height=Math.max(e(o+a,i,!1)-n.y,0===a?0:1),t},l.subPixelOptimize=function(t,e,n){var i=r(2*t);return(i+r(e))%2==0?i/2:(i+(n?1:-1))/2},l.doEnterHover=g,l.doLeaveHover=v,l.setElementHoverStl=y,l.setHoverStyle=function(t,e){"group"===t.type?t.traverse(function(t){"group"!==t.type&&y(t,e)}):y(t,e),t.on("mouseover",m).on("mouseout",_),t.on("emphasis",x).on("normal",b)},l.setNormalStyle=function(t,e){if(t.__normalStl)for(var n in e)t.__normalStl.hasOwnProperty(n)&&(t.__normalStl[n]=e[n])},l.setText=function(t,e,n){var i=e.getShallow("position")||"inside",r=0<=i.indexOf("inside")?"white":n,o=e.getModel("textStyle");u.extend(t,{textDistance:e.getShallow("distance")||5,textFont:o.getFont(),textPosition:i,textFill:o.getTextColor()||r})},l.updateProps=u.curry(w,!0),l.initProps=u.curry(w,!1),l.getTransform=function(t,e){for(var n=o.identity([]);t&&t!==e;)o.mul(n,t.getLocalTransform(),n),t=t.parent;return n},l.applyTransform=function(t,e,n){return n&&(e=o.invert([],e)),s.applyTransform([],t,e)},l.transformDirection=function(t,e,n){var i=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),o=["left"===t?-i:"right"===t?i:0,"top"===t?-r:"bottom"===t?r:0];return o=l.applyTransform(o,e,n),Math.abs(o[0])>Math.abs(o[1])?0<o[0]?"right":"left":0<o[1]?"bottom":"top"},t.exports=l},function(t,e){var a={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},h={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},l=Object.prototype.toString,n=Array.prototype,s=n.forEach,c=n.filter,i=n.slice,u=n.map,p=n.reduce,r={};function d(t){if(null==t||"object"!=typeof t)return t;var e=t,n=l.call(t);if("[object Array]"===n){e=[];for(var i=0,r=t.length;i<r;i++)e[i]=d(t[i])}else if(h[n]){var o=t.constructor;if(t.constructor.from)e=o.from(t);else{e=new o(t.length);for(i=0,r=t.length;i<r;i++)e[i]=d(t[i])}}else if(!a[n]&&!P(t)&&!w(t))for(var s in e={},t)t.hasOwnProperty(s)&&(e[s]=d(t[s]));return e}function f(t,e,n){if(!x(e)||!x(t))return n?d(e):t;for(var i in e)if(e.hasOwnProperty(i)){var r=t[i],o=e[i];!x(o)||!x(r)||_(o)||_(r)||w(o)||w(r)||b(o)||b(r)||P(o)||P(r)?!n&&i in t||(t[i]=d(e[i])):f(r,o,n)}return t}function o(t,e,n){for(var i in e)e.hasOwnProperty(i)&&(n?null!=e[i]:null==t[i])&&(t[i]=e[i]);return t}function g(){return r.createCanvas()}var v;function y(t,e,n){if(t&&e)if(t.forEach&&t.forEach===s)t.forEach(e,n);else if(t.length===+t.length)for(var i=0,r=t.length;i<r;i++)e.call(n,t[i],i,t);else for(var o in t)t.hasOwnProperty(o)&&e.call(n,t[o],o,t)}function m(t,e){var n=i.call(arguments,2);return function(){return t.apply(e,n.concat(i.call(arguments)))}}function _(t){return"[object Array]"===l.call(t)}function x(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function b(t){return!!a[l.call(t)]}function w(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}r.createCanvas=function(){return document.createElement("canvas")};var C="__ec_primitive__";function P(t){return t[C]}function S(t){t&&y(t,function(t,e){this.set(e,t)},this)}var T="_ec_";S.prototype={constructor:S,get:function(t){return this[T+t]},set:function(t,e){return this[T+t]=e},each:function(t,e){for(var n in void 0!==e&&(t=m(t,e)),this)this.hasOwnProperty(n)&&t(this[n],n.slice(4))},removeKey:function(t){delete this[T+t]}},e.$override=function(t,e){r[t]=e},e.clone=d,e.merge=f,e.mergeAll=function(t,e){for(var n=t[0],i=1,r=t.length;i<r;i++)n=f(n,t[i],e);return n},e.extend=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},e.defaults=o,e.createCanvas=g,e.getContext=function(){return v=v||g().getContext("2d")},e.indexOf=function(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n}return-1},e.inherits=function(t,e){var n=t.prototype;function i(){}for(var r in i.prototype=e.prototype,t.prototype=new i,n)t.prototype[r]=n[r];(t.prototype.constructor=t).superClass=e},e.mixin=function(t,e,n){o(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,n)},e.isArrayLike=function(t){if(t)return"string"!=typeof t&&"number"==typeof t.length},e.each=y,e.map=function(t,e,n){if(t&&e){if(t.map&&t.map===u)return t.map(e,n);for(var i=[],r=0,o=t.length;r<o;r++)i.push(e.call(n,t[r],r,t));return i}},e.reduce=function(t,e,n,i){if(t&&e){if(t.reduce&&t.reduce===p)return t.reduce(e,n,i);for(var r=0,o=t.length;r<o;r++)n=e.call(i,n,t[r],r,t);return n}},e.filter=function(t,e,n){if(t&&e){if(t.filter&&t.filter===c)return t.filter(e,n);for(var i=[],r=0,o=t.length;r<o;r++)e.call(n,t[r],r,t)&&i.push(t[r]);return i}},e.find=function(t,e,n){if(t&&e)for(var i=0,r=t.length;i<r;i++)if(e.call(n,t[i],i,t))return t[i]},e.bind=m,e.curry=function(t){var e=i.call(arguments,1);return function(){return t.apply(this,e.concat(i.call(arguments)))}},e.isArray=_,e.isFunction=function(t){return"function"==typeof t},e.isString=function(t){return"[object String]"===l.call(t)},e.isObject=x,e.isBuiltInObject=b,e.isDom=w,e.eqNaN=function(t){return t!=t},e.retrieve=function(t){for(var e=0,n=arguments.length;e<n;e++)if(null!=arguments[e])return arguments[e]},e.retrieve2=function(t,e){return null!=t?t:e},e.retrieve3=function(t,e,n){return null!=t?t:null!=e?e:n},e.slice=function(){return Function.call.apply(i,arguments)},e.normalizeCssArray=function(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t},e.assert=function(t,e){if(!t)throw new Error(e)},e.setAsPrimitive=function(t){t[C]=!0},e.isPrimitive=P,e.createHashMap=function(t){return new S(t)},e.noop=function(){}},function(t,e,n){function i(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}var a=n(6),T=n(29),r=n(40),E=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],P=Math.sqrt,S=Math.sin,R=Math.cos,N=Math.PI,M=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(i(t)*i(e))},k=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(M(t,e))};function A(t,e,n,i,r,o,s,a,h,l,c){var u=h*(N/180),p=R(u)*(t-n)/2+S(u)*(e-i)/2,d=-1*S(u)*(t-n)/2+R(u)*(e-i)/2,f=p*p/(s*s)+d*d/(a*a);1<f&&(s*=P(f),a*=P(f));var g=(r===o?-1:1)*P((s*s*(a*a)-s*s*(d*d)-a*a*(p*p))/(s*s*(d*d)+a*a*(p*p)))||0,v=g*s*d/a,y=g*-a*p/s,m=(t+n)/2+R(u)*v-S(u)*y,_=(e+i)/2+S(u)*v+R(u)*y,x=k([1,0],[(p-v)/s,(d-y)/a]),b=[(p-v)/s,(d-y)/a],w=[(-1*p-v)/s,(-1*d-y)/a],C=k(b,w);M(b,w)<=-1&&(C=N),1<=M(b,w)&&(C=0),0===o&&0<C&&(C-=2*N),1===o&&C<0&&(C+=2*N),c.addData(l,m,_,s,a,x,C,u,o)}function o(t,e){var n=function(t){if(!t)return[];var e,n=t.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(e=0;e<E.length;e++)n=n.replace(new RegExp(E[e],"g"),"|"+E[e]);var i,r=n.split("|"),o=0,s=0,a=new T,h=T.CMD;for(e=1;e<r.length;e++){var l,c=r[e],u=c.charAt(0),p=0,d=c.slice(1).replace(/e,-/g,"e-").split(",");0<d.length&&""===d[0]&&d.shift();for(var f=0;f<d.length;f++)d[f]=parseFloat(d[f]);for(;p<d.length&&!isNaN(d[p])&&!isNaN(d[0]);){var g,v,y,m,_,x,b,w=o,C=s;switch(u){case"l":o+=d[p++],s+=d[p++],l=h.L,a.addData(l,o,s);break;case"L":o=d[p++],s=d[p++],l=h.L,a.addData(l,o,s);break;case"m":o+=d[p++],s+=d[p++],l=h.M,a.addData(l,o,s),u="l";break;case"M":o=d[p++],s=d[p++],l=h.M,a.addData(l,o,s),u="L";break;case"h":o+=d[p++],l=h.L,a.addData(l,o,s);break;case"H":o=d[p++],l=h.L,a.addData(l,o,s);break;case"v":s+=d[p++],l=h.L,a.addData(l,o,s);break;case"V":s=d[p++],l=h.L,a.addData(l,o,s);break;case"C":l=h.C,a.addData(l,d[p++],d[p++],d[p++],d[p++],d[p++],d[p++]),o=d[p-2],s=d[p-1];break;case"c":l=h.C,a.addData(l,d[p++]+o,d[p++]+s,d[p++]+o,d[p++]+s,d[p++]+o,d[p++]+s),o+=d[p-2],s+=d[p-1];break;case"S":g=o,v=s;var P=a.len(),S=a.data;i===h.C&&(g+=o-S[P-4],v+=s-S[P-3]),l=h.C,w=d[p++],C=d[p++],o=d[p++],s=d[p++],a.addData(l,g,v,w,C,o,s);break;case"s":g=o,v=s;P=a.len(),S=a.data;i===h.C&&(g+=o-S[P-4],v+=s-S[P-3]),l=h.C,w=o+d[p++],C=s+d[p++],o+=d[p++],s+=d[p++],a.addData(l,g,v,w,C,o,s);break;case"Q":w=d[p++],C=d[p++],o=d[p++],s=d[p++],l=h.Q,a.addData(l,w,C,o,s);break;case"q":w=d[p++]+o,C=d[p++]+s,o+=d[p++],s+=d[p++],l=h.Q,a.addData(l,w,C,o,s);break;case"T":g=o,v=s;P=a.len(),S=a.data;i===h.Q&&(g+=o-S[P-4],v+=s-S[P-3]),o=d[p++],s=d[p++],l=h.Q,a.addData(l,g,v,o,s);break;case"t":g=o,v=s;P=a.len(),S=a.data;i===h.Q&&(g+=o-S[P-4],v+=s-S[P-3]),o+=d[p++],s+=d[p++],l=h.Q,a.addData(l,g,v,o,s);break;case"A":y=d[p++],m=d[p++],_=d[p++],x=d[p++],b=d[p++],A(w=o,C=s,o=d[p++],s=d[p++],x,b,y,m,_,l=h.A,a);break;case"a":y=d[p++],m=d[p++],_=d[p++],x=d[p++],b=d[p++],A(w=o,C=s,o+=d[p++],s+=d[p++],x,b,y,m,_,l=h.A,a)}}"z"!==u&&"Z"!==u||(l=h.Z,a.addData(l)),i=l}return a.toStatic(),a}(t);return(e=e||{}).buildPath=function(t){if(t.setData){t.setData(n.data),(e=t.getContext())&&t.rebuildPath(e)}else{var e=t;n.rebuildPath(e)}},e.applyTransform=function(t){r(n,t),this.dirty(!0)},e}e.createFromString=function(t,e){return new a(o(t,e))},e.extendFromString=function(t,e){return a.extend(o(t,e))},e.mergePath=function(t,e){for(var n=[],i=t.length,r=0;r<i;r++){var o=t[r];o.path||o.createPathProxy(),o.__dirtyPath&&o.buildPath(o.path,o.shape,!0),n.push(o.path)}var s=new a(e);return s.createPathProxy(),s.buildPath=function(t){t.appendPath(n);var e=t.getContext();e&&t.rebuildPath(e)},s}},function(t,e,n){var i=n(7),o=n(4),a=n(29),h=n(32),y=n(39).prototype.getCanvasPattern,r=Math.abs,m=new a(!0);function s(t){i.call(this,t),this.path=null}s.prototype={constructor:s,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function(t,e){var n,i=this.style,r=this.path||m,o=i.hasStroke(),s=i.hasFill(),a=i.fill,h=i.stroke,l=s&&!!a.colorStops,c=o&&!!h.colorStops,u=s&&!!a.image,p=o&&!!h.image;i.bind(t,this,e),this.setTransform(t),this.__dirty&&(l&&(n=n||this.getBoundingRect(),this._fillGradient=i.getGradient(t,a,n)),c&&(n=n||this.getBoundingRect(),this._strokeGradient=i.getGradient(t,h,n)));l?t.fillStyle=this._fillGradient:u&&(t.fillStyle=y.call(a,t)),c?t.strokeStyle=this._strokeGradient:p&&(t.strokeStyle=y.call(h,t));var d=i.lineDash,f=i.lineDashOffset,g=!!t.setLineDash,v=this.getGlobalScale();r.setScale(v[0],v[1]),this.__dirtyPath||d&&!g&&o?(r.beginPath(t),d&&!g&&(r.setLineDash(d),r.setLineDashOffset(f)),this.buildPath(r,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(t.beginPath(),this.path.rebuildPath(t)),s&&r.fill(t),d&&g&&(t.setLineDash(d),t.lineDashOffset=f),o&&r.stroke(t),d&&g&&t.setLineDash([]),this.restoreTransform(t),null!=i.text&&this.drawRectText(t,this.getBoundingRect())},buildPath:function(t,e,n){},createPathProxy:function(){this.path=new a},getBoundingRect:function(){var t=this._rect,e=this.style,n=!t;if(n){var i=this.path;i=i||(this.path=new a),this.__dirtyPath&&(i.beginPath(),this.buildPath(i,this.shape,!1)),t=i.getBoundingRect()}if(this._rect=t,e.hasStroke()){var r=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||n){r.copy(t);var o=e.lineWidth,s=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),1e-10<s&&(r.width+=o/s,r.height+=o/s,r.x-=o/s/2,r.y-=o/s/2)}return r}return t},contain:function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect(),r=this.style;if(t=n[0],e=n[1],i.contain(t,e)){var o=this.path.data;if(r.hasStroke()){var s=r.lineWidth,a=r.strokeNoScale?this.getLineScale():1;if(1e-10<a&&(r.hasFill()||(s=Math.max(s,this.strokeContainThreshold)),h.containStroke(o,s/a,t,e)))return!0}if(r.hasFill())return h.contain(o,t,e)}return!1},dirty:function(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(t){return this.animate("shape",t)},attrKV:function(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):i.prototype.attrKV.call(this,t,e)},setShape:function(t,e){var n=this.shape;if(n){if(o.isObject(t))for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);else n[t]=e;this.dirty(!0)}return this},getLineScale:function(){var t=this.transform;return t&&1e-10<r(t[0]-1)&&1e-10<r(t[3]-1)?Math.sqrt(r(t[0]*t[3]-t[2]*t[1])):1}},s.extend=function(r){function t(t){s.call(this,t),r.style&&this.style.extendFrom(r.style,!1);var e=r.shape;if(e){this.shape=this.shape||{};var n=this.shape;for(var i in e)!n.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(n[i]=e[i])}r.init&&r.init.call(this,t)}for(var e in o.inherits(t,s),r)"style"!==e&&"shape"!==e&&(t.prototype[e]=r[e]);return t},o.inherits(s,i);var l=s;t.exports=l},function(t,e,n){var i=n(4),r=n(8),o=n(9),s=n(23);function a(t){for(var e in t=t||{},o.call(this,t),t)t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);this.style=new r(t.style,this),this._rect=null,this.__clipPaths=[]}a.prototype={constructor:a,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:-1,beforeBrush:function(t){},afterBrush:function(t){},brush:function(t,e){},getBoundingRect:function(){},contain:function(t,e){return this.rectContain(t,e)},traverse:function(t,e){t.call(e,this)},rectContain:function(t,e){var n=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(n[0],n[1])},dirty:function(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(t){return this.animate("style",t)},attrKV:function(t,e){"style"!==t?o.prototype.attrKV.call(this,t,e):this.style.set(e)},setStyle:function(t,e){return this.style.set(t,e),this.dirty(!1),this},useStyle:function(t){return this.style=new r(t,this),this.dirty(!1),this}},i.inherits(a,o),i.mixin(a,s);var h=a;t.exports=h},function(t,e){function n(t,e){this.extendFrom(t,!1),this.host=e}var c=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function s(t,e,n){var i=null==e.x?0:e.x,r=null==e.x2?1:e.x2,o=null==e.y?0:e.y,s=null==e.y2?0:e.y2;return e.global||(i=i*n.width+n.x,r=r*n.width+n.x,o=o*n.height+n.y,s=s*n.height+n.y),t.createLinearGradient(i,o,r,s)}function a(t,e,n){var i=n.width,r=n.height,o=Math.min(i,r),s=null==e.x?.5:e.x,a=null==e.y?.5:e.y,h=null==e.r?.5:e.r;return e.global||(s=s*i+n.x,a=a*r+n.y,h*=o),t.createRadialGradient(s,a,0,s,a,h)}for(var i=n.prototype={constructor:n,host:null,fill:"#000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(t,e,n){for(var i=this,r=n&&n.style,o=!r,s=0;s<c.length;s++){var a=c[s],h=a[0];!o&&i[h]===r[h]||(t[h]=i[h]||a[1])}if(!o&&i.fill===r.fill||(t.fillStyle=i.fill),!o&&i.stroke===r.stroke||(t.strokeStyle=i.stroke),!o&&i.opacity===r.opacity||(t.globalAlpha=null==i.opacity?1:i.opacity),!o&&i.blend===r.blend||(t.globalCompositeOperation=i.blend||"source-over"),this.hasStroke()){var l=i.lineWidth;t.lineWidth=l/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1)}},hasFill:function(){var t=this.fill;return null!=t&&"none"!==t},hasStroke:function(){var t=this.stroke;return null!=t&&"none"!==t&&0<this.lineWidth},extendFrom:function(t,e){if(t)for(var n in t)!t.hasOwnProperty(n)||!0!==e&&(!1===e?this.hasOwnProperty(n):null==t[n])||(this[n]=t[n])},set:function(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0)},clone:function(){var t=new this.constructor;return t.extendFrom(this,!0),t},getGradient:function(t,e,n){for(var i=("radial"===e.type?a:s)(t,e,n),r=e.colorStops,o=0;o<r.length;o++)i.addColorStop(r[o].offset,r[o].color);return i}},r=0;r<c.length;r++){var o=c[r];o[0]in i||(i[o[0]]=o[1])}n.getGradient=i.getGradient;var h=n;t.exports=h},function(t,e,n){function i(t){s.call(this,t),o.call(this,t),a.call(this,t),this.id=t.id||r()}var r=n(10),o=n(11),s=n(12),a=n(15),h=n(4);i.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,drift:function(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var n=this.transform;(n=n||(this.transform=[1,0,0,1,0,0]))[4]+=t,n[5]+=e,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(t,e){},attrKV:function(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var n=this[t];(n=n||(this[t]=[]))[0]=e[0],n[1]=e[1]}}else this[t]=e},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(h.isObject(t))for(var n in t)t.hasOwnProperty(n)&&this.attrKV(n,t[n]);return this.dirty(!1),this},setClipPath:function(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),(this.clipPath=t).__zr=e,(t.__clipTarget=this).dirty(!1)},removeClipPath:function(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(t){this.__zr=t;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.addAnimator(e[n]);this.clipPath&&this.clipPath.addSelfToZr(t)},removeSelfFromZr:function(t){this.__zr=null;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.removeAnimator(e[n]);this.clipPath&&this.clipPath.removeSelfFromZr(t)}},h.mixin(i,a),h.mixin(i,s),h.mixin(i,o);var l=i;t.exports=l},function(t,e){var n=2311;t.exports=function(){return n++}},function(t,e){function n(){this._$handlers={}}var a=Array.prototype.slice;n.prototype={constructor:n,one:function(t,e,n){var i=this._$handlers;if(!e||!t)return this;i[t]||(i[t]=[]);for(var r=0;r<i[t].length;r++)if(i[t][r].h===e)return this;return i[t].push({h:e,one:!0,ctx:n||this}),this},on:function(t,e,n){var i=this._$handlers;if(!e||!t)return this;i[t]||(i[t]=[]);for(var r=0;r<i[t].length;r++)if(i[t][r].h===e)return this;return i[t].push({h:e,one:!1,ctx:n||this}),this},isSilent:function(t){var e=this._$handlers;return e[t]&&e[t].length},off:function(t,e){var n=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(n[t]){for(var i=[],r=0,o=n[t].length;r<o;r++)n[t][r].h!=e&&i.push(n[t][r]);n[t]=i}n[t]&&0===n[t].length&&delete n[t]}else delete n[t];return this},trigger:function(t){if(this._$handlers[t]){var e=arguments,n=e.length;3<n&&(e=a.call(e,1));for(var i=this._$handlers[t],r=i.length,o=0;o<r;){switch(n){case 1:i[o].h.call(i[o].ctx);break;case 2:i[o].h.call(i[o].ctx,e[1]);break;case 3:i[o].h.call(i[o].ctx,e[1],e[2]);break;default:i[o].h.apply(i[o].ctx,e)}i[o].one?(i.splice(o,1),r--):o++}}return this},triggerWithContext:function(t){if(this._$handlers[t]){var e=arguments,n=e.length;4<n&&(e=a.call(e,1,e.length-1));for(var i=e[e.length-1],r=this._$handlers[t],o=r.length,s=0;s<o;){switch(n){case 1:r[s].h.call(i);break;case 2:r[s].h.call(i,e[1]);break;case 3:r[s].h.call(i,e[1],e[2]);break;default:r[s].h.apply(i,e)}r[s].one?(r.splice(s,1),o--):s++}}return this}};var i=n;t.exports=i},function(t,e,n){var s=n(13),r=n(14),a=s.identity;function h(t){return 5e-5<t||t<-5e-5}function i(t){(t=t||{}).position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null}var o=i.prototype;o.transform=null,o.needLocalTransform=function(){return h(this.rotation)||h(this.position[0])||h(this.position[1])||h(this.scale[0]-1)||h(this.scale[1]-1)},o.updateTransform=function(){var t=this.parent,e=t&&t.transform,n=this.needLocalTransform(),i=this.transform;n||e?(i=i||s.create(),n?this.getLocalTransform(i):a(i),e&&(n?s.mul(i,t.transform,i):s.copy(i,t.transform)),this.transform=i,this.invTransform=this.invTransform||s.create(),s.invert(this.invTransform,i)):i&&a(i)},o.getLocalTransform=function(t){return i.getLocalTransform(this,t)},o.setTransform=function(t){var e=this.transform,n=t.dpr||1;e?t.setTransform(n*e[0],n*e[1],n*e[2],n*e[3],n*e[4],n*e[5]):t.setTransform(n,0,0,n,0,0)},o.restoreTransform=function(t){var e=t.dpr||1;t.setTransform(e,0,0,e,0,0)};var l=[];o.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(s.mul(l,t.invTransform,e),e=l);var n=e[0]*e[0]+e[1]*e[1],i=e[2]*e[2]+e[3]*e[3],r=this.position,o=this.scale;h(n-1)&&(n=Math.sqrt(n)),h(i-1)&&(i=Math.sqrt(i)),e[0]<0&&(n=-n),e[3]<0&&(i=-i),r[0]=e[4],r[1]=e[5],o[0]=n,o[1]=i,this.rotation=Math.atan2(-e[1]/i,e[0]/n)}},o.getGlobalScale=function(){var t=this.transform;if(!t)return[1,1];var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),n=Math.sqrt(t[2]*t[2]+t[3]*t[3]);return t[0]<0&&(e=-e),t[3]<0&&(n=-n),[e,n]},o.transformCoordToLocal=function(t,e){var n=[t,e],i=this.invTransform;return i&&r.applyTransform(n,n,i),n},o.transformCoordToGlobal=function(t,e){var n=[t,e],i=this.transform;return i&&r.applyTransform(n,n,i),n},i.getLocalTransform=function(t,e){a(e=e||[]);var n=t.origin,i=t.scale||[1,1],r=t.rotation||0,o=t.position||[0,0];return n&&(e[4]-=n[0],e[5]-=n[1]),s.scale(e,e,i),r&&s.rotate(e,e,r),n&&(e[4]+=n[0],e[5]+=n[1]),e[4]+=o[0],e[5]+=o[1],e};var c=i;t.exports=c},function(t,e){var n="undefined"==typeof Float32Array?Array:Float32Array;function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}e.create=function(){var t=new n(6);return i(t),t},e.identity=i,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.mul=function(t,e,n){var i=e[0]*n[0]+e[2]*n[1],r=e[1]*n[0]+e[3]*n[1],o=e[0]*n[2]+e[2]*n[3],s=e[1]*n[2]+e[3]*n[3],a=e[0]*n[4]+e[2]*n[5]+e[4],h=e[1]*n[4]+e[3]*n[5]+e[5];return t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t},e.translate=function(t,e,n){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+n[0],t[5]=e[5]+n[1],t},e.rotate=function(t,e,n){var i=e[0],r=e[2],o=e[4],s=e[1],a=e[3],h=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=i*c+s*l,t[1]=-i*l+s*c,t[2]=r*c+a*l,t[3]=-r*l+c*a,t[4]=c*o+l*h,t[5]=c*h-l*o,t},e.scale=function(t,e,n){var i=n[0],r=n[1];return t[0]=e[0]*i,t[1]=e[1]*r,t[2]=e[2]*i,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*r,t},e.invert=function(t,e){var n=e[0],i=e[2],r=e[4],o=e[1],s=e[3],a=e[5],h=n*s-o*i;return h?(h=1/h,t[0]=s*h,t[1]=-o*h,t[2]=-i*h,t[3]=n*h,t[4]=(i*a-s*r)*h,t[5]=(o*r-n*a)*h,t):null}},function(t,e){var i="undefined"==typeof Float32Array?Array:Float32Array;function r(t){return Math.sqrt(o(t))}var n=r;function o(t){return t[0]*t[0]+t[1]*t[1]}var s=o;function a(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var h=a;function l(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}var c=l;e.create=function(t,e){var n=new i(2);return null==t&&(t=0),null==e&&(e=0),n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.clone=function(t){var e=new i(2);return e[0]=t[0],e[1]=t[1],e},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},e.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},e.len=r,e.length=n,e.lenSquare=o,e.lengthSquare=s,e.mul=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},e.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.normalize=function(t,e){var n=r(e);return 0===n?(t[0]=0,t[1]=0):(t[0]=e[0]/n,t[1]=e[1]/n),t},e.distance=a,e.dist=h,e.distanceSquare=l,e.distSquare=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.lerp=function(t,e,n,i){return t[0]=e[0]+i*(n[0]-e[0]),t[1]=e[1]+i*(n[1]-e[1]),t},e.applyTransform=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}},function(t,e,n){function i(){this.animators=[]}var p=n(16),d=n(21),r=n(4),c=r.isString,u=r.isFunction,l=r.isObject,f=r.isArrayLike,g=r.indexOf;i.prototype={constructor:i,animate:function(t,e){var n,i=!1,r=this,o=this.__zr;if(t){var s=t.split("."),a=r;i="shape"===s[0];for(var h=0,l=s.length;h<l;h++)a=a&&a[s[h]];a&&(n=a)}else n=r;if(n){var c=r.animators,u=new p(n,e);return u.during(function(t){r.dirty(i)}).done(function(){c.splice(g(c,u),1)}),c.push(u),o&&o.animation.addAnimator(u),u}d('Property "'+t+'" is not existed in element '+r.id)},stopAnimation:function(t){for(var e=this.animators,n=e.length,i=0;i<n;i++)e[i].stop(t);return e.length=0,this},animateTo:function(t,e,n,i,r,o){c(n)?(r=i,i=n,n=0):u(i)?(r=i,i="linear",n=0):u(n)?(r=n,n=0):e=u(e)?(r=e,500):e||500,this.stopAnimation(),this._animateToShallow("",this,t,e,n);var s=this.animators.slice(),a=s.length;function h(){--a||r&&r()}a||r&&r();for(var l=0;l<s.length;l++)s[l].done(h).start(i,o)},_animateToShallow:function(t,e,n,i,r){var o={},s=0;for(var a in n)if(n.hasOwnProperty(a))if(null!=e[a])l(n[a])&&!f(n[a])?this._animateToShallow(t?t+"."+a:a,e[a],n[a],i,r):(o[a]=n[a],s++);else if(null!=n[a])if(t){var h={};h[t]={},h[t][a]=n[a],this.attr(h)}else this.attr(a,n[a]);return 0<s&&this.animate(t,!1).when(null==i?500:i,o).delay(r||0),this}};var o=i;t.exports=o},function(t,e,n){var L=n(17),O=n(19),z=n(4).isArrayLike,h=Array.prototype.slice;function r(t,e){return t[e]}function o(t,e,n){t[e]=n}function I(t,e,n){return(e-t)*n+t}function F(t,e,n){return.5<n?e:t}function B(t,e,n,i,r){var o=t.length;if(1==r)for(var s=0;s<o;s++)i[s]=I(t[s],e[s],n);else{var a=o&&t[0].length;for(s=0;s<o;s++)for(var h=0;h<a;h++)i[s][h]=I(t[s][h],e[s][h],n)}}function j(t,e,n){var i=t.length,r=e.length;if(i!==r)if(r<i)t.length=r;else for(var o=i;o<r;o++)t.push(1===n?e[o]:h.call(e[o]));var s=t[0]&&t[0].length;for(o=0;o<t.length;o++)if(1===n)isNaN(t[o])&&(t[o]=e[o]);else for(var a=0;a<s;a++)isNaN(t[o][a])&&(t[o][a]=e[o][a])}function D(t,e,n){if(t===e)return!0;var i=t.length;if(i!==e.length)return!1;if(1===n){for(var r=0;r<i;r++)if(t[r]!==e[r])return!1}else{var o=t[0].length;for(r=0;r<i;r++)for(var s=0;s<o;s++)if(t[r][s]!==e[r][s])return!1}return!0}function H(t,e,n,i,r,o,s,a,h){var l=t.length;if(1==h)for(var c=0;c<l;c++)a[c]=G(t[c],e[c],n[c],i[c],r,o,s);else{var u=t[0].length;for(c=0;c<l;c++)for(var p=0;p<u;p++)a[c][p]=G(t[c][p],e[c][p],n[c][p],i[c][p],r,o,s)}}function G(t,e,n,i,r,o,s){var a=.5*(n-t),h=.5*(i-e);return(2*(e-n)+a+h)*s+(-3*(e-n)-2*a-h)*o+a*r+e}function s(t){if(z(t)){var e=t.length;if(z(t[0])){for(var n=[],i=0;i<e;i++)n.push(h.call(t[i]));return n}return h.call(t)}return t}function V(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}function l(t,e,n,i,o,r){var s=t._getter,a=t._setter,h="spline"===e,l=i.length;if(l){var c,u=i[0].value,p=z(u),d=!1,f=!1,g=p?function(t){var e=t[t.length-1].value;return z(e&&e[0])?2:1}(i):0;i.sort(function(t,e){return t.time-e.time}),c=i[l-1].time;for(var v=[],y=[],m=i[0].value,_=!0,x=0;x<l;x++){v.push(i[x].time/c);var b=i[x].value;if(p&&D(b,m,g)||!p&&b===m||(_=!1),"string"==typeof(m=b)){var w=O.parse(b);w?(b=w,d=!0):f=!0}y.push(b)}if(r||!_){var C=y[l-1];for(x=0;x<l-1;x++)p?j(y[x],C,g):!isNaN(y[x])||isNaN(C)||f||d||(y[x]=C);p&&j(s(t._target,o),C,g);var P,S,T,E,R,N=0,M=0;if(d)var k=[0,0,0,0];var A=new L({target:t._target,life:c,loop:t._loop,delay:t._delay,onframe:function(t,e){var n;if(e<0)n=0;else if(e<M){for(n=Math.min(N+1,l-1);0<=n&&!(v[n]<=e);n--);n=Math.min(n,l-2)}else{for(n=N;n<l&&!(v[n]>e);n++);n=Math.min(n-1,l-2)}M=e;var i=v[(N=n)+1]-v[n];if(0!=i)if(P=(e-v[n])/i,h)if(T=y[n],S=y[0===n?n:n-1],E=y[l-2<n?l-1:n+1],R=y[l-3<n?l-1:n+2],p)H(S,T,E,R,P,P*P,P*P*P,s(t,o),g);else{if(d)r=H(S,T,E,R,P,P*P,P*P*P,k,1),r=V(k);else{if(f)return F(T,E,P);r=G(S,T,E,R,P,P*P,P*P*P)}a(t,o,r)}else if(p)B(y[n],y[n+1],P,s(t,o),g);else{var r;if(d)B(y[n],y[n+1],P,k,1),r=V(k);else{if(f)return F(y[n],y[n+1],P);r=I(y[n],y[n+1],P)}a(t,o,r)}},ondestroy:n});return e&&"spline"!==e&&(A.easing=e),A}}}function i(t,e,n,i){this._tracks={},this._target=t,this._loop=e||!1,this._getter=n||r,this._setter=i||o,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]}i.prototype={when:function(t,e){var n=this._tracks;for(var i in e)if(e.hasOwnProperty(i)){if(!n[i]){n[i]=[];var r=this._getter(this._target,i);if(null==r)continue;0!==t&&n[i].push({time:0,value:s(r)})}n[i].push({time:t,value:e[i]})}return this},during:function(t){return this._onframeList.push(t),this},pause:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].pause();this._paused=!0},resume:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,n=0;n<e;n++)t[n].call(this)},start:function(t,e){function n(){--o||r._doneCallback()}var i,r=this,o=0;for(var s in this._tracks)if(this._tracks.hasOwnProperty(s)){var a=l(this,t,n,this._tracks[s],s,e);a&&(this._clipList.push(a),o++,this.animation&&this.animation.addClip(a),i=a)}if(i){var h=i.onframe;i.onframe=function(t,e){h(t,e);for(var n=0;n<r._onframeList.length;n++)r._onframeList[n](t,e)}}return o||this._doneCallback(),this},stop:function(t){for(var e=this._clipList,n=this.animation,i=0;i<e.length;i++){var r=e[i];t&&r.onframe(this._target,1),n&&n.removeClip(r)}e.length=0},delay:function(t){return this._delay=t,this},done:function(t){return t&&this._doneList.push(t),this},getClips:function(){return this._clipList}};var a=i;t.exports=a},function(t,e,n){var s=n(18);function i(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1}i.prototype={constructor:i,step:function(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)this._pausedTime+=e;else{var n=(t-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var i=this.easing,r="string"==typeof i?s[i]:i,o="function"==typeof r?r(n):n;return this.fire("frame",o),1==n?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(t){var e=(t-this._startTime-this._pausedTime)%this._life;this._startTime=t-e+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(t,e){this[t="on"+t]&&this[t](this._target,e)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var r=i;t.exports=r},function(t,e){var n={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){return t*t*(2.70158*t-1.70158)},backOut:function(t){return--t*t*(2.70158*t+1.70158)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)},bounceIn:function(t){return 1-n.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*n.bounceIn(2*t):.5*n.bounceOut(2*t-1)+.5}},i=n;t.exports=i},function(t,e,n){var i=n(20),c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(t){return(t=Math.round(t))<0?0:255<t?255:t}function p(t){return t<0?0:1<t?1:t}function d(t){return t.length&&"%"===t.charAt(t.length-1)?u(parseFloat(t)/100*255):u(parseInt(t,10))}function f(t){return t.length&&"%"===t.charAt(t.length-1)?p(parseFloat(t)/100):p(parseFloat(t))}function a(t,e,n){return n<0?n+=1:1<n&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function g(t,e,n){return t+(e-t)*n}function v(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function y(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}var m=new i(20),r=null;function _(t,e){r&&y(r,e),r=m.put(t,r||e.slice())}function x(t,e){if(t){e=e||[];var n=m.get(t);if(n)return y(e,n);var i,r=(t+="").replace(/ /g,"").toLowerCase();if(r in c)return y(e,c[r]),_(t,e),e;if("#"===r.charAt(0))return 4===r.length?0<=(i=parseInt(r.substr(1),16))&&i<=4095?(v(e,(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1),_(t,e),e):void v(e,0,0,0,1):7===r.length?0<=(i=parseInt(r.substr(1),16))&&i<=16777215?(v(e,(16711680&i)>>16,(65280&i)>>8,255&i,1),_(t,e),e):void v(e,0,0,0,1):void 0;var o=r.indexOf("("),s=r.indexOf(")");if(-1!==o&&s+1===r.length){var a=r.substr(0,o),h=r.substr(o+1,s-(o+1)).split(","),l=1;switch(a){case"rgba":if(4!==h.length)return void v(e,0,0,0,1);l=f(h.pop());case"rgb":return 3!==h.length?void v(e,0,0,0,1):(v(e,d(h[0]),d(h[1]),d(h[2]),l),_(t,e),e);case"hsla":return 4!==h.length?void v(e,0,0,0,1):(h[3]=f(h[3]),b(h,e),_(t,e),e);case"hsl":return 3!==h.length?void v(e,0,0,0,1):(b(h,e),_(t,e),e);default:return}}v(e,0,0,0,1)}}function b(t,e){var n=(parseFloat(t[0])%360+360)%360/360,i=f(t[1]),r=f(t[2]),o=r<=.5?r*(i+1):r+i-r*i,s=2*r-o;return v(e=e||[],u(255*a(s,o,n+1/3)),u(255*a(s,o,n)),u(255*a(s,o,n-1/3)),1),4===t.length&&(e[3]=t[3]),e}function o(t,e,n){if(e&&e.length&&0<=t&&t<=1){n=n||[];var i=t*(e.length-1),r=Math.floor(i),o=Math.ceil(i),s=e[r],a=e[o],h=i-r;return n[0]=u(g(s[0],a[0],h)),n[1]=u(g(s[1],a[1],h)),n[2]=u(g(s[2],a[2],h)),n[3]=p(g(s[3],a[3],h)),n}}var s=o;function h(t,e,n){if(e&&e.length&&0<=t&&t<=1){var i=t*(e.length-1),r=Math.floor(i),o=Math.ceil(i),s=x(e[r]),a=x(e[o]),h=i-r,l=w([u(g(s[0],a[0],h)),u(g(s[1],a[1],h)),u(g(s[2],a[2],h)),p(g(s[3],a[3],h))],"rgba");return n?{color:l,leftIndex:r,rightIndex:o,value:i}:l}}var l=h;function w(t,e){if(t&&t.length){var n=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(n+=","+t[3]),e+"("+n+")"}}e.parse=x,e.lift=function(t,e){var n=x(t);if(n){for(var i=0;i<3;i++)n[i]=e<0?n[i]*(1-e)|0:(255-n[i])*e+n[i]|0;return w(n,4===n.length?"rgba":"rgb")}},e.toHex=function(t){var e=x(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1)},e.fastLerp=o,e.fastMapToColor=s,e.lerp=h,e.mapToColor=l,e.modifyHSL=function(t,e,n,i){if(t=x(t))return t=function(t){if(t){var e,n,i=t[0]/255,r=t[1]/255,o=t[2]/255,s=Math.min(i,r,o),a=Math.max(i,r,o),h=a-s,l=(a+s)/2;if(0==h)n=e=0;else{n=l<.5?h/(a+s):h/(2-a-s);var c=((a-i)/6+h/2)/h,u=((a-r)/6+h/2)/h,p=((a-o)/6+h/2)/h;i===a?e=p-u:r===a?e=1/3+c-p:o===a&&(e=2/3+u-c),e<0&&(e+=1),1<e&&(e-=1)}var d=[360*e,n,l];return null!=t[3]&&d.push(t[3]),d}}(t),null!=e&&(t[0]=function(t){return(t=Math.round(t))<0?0:360<t?360:t}(e)),null!=n&&(t[1]=f(n)),null!=i&&(t[2]=f(i)),w(b(t),"rgba")},e.modifyAlpha=function(t,e){if((t=x(t))&&null!=e)return t[3]=p(e),w(t,"rgba")},e.stringify=w},function(t,e){function n(){this.head=null,this.tail=null,this._len=0}var i=n.prototype;i.insert=function(t){var e=new h(t);return this.insertEntry(e),e},i.insertEntry=function(t){this.head?((this.tail.next=t).prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},i.remove=function(t){var e=t.prev,n=t.next;e?e.next=n:this.head=n,n?n.prev=e:this.tail=e,t.next=t.prev=null,this._len--},i.len=function(){return this._len},i.clear=function(){this.head=this.tail=null,this._len=0};function r(t){this._list=new n,this._map={},this._maxSize=t||10,this._lastRemovedEntry=null}var h=function(t){this.value=t,this.next,this.prev},o=r.prototype;o.put=function(t,e){var n=this._list,i=this._map,r=null;if(null==i[t]){var o=n.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&0<o){var a=n.head;n.remove(a),delete i[a.key],r=a.value,this._lastRemovedEntry=a}s?s.value=e:s=new h(e),s.key=t,n.insertEntry(s),i[t]=s}return r},o.get=function(t){var e=this._map[t],n=this._list;if(null!=e)return e!==n.tail&&(n.remove(e),n.insertEntry(e)),e.value},o.clear=function(){this._list.clear(),this._map={}};var s=r;t.exports=s},function(t,e,n){var i=n(22).debugMode,r=function(){};1===i?r=function(){for(var t in arguments)throw new Error(arguments[t])}:1<i&&(r=function(){for(var t in arguments)console.log(arguments[t])});var o=r;t.exports=o},function(t,e){var n=1;"undefined"!=typeof window&&(n=Math.max(window.devicePixelRatio||1,1));var i=n;e.debugMode=0,e.devicePixelRatio=i},function(t,e,n){function i(){}var o=n(24),s=new(n(26));i.prototype={constructor:i,drawRectText:function(t,e){var n=this.style;e=n.textRect||e,this.__dirty&&o.normalizeTextStyle(n,!0);var i=n.text;if(null!=i&&(i+=""),o.needDrawText(i,n)){t.save();var r=this.transform;n.transformText?this.setTransform(t):r&&(s.copy(e),s.applyTransform(r),e=s),o.renderText(this,t,i,n,e),t.restore()}}};var r=i;t.exports=r},function(t,e,n){var i=n(4),g=i.retrieve2,v=i.retrieve3,r=i.each,o=i.normalizeCssArray,d=i.isString,f=i.isObject,M=n(25),y=n(28),m=n(27),s={left:1,right:1,center:1},a={top:1,bottom:1,middle:1};function h(t){if(t){t.font=M.makeFont(t);var e=t.textAlign;"middle"===e&&(e="center"),t.textAlign=null==e||s[e]?e:"left";var n=t.textVerticalAlign||t.textBaseline;"center"===n&&(n="middle"),t.textVerticalAlign=null==n||a[n]?n:"top",t.textPadding&&(t.textPadding=o(t.textPadding))}}function k(t,e,n,i,r){if(n&&e.textRotation){var o=e.textOrigin;"center"===o?(i=n.width/2+n.x,r=n.height/2+n.y):o&&(i=o[0]+n.x,r=o[1]+n.y),t.translate(i,r),t.rotate(-e.textRotation),t.translate(-i,-r)}}function A(t,e,n,i,r,o,s,a){var h=i.rich[n.styleName]||{},l=n.textVerticalAlign,c=o+r/2;"top"===l?c=o+n.height/2:"bottom"===l&&(c=o+r-n.height/2),!n.isLineHolder&&L(h)&&O(t,e,h,"right"===a?s-n.width:"center"===a?s-n.width/2:s,c-n.height/2,n.width,n.height);var u=n.textPadding;u&&(s=N(s,a,u),c-=n.height/2-u[2]-n.textHeight/2),T(e,"shadowBlur",v(h.textShadowBlur,i.textShadowBlur,0)),T(e,"shadowColor",h.textShadowColor||i.textShadowColor||"transparent"),T(e,"shadowOffsetX",v(h.textShadowOffsetX,i.textShadowOffsetX,0)),T(e,"shadowOffsetY",v(h.textShadowOffsetY,i.textShadowOffsetY,0)),T(e,"textAlign",a),T(e,"textBaseline","middle"),T(e,"font",n.font||M.DEFAULT_FONT);var p=E(h.textStroke||i.textStroke,f),d=R(h.textFill||i.textFill),f=g(h.textStrokeWidth,i.textStrokeWidth);p&&(T(e,"lineWidth",f),T(e,"strokeStyle",p),e.strokeText(n.text,s,c)),d&&(T(e,"fillStyle",d),e.fillText(n.text,s,c))}function L(t){return t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor}function O(t,e,n,i,r,o,s){var a=n.textBackgroundColor,h=n.textBorderWidth,l=n.textBorderColor,c=d(a);if(T(e,"shadowBlur",n.textBoxShadowBlur||0),T(e,"shadowColor",n.textBoxShadowColor||"transparent"),T(e,"shadowOffsetX",n.textBoxShadowOffsetX||0),T(e,"shadowOffsetY",n.textBoxShadowOffsetY||0),c||h&&l){e.beginPath();var u=n.textBorderRadius;u?y.buildPath(e,{x:i,y:r,width:o,height:s,r:u}):e.rect(i,r,o,s),e.closePath()}if(c)T(e,"fillStyle",a),e.fill();else if(f(a)){var p=a.image;(p=m.createOrUpdateImage(p,null,t,_,a))&&m.isImageReady(p)&&e.drawImage(p,i,r,o,s)}h&&l&&(T(e,"lineWidth",h),T(e,"strokeStyle",l),e.stroke())}function _(t,e){e.image=t}function z(t,e,n){var i=e.x||0,r=e.y||0,o=e.textAlign,s=e.textVerticalAlign;if(n){var a=e.textPosition;if(a instanceof Array)i=n.x+c(a[0],n.width),r=n.y+c(a[1],n.height);else{var h=M.adjustTextPositionOnRect(a,n,e.textDistance);i=h.x,r=h.y,o=o||h.textAlign,s=s||h.textVerticalAlign}var l=e.textOffset;l&&(i+=l[0],r+=l[1])}return{baseX:i,baseY:r,textAlign:o,textVerticalAlign:s}}function T(t,e,n){return t[e]=n,t[e]}function E(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function R(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function c(t,e){return"string"==typeof t?0<=t.lastIndexOf("%")?parseFloat(t)/100*e:parseFloat(t):t}function N(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}e.normalizeTextStyle=function(t){return h(t),r(t.rich,h),t},e.renderText=function(t,e,n,i,r){i.rich?function(t,e,n,i,r){var o=t.__textCotentBlock;o&&!t.__dirty||(o=t.__textCotentBlock=M.parseRichText(n,i));!function(t,e,n,i,r){var o=n.width,s=n.outerWidth,a=n.outerHeight,h=i.textPadding,l=z(a,i,r),c=l.baseX,u=l.baseY,p=l.textAlign,d=l.textVerticalAlign;k(e,i,r,c,u);var f=M.adjustTextX(c,s,p),g=M.adjustTextY(u,a,d),v=f,y=g;h&&(v+=h[3],y+=h[0]);var m=v+o;L(i)&&O(t,e,i,f,g,s,a);for(var _=0;_<n.lines.length;_++){for(var x,b=n.lines[_],w=b.tokens,C=w.length,P=b.lineHeight,S=b.width,T=0,E=v,R=m,N=C-1;T<C&&(!(x=w[T]).textAlign||"left"===x.textAlign);)A(t,e,x,i,P,y,E,"left"),S-=x.width,E+=x.width,T++;for(;0<=N&&"right"===(x=w[N]).textAlign;)A(t,e,x,i,P,y,R,"right"),S-=x.width,R-=x.width,N--;for(E+=(o-(E-v)-(m-R)-S)/2;T<=N;)x=w[T],A(t,e,x,i,P,y,E+x.width/2,"center"),E+=x.width,T++;y+=P}}(t,e,o,i,r)}(t,e,n,i,r):function(t,e,n,i,r){var o=T(e,"font",i.font||M.DEFAULT_FONT),s=i.textPadding,a=t.__textCotentBlock;a&&!t.__dirty||(a=t.__textCotentBlock=M.parsePlainText(n,o,s,i.truncate));var h=a.outerHeight,l=a.lines,c=a.lineHeight,u=z(h,i,r),p=u.baseX,d=u.baseY,f=u.textAlign,g=u.textVerticalAlign;k(e,i,r,p,d);var v=M.adjustTextY(d,h,g),y=p,m=v,_=L(i);if(_||s){var x=M.getWidth(n,o);s&&(x+=s[1]+s[3]);var b=M.adjustTextX(p,x,f);_&&O(t,e,i,b,v,x,h),s&&(y=N(p,f,s),m+=s[0])}T(e,"textAlign",f||"left"),T(e,"textBaseline","middle"),T(e,"shadowBlur",i.textShadowBlur||0),T(e,"shadowColor",i.textShadowColor||"transparent"),T(e,"shadowOffsetX",i.textShadowOffsetX||0),T(e,"shadowOffsetY",i.textShadowOffsetY||0),m+=c/2;var w=i.textStrokeWidth,C=E(i.textStroke,w),P=R(i.textFill);C&&(T(e,"lineWidth",w),T(e,"strokeStyle",C));P&&T(e,"fillStyle",P);for(var S=0;S<l.length;S++)C&&e.strokeText(l[S],y,m),P&&e.fillText(l[S],y,m),m+=c}(t,e,n,i,r)},e.getStroke=E,e.getFill=R,e.needDrawText=function(t,e){return null!=t&&(t||e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor||e.textPadding)}},function(t,e,n){var p=n(26),k=n(27),i=n(4),r=i.getContext,l=i.extend,A=i.retrieve2,L=i.retrieve3,a={},h=0,c=5e3,O=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,u="12px sans-serif",o={};function z(t,e){var n=t+":"+(e=e||u);if(a[n])return a[n];for(var i=(t+"").split("\n"),r=0,o=0,s=i.length;o<s;o++)r=Math.max(m(i[o],e).width,r);return c<h&&(h=0,a={}),h++,a[n]=r}function d(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function f(t,e,n){return"middle"===n?t-=e/2:"bottom"===n&&(t-=e),t}function I(t,e,n,i,r){if(!e)return"";var o=(t+"").split("\n");r=g(e,n,i,r);for(var s=0,a=o.length;s<a;s++)o[s]=v(o[s],r);return o.join("\n")}function g(t,e,n,i){(i=l({},i)).font=e;n=A(n,"...");i.maxIterations=A(i.maxIterations,2);var r=i.minChar=A(i.minChar,0);i.cnCharWidth=z("",e);var o=i.ascCharWidth=z("a",e);i.placeholder=A(i.placeholder,"");for(var s=t=Math.max(0,t-1),a=0;a<r&&o<=s;a++)s-=o;var h=z(n);return s<h&&(n="",h=0),s=t-h,i.ellipsis=n,i.ellipsisWidth=h,i.contentWidth=s,i.containerWidth=t,i}function v(t,e){var n=e.containerWidth,i=e.font,r=e.contentWidth;if(!n)return"";var o=z(t,i);if(o<=n)return t;for(var s=0;;s++){if(o<=r||s>=e.maxIterations){t+=e.ellipsis;break}var a=0===s?y(t,r,e.ascCharWidth,e.cnCharWidth):0<o?Math.floor(t.length*r/o):0;o=z(t=t.substr(0,a),i)}return""===t&&(t=e.placeholder),t}function y(t,e,n,i){for(var r=0,o=0,s=t.length;o<s&&r<e;o++){var a=t.charCodeAt(o);r+=0<=a&&a<=127?n:i}return o}function F(t){return z("",t)}function m(t,e){return o.measureText(t,e)}function _(t,e,n,i){null!=t&&(t+="");var r=F(e),o=t?t.split("\n"):[],s=o.length*r,a=s;if(n&&(a+=n[0]+n[2]),t&&i){var h=i.outerHeight,l=i.outerWidth;if(null!=h&&h<a)t="",o=[];else if(null!=l)for(var c=g(l-(n?n[1]+n[3]:0),e,i.ellipsis,{minChar:i.minChar,placeholder:i.placeholder}),u=0,p=o.length;u<p;u++)o[u]=v(o[u],c)}return{lines:o,height:s,outerHeight:a,lineHeight:r}}function x(t,e){var n={lines:[],width:0,height:0};if(null!=t&&(t+=""),!t)return n;for(var i,r=O.lastIndex=0;null!=(i=O.exec(t));){var o=i.index;r<o&&B(n,t.substring(r,o)),B(n,i[2],i[1]),r=O.lastIndex}r<t.length&&B(n,t.substring(r,t.length));var s=n.lines,a=0,h=0,l=[],c=e.textPadding,u=e.truncate,p=u&&u.outerWidth,d=u&&u.outerHeight;c&&(null!=p&&(p-=c[1]+c[3]),null!=d&&(d-=c[0]+c[2]));for(var f=0;f<s.length;f++){for(var g=s[f],v=0,y=0,m=0;m<g.tokens.length;m++){var _=(N=g.tokens[m]).styleName&&e.rich[N.styleName]||{},x=N.textPadding=_.textPadding,b=N.font=_.font||e.font,w=N.textHeight=A(_.textHeight,F(b));if(x&&(w+=x[0]+x[2]),N.height=w,N.lineHeight=L(_.textLineHeight,e.textLineHeight,w),N.textAlign=_&&_.textAlign||e.textAlign,N.textVerticalAlign=_&&_.textVerticalAlign||"middle",null!=d&&a+N.lineHeight>d)return{lines:[],width:0,height:0};N.textWidth=z(N.text,b);var C=_.textWidth,P=null==C||"auto"===C;if("string"==typeof C&&"%"===C.charAt(C.length-1))N.percentWidth=C,l.push(N),C=0;else{if(P){C=N.textWidth;var S=_.textBackgroundColor,T=S&&S.image;T&&(T=k.findExistImage(T),k.isImageReady(T)&&(C=Math.max(C,T.width*w/T.height)))}var E=x?x[1]+x[3]:0;C+=E;var R=null!=p?p-y:null;null!=R&&R<C&&(!P||R<E?(N.text="",N.textWidth=C=0):(N.text=I(N.text,R-E,b,u.ellipsis,{minChar:u.minChar}),N.textWidth=z(N.text,b),C=N.textWidth+E))}y+=N.width=C,_&&(v=Math.max(v,N.lineHeight))}g.width=y,a+=g.lineHeight=v,h=Math.max(h,y)}n.outerWidth=n.width=A(e.textWidth,h),n.outerHeight=n.height=A(e.textHeight,a),c&&(n.outerWidth+=c[1]+c[3],n.outerHeight+=c[0]+c[2]);for(f=0;f<l.length;f++){var N,M=(N=l[f]).percentWidth;N.width=parseInt(M,10)/100*h}return n}function B(t,e,n){for(var i=""===e,r=e.split("\n"),o=t.lines,s=0;s<r.length;s++){var a=r[s],h={styleName:n,text:a,isLineHolder:!a&&!i};if(s)o.push({tokens:[h]});else{var l=(o[o.length-1]||(o[0]={tokens:[]})).tokens,c=l.length;1===c&&l[0].isLineHolder?l[0]=h:!a&&c&&!i||l.push(h)}}}o.measureText=function(t,e){var n=r();return n.font=e||u,n.measureText(t)},e.DEFAULT_FONT=u,e.$override=function(t,e){o[t]=e},e.getWidth=z,e.getBoundingRect=function(t,e,n,i,r,o,s){return o?function(t,e,n,i,r,o,s){var a=x(t,{rich:o,truncate:s,font:e,textAlign:n,textPadding:r}),h=a.outerWidth,l=a.outerHeight,c=d(0,h,n),u=f(0,l,i);return new p(c,u,h,l)}(t,e,n,i,r,o,s):function(t,e,n,i,r,o){var s=_(t,e,r,o),a=z(t,e);r&&(a+=r[1]+r[3]);var h=s.outerHeight,l=d(0,a,n),c=f(0,h,i),u=new p(l,c,a,h);return u.lineHeight=s.lineHeight,u}(t,e,n,i,r,s)},e.adjustTextX=d,e.adjustTextY=f,e.adjustTextPositionOnRect=function(t,e,n){var i=e.x,r=e.y,o=e.height,s=e.width,a=o/2,h="left",l="top";switch(t){case"left":i-=n,r+=a,h="right",l="middle";break;case"right":i+=n+s,r+=a,l="middle";break;case"top":i+=s/2,r-=n,h="center",l="bottom";break;case"bottom":i+=s/2,r+=o+n,h="center";break;case"inside":i+=s/2,r+=a,h="center",l="middle";break;case"insideLeft":i+=n,r+=a,l="middle";break;case"insideRight":i+=s-n,r+=a,h="right",l="middle";break;case"insideTop":i+=s/2,r+=n,h="center";break;case"insideBottom":i+=s/2,r+=o-n,h="center",l="bottom";break;case"insideTopLeft":i+=n,r+=n;break;case"insideTopRight":i+=s-n,r+=n,h="right";break;case"insideBottomLeft":i+=n,r+=o-n,l="bottom";break;case"insideBottomRight":i+=s-n,r+=o-n,h="right",l="bottom"}return{x:i,y:r,textAlign:h,textVerticalAlign:l}},e.truncateText=I,e.getLineHeight=F,e.measureText=m,e.parsePlainText=_,e.parseRichText=x,e.makeFont=function(t){return(t.fontSize||t.fontFamily)&&[t.fontStyle,t.fontWeight,(t.fontSize||12)+"px",t.fontFamily||"sans-serif"].join(" ")||t.textFont||t.font}},function(t,e,n){var i,r,o,s,a=n(14),h=n(13),l=a.applyTransform,c=Math.min,u=Math.max;function p(t,e,n,i){n<0&&(t+=n,n=-n),i<0&&(e+=i,i=-i),this.x=t,this.y=e,this.width=n,this.height=i}p.prototype={constructor:p,union:function(t){var e=c(t.x,this.x),n=c(t.y,this.y);this.width=u(t.x+t.width,this.x+this.width)-e,this.height=u(t.y+t.height,this.y+this.height)-n,this.x=e,this.y=n},applyTransform:(i=[],r=[],o=[],s=[],function(t){if(t){i[0]=o[0]=this.x,i[1]=s[1]=this.y,r[0]=s[0]=this.x+this.width,r[1]=o[1]=this.y+this.height,l(i,i,t),l(r,r,t),l(o,o,t),l(s,s,t),this.x=c(i[0],r[0],o[0],s[0]),this.y=c(i[1],r[1],o[1],s[1]);var e=u(i[0],r[0],o[0],s[0]),n=u(i[1],r[1],o[1],s[1]);this.width=e-this.x,this.height=n-this.y}}),calculateTransform:function(t){var e=t.width/this.width,n=t.height/this.height,i=h.create();return h.translate(i,i,[-this.x,-this.y]),h.scale(i,i,[e,n]),h.translate(i,i,[t.x,t.y]),i},intersect:function(t){if(!t)return!1;t instanceof p||(t=p.create(t));var e=this,n=e.x,i=e.x+e.width,r=e.y,o=e.y+e.height,s=t.x,a=t.x+t.width,h=t.y,l=t.y+t.height;return!(i<s||a<n||o<h||l<r)},contain:function(t,e){var n=this;return t>=n.x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height},clone:function(){return new p(this.x,this.y,this.width,this.height)},copy:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},p.create=function(t){return new p(t.x,t.y,t.width,t.height)};var d=p;t.exports=d},function(t,e,n){var a=new(n(20))(50);function h(){var t=this.__cachedImgObj;this.onload=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var n=t.pending[e],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}t.pending.length=0}function l(t){return t&&t.width&&t.height}e.findExistImage=function(t){if("string"!=typeof t)return t;var e=a.get(t);return e&&e.image},e.createOrUpdateImage=function(t,e,n,i,r){if(t){if("string"!=typeof t)return t;if(e&&e.__zrImageSrc===t||!n)return e;var o=a.get(t),s={hostEl:n,cb:i,cbPayload:r};return o?l(e=o.image)||o.pending.push(s):((e=e||new Image).onload=h,a.put(t,e.__cachedImgObj={image:e,pending:[s]}),e.src=e.__zrImageSrc=t),e}return e},e.isImageReady=l},function(t,e){e.buildPath=function(t,e){var n,i,r,o,s,a=e.x,h=e.y,l=e.width,c=e.height,u=e.r;l<0&&(a+=l,l=-l),c<0&&(h+=c,c=-c),"number"==typeof u?n=i=r=o=u:u instanceof Array?1===u.length?n=i=r=o=u[0]:2===u.length?(n=r=u[0],i=o=u[1]):3===u.length?(n=u[0],i=o=u[1],r=u[2]):(n=u[0],i=u[1],r=u[2],o=u[3]):n=i=r=o=0,l<n+i&&(n*=l/(s=n+i),i*=l/s),l<r+o&&(r*=l/(s=r+o),o*=l/s),c<i+r&&(i*=c/(s=i+r),r*=c/s),c<n+o&&(n*=c/(s=n+o),o*=c/s),t.moveTo(a+n,h),t.lineTo(a+l-i,h),0!==i&&t.quadraticCurveTo(a+l,h,a+l,h+i),t.lineTo(a+l,h+c-r),0!==r&&t.quadraticCurveTo(a+l,h+c,a+l-r,h+c),t.lineTo(a+o,h+c),0!==o&&t.quadraticCurveTo(a,h+c,a,h+c-o),t.lineTo(a,h+n),0!==n&&t.quadraticCurveTo(a,h,a+n,h)}},function(t,e,n){function i(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null}var w=n(30),v=n(14),y=n(31),m=n(26),r=n(22).devicePixelRatio,S={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},_=[],x=[],b=[],C=[],P=Math.min,T=Math.max,E=Math.cos,R=Math.sin,N=Math.sqrt,M=Math.abs,a="undefined"!=typeof Float32Array;i.prototype={constructor:i,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(t,e){this._ux=M(1/r/t)||0,this._uy=M(1/r/e)||0},getContext:function(){return this._ctx},beginPath:function(t){return(this._ctx=t)&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(t,e){return this.addData(S.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},lineTo:function(t,e){var n=M(t-this._xi)>this._ux||M(e-this._yi)>this._uy||this._len<5;return this.addData(S.L,t,e),this._ctx&&n&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),n&&(this._xi=t,this._yi=e),this},bezierCurveTo:function(t,e,n,i,r,o){return this.addData(S.C,t,e,n,i,r,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,n,i,r,o):this._ctx.bezierCurveTo(t,e,n,i,r,o)),this._xi=r,this._yi=o,this},quadraticCurveTo:function(t,e,n,i){return this.addData(S.Q,t,e,n,i),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,n,i):this._ctx.quadraticCurveTo(t,e,n,i)),this._xi=n,this._yi=i,this},arc:function(t,e,n,i,r,o){return this.addData(S.A,t,e,n,n,i,r-i,0,o?0:1),this._ctx&&this._ctx.arc(t,e,n,i,r,o),this._xi=E(r)*n+t,this._yi=R(r)*n+t,this},arcTo:function(t,e,n,i,r){return this._ctx&&this._ctx.arcTo(t,e,n,i,r),this},rect:function(t,e,n,i){return this._ctx&&this._ctx.rect(t,e,n,i),this.addData(S.R,t,e,n,i),this},closePath:function(){this.addData(S.Z);var t=this._ctx,e=this._x0,n=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,n),t.closePath()),this._xi=e,this._yi=n,this},fill:function(t){t&&t.fill(),this.toStatic()},stroke:function(t){t&&t.stroke(),this.toStatic()},setLineDash:function(t){if(t instanceof Array){this._lineDash=t;for(var e=this._dashIdx=0,n=0;n<t.length;n++)e+=t[n];this._dashSum=e}return this},setLineDashOffset:function(t){return this._dashOffset=t,this},len:function(){return this._len},setData:function(t){var e=t.length;this.data&&this.data.length==e||!a||(this.data=new Float32Array(e));for(var n=0;n<e;n++)this.data[n]=t[n];this._len=e},appendPath:function(t){t instanceof Array||(t=[t]);for(var e=t.length,n=0,i=this._len,r=0;r<e;r++)n+=t[r].len();a&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(r=0;r<e;r++)for(var o=t[r].data,s=0;s<o.length;s++)this.data[i++]=o[s];this._len=i},addData:function(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var n=0;n<arguments.length;n++)e[this._len++]=arguments[n];this._prevCmd=t}},_expandData:function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(t,e){var n,i,r=this._dashSum,o=this._dashOffset,s=this._lineDash,a=this._ctx,h=this._xi,l=this._yi,c=t-h,u=e-l,p=N(c*c+u*u),d=h,f=l,g=s.length;for(o<0&&(o=r+o),d-=(o%=r)*(c/=p),f-=o*(u/=p);0<c&&d<=t||c<0&&t<=d||0==c&&(0<u&&f<=e||u<0&&e<=f);)d+=c*(n=s[i=this._dashIdx]),f+=u*n,this._dashIdx=(i+1)%g,0<c&&d<h||c<0&&h<d||0<u&&f<l||u<0&&l<f||a[i%2?"moveTo":"lineTo"](0<=c?P(d,t):T(d,t),0<=u?P(f,e):T(f,e));c=d-t,u=f-e,this._dashOffset=-N(c*c+u*u)},_dashedBezierTo:function(t,e,n,i,r,o){var s,a,h,l,c,u=this._dashSum,p=this._dashOffset,d=this._lineDash,f=this._ctx,g=this._xi,v=this._yi,y=w.cubicAt,m=0,_=this._dashIdx,x=d.length,b=0;for(p<0&&(p=u+p),p%=u,s=0;s<1;s+=.1)a=y(g,t,n,r,s+.1)-y(g,t,n,r,s),h=y(v,e,i,o,s+.1)-y(v,e,i,o,s),m+=N(a*a+h*h);for(;_<x&&!(p<(b+=d[_]));_++);for(s=(b-p)/m;s<=1;)l=y(g,t,n,r,s),c=y(v,e,i,o,s),_%2?f.moveTo(l,c):f.lineTo(l,c),s+=d[_]/m,_=(_+1)%x;_%2!=0&&f.lineTo(r,o),a=r-l,h=o-c,this._dashOffset=-N(a*a+h*h)},_dashedQuadraticTo:function(t,e,n,i){var r=n,o=i;n=(n+2*t)/3,i=(i+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,n,i,r,o)},toStatic:function(){var t=this.data;t instanceof Array&&(t.length=this._len,a&&(this.data=new Float32Array(t)))},getBoundingRect:function(){_[0]=_[1]=b[0]=b[1]=Number.MAX_VALUE,x[0]=x[1]=C[0]=C[1]=-Number.MAX_VALUE;for(var t=this.data,e=0,n=0,i=0,r=0,o=0;o<t.length;){var s=t[o++];switch(1==o&&(i=e=t[o],r=n=t[o+1]),s){case S.M:e=i=t[o++],n=r=t[o++],b[0]=i,b[1]=r,C[0]=i,C[1]=r;break;case S.L:y.fromLine(e,n,t[o],t[o+1],b,C),e=t[o++],n=t[o++];break;case S.C:y.fromCubic(e,n,t[o++],t[o++],t[o++],t[o++],t[o],t[o+1],b,C),e=t[o++],n=t[o++];break;case S.Q:y.fromQuadratic(e,n,t[o++],t[o++],t[o],t[o+1],b,C),e=t[o++],n=t[o++];break;case S.A:var a=t[o++],h=t[o++],l=t[o++],c=t[o++],u=t[o++],p=t[o++]+u,d=(t[o++],1-t[o++]);1==o&&(i=E(u)*l+a,r=R(u)*c+h),y.fromArc(a,h,l,c,u,p,d,b,C),e=E(p)*l+a,n=R(p)*c+h;break;case S.R:i=e=t[o++],r=n=t[o++];var f=t[o++],g=t[o++];y.fromLine(i,r,i+f,r+g,b,C);break;case S.Z:e=i,n=r}v.min(_,_,b),v.max(x,x,C)}return 0===o&&(_[0]=_[1]=x[0]=x[1]=0),new m(_[0],_[1],x[0]-_[0],x[1]-_[1])},rebuildPath:function(t){for(var e,n,i,r,o,s,a=this.data,h=this._ux,l=this._uy,c=this._len,u=0;u<c;){var p=a[u++];switch(1==u&&(e=i=a[u],n=r=a[u+1]),p){case S.M:e=i=a[u++],n=r=a[u++],t.moveTo(i,r);break;case S.L:o=a[u++],s=a[u++],(M(o-i)>h||M(s-r)>l||u===c-1)&&(t.lineTo(o,s),i=o,r=s);break;case S.C:t.bezierCurveTo(a[u++],a[u++],a[u++],a[u++],a[u++],a[u++]),i=a[u-2],r=a[u-1];break;case S.Q:t.quadraticCurveTo(a[u++],a[u++],a[u++],a[u++]),i=a[u-2],r=a[u-1];break;case S.A:var d=a[u++],f=a[u++],g=a[u++],v=a[u++],y=a[u++],m=a[u++],_=a[u++],x=a[u++],b=v<g?g:v,w=v<g?1:g/v,C=v<g?v/g:1,P=y+m;.001<Math.abs(g-v)?(t.translate(d,f),t.rotate(_),t.scale(w,C),t.arc(0,0,b,y,P,1-x),t.scale(1/w,1/C),t.rotate(-_),t.translate(-d,-f)):t.arc(d,f,b,y,P,1-x),1==u&&(e=E(y)*g+d,n=R(y)*v+f),i=E(P)*g+d,r=R(P)*v+f;break;case S.R:e=i=a[u],n=r=a[u+1],t.rect(a[u++],a[u++],a[u++],a[u++]);break;case S.Z:t.closePath(),i=e,r=n}}}},i.CMD=S;var o=i;t.exports=o},function(t,e,n){var i=n(14),r=i.create,x=i.distSquare,T=Math.pow,E=Math.sqrt,o=1e-8,R=E(3),b=r(),w=r(),C=r();function N(t){return-o<t&&t<o}function d(t){return o<t||t<-o}function P(t,e,n,i,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*i+3*o*n)}function m(t,e,n,i){var r=1-i;return r*(r*t+2*i*e)+i*i*n}e.cubicAt=P,e.cubicDerivativeAt=function(t,e,n,i,r){var o=1-r;return 3*(((e-t)*o+2*(n-e)*r)*o+(i-n)*r*r)},e.cubicRootAt=function(t,e,n,i,r,o){var s=i+3*(e-n)-t,a=3*(n-2*e+t),h=3*(e-t),l=t-r,c=a*a-3*s*h,u=a*h-9*s*l,p=h*h-3*a*l,d=0;if(N(c)&&N(u)){if(N(a))o[0]=0;else 0<=(P=-h/a)&&P<=1&&(o[d++]=P)}else{var f=u*u-4*c*p;if(N(f)){var g=u/c,v=-g/2;0<=(P=-a/s+g)&&P<=1&&(o[d++]=P),0<=v&&v<=1&&(o[d++]=v)}else if(0<f){var y=E(f),m=c*a+1.5*s*(-u+y),_=c*a+1.5*s*(-u-y);0<=(P=(-a-((m=m<0?-T(-m,1/3):T(m,1/3))+(_=_<0?-T(-_,1/3):T(_,1/3))))/(3*s))&&P<=1&&(o[d++]=P)}else{var x=(2*c*a-3*s*u)/(2*E(c*c*c)),b=Math.acos(x)/3,w=E(c),C=Math.cos(b),P=(-a-2*w*C)/(3*s),S=(v=(-a+w*(C+R*Math.sin(b)))/(3*s),(-a+w*(C-R*Math.sin(b)))/(3*s));0<=P&&P<=1&&(o[d++]=P),0<=v&&v<=1&&(o[d++]=v),0<=S&&S<=1&&(o[d++]=S)}}return d},e.cubicExtrema=function(t,e,n,i,r){var o=6*n-12*e+6*t,s=9*e+3*i-3*t-9*n,a=3*e-3*t,h=0;if(N(s)){if(d(o))0<=(c=-a/o)&&c<=1&&(r[h++]=c)}else{var l=o*o-4*s*a;if(N(l))r[0]=-o/(2*s);else if(0<l){var c,u=E(l),p=(-o-u)/(2*s);0<=(c=(-o+u)/(2*s))&&c<=1&&(r[h++]=c),0<=p&&p<=1&&(r[h++]=p)}}return h},e.cubicSubdivide=function(t,e,n,i,r,o){var s=(e-t)*r+t,a=(n-e)*r+e,h=(i-n)*r+n,l=(a-s)*r+s,c=(h-a)*r+a,u=(c-l)*r+l;o[0]=t,o[1]=s,o[2]=l,o[3]=u,o[4]=u,o[5]=c,o[6]=h,o[7]=i},e.cubicProjectPoint=function(t,e,n,i,r,o,s,a,h,l,c){var u,p,d,f,g,v=.005,y=1/0;b[0]=h,b[1]=l;for(var m=0;m<1;m+=.05)w[0]=P(t,n,r,s,m),w[1]=P(e,i,o,a,m),(f=x(b,w))<y&&(u=m,y=f);y=1/0;for(var _=0;_<32&&!(v<1e-4);_++)p=u-v,d=u+v,w[0]=P(t,n,r,s,p),w[1]=P(e,i,o,a,p),f=x(w,b),0<=p&&f<y?(u=p,y=f):(C[0]=P(t,n,r,s,d),C[1]=P(e,i,o,a,d),g=x(C,b),d<=1&&g<y?(u=d,y=g):v*=.5);return c&&(c[0]=P(t,n,r,s,u),c[1]=P(e,i,o,a,u)),E(y)},e.quadraticAt=m,e.quadraticDerivativeAt=function(t,e,n,i){return 2*((1-i)*(e-t)+i*(n-e))},e.quadraticRootAt=function(t,e,n,i,r){var o=t-2*e+n,s=2*(e-t),a=t-i,h=0;if(N(o)){if(d(s))0<=(c=-a/s)&&c<=1&&(r[h++]=c)}else{var l=s*s-4*o*a;if(N(l))0<=(c=-s/(2*o))&&c<=1&&(r[h++]=c);else if(0<l){var c,u=E(l),p=(-s-u)/(2*o);0<=(c=(-s+u)/(2*o))&&c<=1&&(r[h++]=c),0<=p&&p<=1&&(r[h++]=p)}}return h},e.quadraticExtremum=function(t,e,n){var i=t+n-2*e;return 0==i?.5:(t-e)/i},e.quadraticSubdivide=function(t,e,n,i,r){var o=(e-t)*i+t,s=(n-e)*i+e,a=(s-o)*i+o;r[0]=t,r[1]=o,r[2]=a,r[3]=a,r[4]=s,r[5]=n},e.quadraticProjectPoint=function(t,e,n,i,r,o,s,a,h){var l,c=.005,u=1/0;b[0]=s,b[1]=a;for(var p=0;p<1;p+=.05){w[0]=m(t,n,r,p),w[1]=m(e,i,o,p),(v=x(b,w))<u&&(l=p,u=v)}u=1/0;for(var d=0;d<32&&!(c<1e-4);d++){var f=l-c,g=l+c;w[0]=m(t,n,r,f),w[1]=m(e,i,o,f);var v=x(w,b);if(0<=f&&v<u)l=f,u=v;else{C[0]=m(t,n,r,g),C[1]=m(e,i,o,g);var y=x(C,b);g<=1&&y<u?(l=g,u=y):c*=.5}}return h&&(h[0]=m(t,n,r,l),h[1]=m(e,i,o,l)),E(u)}},function(t,e,n){var f=n(14),v=n(30),y=Math.min,m=Math.max,g=Math.sin,_=Math.cos,x=2*Math.PI,b=f.create(),w=f.create(),C=f.create();var P=[],S=[];e.fromPoints=function(t,e,n){if(0!==t.length){var i,r=t[0],o=r[0],s=r[0],a=r[1],h=r[1];for(i=1;i<t.length;i++)r=t[i],o=y(o,r[0]),s=m(s,r[0]),a=y(a,r[1]),h=m(h,r[1]);e[0]=o,e[1]=a,n[0]=s,n[1]=h}},e.fromLine=function(t,e,n,i,r,o){r[0]=y(t,n),r[1]=y(e,i),o[0]=m(t,n),o[1]=m(e,i)},e.fromCubic=function(t,e,n,i,r,o,s,a,h,l){var c,u=v.cubicExtrema,p=v.cubicAt,d=u(t,n,r,s,P);for(h[0]=1/0,h[1]=1/0,l[0]=-1/0,l[1]=-1/0,c=0;c<d;c++){var f=p(t,n,r,s,P[c]);h[0]=y(f,h[0]),l[0]=m(f,l[0])}for(d=u(e,i,o,a,S),c=0;c<d;c++){var g=p(e,i,o,a,S[c]);h[1]=y(g,h[1]),l[1]=m(g,l[1])}h[0]=y(t,h[0]),l[0]=m(t,l[0]),h[0]=y(s,h[0]),l[0]=m(s,l[0]),h[1]=y(e,h[1]),l[1]=m(e,l[1]),h[1]=y(a,h[1]),l[1]=m(a,l[1])},e.fromQuadratic=function(t,e,n,i,r,o,s,a){var h=v.quadraticExtremum,l=v.quadraticAt,c=m(y(h(t,n,r),1),0),u=m(y(h(e,i,o),1),0),p=l(t,n,r,c),d=l(e,i,o,u);s[0]=y(t,r,p),s[1]=y(e,o,d),a[0]=m(t,r,p),a[1]=m(e,o,d)},e.fromArc=function(t,e,n,i,r,o,s,a,h){var l=f.min,c=f.max,u=Math.abs(r-o);if(u%x<1e-4&&1e-4<u)return a[0]=t-n,a[1]=e-i,h[0]=t+n,void(h[1]=e+i);if(b[0]=_(r)*n+t,b[1]=g(r)*i+e,w[0]=_(o)*n+t,w[1]=g(o)*i+e,l(a,b,w),c(h,b,w),(r%=x)<0&&(r+=x),(o%=x)<0&&(o+=x),o<r&&!s?o+=x:r<o&&s&&(r+=x),s){var p=o;o=r,r=p}for(var d=0;d<o;d+=Math.PI/2)r<d&&(C[0]=_(d)*n+t,C[1]=g(d)*i+e,l(a,C,a),c(h,C,h))}},function(t,e,n){var i=n(29),w=n(33),C=n(34),P=n(35),S=n(36),g=n(37).normalizeRadian,_=n(30),T=n(38),E=i.CMD,v=2*Math.PI,R=1e-4;var x=[-1,-1,-1],b=[-1,-1];function N(t,e,n,i,r,o,s,a,h,l){if(e<l&&i<l&&o<l&&a<l||l<e&&l<i&&l<o&&l<a)return 0;var c,u=_.cubicRootAt(e,i,o,a,l,x);if(0===u)return 0;for(var p,d,f=0,g=-1,v=0;v<u;v++){var y=x[v],m=0===y||1===y?.5:1;_.cubicAt(t,n,r,s,y)<h||(g<0&&(g=_.cubicExtrema(e,i,o,a,b),b[1]<b[0]&&1<g&&(void 0,c=b[0],b[0]=b[1],b[1]=c),p=_.cubicAt(e,i,o,a,b[0]),1<g&&(d=_.cubicAt(e,i,o,a,b[1]))),2==g?y<b[0]?f+=p<e?m:-m:y<b[1]?f+=d<p?m:-m:f+=a<d?m:-m:y<b[0]?f+=p<e?m:-m:f+=a<p?m:-m)}return f}function M(t,e,n,i,r,o,s,a){if(e<a&&i<a&&o<a||a<e&&a<i&&a<o)return 0;var h=_.quadraticRootAt(e,i,o,a,x);if(0===h)return 0;var l=_.quadraticExtremum(e,i,o);if(0<=l&&l<=1){for(var c=0,u=_.quadraticAt(e,i,o,l),p=0;p<h;p++){var d=0===x[p]||1===x[p]?.5:1;_.quadraticAt(t,n,r,x[p])<s||(x[p]<l?c+=u<e?d:-d:c+=o<u?d:-d)}return c}d=0===x[0]||1===x[0]?.5:1;return _.quadraticAt(t,n,r,x[0])<s?0:o<e?d:-d}function k(t,e,n,i,r,o,s,a){if(n<(a-=e)||a<-n)return 0;var h=Math.sqrt(n*n-a*a);x[0]=-h,x[1]=h;var l=Math.abs(i-r);if(l<1e-4)return 0;if(l%v<1e-4){r=v;var c=o?1:-1;return s>=x[i=0]+t&&s<=x[1]+t?c:0}if(o){h=i;i=g(r),r=g(h)}else i=g(i),r=g(r);r<i&&(r+=v);for(var u=0,p=0;p<2;p++){var d=x[p];if(s<d+t){var f=Math.atan2(a,d);c=o?1:-1;f<0&&(f=v+f),(i<=f&&f<=r||i<=f+v&&f+v<=r)&&(f>Math.PI/2&&f<1.5*Math.PI&&(c=-c),u+=c)}}return u}function r(t,e,n,i,r){for(var o=0,s=0,a=0,h=0,l=0,c=0;c<t.length;){var u=t[c++];switch(u===E.M&&1<c&&(n||(o+=T(s,a,h,l,i,r))),1==c&&(h=s=t[c],l=a=t[c+1]),u){case E.M:s=h=t[c++],a=l=t[c++];break;case E.L:if(n){if(w.containStroke(s,a,t[c],t[c+1],e,i,r))return!0}else o+=T(s,a,t[c],t[c+1],i,r)||0;s=t[c++],a=t[c++];break;case E.C:if(n){if(C.containStroke(s,a,t[c++],t[c++],t[c++],t[c++],t[c],t[c+1],e,i,r))return!0}else o+=N(s,a,t[c++],t[c++],t[c++],t[c++],t[c],t[c+1],i,r)||0;s=t[c++],a=t[c++];break;case E.Q:if(n){if(P.containStroke(s,a,t[c++],t[c++],t[c],t[c+1],e,i,r))return!0}else o+=M(s,a,t[c++],t[c++],t[c],t[c+1],i,r)||0;s=t[c++],a=t[c++];break;case E.A:var p=t[c++],d=t[c++],f=t[c++],g=t[c++],v=t[c++],y=t[c++],m=(t[c++],1-t[c++]),_=Math.cos(v)*f+p,x=Math.sin(v)*g+d;1<c?o+=T(s,a,_,x,i,r):(h=_,l=x);var b=(i-p)*g/f+p;if(n){if(S.containStroke(p,d,g,v,v+y,m,e,b,r))return!0}else o+=k(p,d,g,v,v+y,m,b,r);s=Math.cos(v+y)*f+p,a=Math.sin(v+y)*g+d;break;case E.R:h=s=t[c++],l=a=t[c++];_=h+t[c++],x=l+t[c++];if(n){if(w.containStroke(h,l,_,l,e,i,r)||w.containStroke(_,l,_,x,e,i,r)||w.containStroke(_,x,h,x,e,i,r)||w.containStroke(h,x,h,l,e,i,r))return!0}else o+=T(_,l,_,x,i,r),o+=T(h,x,h,l,i,r);break;case E.Z:if(n){if(w.containStroke(s,a,h,l,e,i,r))return!0}else o+=T(s,a,h,l,i,r);s=h,a=l}}return n||function(t,e){return Math.abs(t-e)<R}(a,l)||(o+=T(s,a,h,l,i,r)||0),0!==o}e.contain=function(t,e,n){return r(t,0,!1,e,n)},e.containStroke=function(t,e,n,i){return r(t,e,!0,n,i)}},function(t,e){e.containStroke=function(t,e,n,i,r,o,s){if(0===r)return!1;var a=r,h=0;if(e+a<s&&i+a<s||s<e-a&&s<i-a||t+a<o&&n+a<o||o<t-a&&o<n-a)return!1;if(t===n)return Math.abs(o-t)<=a/2;var l=(h=(e-i)/(t-n))*o-s+(t*i-n*e)/(t-n);return l*l/(h*h+1)<=a/2*a/2}},function(t,e,n){var p=n(30);e.containStroke=function(t,e,n,i,r,o,s,a,h,l,c){if(0===h)return!1;var u=h;return!(e+u<c&&i+u<c&&o+u<c&&a+u<c||c<e-u&&c<i-u&&c<o-u&&c<a-u||t+u<l&&n+u<l&&r+u<l&&s+u<l||l<t-u&&l<n-u&&l<r-u&&l<s-u)&&p.cubicProjectPoint(t,e,n,i,r,o,s,a,l,c,null)<=u/2}},function(t,e,n){var c=n(30).quadraticProjectPoint;e.containStroke=function(t,e,n,i,r,o,s,a,h){if(0===s)return!1;var l=s;return!(e+l<h&&i+l<h&&o+l<h||h<e-l&&h<i-l&&h<o-l||t+l<a&&n+l<a&&r+l<a||a<t-l&&a<n-l&&a<r-l)&&c(t,e,n,i,r,o,a,h,null)<=l/2}},function(t,e,n){var d=n(37).normalizeRadian,f=2*Math.PI;e.containStroke=function(t,e,n,i,r,o,s,a,h){if(0===s)return!1;var l=s;a-=t,h-=e;var c=Math.sqrt(a*a+h*h);if(n<c-l||c+l<n)return!1;if(Math.abs(i-r)%f<1e-4)return!0;if(o){var u=i;i=d(r),r=d(u)}else i=d(i),r=d(r);r<i&&(r+=f);var p=Math.atan2(h,a);return p<0&&(p+=f),i<=p&&p<=r||i<=p+f&&p+f<=r}},function(t,e){var n=2*Math.PI;e.normalizeRadian=function(t){return(t%=n)<0&&(t+=n),t}},function(t,e){t.exports=function(t,e,n,i,r,o){if(e<o&&i<o||o<e&&o<i)return 0;if(i===e)return 0;var s=i<e?1:-1,a=(o-e)/(i-e);return 1!=a&&0!=a||(s=i<e?.5:-.5),r<a*(n-t)+t?s:0}},function(t,e){function n(t,e){this.image=t,this.repeat=e,this.type="pattern"}n.prototype.getCanvasPattern=function(t){return t.createPattern(this.image,this.repeat||"repeat")};var i=n;t.exports=i},function(t,e,n){var i=n(29),x=n(14).applyTransform,b=i.CMD,w=[[],[],[]],C=Math.sqrt,P=Math.atan2;t.exports=function(t,e){var n,i,r,o,s,a=t.data,h=b.M,l=b.C,c=b.L,u=b.R,p=b.A,d=b.Q;for(o=r=0;r<a.length;){switch(n=a[r++],o=r,i=0,n){case h:case c:i=1;break;case l:i=3;break;case d:i=2;break;case p:var f=e[4],g=e[5],v=C(e[0]*e[0]+e[1]*e[1]),y=C(e[2]*e[2]+e[3]*e[3]),m=P(-e[1]/y,e[0]/v);a[r]*=v,a[r++]+=f,a[r]*=y,a[r++]+=g,a[r++]*=v,a[r++]*=y,a[r++]+=m,a[r++]+=m,o=r+=2;break;case u:_[0]=a[r++],_[1]=a[r++],x(_,_,e),a[o++]=_[0],a[o++]=_[1],_[0]+=a[r++],_[1]+=a[r++],x(_,_,e),a[o++]=_[0],a[o++]=_[1]}for(s=0;s<i;s++){var _;(_=w[s])[0]=a[r++],_[1]=a[r++],x(_,_,e),a[o++]=_[0],a[o++]=_[1]}}}},function(t,e){function n(t){this.colorStops=t||[]}n.prototype={constructor:n,addColorStop:function(t,e){this.colorStops.push({offset:t,color:e})}};var i=n;t.exports=i},function(t,e){function n(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this)}function h(t,e){return{target:t,topTarget:e&&e.topTarget}}n.prototype={constructor:n,_dragStart:function(t){var e=t.target;e&&e.draggable&&((this._draggingTarget=e).dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(h(e,t),"dragstart",t.event))},_drag:function(t){var e=this._draggingTarget;if(e){var n=t.offsetX,i=t.offsetY,r=n-this._x,o=i-this._y;this._x=n,this._y=i,e.drift(r,o,t),this.dispatchToElement(h(e,t),"drag",t.event);var s=this.findHover(n,i,e).target,a=this._dropTarget;e!==(this._dropTarget=s)&&(a&&s!==a&&this.dispatchToElement(h(a,t),"dragleave",t.event),s&&s!==a&&this.dispatchToElement(h(s,t),"dragenter",t.event))}},_dragEnd:function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(h(e,t),"dragend",t.event),this._dropTarget&&this.dispatchToElement(h(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null}};var i=n;t.exports=i},function(t,e,n){function o(t){for(var e in t=t||{},i.call(this,t),t)t.hasOwnProperty(e)&&(this[e]=t[e]);this._children=[],this.__storage=null,this.__dirty=!0}var s=n(4),i=n(9),l=n(26);o.prototype={constructor:o,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},childOfName:function(t){for(var e=this._children,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},childCount:function(){return this._children.length},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},addBefore:function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var n=this._children,i=n.indexOf(e);0<=i&&(n.splice(i,0,t),this._doAdd(t))}return this},_doAdd:function(t){t.parent&&t.parent.remove(t);var e=(t.parent=this).__storage,n=this.__zr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof o&&t.addChildrenToStorage(e)),n&&n.refresh()},remove:function(t){var e=this.__zr,n=this.__storage,i=this._children,r=s.indexOf(i,t);return r<0||(i.splice(r,1),t.parent=null,n&&(n.delFromStorage(t),t instanceof o&&t.delChildrenFromStorage(n)),e&&e.refresh()),this},removeAll:function(){var t,e,n=this._children,i=this.__storage;for(e=0;e<n.length;e++)t=n[e],i&&(i.delFromStorage(t),t instanceof o&&t.delChildrenFromStorage(i)),t.parent=null;return n.length=0,this},eachChild:function(t,e){for(var n=this._children,i=0;i<n.length;i++){var r=n[i];t.call(e,r,i)}return this},traverse:function(t,e){for(var n=0;n<this._children.length;n++){var i=this._children[n];t.call(e,i),"group"===i.type&&i.traverse(t,e)}return this},addChildrenToStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.addToStorage(n),n instanceof o&&n.addChildrenToStorage(t)}},delChildrenFromStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.delFromStorage(n),n instanceof o&&n.delChildrenFromStorage(t)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(t){for(var e=null,n=new l(0,0,0,0),i=t||this._children,r=[],o=0;o<i.length;o++){var s=i[o];if(!s.ignore&&!s.invisible){var a=s.getBoundingRect(),h=s.getLocalTransform(r);h?(n.copy(a),n.applyTransform(h),(e=e||n.clone()).union(n)):(e=e||a.clone()).union(a)}}return e||n}},s.inherits(o,i);var r=o;t.exports=r},function(t,e,n){var i=n(7),r=n(26),o=n(4),f=n(27);function s(t){i.call(this,t)}s.prototype={constructor:s,type:"image",brush:function(t,e){var n=this.style,i=n.image;n.bind(t,this,e);var r=this._image=f.createOrUpdateImage(i,this._image,this,this.onload);if(r&&f.isImageReady(r)){var o=n.x||0,s=n.y||0,a=n.width,h=n.height,l=r.width/r.height;if(null==a&&null!=h?a=h*l:null==h&&null!=a?h=a/l:null==a&&null==h&&(a=r.width,h=r.height),this.setTransform(t),n.sWidth&&n.sHeight){var c=n.sx||0,u=n.sy||0;t.drawImage(r,c,u,n.sWidth,n.sHeight,o,s,a,h)}else if(n.sx&&n.sy){var p=a-(c=n.sx),d=h-(u=n.sy);t.drawImage(r,c,u,p,d,o,s,a,h)}else t.drawImage(r,o,s,a,h);this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect())}},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new r(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect}},o.inherits(s,i);var a=s;t.exports=a},function(t,e,n){function i(t){r.call(this,t)}var r=n(7),o=n(4),s=n(25),a=n(24);i.prototype={constructor:i,type:"text",brush:function(t,e){var n=this.style;this.__dirty&&a.normalizeTextStyle(n,!0),n.fill=n.stroke=n.shadowBlur=n.shadowColor=n.shadowOffsetX=n.shadowOffsetY=null;var i=n.text;null!=i&&(i+=""),n.bind(t,this,e),a.needDrawText(i,n)&&(this.setTransform(t),a.renderText(this,t,i,n),this.restoreTransform(t))},getBoundingRect:function(){var t=this.style;if(this.__dirty&&a.normalizeTextStyle(t,!0),!this._rect){var e=t.text;null!=e?e+="":e="";var n=s.getBoundingRect(t.text+"",t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.rich);if(n.x+=t.x||0,n.y+=t.y||0,a.getStroke(t.textStroke,t.textStrokeWidth)){var i=t.textStrokeWidth;n.x-=i/2,n.y-=i/2,n.width+=i,n.height+=i}this._rect=n}return this._rect}},o.inherits(i,r);var h=i;t.exports=h},function(t,e,n){var i=n(6).extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(t,e,n){n&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}});t.exports=i},function(t,e,n){var i=n(6),r=n(48),o=i.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:r(i.prototype.brush),buildPath:function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r0||0,0),o=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,h=e.clockwise,l=Math.cos(s),c=Math.sin(s);t.moveTo(l*r+n,c*r+i),t.lineTo(l*o+n,c*o+i),t.arc(n,i,o,s,a,!h),t.lineTo(Math.cos(a)*r+n,Math.sin(a)*r+i),0!==r&&t.arc(n,i,r,a,s,h),t.closePath()}});t.exports=o},function(t,e,n){var i=n(49),l=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]];t.exports=function(h){return i.browser.ie&&11<=i.browser.version?function(){var t,e=this.__clipPaths,n=this.style;if(e)for(var i=0;i<e.length;i++){var r=e[i],o=r&&r.shape,s=r&&r.type;if(o&&("sector"===s&&o.startAngle===o.endAngle||"rect"===s&&(!o.width||!o.height))){for(var a=0;a<l.length;a++)l[a][2]=n[l[a][0]],n[l[a][0]]=l[a][1];t=!0;break}}if(h.apply(this,arguments),t)for(a=0;a<l.length;a++)n[l[a][0]]=l[a][2]}:h}},function(t,e){var n="undefined"==typeof navigator?{browser:{},os:{},node:!0,canvasSupported:!0,svgSupported:!0}:function(t){var e={},n=t.match(/Firefox\/([\d.]+)/),i=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),r=t.match(/Edge\/([\d.]+)/),o=/micromessenger/i.test(t);n&&(e.firefox=!0,e.version=n[1]);i&&(e.ie=!0,e.version=i[1]);r&&(e.edge=!0,e.version=r[1]);o&&(e.weChat=!0);return{browser:e,os:{},node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!e.ie&&!e.edge,pointerEventsSupported:"onpointerdown"in window&&(e.edge||e.ie&&11<=e.version)}}(navigator.userAgent);t.exports=n},function(t,e,n){var i=n(6).extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=2*Math.PI;t.moveTo(n+e.r,i),t.arc(n,i,e.r,0,r,!1),t.moveTo(n+e.r0,i),t.arc(n,i,e.r0,0,r,!0)}});t.exports=i},function(t,e,n){var i=n(6),r=n(52),o=i.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){r.buildPath(t,e,!0)}});t.exports=o},function(t,e,n){var p=n(53),d=n(54);e.buildPath=function(t,e,n){var i=e.points,r=e.smooth;if(i&&2<=i.length){if(r&&"spline"!==r){var o=d(i,r,n,e.smoothConstraint);t.moveTo(i[0][0],i[0][1]);for(var s=i.length,a=0;a<(n?s:s-1);a++){var h=o[2*a],l=o[2*a+1],c=i[(a+1)%s];t.bezierCurveTo(h[0],h[1],l[0],l[1],c[0],c[1])}}else{"spline"===r&&(i=p(i,n)),t.moveTo(i[0][0],i[0][1]);a=1;for(var u=i.length;a<u;a++)t.lineTo(i[a][0],i[a][1])}n&&t.closePath()}}},function(t,e,n){var v=n(14).distance;function y(t,e,n,i,r,o,s){var a=.5*(n-t),h=.5*(i-e);return(2*(e-n)+a+h)*s+(-3*(e-n)-2*a-h)*o+a*r+e}t.exports=function(t,e){for(var n=t.length,i=[],r=0,o=1;o<n;o++)r+=v(t[o-1],t[o]);var s=r/2;for(s=s<n?n:s,o=0;o<s;o++){var a,h,l,c=o/(s-1)*(e?n:n-1),u=Math.floor(c),p=c-u,d=t[u%n];l=e?(a=t[(u-1+n)%n],h=t[(u+1)%n],t[(u+2)%n]):(a=t[0===u?u:u-1],h=t[n-2<u?n-1:u+1],t[n-3<u?n-1:u+2]);var f=p*p,g=p*f;i.push([y(a[0],d[0],h[0],l[0],p,f,g),y(a[1],d[1],h[1],l[1],p,f,g)])}return i}},function(t,e,n){var i=n(14),x=i.min,b=i.max,w=i.scale,C=i.distance,P=i.add,S=i.clone,T=i.sub;t.exports=function(t,e,n,i){var r,o,s,a,h=[],l=[],c=[],u=[];if(i){s=[1/0,1/0],a=[-1/0,-1/0];for(var p=0,d=t.length;p<d;p++)x(s,s,t[p]),b(a,a,t[p]);x(s,s,i[0]),b(a,a,i[1])}for(p=0,d=t.length;p<d;p++){var f=t[p];if(n)r=t[p?p-1:d-1],o=t[(p+1)%d];else{if(0===p||p===d-1){h.push(S(t[p]));continue}r=t[p-1],o=t[p+1]}T(l,o,r),w(l,l,e);var g=C(f,r),v=C(f,o),y=g+v;0!==y&&(g/=y,v/=y),w(c,l,-g),w(u,l,v);var m=P([],f,c),_=P([],f,u);i&&(b(m,m,s),x(m,m,a),b(_,_,s),x(_,_,a)),h.push(m),h.push(_)}return n&&h.push(h.shift()),h}},function(t,e,n){var i=n(6),r=n(52),o=i.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){r.buildPath(t,e,!1)}});t.exports=o},function(t,e,n){var i=n(6),s=n(28),r=i.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.x,i=e.y,r=e.width,o=e.height;e.r?s.buildPath(t,e):t.rect(n,i,r,o),t.closePath()}});t.exports=r},function(t,e,n){var i=n(6).extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,s=e.percent;0!==s&&(t.moveTo(n,i),s<1&&(r=n*(1-s)+r*s,o=i*(1-s)+o*s),t.lineTo(r,o))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]}});t.exports=i},function(t,e,n){var i=n(6),r=n(14),o=n(30),u=o.quadraticSubdivide,p=o.cubicSubdivide,s=o.quadraticAt,a=o.cubicAt,h=o.quadraticDerivativeAt,l=o.cubicDerivativeAt,d=[];function c(t,e,n){var i=t.cpx2,r=t.cpy2;return null===i||null===r?[(n?l:a)(t.x1,t.cpx1,t.cpx2,t.x2,e),(n?l:a)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(n?h:s)(t.x1,t.cpx1,t.x2,e),(n?h:s)(t.y1,t.cpy1,t.y2,e)]}var f=i.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,s=e.cpx1,a=e.cpy1,h=e.cpx2,l=e.cpy2,c=e.percent;0!==c&&(t.moveTo(n,i),null==h||null==l?(c<1&&(u(n,s,r,c,d),s=d[1],r=d[2],u(i,a,o,c,d),a=d[1],o=d[2]),t.quadraticCurveTo(s,a,r,o)):(c<1&&(p(n,s,h,r,c,d),s=d[1],h=d[2],r=d[3],p(i,a,l,o,c,d),a=d[1],l=d[2],o=d[3]),t.bezierCurveTo(s,a,h,l,r,o)))},pointAt:function(t){return c(this.shape,t,!1)},tangentAt:function(t){var e=c(this.shape,t,!0);return r.normalize(e,e)}});t.exports=f},function(t,e,n){var i=n(6).extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r,0),o=e.startAngle,s=e.endAngle,a=e.clockwise,h=Math.cos(o),l=Math.sin(o);t.moveTo(h*r+n,l*r+i),t.arc(n,i,r,o,s,!a)}});t.exports=i},function(t,e,n){function i(t,e,n,i,r,o){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==n?1:n,this.y2=null==i?0:i,this.type="linear",this.global=o||!1,s.call(this,r)}var r=n(4),s=n(41);i.prototype={constructor:i},r.inherits(i,s);var o=i;t.exports=o},function(t,e,n){function i(t,e,n,i,r){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==n?.5:n,this.type="radial",this.global=r||!1,o.call(this,i)}var r=n(4),o=n(41);i.prototype={constructor:i},r.inherits(i,o);var s=i;t.exports=s},function(t,e,n){function i(t){"string"==typeof t?this._fromStr(t):t&&(t.property&&(this.property=t.property),null!=t.duration&&(this.duration=t.duration),t.easing&&(this.easing=t.easing),t.delay&&(this.delay=t.delay)),"*"!==this.property?this.property=this.property.split(","):this.property=r}var p=n(4),a=n(8),h=n(14).copy,r=["position","rotation","scale","style","shape"];i.prototype={constructor:i,property:"*",easing:"Linear",duration:500,delay:0,_fromStr:function(t){var e=t.split(/\s+/g);this.property=e[0],this.duration=+e[1],this.delay=+e[2],this.easing=e[3]}};function o(t){t=t||{},this._states={},this._el=t.el,this._subStates=[],this._transitionAnimators=[],t.initialState&&(this._initialState=t.initialState);var e=t.states;if(e)for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];this._addState(n,i)}this.setState(this._initialState)}o.prototype={constructor:o,_initialState:"normal",_currentState:"",el:function(){return this._el},_addState:function(t,e){if((this._states[t]=e).transition&&(e.transition=new i(e.transition)),t!==this._initialState)this._extendFromInitial(e);else{var n=this._el;for(var t in p.merge(e.style,n.style,!1,!1),e.shape?p.merge(e.shape,n.shape,!1,!0):e.shape=p.clone(n.shape,!0),this._states)this._states.hasOwnProperty(t)&&this._extendFromInitial(this._states[t])}},_extendFromInitial:function(t){var e=this._states[this._initialState];e&&t!==e&&p.merge(t,e,!1,!0)},setState:function(t,e){if(t!==this._currentState||this.transiting()){var n=this._states[t];if(n){if(this._stopTransition(),!e){var i=this._states[this._currentState];i&&i.onleave&&i.onleave.call(this),n.onenter&&n.onenter.call(this)}if(this._currentState=t,this._el){var r=this._el;if(null!=n.zlevel&&(r.zlevel=n.zlevel),null!=n.z&&(r.z=n.z),n.position&&h(r.position,n.position),n.scale&&h(r.scale,n.scale),null!=n.rotation&&(r.rotation=n.rotation),n.style){var o=this._states[this._initialState];r.style=new a,o&&r.style.extendFrom(o.style,!1),t!=this._initialState&&o.style!==n.style&&r.style.extendFrom(n.style,!0)}n.shape&&(r.shape=p.clone(n.shape,!0)),r.dirty()}}for(var s=0;s<this._subStates.length;s++)this._subStates.setState(t)}},getState:function(){return this._currentState},transitionState:function(t,e){if(t!==this._currentState||this.transiting()){var n=this._states[t],i=/$[style|shape]\./,r=this,o={};if(n){r._stopTransition();var s=r._el;if(n.transition&&s&&s.__zr){function a(){0===--c&&(r.setState(t),e&&e())}for(var h=n.transition,l=h.property,c=0,u=0;u<l.length;u++){var p=l[u];if("style"===p||"shape"===p){if(n[p])for(var d in n[p])if(n[p].hasOwnProperty(d)){var f=p+"."+d;o[f]||(o[f]=1,c+=r._animProp(n,p,d,h,a))}}else{if(o[p])continue;if(o[p]=1,p.match(i)){var g=p.slice(0,5);p=p.slice(6),c+=r._animProp(n,g,p,h,a)}else c+=r._animProp(n,"",p,h,a)}}0===c&&(r.setState(t),e&&e())}else r.setState(t),e&&e()}var v=r._subStates;for(u=0;u<v.length;u++)v.transitionState(t)}},_animProp:function(t,e,n,i,r){var o=this._el,s=e?t[e]:t,a=e?o[e]:o,h=s&&n in s&&a&&n in a,l=this._transitionAnimators;if(h){var c={};if(s[n]===a[n])return 0;c[n]=s[n];var u=o.animate(e).when(i.duration,c).delay(i.dealy).done(function(){var t=p.indexOf(l,1);0<t&&l.splice(t,1),r()}).start(i.easing);return l.push(u),1}return 0},_stopTransition:function(){for(var t=this._transitionAnimators,e=0;e<t.length;e++)t[e].stop();t.length=0},transiting:function(){return 0<this._transitionAnimators.length},addSubStates:function(t){this._subStates.push(t)},removeSubStates:function(t){0<=p.indexOf(this._subStates,t)&&this._subStates.splice(t,1)}};var s=o;t.exports=s},function(t,e,n){"use strict";var i=n(4),r=["getDom","getZr","getWidth","getHeight","dispatchAction","on","off","trigger","getDataURL","getConnectedDataURL","getModel","getOption","remove","_getParentZr"];t.exports=function(e){i.each(r,function(t){this[t]=i.bind(e[t],e)},this)}},function(t,e){function i(t,e){this.x=t,this.y=e}i.load=function(t){return new i(Number(t.x),Number(t.y))},i.loadArray=function(t){for(var e=[],n=0;n<t.length;n++)e.push(i.load(t[n]));return e},i.cloneArray=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].clone());return e},i.prototype={constructor:i,transform:function(t){var e=this.x,n=this.y;this.x=t[0][0]*e+t[0][1]*n+t[0][2],this.y=t[1][0]*e+t[1][1]*n+t[1][2]},equals:function(t){return t instanceof i&&(this.x==t.x&&this.y==t.y)},clone:function(){return new i(this.x,this.y)},add:function(t){return this.x=this.x+t.x,this.y=this.y+t.y,this},near:function(t,e,n){return Math.sqrt(Math.pow(this.x-t,2)+Math.pow(this.y-e,2))<=n},contains:function(t,e){return this.x==t&&this.y==e},toString:function(){return"["+this.x+","+this.y+"]"},getPoints:function(){return[this]}},t.exports=i},function(t,e,n){var i=n(10),c=n(49),u=n(4),p=n(66),d=n(67),r=n(69),f=n(72),g=n(74),v=!c.canvasSupported,y={canvas:r},o={};function s(t,e,n){n=n||{},this.dom=e,this.id=t;var i=this,r=new d,o=n.renderer;if(v){if(!y.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");o="vml"}else o&&y[o]||(o="canvas");var s=new y[o](e,r,n);this.storage=r,this.painter=s;var a=c.node?null:new g(s.getViewportRoot());this.handler=new p(r,s,a,s.root),this.animation=new f({stage:{update:u.bind(this.flush,this)}}),this.animation.start(),this._needsRefresh;var h=r.delFromStorage,l=r.addToStorage;r.delFromStorage=function(t){h.call(r,t),t&&t.removeSelfFromZr(i)},r.addToStorage=function(t){l.call(r,t),t.addSelfToZr(i)}}s.prototype={constructor:s,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0},configLayer:function(t,e){this.painter.configLayer(t,e),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},flush:function(){this._needsRefresh&&this.refreshImmediately(),this._needsRefreshHover&&this.refreshHoverImmediately()},addHover:function(t,e){this.painter.addHover&&(this.painter.addHover(t,e),this.refreshHover())},removeHover:function(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(t,e){return this.painter.pathToImage(t,e)},setCursorStyle:function(t){this.handler.setCursorStyle(t)},findHover:function(t,e){return this.handler.findHover(t,e)},on:function(t,e,n){this.handler.on(t,e,n)},off:function(t,e){this.handler.off(t,e)},trigger:function(t,e){this.handler.trigger(t,e)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,function(t){delete o[t]}(this.id)}},e.version="3.7.4",e.init=function(t,e){var n=new s(i(),t,e);return o[n.id]=n},e.dispose=function(t){if(t)t.dispose();else{for(var e in o)o.hasOwnProperty(e)&&o[e].dispose();o={}}return this},e.getInstance=function(t){return o[t]},e.registerPainter=function(t,e){y[t]=e}},function(t,e,n){var r=n(4),o=n(14),s=n(42),a=n(11),h="silent";function l(){}l.prototype.dispose=function(){};function c(t,e,n,i){a.call(this),this.storage=t,this.painter=e,this.painterRoot=i,n=n||new l,((this.proxy=n).handler=this)._hovered={},this._lastTouchMoment,this._lastX,this._lastY,s.call(this),r.each(u,function(t){n.on&&n.on(t,this[t],this)},this)}var u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"];function p(t,e,n){if(t[t.rectHover?"rectContain":"contain"](e,n)){for(var i,r=t;r;){if(r.clipPath&&!r.clipPath.contain(e,n))return!1;r.silent&&(i=!0),r=r.parent}return!i||h}return!1}c.prototype={constructor:c,mousemove:function(t){var e=t.zrX,n=t.zrY,i=this._hovered,r=i.target;r&&!r.__zr&&(r=(i=this.findHover(i.x,i.y)).target);var o=this._hovered=this.findHover(e,n),s=o.target,a=this.proxy;a.setCursor&&a.setCursor(s?s.cursor:"default"),r&&s!==r&&this.dispatchToElement(i,"mouseout",t),this.dispatchToElement(o,"mousemove",t),s&&s!==r&&this.dispatchToElement(o,"mouseover",t)},mouseout:function(t){this.dispatchToElement(this._hovered,"mouseout",t);for(var e,n=t.toElement||t.relatedTarget;(n=n&&n.parentNode)&&9!=n.nodeType&&!(e=n===this.painterRoot););e||this.trigger("globalout",{event:t})},resize:function(t){this._hovered={}},dispatch:function(t,e){var n=this[t];n&&n.call(this,e)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},dispatchToElement:function(t,e,n){var i=(t=t||{}).target;if(!i||!i.silent){for(var r="on"+e,o=function(t,e,n){return{type:t,event:n,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which}}(e,t,n);i&&(i[r]&&(o.cancelBubble=i[r].call(i,o)),i.trigger(e,o),i=i.parent,!o.cancelBubble););o.cancelBubble||(this.trigger(e,o),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[r]&&t[r].call(t,o),t.trigger&&t.trigger(e,o)}))}},findHover:function(t,e,n){for(var i=this.storage.getDisplayList(),r={x:t,y:e},o=i.length-1;0<=o;o--){var s;if(i[o]!==n&&!i[o].ignore&&(s=p(i[o],t,e))&&(r.topTarget||(r.topTarget=i[o]),s!==h)){r.target=i[o];break}}return r}},r.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(i){c.prototype[i]=function(t){var e=this.findHover(t.zrX,t.zrY),n=e.target;if("mousedown"===i)this._downEl=n,this._downPoint=[t.zrX,t.zrY],this._upEl=n;else if("mosueup"===i)this._upEl=n;else if("click"===i){if(this._downEl!==this._upEl||!this._downPoint||4<o.dist(this._downPoint,[t.zrX,t.zrY]))return;this._downPoint=null}this.dispatchToElement(e,i,t)}}),r.mixin(c,a),r.mixin(c,s);var i=c;t.exports=i},function(t,e,n){var o=n(4),s=n(49),a=n(43),h=n(68);function l(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}function i(){this._roots=[],this._displayList=[],this._displayListLen=0}i.prototype={constructor:i,traverse:function(t,e){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,e)},getDisplayList:function(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList},updateDisplayList:function(t){this._displayListLen=0;for(var e=this._roots,n=this._displayList,i=0,r=e.length;i<r;i++)this._updateAndAddDisplayable(e[i],null,t);n.length=this._displayListLen,s.canvasSupported&&h(n,l)},_updateAndAddDisplayable:function(t,e,n){if(!t.ignore||n){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var i=t.clipPath;if(i){e=e?e.slice():[];for(var r=i,o=t;r;)r.parent=o,r.updateTransform(),e.push(r),r=(o=r).clipPath}if(t.isGroup){for(var s=t._children,a=0;a<s.length;a++){var h=s[a];t.__dirty&&(h.__dirty=!0),this._updateAndAddDisplayable(h,e,n)}t.__dirty=!1}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t}},addRoot:function(t){t.__storage!==this&&(t instanceof a&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t){for(var e=0;e<this._roots.length;e++){var n=this._roots[e];n instanceof a&&n.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(t instanceof Array){e=0;for(var i=t.length;e<i;e++)this.delRoot(t[e])}else{var r=o.indexOf(this._roots,t);0<=r&&(this.delFromStorage(t),this._roots.splice(r,1),t instanceof a&&t.delChildrenFromStorage(this))}},addToStorage:function(t){return t.__storage=this,t.dirty(!1),this},delFromStorage:function(t){return t&&(t.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:l};var r=i;t.exports=r},function(t,e){var l=32,m=7;function c(t,e,n,i){var r=e+1;if(r===n)return 1;if(i(t[r++],t[e])<0){for(;r<n&&i(t[r],t[r-1])<0;)r++;!function(t,e,n){n--;for(;e<n;){var i=t[e];t[e++]=t[n],t[n--]=i}}(t,e,r)}else for(;r<n&&0<=i(t[r],t[r-1]);)r++;return r-e}function u(t,e,n,i,r){for(i===e&&i++;i<n;i++){for(var o,s=t[i],a=e,h=i;a<h;)r(s,t[o=a+h>>>1])<0?h=o:a=1+o;var l=i-a;switch(l){case 3:t[a+3]=t[a+2];case 2:t[a+2]=t[a+1];case 1:t[a+1]=t[a];break;default:for(;0<l;)t[a+l]=t[a+l-1],l--}t[a]=s}}function _(t,e,n,i,r,o){var s=0,a=0,h=1;if(0<o(t,e[n+r])){for(a=i-r;h<a&&0<o(t,e[n+r+h]);)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a),s+=r,h+=r}else{for(a=r+1;h<a&&o(t,e[n+r-h])<=0;)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a);var l=s;s=r-h,h=r-l}for(s++;s<h;){var c=s+(h-s>>>1);0<o(t,e[n+c])?s=c+1:h=c}return h}function x(t,e,n,i,r,o){var s=0,a=0,h=1;if(o(t,e[n+r])<0){for(a=r+1;h<a&&o(t,e[n+r-h])<0;)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a);var l=s;s=r-h,h=r-l}else{for(a=i-r;h<a&&0<=o(t,e[n+r+h]);)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a),s+=r,h+=r}for(s++;s<h;){var c=s+(h-s>>>1);o(t,e[n+c])<0?h=c:s=c+1}return h}function p(f,g){var t,s,a,v=m,h=0;t=f.length;var y=[];function e(t){var e=s[t],n=a[t],i=s[t+1],r=a[t+1];a[t]=n+r,t===h-3&&(s[t+1]=s[t+2],a[t+1]=a[t+2]),h--;var o=x(f[i],f,e,n,0,g);e+=o,0!==(n-=o)&&0!==(r=_(f[e+n-1],f,i,r,r-1,g))&&(n<=r?function(t,e,n,i){var r=0;for(r=0;r<e;r++)y[r]=f[t+r];var o=0,s=n,a=t;if(f[a++]=f[s++],0==--i){for(r=0;r<e;r++)f[a+r]=y[o+r];return}if(1===e){for(r=0;r<i;r++)f[a+r]=f[s+r];return f[a+i]=y[o]}var h,l,c,u=v;for(;;){l=h=0,c=!1;do{if(g(f[s],y[o])<0){if(f[a++]=f[s++],l++,(h=0)==--i){c=!0;break}}else if(f[a++]=y[o++],h++,l=0,1==--e){c=!0;break}}while((h|l)<u);if(c)break;do{if(0!==(h=x(f[s],y,o,e,0,g))){for(r=0;r<h;r++)f[a+r]=y[o+r];if(a+=h,o+=h,(e-=h)<=1){c=!0;break}}if(f[a++]=f[s++],0==--i){c=!0;break}if(0!==(l=_(y[o],f,s,i,0,g))){for(r=0;r<l;r++)f[a+r]=f[s+r];if(a+=l,s+=l,0===(i-=l)){c=!0;break}}if(f[a++]=y[o++],1==--e){c=!0;break}u--}while(m<=h||m<=l);if(c)break;u<0&&(u=0),u+=2}if((v=u)<1&&(v=1),1===e){for(r=0;r<i;r++)f[a+r]=f[s+r];f[a+i]=y[o]}else{if(0===e)throw new Error;for(r=0;r<e;r++)f[a+r]=y[o+r]}}(e,n,i,r):function(t,e,n,i){var r=0;for(r=0;r<i;r++)y[r]=f[n+r];var o=t+e-1,s=i-1,a=n+i-1,h=0,l=0;if(f[a--]=f[o--],0==--e){for(h=a-(i-1),r=0;r<i;r++)f[h+r]=y[r];return}if(1===i){for(l=(a-=e)+1,h=(o-=e)+1,r=e-1;0<=r;r--)f[l+r]=f[h+r];return f[a]=y[s]}var c=v;for(;;){var u=0,p=0,d=!1;do{if(g(y[s],f[o])<0){if(f[a--]=f[o--],u++,(p=0)==--e){d=!0;break}}else if(f[a--]=y[s--],p++,u=0,1==--i){d=!0;break}}while((u|p)<c);if(d)break;do{if(0!==(u=e-x(y[s],f,t,e,e-1,g))){for(e-=u,l=(a-=u)+1,h=(o-=u)+1,r=u-1;0<=r;r--)f[l+r]=f[h+r];if(0===e){d=!0;break}}if(f[a--]=y[s--],1==--i){d=!0;break}if(0!==(p=i-_(f[o],y,0,i,i-1,g))){for(i-=p,l=(a-=p)+1,h=(s-=p)+1,r=0;r<p;r++)f[l+r]=y[h+r];if(i<=1){d=!0;break}}if(f[a--]=f[o--],0==--e){d=!0;break}c--}while(m<=u||m<=p);if(d)break;c<0&&(c=0),c+=2}(v=c)<1&&(v=1);if(1===i){for(l=(a-=e)+1,h=(o-=e)+1,r=e-1;0<=r;r--)f[l+r]=f[h+r];f[a]=y[s]}else{if(0===i)throw new Error;for(h=a-(i-1),r=0;r<i;r++)f[h+r]=y[r]}}(e,n,i,r))}s=[],a=[],this.mergeRuns=function(){for(;1<h;){var t=h-2;if(1<=t&&a[t-1]<=a[t]+a[t+1]||2<=t&&a[t-2]<=a[t]+a[t-1])a[t-1]<a[t+1]&&t--;else if(a[t]>a[t+1])break;e(t)}},this.forceMergeRuns=function(){for(;1<h;){var t=h-2;0<t&&a[t-1]<a[t+1]&&t--,e(t)}},this.pushRun=function(t,e){s[h]=t,a[h]=e,h+=1}}t.exports=function(t,e,n,i){n=n||0;var r=(i=i||t.length)-n;if(!(r<2)){var o=0;if(r<l)u(t,n,i,n+(o=c(t,n,i,e)),e);else{var s=new p(t,e),a=function(t){for(var e=0;l<=t;)e|=1&t,t>>=1;return t+e}(r);do{if((o=c(t,n,i,e))<a){var h=r;a<h&&(h=a),u(t,n,n+h,n+o,e),o=h}s.pushRun(n,o),s.mergeRuns(),r-=o,n+=o}while(0!==r);s.forceMergeRuns()}}}},function(t,e,n){var u=n(22).devicePixelRatio,m=n(4),_=n(21),i=n(26),a=n(68),v=n(70),r=n(71),x=n(44);function h(t){return parseInt(t,10)}function o(t){t.__unusedCount++}function s(t){1==t.__unusedCount&&t.clear()}var l=new i(0,0,0,0),c=new i(0,0,0,0);function p(t,e,n){this.type="canvas";var i=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=n=m.extend({},n||{}),this.dpr=n.devicePixelRatio||u,this._singleCanvas=i;var r=(this.root=t).style;r&&(r["-webkit-tap-highlight-color"]="transparent",r["-webkit-user-select"]=r["user-select"]=r["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var o=this._zlevelList=[],s=this._layers={};if(this._layerConfig={},i){null!=n.width&&(t.width=n.width),null!=n.height&&(t.height=n.height);var a=t.width,h=t.height;this._width=a,this._height=h;var l=new v(t,this,1);l.initContext(),s[0]=l,o.push(0),this._domRoot=t}else{this._width=this._getSize(0),this._height=this._getSize(1);var c=this._domRoot=function(t,e){var n=document.createElement("div");return n.style.cssText=["position:relative","overflow:hidden","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}(this._width,this._height);t.appendChild(c)}this._progressiveLayers=[],this._hoverlayer,this._hoverElements=[]}p.prototype={constructor:p,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(t){var e=this.storage.getDisplayList(!0),n=this._zlevelList;this._paintList(e,t);for(var i=0;i<n.length;i++){var r=n[i],o=this._layers[r];!o.__builtin__&&o.refresh&&o.refresh()}return this.refreshHover(),this._progressiveLayers.length&&this._startProgessive(),this},addHover:function(t,e){if(!t.__hoverMir){var n=new t.constructor({style:t.style,shape:t.shape});((n.__from=t).__hoverMir=n).setStyle(e),this._hoverElements.push(n)}},removeHover:function(t){var e=t.__hoverMir,n=this._hoverElements,i=m.indexOf(n,e);0<=i&&n.splice(i,1),t.__hoverMir=null},clearHover:function(t){for(var e=this._hoverElements,n=0;n<e.length;n++){var i=e[n].__from;i&&(i.__hoverMir=null)}e.length=0},refreshHover:function(){var t=this._hoverElements,e=t.length,n=this._hoverlayer;if(n&&n.clear(),e){a(t,this.storage.displayableSortFunc);var i={};(n=n||(this._hoverlayer=this.getLayer(1e5))).ctx.save();for(var r=0;r<e;){var o=t[r],s=o.__from;s&&s.__zr?(r++,s.invisible||(o.transform=s.transform,o.invTransform=s.invTransform,o.__clipPaths=s.__clipPaths,this._doPaintEl(o,n,!0,i))):(t.splice(r,1),s.__hoverMir=null,e--)}n.ctx.restore()}},_startProgessive:function(){var e=this;if(e._furtherProgressive){var n=e._progressiveToken=+new Date;e._progress++,r(function t(){n===e._progressiveToken&&e.storage&&(e._doPaintList(e.storage.getDisplayList()),e._furtherProgressive?(e._progress++,r(t)):e._progressiveToken=-1)})}},_clearProgressive:function(){this._progressiveToken=-1,this._progress=0,m.each(this._progressiveLayers,function(t){t.__dirty&&t.clear()})},_paintList:function(t,e){null==e&&(e=!1),this._updateLayerStatus(t),this._clearProgressive(),this.eachBuiltinLayer(o),this._doPaintList(t,e),this.eachBuiltinLayer(s)},_doPaintList:function(t,e){var n,i,r,o,s,a,h=0,l=this._width,c=this._height,u=this._progress;function p(t){var e=r.dpr||1;r.save(),r.globalAlpha=1,r.shadowBlur=0,n.__dirty=!0,r.setTransform(1,0,0,1,0,0),r.drawImage(t.dom,0,0,l*e,c*e),r.restore()}for(var d=0,f=t.length;d<f;d++){var g=t[d],v=this._singleCanvas?0:g.zlevel,y=g.__frame;if(y<0&&s&&(p(s),s=null),i!==v&&(r&&r.restore(),o={},i=v,(n=this.getLayer(i)).__builtin__||_("ZLevel "+i+" has been used by unkown layer "+n.id),(r=n.ctx).save(),n.__unusedCount=0,(n.__dirty||e)&&n.clear()),n.__dirty||e){if(0<=y){if(!s){if((s=this._progressiveLayers[Math.min(h++,4)]).ctx.save(),s.renderScope={},s&&s.__progress>s.__maxProgress){d=s.__nextIdxNotProg-1;continue}a=s.__progress,s.__dirty||(u=a),s.__progress=u+1}y===u&&this._doPaintEl(g,s,!0,s.renderScope)}else this._doPaintEl(g,n,e,o);g.__dirty=!1}}s&&p(s),r&&r.restore(),this._furtherProgressive=!1,m.each(this._progressiveLayers,function(t){t.__maxProgress>=t.__progress&&(this._furtherProgressive=!0)},this)},_doPaintEl:function(t,e,n,i){var r=e.ctx,o=t.transform;if((e.__dirty||n)&&!t.invisible&&0!==t.style.opacity&&(!o||o[0]||o[3])&&(!t.culling||!function(t,e,n){return l.copy(t.getBoundingRect()),t.transform&&l.applyTransform(t.transform),c.width=e,c.height=n,!l.intersect(c)}(t,this._width,this._height))){var s=t.__clipPaths;i.prevClipLayer===e&&!function(t,e){if(t==e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!0}(s,i.prevElClipPaths)||(i.prevElClipPaths&&(i.prevClipLayer.ctx.restore(),i.prevClipLayer=i.prevElClipPaths=null,i.prevEl=null),s&&(r.save(),function(t,e){for(var n=0;n<t.length;n++){var i=t[n];i.setTransform(e),e.beginPath(),i.buildPath(e,i.shape),e.clip(),i.restoreTransform(e)}}(s,r),i.prevClipLayer=e,i.prevElClipPaths=s)),t.beforeBrush&&t.beforeBrush(r),t.brush(r,i.prevEl||null),(i.prevEl=t).afterBrush&&t.afterBrush(r)}},getLayer:function(t){if(this._singleCanvas)return this._layers[0];var e=this._layers[t];return e||((e=new v("zr_"+t,this,this.dpr)).__builtin__=!0,this._layerConfig[t]&&m.merge(e,this._layerConfig[t],!0),this.insertLayer(t,e),e.initContext()),e},insertLayer:function(t,e){var n=this._layers,i=this._zlevelList,r=i.length,o=null,s=-1,a=this._domRoot;if(n[t])_("ZLevel "+t+" has been used already");else if(function(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh)}(e)){if(0<r&&t>i[0]){for(s=0;s<r-1&&!(i[s]<t&&i[s+1]>t);s++);o=n[i[s]]}if(i.splice(s+1,0,t),!(n[t]=e).virtual)if(o){var h=o.dom;h.nextSibling?a.insertBefore(e.dom,h.nextSibling):a.appendChild(e.dom)}else a.firstChild?a.insertBefore(e.dom,a.firstChild):a.appendChild(e.dom)}else _("Layer of zlevel "+t+" is not valid")},eachLayer:function(t,e){var n,i,r=this._zlevelList;for(i=0;i<r.length;i++)n=r[i],t.call(e,this._layers[n],n)},eachBuiltinLayer:function(t,e){var n,i,r,o=this._zlevelList;for(r=0;r<o.length;r++)i=o[r],(n=this._layers[i]).__builtin__&&t.call(e,n,i)},eachOtherLayer:function(t,e){var n,i,r,o=this._zlevelList;for(r=0;r<o.length;r++)i=o[r],(n=this._layers[i]).__builtin__||t.call(e,n,i)},getLayers:function(){return this._layers},_updateLayerStatus:function(t){var e=this._layers,n=this._progressiveLayers,i={},r={};this.eachBuiltinLayer(function(t,e){i[e]=t.elCount,t.elCount=0,t.__dirty=!1}),m.each(n,function(t,e){r[e]=t.elCount,t.elCount=0,t.__dirty=!1});for(var o,s,a=0,h=0,l=0,c=t.length;l<c;l++){var u=t[l],p=e[this._singleCanvas?0:u.zlevel],d=u.progressive;if(p&&(p.elCount++,p.__dirty=p.__dirty||u.__dirty),0<=d){s!==d&&(s=d,h++);var f=u.__frame=h-1;if(!o){var g=Math.min(a,4);(o=n[g])||(o=n[g]=new v("progressive",this,this.dpr)).initContext(),o.__maxProgress=0}o.__dirty=o.__dirty||u.__dirty,o.elCount++,o.__maxProgress=Math.max(o.__maxProgress,f),o.__maxProgress>=o.__progress&&(p.__dirty=!0)}else u.__frame=-1,o&&(o.__nextIdxNotProg=l,a++,o=null)}o&&(a++,o.__nextIdxNotProg=l),this.eachBuiltinLayer(function(t,e){i[e]!==t.elCount&&(t.__dirty=!0)}),n.length=Math.min(a,5),m.each(n,function(t,e){r[e]!==t.elCount&&(u.__dirty=!0),t.__dirty&&(t.__progress=0)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(t){t.clear()},configLayer:function(t,e){if(e){var n=this._layerConfig;n[t]?m.merge(n[t],e,!0):n[t]=e;var i=this._layers[t];i&&m.merge(i,n[t],!0)}},delLayer:function(t){var e=this._layers,n=this._zlevelList,i=e[t];i&&(i.dom.parentNode.removeChild(i.dom),delete e[t],n.splice(m.indexOf(n,t),1))},resize:function(e,n){var t=this._domRoot;t.style.display="none";var i=this._opts;if(null!=e&&(i.width=e),null!=n&&(i.height=n),e=this._getSize(0),n=this._getSize(1),t.style.display="",this._width!=e||n!=this._height){for(var r in t.style.width=e+"px",t.style.height=n+"px",this._layers)this._layers.hasOwnProperty(r)&&this._layers[r].resize(e,n);m.each(this._progressiveLayers,function(t){t.resize(e,n)}),this.refresh(!0)}return this._width=e,this._height=n,this},clearLayer:function(t){var e=this._layers[t];e&&e.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(t){if(t=t||{},this._singleCanvas)return this._layers[0].dom;var a=new v("image",this,t.pixelRatio||this.dpr);a.initContext(),a.clearColor=t.backgroundColor,a.clear();var e,n=this.storage.getDisplayList(!0),i={},h=this;function r(t,e){var n,i=h._zlevelList;null==t&&(t=-1/0);for(var r=0;r<i.length;r++){var o=i[r],s=h._layers[o];if(!s.__builtin__&&t<o&&o<e){n=s;break}}n&&n.renderToCanvas&&(a.ctx.save(),n.renderToCanvas(a.ctx),a.ctx.restore())}for(var o=0;o<n.length;o++){var s=n[o];s.zlevel!==e&&(r(e,s.zlevel),e=s.zlevel),this._doPaintEl(s,a,!0,i)}return r(e,1/0),a.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,n=["width","height"][t],i=["clientWidth","clientHeight"][t],r=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var s=this.root,a=document.defaultView.getComputedStyle(s);return(s[i]||h(a[n])||h(s.style[n]))-(h(a[r])||0)-(h(a[o])||0)|0},pathToImage:function(t,e){e=e||this.dpr;var n=document.createElement("canvas"),i=n.getContext("2d"),r=t.getBoundingRect(),o=t.style,s=o.shadowBlur,a=o.shadowOffsetX,h=o.shadowOffsetY,l=o.hasStroke()?o.lineWidth:0,c=Math.max(l/2,-a+s),u=Math.max(l/2,a+s),p=Math.max(l/2,-h+s),d=Math.max(l/2,h+s),f=r.width+c+u,g=r.height+p+d;n.width=f*e,n.height=g*e,i.scale(e,e),i.clearRect(0,0,f,g),i.dpr=e;var v={position:t.position,rotation:t.rotation,scale:t.scale};t.position=[c-r.x,p-r.y],t.rotation=0,t.scale=[1,1],t.updateTransform(),t&&t.brush(i);var y=new x({style:{x:0,y:0,image:n}});return null!=v.position&&(y.position=t.position=v.position),null!=v.rotation&&(y.rotation=t.rotation=v.rotation),null!=v.scale&&(y.scale=t.scale=v.scale),y}};var d=p;t.exports=d},function(t,e,n){var a=n(4),o=n(22).devicePixelRatio,u=n(8),p=n(39);function s(){return!1}function h(t,e,n){var i=a.createCanvas(),r=e.getWidth(),o=e.getHeight(),s=i.style;return s.position="absolute",s.left=0,s.top=0,s.width=r+"px",s.height=o+"px",i.width=r*n,i.height=o*n,i.setAttribute("data-zr-dom-id",t),i}function i(t,e,n){var i;n=n||o,"string"==typeof t?i=h(t,e,n):a.isObject(t)&&(t=(i=t).id),this.id=t;var r=(this.dom=i).style;r&&(i.onselectstart=s,r["-webkit-user-select"]="none",r["user-select"]="none",r["-webkit-touch-callout"]="none",r["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",r.padding=0,r.margin=0,r["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=n}i.prototype={constructor:i,elCount:0,__dirty:!0,initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.__currentValues={},this.ctx.dpr=this.dpr},createBackBuffer:function(){var t=this.dpr;this.domBack=h("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),this.ctxBack.__currentValues={},1!=t&&this.ctxBack.scale(t,t)},resize:function(t,e){var n=this.dpr,i=this.dom,r=i.style,o=this.domBack;r.width=t+"px",r.height=e+"px",i.width=t*n,i.height=e*n,o&&(o.width=t*n,o.height=e*n,1!=n&&this.ctxBack.scale(n,n))},clear:function(t){var e,n=this.dom,i=this.ctx,r=n.width,o=n.height,s=this.clearColor,a=this.motionBlur&&!t,h=this.lastFrameAlpha,l=this.dpr;a&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(n,0,0,r/l,o/l)),i.clearRect(0,0,r,o),s&&(s.colorStops?(e=s.__canvasGradient||u.getGradient(i,s,{x:0,y:0,width:r,height:o}),s.__canvasGradient=e):s.image&&(e=p.prototype.getCanvasPattern.call(s,i)),i.save(),i.fillStyle=e||s,i.fillRect(0,0,r,o),i.restore());if(a){var c=this.domBack;i.save(),i.globalAlpha=h,i.drawImage(c,0,0,r,o),i.restore()}}};var r=i;t.exports=r},function(t,e){var n="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16)};t.exports=n},function(t,e,n){function i(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,o.call(this)}var r=n(4),o=n(73).Dispatcher,s=n(71),a=n(16);i.prototype={constructor:i,addClip:function(t){this._clips.push(t)},addAnimator:function(t){t.animation=this;for(var e=t.getClips(),n=0;n<e.length;n++)this.addClip(e[n])},removeClip:function(t){var e=r.indexOf(this._clips,t);0<=e&&this._clips.splice(e,1)},removeAnimator:function(t){for(var e=t.getClips(),n=0;n<e.length;n++)this.removeClip(e[n]);t.animation=null},_update:function(){for(var t=(new Date).getTime()-this._pausedTime,e=t-this._time,n=this._clips,i=n.length,r=[],o=[],s=0;s<i;s++){var a=n[s],h=a.step(t,e);h&&(r.push(h),o.push(a))}for(s=0;s<i;)n[s]._needsRemove?(n[s]=n[i-1],n.pop(),i--):s++;i=r.length;for(s=0;s<i;s++)o[s].fire(r[s]);this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update()},_startLoop:function(){var e=this;this._running=!0,s(function t(){e._running&&(s(t),e._paused||e._update())})},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},animate:function(t,e){var n=new a(t,(e=e||{}).loop,e.getter,e.setter);return this.addAnimator(n),n}},r.mixin(i,o);var h=i;t.exports=h},function(t,e,n){var i=n(11);e.Dispatcher=i;var r=n(49),o="undefined"!=typeof window&&!!window.addEventListener,s=/^(?:mouse|pointer|contextmenu|drag|drop)|click/;function a(t,e,n,i){return n=n||{},i||!r.canvasSupported?h(t,e,n):r.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX?(n.zrX=e.layerX,n.zrY=e.layerY):null!=e.offsetX?(n.zrX=e.offsetX,n.zrY=e.offsetY):h(t,e,n),n}function h(t,e,n){var i=function(t){return t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0}}(t);n.zrX=e.clientX-i.left,n.zrY=e.clientY-i.top}var l=o?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0};e.clientToLocal=a,e.normalizeEvent=function(t,e,n){if(null!=(e=e||window.event).zrX)return e;var i=e.type;if(i&&0<=i.indexOf("touch")){var r="touchend"!=i?e.targetTouches[0]:e.changedTouches[0];r&&a(t,r,e,n)}else a(t,e,e,n),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;var o=e.button;return null==e.which&&void 0!==o&&s.test(e.type)&&(e.which=1&o?1:2&o?3:4&o?2:0),e},e.addEventListener=function(t,e,n){o?t.addEventListener(e,n):t.attachEvent("on"+e,n)},e.removeEventListener=function(t,e,n){o?t.removeEventListener(e,n):t.detachEvent("on"+e,n)},e.stop=l,e.notLeftMouse=function(t){return 1<t.which}},function(t,e,n){var i=n(73),r=i.addEventListener,o=i.removeEventListener,s=i.normalizeEvent,a=n(4),h=n(11),l=n(49),c=n(75),u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],p=["touchstart","touchend","touchmove"],d={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},f=a.map(u,function(t){var e=t.replace("mouse","pointer");return d[e]?e:t});function g(t){return"mousewheel"===t&&l.browser.firefox?"DOMMouseScroll":t}function v(t,e,n){var i=t._gestureMgr;"start"===n&&i.clear();var r=i.recognize(e,t.handler.findHover(e.zrX,e.zrY,null).target,t.dom);if("end"===n&&i.clear(),r){var o=r.type;e.gestureEvent=o,t.handler.dispatchToElement({target:r.target},o,r.event)}}function y(t){t._touching=!0,clearTimeout(t._touchTimer),t._touchTimer=setTimeout(function(){t._touching=!1},700)}var m={mousemove:function(t){t=s(this.dom,t),this.trigger("mousemove",t)},mouseout:function(t){var e=(t=s(this.dom,t)).toElement||t.relatedTarget;if(e!=this.dom)for(;e&&9!=e.nodeType;){if(e===this.dom)return;e=e.parentNode}this.trigger("mouseout",t)},touchstart:function(t){(t=s(this.dom,t)).zrByTouch=!0,this._lastTouchMoment=new Date,v(this,t,"start"),m.mousemove.call(this,t),m.mousedown.call(this,t),y(this)},touchmove:function(t){(t=s(this.dom,t)).zrByTouch=!0,v(this,t,"change"),m.mousemove.call(this,t),y(this)},touchend:function(t){(t=s(this.dom,t)).zrByTouch=!0,v(this,t,"end"),m.mouseup.call(this,t),+new Date-this._lastTouchMoment<300&&m.click.call(this,t),y(this)},pointerdown:function(t){m.mousedown.call(this,t)},pointermove:function(t){_(t)||m.mousemove.call(this,t)},pointerup:function(t){m.mouseup.call(this,t)},pointerout:function(t){_(t)||m.mouseout.call(this,t)}};function _(t){var e=t.pointerType;return"pen"===e||"touch"===e}function x(e){a.each(p,function(t){e._handlers[t]=a.bind(m[t],e)}),a.each(f,function(t){e._handlers[t]=a.bind(m[t],e)}),a.each(u,function(t){e._handlers[t]=function(t,e){return function(){if(!e._touching)return t.apply(e,arguments)}}(m[t],e)})}function b(n){function t(t,e){a.each(t,function(t){r(n,g(t),e._handlers[t])},e)}h.call(this),this.dom=n,this._touching=!1,this._touchTimer,this._gestureMgr=new c,this._handlers={},x(this),l.pointerEventsSupported?t(f,this):(l.touchEventsSupported&&t(p,this),t(u,this))}a.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){m[e]=function(t){t=s(this.dom,t),this.trigger(e,t)}});var w=b.prototype;w.dispose=function(){for(var t=u.concat(p),e=0;e<t.length;e++){var n=t[e];o(this.dom,g(n),this._handlers[n])}},w.setCursor=function(t){this.dom.style.cursor=t||"default"},a.mixin(b,h);var C=b;t.exports=C},function(t,e,n){function i(){this._track=[]}var l=n(73);function a(t){var e=t[1][0]-t[0][0],n=t[1][1]-t[0][1];return Math.sqrt(e*e+n*n)}i.prototype={constructor:i,recognize:function(t,e,n){return this._doTrack(t,e,n),this._recognize(t)},clear:function(){return this._track.length=0,this},_doTrack:function(t,e,n){var i=t.touches;if(i){for(var r={points:[],touches:[],target:e,event:t},o=0,s=i.length;o<s;o++){var a=i[o],h=l.clientToLocal(n,a,{});r.points.push([h.zrX,h.zrY]),r.touches.push(a)}this._track.push(r)}},_recognize:function(t){for(var e in r)if(r.hasOwnProperty(e)){var n=r[e](this._track,t);if(n)return n}}};var r={pinch:function(t,e){var n=t.length;if(n){var i=(t[n-1]||{}).points,r=(t[n-2]||{}).points||i;if(r&&1<r.length&&i&&1<i.length){var o=a(i)/a(r);isFinite(o)||(o=1),e.pinchScale=o;var s=function(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]}(i);return e.pinchX=s[0],e.pinchY=s[1],{type:"pinch",target:t[0].target,event:e}}}}},o=i;t.exports=o},function(t,e,n){var p=n(4),i=n(77),r=n(79),v=n(82),o=n(84),s=n(86),a=n(87),h=n(89),l=n(90),c=n(91),u=n(92),d=n(93),f=n(94),g=n(95),y=n(96),m=n(97),_=n(98),x=n(99),b=n(101),w=n(102),C=n(103),P=n(104);function S(t,e){for(var n,i=t.allNodes.length-1;0<=i;i--)t.allNodes[i].model.get("resourceId")==e&&(n=t.allNodes[i]);return n}function T(t){return t.parent&&P.isSubProcess(t.parent)?t.position[0]+T(t.parent):t.position[0]}function E(t){return t.parent&&P.isSubProcess(t.parent)?t.position[1]+E(t.parent):t.position[1]}var R={toJson:function(t,e,n){for(var i=[],r=0;r<e.length;r++){var o=e[r];o.parent&&P.isSubProcess(o.parent)||o&&o.toJSON&&i.push(o.toJSON())}for(var s=0;s<n.length;s++){var a=n[s];a.parent&&P.isSubProcess(a.parent)||a&&a.toJSON&&i.push(a.toJSON())}return t.set("childShapes",i),t.option},fromJson:function(h,t){h.clear(!0);var e=new v(t),n=(h.model=e).get("properties.width"),i=e.get("properties.height");function l(t,e){if(t.nodeType===P.SUB_PROCESS)for(var n=e.get("childShapes"),i=0;i<n.length;i++){var r=new v(n[i]);if(P.isFlowModel(r))h.addConnectorByModel(r,t);else{var o=e.get("bounds.upperLeft"),s=r.get("bounds.upperLeft"),a=r.get("bounds.lowerRight");r.set("bounds.upperLeft",{x:s.x+o.x,y:s.y+o.y}),r.set("bounds.lowerRight",{x:a.x+o.x,y:a.y+o.y}),l(h.addNodeByModel(r,!0,!0),r)}}}0<n&&0<i&&h.resize(n,i);for(var r=e.get("childShapes"),o=[],s=0;s<r.length;s++){var a=r[s];if(a.stencil.type===P.SEQUENCE_FLOW)o.push(a);else{var c=new v(a);l(h.addNodeByModel(c,!1,!0),c)}}for(var u=0,p=o.length;u<p;u++){var d=new v(o[u]);h.addConnectorByModel(d)}for(var f=0;f<r.length;f++)if(r[f].properties.slotEvent)for(var g=0;g<r[f].properties.slotEvent.length;g++)S(h,r[f].resourceId).slotEvent.push(S(h,r[f].properties.slotEvent[g]))},registerBPMNNode:function(){r.registerClass(o,"StartNoneEvent"),r.registerClass(s,"EndNoneEvent"),r.registerClass(a,"UserTask"),r.registerClass(h,"ManualTask"),r.registerClass(l,"ScriptTask"),r.registerClass(c,"MailTask"),r.registerClass(u,"ServiceTask"),r.registerClass(d,"SmsTask"),r.registerClass(f,"Comment"),r.registerClass(g,"CatchTimerEvent"),r.registerClass(_,"CatchMessageEvent"),r.registerClass(y,"CatchSignalEvent"),r.registerClass(m,"ThrowSignalEvent"),r.registerClass(x,"InclusiveGateway"),r.registerClass(b,"ExclusiveGateway"),r.registerClass(w,"ParallelGateway"),r.registerClass(C,"SubProcess")},findHover:function(t,e,n,i){for(var r=t.length-1;0<=r;r--)if(c=i,u=t[r],-1==p.indexOf(c,u)&&!t[r].ignore&&(o=t[r],s=e,a=n,l=h=void 0,o.parent?P.isSubProcess(o.parent)?(h=s-T(o.parent),l=a-E(o.parent),o.rectContain(h,l)):void 0:o.rectContain(s,a)))return t[r];var o,s,a,h,l,c,u},parentX:T,parentY:E,getParentNode:function t(e){return e.parent&&P.isSubProcess(e.parent)?t(e.parent):e},getUUID:i.getUUID};t.exports=R},function(t,e,n){var p=n(64),l=n(78),d=n(26),f=n(4);function r(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function c(t,e){if(t.startPoint.x==t.endPoint.x&&e.startPoint.x==e.endPoint.x)return t.startPoint.x==e.startPoint.x&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y));if(t.startPoint.x==t.endPoint.x||e.startPoint.x==e.endPoint.x){if(t.startPoint.x==t.endPoint.x){var n=t;t=e,e=n}var i=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),r=t.startPoint.y-i*t.startPoint.x,o=e.startPoint.x,s=i*o+r;return t.contains(o,s)&&e.contains(o,s)}var a=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),h=t.startPoint.y-a*t.startPoint.x,l=(e.endPoint.y-e.startPoint.y)/(e.endPoint.x-e.startPoint.x),c=e.startPoint.y-l*e.startPoint.x;return a==l?h==c&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y)):(s=a*(o=(c-h)/(a-l))+h,t.contains(o,s)&&e.contains(o,s))}function i(t){return 0<t?1:t<0?-1:0}function o(t,e){return[[1,0,t],[0,1,e],[0,0,1]]}function s(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function g(t,e,n){return e=e||"type",n=n||"GroupNode",t.parent&&t.parent[e]===n?t.position[0]+g(t.parent):t.position[0]}function v(t,e,n){return e=e||"type",n=n||"GroupNode",t.parent&&t.parent[e]===n?t.position[1]+v(t.parent):t.position[1]}function a(t,e){var n=t.clipPath,i=t.getBoundingRect();n&&(i=n.getBoundingRect());var r=f.clone(i),o=[],s=-1<=r.x&&r.x<=0?Number(r.width)+2*Number(r.x):Number(r.width),a=-1<=r.y&&r.y<=0?Number(r.height)+2*Number(r.y):Number(r.height);o[0]=[-r.width/2,-r.height/2],o[1]=[r.width/2,-r.height/2],o[2]=[r.width/2,r.height/2],o[3]=[-r.width/2,r.height/2],o[4]=[-r.width/2,-r.height/2];var h=t.position[0],l=t.position[1];t.parent&&e&&("GroupNode"!==t.parent.type&&"SubProcess"!==t.parent.nodeType||(h+=g(t.parent),l+=v(t.parent)));var c=new d(-1<=r.x&&r.x<=0?Number(h):Number(h+r.x),-1<=r.y&&r.y<=0?Number(l):Number(l+r.y),Number(s),Number(a)),u=Number(h)+Number(r.width)/2+Number(r.x),p=Number(l)+Number(r.height)/2+Number(r.y);return{x:Number(u),y:Number(p),width:s,height:a,points:o,boundingRect:c}}var h={createNew:function(){var r=[];return{add:function(t,e){this.get(t).push(e)},getsimilar:function(t){var n=[],i=t.split(",");return r.forEach(function(t){var e=t.key.split(",");-1<e[0].indexOf(i[0])&&-1<e[1].indexOf(i[1])&&(n=n.concat(t.value))}),n.length<=0&&r.push({key:t,value:n}),n},get:function(t){for(var e=0;e<r.length;e++)if(t==r[e].key)return r[e].value;var n=[];return r.push({key:t,value:n}),n},keys:function(){for(var t=[],e=0;e<r.length;e++)t.push(r[e].key);return t},top:function(){return r[r.length-1]},remove:function(t){for(var e=-1,n=0;n<r.length;n++)if(t==r[n].key){e=n;break}return r.splice(e,1)[0]},removeItem:function(t,e){var n=this.get(t),i=f.indexOf(n,e);n.splice(i,1)},removeTop:function(){return r.splice(r.length-1,1)[0]},length:function(){return r.length},clear:function(){r.splice(0,r.length)}}}};function u(t){return"\\"+_[t]}var y={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},m=/(.)^/,_={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},x=/\\|'|\r|\n|\u2028|\u2029/g;function b(){}b.extend=function(t){function e(){}var n,i,r=this,o=t&&t.init?t.init:function(){r.apply(this,arguments)};for(n in e.prototype=r.prototype,i=o.fn=o.prototype=new e,t)null!=t[n]&&t[n].constructor===Object?i[n]=f.mergeAll([{},e.prototype[n],t[n]],!0):i[n]=t[n];return(i.constructor=o).extend=r.extend,o},t.exports={inherits:function(t,e){var n=t.prototype;function i(){}for(var r in i.prototype=e.prototype,t.prototype=new i,n)t.prototype[r]=n[r];(t.prototype.constructor=t).superClass=e},getUUID:function(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0,r=0;r<36;r++)8==r||13==r||18==r||23==r?n[r]="-":14==r?n[r]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19==r?3&t|8:t]);return"sid-"+n.join("")},distance:r,getPolylineLength:function(t){for(var e=0,n=0;n<t.length-1;n++)e+=r(t[n],t[n+1]);return e},max:function(t){if(0==t.lenght)return NaN;for(var e=t[0],n=0;n<t.length;n++)e<t[n]&&(e=t[n]);return e},min:function(t){if(0==t.lenght)return NaN;for(var e=t[0],n=0;n<t.length;n++)e>t[n]&&(e=t[n]);return e},isEmpty:function(t){return null==t||(f.isArrayLike(t)&&(f.isArray(t)||f.isString(t))?0===t.length:void 0)},mergeOpt:function t(e,n,i,r){if(!f.isObject(n)||!f.isObject(e))return i?f.clone(n):e;for(var o in n)if(n.hasOwnProperty(o)){var s=e[o],a=n[o];!f.isObject(a)||!f.isObject(s)||f.isArray(a)||f.isArray(s)||f.isDom(a)||f.isDom(s)||f.isBuiltInObject(a)||f.isBuiltInObject(s)||f.isPrimitive(a)||f.isPrimitive(s)?!i&&o in e||o!==r&&(e[o]=f.clone(n[o],!0)):t(s,a,i,r)}return e},orthogonalPath:function(t){if(t.length<=1)return!0;for(var e=0;e<t.length-1;e++)if(t[e].x!=t[e+1].x&&t[e].y!=t[e+1].y)return!1;return!0},polylineIntersectsRectangle:function(t,e,n){var i=[];i.push(new l(new p(e[0],e[1]),new p(e[2],e[1]))),i.push(new l(new p(e[2],e[1]),new p(e[2],e[3]))),i.push(new l(new p(e[2],e[3]),new p(e[0],e[3]))),i.push(new l(new p(e[0],e[3]),new p(e[0],e[1])));for(var r=0;r<t.length-1;r++)for(var o=new l(t[r],t[r+1]),s=0;s<i.length;s++)if(c(o,i[s]))return!0;if(n)for(var a=new l(t[t.length-1],t[0]),h=0;h<i.length;h++)if(c(a,i[h]))return!0;return!1},scorePath:function(t){if(t.length<=2)return-1;for(var e=0,n=1;n<t.length-1;n++)if(t[n-1].x==t[n].x&&t[n].x==t[n+1].x){if(i(t[n+1].y-t[n].y)!=i(t[n].y-t[n-1].y))return-1;e++}else if(t[n-1].y==t[n].y&&t[n].y==t[n+1].y){if(i(t[n+1].x-t[n].x)!=i(t[n].x-t[n-1].x))return-1;e++}else e--;return e},forwardPath:function(t){if(t.length<=2)return!0;for(var e=0;e<t.length-2;e++)if(t[e].x==t[e+1].x&&t[e+1].x==t[e+2].x){if(0!=i(t[e+1].y-t[e].y)&&i(t[e+1].y-t[e].y)==-1*i(t[e+2].y-t[e+1].y))return!1}else if(t[e].y==t[e+1].y&&t[e+1].y==t[e+2].y&&0!=i(t[e+1].x-t[e].x)&&i(t[e+1].x-t[e].x)==-1*i(t[e+2].x-t[e+1].x))return!1;return!0},traslatePoints:function(t,e){var n=[];if(e){for(var i=0;i<t.length;i++){var r=t[i];n.push(new p(r[0],r[1]))}return n}for(var o=0;o<t.length;o++){var s=t[o];n.push([s.x,s.y])}return n},getEndPoint:function(t,e,n){var i=t.clone();return i.transform(o(-t.x,-t.y)),i.y-=e,i.transform(function(t){return[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]}(n)),i.transform(o(t.x,t.y)),i},getConnectorPoints:function(t,e){e=e||{};var n=f.clone(t.boundingRect||t),h=e.rotation,l={left:new p(n.x,n.y+n.height/2),top:new p(n.x+n.width/2,n.y),right:new p(n.x+n.width,n.y+n.height/2),bottom:new p(n.x+n.width/2,n.y+n.height),center:new p(n.x+n.width/2,n.y+n.height/2)};if(0<Object.keys(e).length&&0<Math.abs(h)){var i=t.boundingRect?t:a(e),c=i.x,u=i.y;Object.keys(l).forEach(function(t){var e=l[t],n=c-e.x,i=u-e.y,r=Math.sin(-h),o=Math.cos(-h),s=c-(n*o-i*r),a=u-(n*r+i*o);l[t].x=s,l[t].y=a})}return l},getConnectorControls:function(t,e){e=e||{};var n=f.clone(t.boundingRect),h=e.rotation,l={tl:new p(n.x,n.y),tc:new p(n.x+n.width/2,n.y-4),tr:new p(n.x+n.width,n.y),bl:new p(n.x,n.y+n.height),br:new p(n.x+n.width,n.y+n.height),mtr:new p(n.x+n.width/2,n.y-20)};if(0<Object.keys(e).length&&0<Math.abs(h)){var i=t,c=i.x,u=i.y;Object.keys(l).forEach(function(t){var e=l[t],n=c-e.x,i=u-e.y,r=Math.sin(-h),o=Math.cos(-h),s=c-(n*o-i*r),a=u-(n*r+i*o);l[t].x=s,l[t].y=a})}return l},calculatePoints:function(t,e,n){var i=Array.isArray(t)?t[0]:t.x,r=Array.isArray(t)?t[1]:t.y,o=e.x-i,s=e.y-r,a=Math.sin(-n),h=Math.cos(-n),l=e.x-(o*h-s*a),c=e.y-(o*a+s*h);return Array.isArray(t)?[l,c]:{x:l,y:c}},tangentRotation:function(t,e){return-Math.PI/2-Math.atan2(e.y-t.y,e.x-t.x)},collinearity:function(t,e,n,i){var r=t.x*e.y+t.y*n.x+e.x*n.y-(e.y*n.x+t.y*e.x+t.x*n.y);return i?Math.abs(r)<=i:0==r},translationMatrix:o,scaleMatrix:function(t,e){return null==e&&(e=t),[[t,0,0],[0,e,0],[0,0,1]]},round:s,getLength:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},getAngle:function(t,e,n){t.x=s(t.x,5),t.y=s(t.y,5),e.x=s(e.x,5),e.y=s(e.y,5);var i=Math.atan((e.x-t.x)/(e.y-t.y));for(i=-i,e.x>=t.x&&e.y>=t.y?i+=Math.PI:e.x<=t.x&&e.y>=t.y?i+=Math.PI:e.x<=t.x&&e.y<=t.y&&(i+=2*Math.PI);i>=2*Math.PI;)i-=2*Math.PI;return isNaN(i)&&(i=0),n&&(i=Math.round(i/n)*n),i},getParentX:g,getParentY:v,getRect:a,StackedMap:h,getMaxLineLength:function(t){for(var e=r(t[0],t[1]),n=[t[0],t[1]],i=1;i<t.length-1;i++)e<r(t[i],t[i+1])&&(e=r(t[i],t[i+1]),n=[t[i],t[i+1]]);return n},randomColor:function(){for(var t=["0","2","3","4","5","6","7","8","9","a","b","c","d"],e="#",n=0;n<6;n++)e+=t[Math.round(15*Math.random())];return e},template:function(o,t,e){!t&&e&&(t=e),t=t||{},t=f.defaults(t,y,!0);var n=RegExp([(t.escape||m).source,(t.interpolate||m).source,(t.evaluate||m).source].join("|")+"|$","g"),s=0,a="__p+='";o.replace(n,function(t,e,n,i,r){return a+=o.slice(s,r).replace(x,u),s=r+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var i=new Function(t.variable||"obj",a)}catch(t){throw t.source=a,t}function r(t){return i.call(this,t)}var h=t.variable||"obj";return r.source="function("+h+"){\n"+a+"}",r},isUndefined:function(t){return void 0===t},getSoltPoints:function(t){return[[10*Math.round(t.getRect().width/3/10),0],[10*Math.round(2*t.getRect().width/3/10),0],[t.getRect().width,10*Math.round(t.getRect().height/3/10)],[t.getRect().width,10*Math.round(2*t.getRect().height/3/10)],[10*Math.round(t.getRect().width/3/10),t.getRect().height],[10*Math.round(2*t.getRect().width/3/10),t.getRect().height],[0,10*Math.round(t.getRect().height/3/10)],[0,10*Math.round(2*t.getRect().height/3/10)]]},collinearReduction:function(t){var e=[];if(t.length<3)return p.cloneArray(t);e.push(t[0].clone());for(var n=1;n<t.length-1;n++)t[n-1].x==t[n].x&&t[n].x==t[n+1].x||t[n-1].y==t[n].y&&t[n].y==t[n+1].y||e.push(t[n].clone());return e.push(t[t.length-1].clone()),e},Class:b}},function(t,e){function n(t,e){this.startPoint=t,this.endPoint=e,this.oType="Line"}n.load=function(t){return new n(Point.load(t.startPoint),Point.load(t.endPoint))},n.prototype={contructor:n,clone:function(){return new n(this.startPoint.clone(),this.endPoint.clone())},equals:function(t){return!(!t instanceof n)&&(this.startPoint.equals(t.startPoint)&&this.endPoint.equals(t.endPoint))},contains:function(t,e){if(Math.min(this.startPoint.x,this.endPoint.x)<=t&&t<=Math.max(this.startPoint.x,this.endPoint.x)&&Math.min(this.startPoint.y,this.endPoint.y)<=e&&e<=Math.max(this.startPoint.y,this.endPoint.y)){if(this.startPoint.x==this.endPoint.x)return t==this.startPoint.x;var n=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x);return e==n*t+(this.startPoint.y-n*this.startPoint.x)}return!1},near:function(t,e,n){if(this.endPoint.x===this.startPoint.x)return(this.startPoint.y-n<=e&&this.endPoint.y+n>=e||this.endPoint.y-n<=e&&this.startPoint.y+n>=e)&&t>this.startPoint.x-n&&t<this.startPoint.x+n;if(this.startPoint.y===this.endPoint.y)return(this.startPoint.x-n<=t&&this.endPoint.x+n>=t||this.endPoint.x-n<=t&&this.startPoint.x+n>=t)&&e>this.startPoint.y-n&&e<this.startPoint.y+n;var i=Math.min(this.endPoint.x,this.startPoint.x),r=Math.min(this.endPoint.y,this.startPoint.y),o=Math.max(this.endPoint.x,this.startPoint.x),s=Math.max(this.endPoint.y,this.startPoint.y),a=this.endPoint.y-this.startPoint.y,h=this.startPoint.x-this.endPoint.x,l=-(this.startPoint.x*this.endPoint.y-this.endPoint.x*this.startPoint.y),c=Math.abs((a*t+h*e+l)/Math.sqrt(Math.pow(a,2)+Math.pow(h,2))),u=(h*(h*t-a*e)-a*l)/(Math.pow(a,2)+Math.pow(h,2)),p=(a*(-h*t+a*e)-h*l)/(Math.pow(a,2)+Math.pow(h,2));return c<=n&&u<=o&&i<=u&&p<=s&&r<=p||this.startPoint.near(t,e,n)||this.endPoint.near(t,e,n)},getPoints:function(){var t=[];return t.push(this.startPoint),t.push(this.endPoint),t},getPoint:function(t){var e=t*(this.endPoint.x-this.startPoint.x)+this.startPoint.x,n=t*(this.endPoint.y-this.startPoint.y)+this.startPoint.y;return new Point(e,n)},toString:function(){return"line("+this.startPoint+","+this.endPoint+")"}},t.exports=n},function(t,e,n){var r=n(80),o=n(4),i=(n(3),n(81));function s(t,e){r.call(this),this.model=t,this.options={outline:{enable:!0,radius:!0,initVisible:!1},text:{color:"#000000",lineHeight:24}},this.bpmnInfo={type:-1,name:"BPMNDiagram",displayName:"Task"};var n=t.get("resourceId");n&&""!=n&&(this.resourceId=n);var i=t.get("properties");i.operationIcons&&(this.operationIcons=i.operationIcons),this.initEvent(e)}s.prototype.initEvent=function(i){var r=this;o.each(["dblclick","click"],function(n){r.on(n,function(t){var e={};e.event=t,e.type=n,e.target=r,i.trigger(n,e)},this)})},s.prototype.getRect=function(){},s.prototype.getBoundingRect=function(){},s.prototype.setPosition=function(t,e){},s.prototype.rectContain=function(t,e){return this.getRect().boundingRect.contain(t,e)},s.prototype.toJSON=function(){if(this.model.set("resourceId",this.resourceId),this.model.set("properties.type",this.bpmnInfo.type),this.model.set("stencil.type",this.bpmnInfo.name),this.slotEvent&&0<this.slotEvent.length){for(var t=[],e=this.slotEvent.length-1;0<=e;e--)t.push(this.slotEvent[e].resourceId);this.model.set("properties.slotEvent",t)}this.model.set("properties.type",this.bpmnInfo.type);var n=this.getRect().boundingRect;return this.model.set("bounds.upperLeft.x",parseInt(n.x)),this.model.set("bounds.upperLeft.y",parseInt(n.y)),this.model.set("bounds.lowerRight.x",parseInt(n.x+n.width)),this.model.set("bounds.lowerRight.y",parseInt(n.y+n.height)),this.model.option},s.prototype.setModel=function(t){var e,n=this.model.get("properties.name");if(this.model.mergeOption(t),(t.properties.name||""==t.properties.name||"0"==t.properties.name)&&n!=t.properties.name){var i,r=this.childOfName("Title");if(15<function(t){var e=encodeURIComponent(t).match(/%[89ABab]/g);return t.length+(e?e.length:0)}(t.properties.name)?(i=t.properties.name.substr(0,6)+"..",this.alarm&&(this.alarm.isShow=!0)):(i=t.properties.name,this.alarm&&(this.alarm.isShow=!1)),r.attr("style",{text:i}),e=t.properties.position?t.properties.position:"init",this.refreshText(e),this.alarm){var o=t.properties.name,s=this.alarm.childOfName("Text");s.attr("style",{text:o});var a=s.getBoundingRect().width+4,h=s.getBoundingRect().height+8,l=[[0,0],[a,0],[a,h],[a-3,h],[a-6,h+3],[a-9,h],[0,h],[0,0]];this.alarm.childOfName("Polyline").attr("shape",{points:l});var c=function t(e){return e.parent&&"SubProcess"==e.parent.nodeType?e.position[0]+t(e.parent):e.position[0]}(this),u=function t(e){return e.parent&&"SubProcess"==e.parent.nodeType?e.position[1]+t(e.parent):e.position[1]}(this),p=[c+this.getBoundingRect().width-(this.alarm.getBoundingRect().width-6),u-this.alarm.getBoundingRect().height-3];this.alarm.attr("position",p)}}},o.inherits(s,r),i.enableClassManagement(s,{registerWhenExtend:!0}),t.exports=s},function(t,e,n){var a=n(3),i=n(77);function r(){this.resourceId=i.getUUID(),a.Group.call(this)}r.prototype.render=function(){},r.prototype.getRect=function(t){},r.prototype.drawText=function(t,e,n){var i,r,o=this.bpmnInfo.name;null!=t&&(o=t);var s=new a.Text({style:{text:o,color:e||this.options.text.color,textFont:"12px Microsoft YaHei"},zlevel:20});switch(n=n||"init"){case"init":i=this.getRect().x-this.position[0]-s.getBoundingRect().width/2,r=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":i=this.getRect().x-this.position[0]-s.getBoundingRect().width/2,r=this.getRect().y-this.position[1]-6;break;case"left":i=this.getRect().x-this.position[0]-s.getBoundingRect().width+6,r=this.getRect().y-this.position[1]-6}return s.attr("style",{x:i,y:r}),{text:s,rect:s.getBoundingRect()}},r.prototype.refreshText=function(t){var e,n,i=this.childOfName("Title");switch(t=t||"init"){case"init":e=this.getRect().x-this.position[0]-i.getBoundingRect().width/2,n=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":e=this.getRect().x-this.position[0]-i.getBoundingRect().width/2,n=this.getRect().y-this.position[1]-6;break;case"left":e=2,n=this.getRect().y-this.position[1]-6}i.attr("style",{x:e,y:n})},r.prototype.toJSON=function(){},a.Util.inherits(r,a.Group),t.exports=r},function(t,e,n){var o=n(4),i={},s="___FT__COMPONENT__CONTAINER___",a=i.parseClassType=function(t){var e={main:"",sub:""};return t&&(t=t.split("."),e.main=t[0]||"",e.sub=t[1]||""),e};function r(t,e){var n=o.slice(arguments,2);return this.superClass.prototype[e].apply(t,n)}function h(t,e,n){return this.superClass.prototype[e].apply(t,n)}i.enableClassExtend=function(n,i){n.extend=function(t){function e(){i&&i.apply(this,arguments),n.apply(this,arguments)}return o.extend(e.prototype,t),e.extend=this.extend,e.superCall=r,e.superApply=h,o.inherits(e,this),e.superClass=this,e}},i.enableClassManagement=function(n,t){t=t||{};var r={};if(n.registerClass=function(t,e){if(e)if((e=a(e)).sub){if(e.sub!==s){(function(t){var e=r[t.main];e&&e[s]||((e=r[t.main]={})[s]=!0);return e})(e)[e.sub]=t}}else{if(r[e.main])return;r[e.main]=t}return t},n.getClass=function(t,e,n){var i=r[t];if(i&&i[s]&&(i=e?i[e]:null),n&&!i)throw new Error("Component "+t+"."+(e||"")+" not exists. Load it first.");return i},n.getClassesByMainType=function(t){t=a(t);var n=[],e=r[t.main];return e&&e[s]?o.each(e,function(t,e){e!==s&&n.push(t)}):n.push(e),n},n.hasClass=function(t){return t=a(t),!!r[t.main]},n.getAllClassMainTypes=function(){var n=[];return o.each(r,function(t,e){n.push(e)}),n},n.hasSubTypes=function(t){t=a(t);var e=r[t.main];return e&&e[s]},n.parseClassType=a,t.registerWhenExtend){var i=n.extend;i&&(n.extend=function(t){var e=i.call(this,t);return n.registerClass(e,t.type)})}return n},t.exports=i},function(t,e,n){var i=n(83).extend({type:"BPMN",defaultOption:{resourceId:"",properties:{type:-1,name:null,notes:"",extProperties:{}},stencil:{type:"BPMNDiagram"},childShapes:[],outgoing:[],bounds:{upperLeft:{x:0,y:0},lowerRight:{x:0,y:0}}}});t.exports=i},function(t,e,n){var o=n(4),i=n(81);function r(t,e,n){this.parentModel=e,this.option=t,this.init&&(arguments.length<=3?this.init(t,e,n):this.init.apply(this,arguments))}r.prototype={constructor:r,init:function(t){o.merge(t,this.getDefaultOption())},getDefaultOption:function(){if(!this.hasOwnProperty("__defaultOption")){for(var t=[],e=this.constructor;e;){var n=e.prototype.defaultOption;n&&t.push(n),e=e.superClass}for(var i={},r=t.length-1;0<=r;r--)i=o.merge(i,t[r],!0);this.__defaultOption=i}return this.__defaultOption},mergeOption:function(t){o.merge(this.option,t,!0)},get:function(t,e){if(!t)return this.option;"string"==typeof t&&(t=t.split("."));for(var n=this.option,i=this.parentModel,r=0;r<t.length&&null!=(n=n&&"object"==typeof n?n[t[r]]:null);r++);return null==n&&i&&!e&&(n=i.get(t)),n},set:function(t,e){var n=this.option;if(-1==t.indexOf("."))n[t]=e;else{for(var i,r=t.split("."),o=r.length,s=n,a=0;a<o-1;a++)null==s[i=r[a]]&&(s[i]={}),s=s[i];s[i=r[o-1]]=e}},getShallow:function(t,e){var n=this.option,i=n&&n[t],r=this.parentModel;return null==i&&r&&!e&&(i=r.getShallow(t)),i},getModel:function(t,e){var n=this.get(t,!0),i=this.parentModel;return new r(n,e||i&&i.getModel(t))},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){return new this.constructor(o.clone(this.option))}},i.enableClassExtend(r),t.exports=r},function(t,e,n){var i=n(85),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.itemSize=20,this.model=t,this.bpmnInfo={type:29,name:"StartNoneEvent"},this.render(t)}s.prototype.render=function(t){var e=new o.Circle({shape:{cx:0,cy:0,r:this.itemSize},style:{fill:"#000"},z:2});e.name="Circle",this.add(e);var n=new o.Circle({shape:{cx:0,cy:0,r:this.itemSize-2},style:{fill:"#fff"},z:2});n.name="Circle1",this.add(n),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var i=this.drawText(t.get("properties.name"));i.text.name="Title",this.add(i.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(79),r=n(4),o=n(26);function s(t,e){i.call(this,t,e),this.bpmnInfo={type:-1,name:"EventNode"},this.model=t}s.prototype.render=function(){},s.prototype.getRect=function(){var t=this.getBoundingRect(),e=r.clone(t);e.x=parseInt(e.x,10),e.y=parseInt(e.y,10),e.width=parseInt(e.width,10),e.height=parseInt(e.height,10);var n=[];n[0]=[-e.width/2,-e.height/2],n[1]=[e.width/2,-e.height/2],n[2]=[e.width/2,e.height/2],n[3]=[-e.width/2,e.height/2],n[4]=[-e.width/2,-e.height/2];var i=new o(this.position[0]-e.width/2,this.position[1]-e.height/2,e.width,e.height);return{x:this.position[0],y:this.position[1],width:e.width,height:e.height,points:n,boundingRect:i}},s.prototype.setPosition=function(t,e){this.attr("position",[t,e])},s.prototype.getBoundingRect=function(){return this.childOfName("Circle").getBoundingRect()},s.prototype.updateShape=function(t,e){var n=this.childOfName("Circle"),i=this.childOfName("Circle1"),r=Number(t),o=n.shape,s=i.shape,a=Number(o.r*r),h=Number(s.r*r);e&&(a=parseInt(a,10),h=parseInt(h,10)),n.setShape({r:a}),i.setShape({r:h})},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(85),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.itemSize=20,this.model=t,this.bpmnInfo={type:31,name:"EndNoneEvent"},this.render(t)}s.prototype.render=function(t){var e=new o.Circle({shape:{cx:0,cy:0,r:this.itemSize},style:{fill:"#000"},z:2});e.name="Circle",this.add(e);var n=new o.Circle({shape:{cx:0,cy:0,r:this.itemSize-5},style:{fill:"#fff"},z:2});n.name="Circle1",this.add(n),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var i=this.drawText(t.get("properties.name"));i.text.name="Title",this.add(i.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(88),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M765.573741 718.489888c-14.999622-112.659873-119.671567-196.438974-237.776452-196.438974-118.912273 0-220.514299 85.277222-238.20317 198.770066-11.840676 76.071559 54.585199 71.326489 54.585199 71.326489l360.734878 0C704.913173 792.148491 776.608052 801.364387 765.573741 718.489888zM690.249195 365.718379c0 89.911776-72.889077 162.810063-162.79676 162.810063-89.908706 0-162.797783-72.898287-162.797783-162.810063 0-89.916892 72.889077-162.80597 162.797783-162.80597C617.360118 202.912409 690.249195 275.801487 690.249195 365.718379z",this.bpmnInfo={type:0,name:"UserTask"},this.render(t)}s.prototype.render=function(t){var e=new o.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);var n=o.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},{x:5,y:5,width:15,height:15});this.add(n),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var i=this.drawText(t.get("properties.name"),"","center");i.text.name="Title",this.add(i.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(79),r=n(4),o=n(26);function s(t,e){i.call(this,t,e),this.bpmnInfo={type:-1,name:"TaskNode"},this.model=t,this.slot=[],this.slotEvent=[],this.isCanSlot=!0}s.prototype.render=function(){},s.prototype.getRect=function(){var t=this.getBoundingRect(),e=r.clone(t);e.x=parseInt(e.x,10),e.y=parseInt(e.y,10),e.width=parseInt(e.width,10),e.height=parseInt(e.height,10);var n=[];n[0]=[-e.width/2,-e.height/2],n[1]=[e.width/2,-e.height/2],n[2]=[e.width/2,e.height/2],n[3]=[-e.width/2,e.height/2],n[4]=[-e.width/2,-e.height/2];var i=new o(this.position[0],this.position[1],e.width,e.height);return{x:this.position[0]+e.width/2,y:this.position[1]+e.height/2,width:e.width,height:e.height,points:n,boundingRect:i}},s.prototype.getBoundingRect=function(){return this.childOfName("Rect").getBoundingRect()},s.prototype.setPosition=function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},s.prototype.updateShape=function(t,e){var n=this.childOfName("Rect"),i=Number(t),r=n.shape,o=Number(r.width*i),s=Number(o*r.height/r.width);e&&(o=parseInt(o,10),s=parseInt(s,10)),n.setShape({width:o,height:s}),this.refreshText()},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(88),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="m 17,9.3290326 c -0.0069,0.5512461 -0.455166,1.0455894 -0.940778,1.0376604 l -5.792746,0 c 0.0053,0.119381 0.0026,0.237107 0.0061,0.355965 l 5.154918,0 c 0.482032,-0.0096 0.925529,0.49051 0.919525,1.037574 -0.0078,0.537128 -0.446283,1.017531 -0.919521,1.007683 l -5.245273,0 c -0.01507,0.104484 -0.03389,0.204081 -0.05316,0.301591 l 2.630175,0 c 0.454137,-0.0096 0.872112,0.461754 0.866386,0.977186 C 13.619526,14.554106 13.206293,15.009498 12.75924,15 L 3.7753054,15 C 3.6045812,15 3.433552,14.94423 3.2916363,14.837136 c -0.00174,0 -0.00436,0 -0.00609,0 C 1.7212035,14.367801 0.99998255,11.458641 1,11.458641 L 1,7.4588393 c 0,0 0.6623144,-1.316333 1.8390583,-2.0872584 1.1767614,-0.7711868 6.8053358,-2.40497 7.2587847,-2.8052901 0.453484,-0.40032 1.660213,1.4859942 0.04775,2.4010487 C 8.5332315,5.882394 8.507351,5.7996113 8.4370292,5.7936859 l 6.3569748,-0.00871 c 0.497046,-0.00958 0.952273,0.5097676 0.94612,1.0738232 -0.0053,0.556126 -0.456176,1.0566566 -0.94612,1.0496854 l -4.72435,0 c 0.01307,0.1149374 0.0244,0.2281319 0.03721,0.3498661 l 5.952195,0 c 0.494517,-0.00871 0.947906,0.5066305 0.940795,1.0679848 z",this.bpmnInfo={type:4,name:"ManualTask"},this.render(t)}s.prototype.render=function(t){var e=new o.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);this.add(o.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},{x:5,y:5,width:15,height:15})),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var n=this.drawText(t.get("properties.name"),"","center");n.text.name="Title",this.add(n.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(88),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="m 5,2 0,0.094 c 0.23706,0.064 0.53189,0.1645 0.8125,0.375 0.5582,0.4186 1.05109,1.228 1.15625,2.5312 l 8.03125,0 1,0 1,0 c 0,-3 -2,-3 -2,-3 l -10,0 z M 4,3 4,13 2,13 c 0,3 2,3 2,3 l 9,0 c 0,0 2,0 2,-3 L 15,6 6,6 6,5.5 C 6,4.1111 5.5595,3.529 5.1875,3.25 4.8155,2.971 4.5,3 4.5,3 L 4,3 z",this.bpmnInfo={type:7,name:"ScriptTask"},this.render(t)}s.prototype.render=function(t){var e=new o.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);this.add(o.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},{x:5,y:5,width:15,height:15})),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var n=this.drawText(t.get("properties.name"),"","center");n.text.name="Title",this.add(n.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(88),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M49.013,51.003c1.847,1.303,7.414,5.174,16.702,11.61S82.118,74.005,87.061,77.48c0.543,0.381,1.697,1.209,3.462,2.485c1.765,1.277,3.232,2.31,4.399,3.097c1.168,0.787,2.58,1.67,4.237,2.647c1.657,0.977,3.219,1.711,4.685,2.198c1.467,0.49,2.825,0.733,4.074,0.733H108h0.082c1.249,0,2.607-0.243,4.074-0.733c1.466-0.487,3.029-1.222,4.685-2.198c1.656-0.978,3.068-1.86,4.236-2.647s2.634-1.82,4.399-3.097s2.92-2.104,3.463-2.485c4.996-3.476,17.707-12.302,38.129-26.479c3.965-2.769,7.277-6.11,9.939-10.021C179.67,37.071,181,32.97,181,28.679c0-3.585-1.291-6.654-3.871-9.207c-2.58-2.553-5.636-3.829-9.165-3.829H48.035c-4.182,0-7.4,1.412-9.654,4.236C36.127,22.704,35,26.235,35,30.471c0,3.422,1.494,7.13,4.481,11.122S45.646,48.722,49.013,51.003z M172.852,59.72c-17.814,12.057-31.34,21.427-40.572,28.108c-3.096,2.281-5.608,4.061-7.537,5.336c-1.928,1.277-4.494,2.58-7.699,3.911c-3.204,1.331-6.191,1.996-8.961,1.996H108h-0.082c-2.77,0-5.758-0.665-8.962-1.996s-5.771-2.634-7.699-3.911c-1.928-1.275-4.44-3.055-7.536-5.336c-7.333-5.377-20.83-14.747-40.492-28.108c-3.096-2.063-5.839-4.427-8.229-7.088v64.688c0,3.586,1.276,6.654,3.829,9.207c2.553,2.554,5.622,3.83,9.207,3.83h119.929c3.584,0,6.653-1.276,9.206-3.83c2.554-2.554,3.829-5.621,3.829-9.207V52.632C178.664,55.238,175.949,57.602,172.852,59.72z",this.bpmnInfo={type:8,name:"MailTask"},this.render(t)}s.prototype.render=function(t){var e=new o.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);this.add(o.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},{x:5,y:5,width:15,height:15})),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var n=this.drawText(t.get("properties.name"),"","center");n.text.name="Title",this.add(n.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(88),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M891.84 410.072c-8.936-33.48-22.192-65.232-39.192-94.584l74.512-112.4-106.272-106.184-112.344 74.456c-29.384-16.944-61.144-30.256-94.648-39.2L587.08 0l-150.16 0-26.816 132.16c-33.504 8.944-65.264 22.256-94.648 39.2l-112.4-74.456L96.832 203.08l74.52 112.4c-17 29.352-30.256 61.112-39.2 94.648L0 436.888l0 150.192 132.16 26.824c8.944 33.504 22.192 65.264 39.2 94.648l-74.52 112.408 106.216 106.152 112.4-74.456c29.384 16.936 61.144 30.256 94.648 39.192L436.92 1024l150.16 0 26.824-132.16c33.504-8.936 65.264-22.256 94.648-39.192l112.344 74.456 106.272-106.152-74.512-112.408c17-29.384 30.256-61.144 39.192-94.648L1024 587.08 1024 436.888 891.84 410.072 891.84 410.072zM689.8 512c0 98.152-79.584 177.8-177.8 177.8S334.208 610.152 334.208 512c0-98.176 79.584-177.792 177.792-177.792S689.8 413.824 689.8 512z",this.bpmnInfo={type:12,name:"ServiceTask"},this.render(t)}s.prototype.render=function(t){var e=new o.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);this.add(o.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},{x:5,y:5,width:15,height:15})),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var n=this.drawText(t.get("properties.name"),"","center");n.text.name="Title",this.add(n.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(88),r=n(4),o=n(3);function s(t,e){i.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M959.907775 439.894775c0 195.140399-200.607924 352.909655-447.964568 352.909655-21.76163 0-43.083238-1.203408-64.080457-3.499707-41.555441-4.701069-109.897969 121.601522-300.828486 147.517775 100.164281-117.992321 106.727767-206.485795 74.250074-228.301659C125.053646 643.782396 64.091202 547.553751 64.091202 439.894775c0-194.757682 200.607924-352.717274 447.852004-352.717274C759.299851 87.177502 959.907775 245.13607 959.907775 439.894775z",this.bpmnInfo={type:11,name:"SmsTask"},this.render(t)}s.prototype.render=function(t){var e=new o.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);this.add(o.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},{x:5,y:5,width:15,height:15})),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var n=this.drawText(t.get("properties.name"),"","center");n.text.name="Title",this.add(n.text)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(79),o=n(4),s=n(26),a=n(3);function r(t,e){i.call(this,t,e),this.bpmnInfo={type:21,name:"Comment"},this.model=t,this.render(t)}r.prototype.render=function(t){var e=new a.Rect({shape:{x:0,y:0,width:100,height:40},style:{opacity:0},z:2});e.name="Rect",this.add(e);var n=new a.Line({shape:{x1:0,y1:0,x2:10,y2:0},style:{lineWidth:1,stroke:"#000"}});this.add(n);var i=new a.Line({shape:{x1:0,y1:0,x2:0,y2:40},style:{lineWidth:1,stroke:"#000"}});this.add(i);var r=new a.Line({shape:{x1:0,y1:40,x2:10,y2:40},style:{lineWidth:1,stroke:"#000"}});this.add(r),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var o=this.drawText(t.get("properties.name"),"","left");o.text.name="Title",this.add(o.text)},r.prototype.getRect=function(t){var e=this.getBoundingRect(),n=o.clone(e);n.x=parseInt(n.x,10),n.y=parseInt(n.y,10),n.width=parseInt(n.width,10),n.height=parseInt(n.height,10);var i=[];i[0]=[-n.width/2,-n.height/2],i[1]=[n.width/2,-n.height/2],i[2]=[n.width/2,n.height/2],i[3]=[-n.width/2,n.height/2],i[4]=[-n.width/2,-n.height/2];var r=new s(this.position[0],this.position[1],n.width,n.height);return{x:this.position[0]+n.width/2,y:this.position[1]+n.height/2,width:n.width,height:n.height,points:i,boundingRect:r}},r.prototype.setPosition=function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},r.prototype.getBoundingRect=function(){return this.childOfName("Rect").getBoundingRect()},r.prototype.updateShape=function(t,e){var n=this.childOfName("Rect"),i=Number(t),r=n.shape,o=Number(r.width*i),s=Number(o*r.height/r.width);e&&(o=parseInt(o,10),s=parseInt(s,10)),n.setShape({width:o,height:s})},o.inherits(r,i),t.exports=r},function(t,e,n){var i=n(85),r=n(4),s=n(3);function o(t,e){i.call(this,t,e),this.startIcon="M 10 0 C 4.4771525 0 0 4.4771525 0 10 C 0 15.522847 4.4771525 20 10 20 C 15.522847 20 20 15.522847 20 10 C 20 4.4771525 15.522847 1.1842379e-15 10 0 z M 9.09375 1.03125 C 9.2292164 1.0174926 9.362825 1.0389311 9.5 1.03125 L 9.5 3.5 L 10.5 3.5 L 10.5 1.03125 C 15.063526 1.2867831 18.713217 4.9364738 18.96875 9.5 L 16.5 9.5 L 16.5 10.5 L 18.96875 10.5 C 18.713217 15.063526 15.063526 18.713217 10.5 18.96875 L 10.5 16.5 L 9.5 16.5 L 9.5 18.96875 C 4.9364738 18.713217 1.2867831 15.063526 1.03125 10.5 L 3.5 10.5 L 3.5 9.5 L 1.03125 9.5 C 1.279102 5.0736488 4.7225326 1.4751713 9.09375 1.03125 z M 9.5 5 L 9.5 8.0625 C 8.6373007 8.2844627 8 9.0680195 8 10 C 8 11.104569 8.8954305 12 10 12 C 10.931981 12 11.715537 11.362699 11.9375 10.5 L 14 10.5 L 14 9.5 L 11.9375 9.5 C 11.756642 8.7970599 11.20294 8.2433585 10.5 8.0625 L 10.5 5 L 9.5 5 z",this.itemSize=10,this.bpmnInfo={type:43,name:"CatchTimerEvent"},this.render(t)}o.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#ffffff",stroke:"#000"},z:3});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:3});n.name="Circle1",this.add(n);var i=this.itemSize+6,r={x:-i/2,y:-i/2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#000"},z:3},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text),this.z=3},r.inherits(o,i),t.exports=o},function(t,e,n){var i=n(85),r=n(4),s=n(3);function o(t,e){i.call(this,t,e),this.startIcon="M7.7124971 20.247342  L22.333334 20.247342  L15.022915000000001 7.575951200000001  L7.7124971 20.247342  z",this.itemSize=10,this.bpmnInfo={type:72,name:"CatchSignalEvent"},this.render(t)}o.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#ffffff",stroke:"#000"},z:3});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:3});n.name="Circle1",this.add(n);var i=this.itemSize,r={x:-i/2,y:-i/2-2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#000",fill:"#ffffff"},z:3},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text),this.z=3},r.inherits(o,i),t.exports=o},function(t,e,n){var i=n(85),r=n(4),s=n(3);function o(t,e){i.call(this,t,e),this.startIcon="M7.7124971 20.247342  L22.333334 20.247342  L15.022915000000001 7.575951200000001  L7.7124971 20.247342  z",this.itemSize=10,this.bpmnInfo={type:75,name:"ThrowSignalEvent"},this.render(t)}o.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#ffffff",stroke:"#000"},z:3});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:3});n.name="Circle1",this.add(n);var i=this.itemSize,r={x:-i/2,y:-i/2-2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#000",fill:"#000000"},z:3},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text),this.z=3},r.inherits(o,i),t.exports=o},function(t,e,n){var i=n(85),r=n(4),s=n(3);function o(t,e){i.call(this,t,e),this.startIcon="M664.356571 633.344l-50.797714 0 228.827429 146.980571L181.613714 780.324571l228.827429-146.980571-50.834286 0-203.190857 130.450286L156.416 359.094857l359.021714 242.578286 352.146286-235.300571 0 397.458286L664.356571 633.344zM156.416 299.922286 156.416 243.675429l711.168 0 0 71.314286-351.378286 222.171429L156.416 299.922286z",this.itemSize=20,this.bpmnInfo={type:100,name:"CatchMessageEvent"},this.render(t)}o.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize},style:{fill:"#ffffff",stroke:"#000"},z:2});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:2});n.name="Circle1",this.add(n);var i=this.itemSize,r={x:-i/2,y:-i/2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#fff"},z:2},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text)},r.inherits(o,i),t.exports=o},function(t,e,n){var i=n(100),r=n(4),a=n(3);function o(t,e){i.call(this,t,e),this.startIcon="M0 19.506393964  L19.506393964 0  L39.012787964 19.506393964  L19.506393964 39.012787964  L0 19.506393964  L0 19.506393964  z",this.nextIcon="M507.7383 49.463867C327.38957 48.865055 154.337045 165.397235 85.887695 332.095705 13.82828 497.171875 51.26921 702.2376 177.31836 830.98145 298.5502 961.4774 498.29297 1009.3747 665.5781 948.3174 838.948 889.28065 966.9399 719.02055 973.89745 535.7715 985.56715 355.706145 879.6298 176.060825 717.4209 97.625 653.90365 65.927975 582.97465 49.398509 512 49.5 510.57905 49.480728 509.15835 49.468582 507.7383 49.463867zM520.41405 99.450195C696.9503 100.419315 863.2164 228.12953 908.87305 398.964845 957.3881 562.41865 891.7662 751.6676 750.9199 848.47755 604.61365 956.01475 387.64963 948.23445 249.48828 830.3994 110.28125 719.40945 60.452365 514.11165 131.875 351.308595 193.77873 200.80243 349.16891 97.58941 512 99.5 514.8069 99.451185 517.6119 99.43481 520.41405 99.450195z",this.itemSize=20,this.bpmnInfo={type:20,name:"InclusiveGateway"},this.render(t)}o.prototype.render=function(t){var e=2*this.itemSize,n={x:-e/2,y:-e/2,width:e,height:e},i=a.makePath(this.startIcon,{style:{stroke:"#000",fill:"#fff"},z:2},n,"center");i.name="Path",this.add(i);var r=this.itemSize,o={x:-r/2,y:-r/2,width:r,height:r};this.add(a.makePath(this.nextIcon,{style:{stroke:"#000"},z:2},o,"center")),this.position=[t.get("bounds.upperLeft.x")+r,t.get("bounds.upperLeft.y")+r];var s=this.drawText(t.get("properties.name"));s.text.name="Title",this.add(s.text)},r.inherits(o,i),t.exports=o},function(t,e,n){var i=n(79),h=n(3),r=n(4),o=n(26);function s(t,e){i.call(this,t,e),this.bpmnInfo={type:-1,name:"GatewayNode"},this.model=t}s.prototype.render=function(){},s.prototype.getRect=function(){var t=this.getBoundingRect(),e=r.clone(t);e.x=parseInt(e.x,10),e.y=parseInt(e.y,10),e.width=parseInt(e.width,10),e.height=parseInt(e.height,10);var n=[];n[0]=[-e.width/2,-e.height/2],n[1]=[e.width/2,-e.height/2],n[2]=[e.width/2,e.height/2],n[3]=[-e.width/2,e.height/2],n[4]=[-e.width/2,-e.height/2];var i=new o(this.position[0]-e.width/2,this.position[1]-e.height/2,e.width,e.height);return{x:this.position[0],y:this.position[1],width:e.width,height:e.height,points:n,boundingRect:i}},s.prototype.setPosition=function(t,e){this.attr("position",[t,e])},s.prototype.getBoundingRect=function(){return this.childOfName("Path").getBoundingRect()},s.prototype.updateShape=function(t,e){var n=Number(t),i=this.getBoundingRect(),r=this.childOfName("Path"),o=i.width*n,s=i.height*n;e&&(o=parseInt(o,10),s=parseInt(s,10));var a={x:-o/2,y:-s/2,width:o,height:s};h.resizePath(r,a)},r.inherits(s,i),t.exports=s},function(t,e,n){var i=n(100),r=n(4),a=n(3);function o(t,e){i.call(this,t,e),this.startIcon="M0 19.506393964  L19.506393964 0  L39.012787964 19.506393964  L19.506393964 39.012787964  L0 19.506393964  L0 19.506393964  z",this.nextIcon="M19.904129064000003 17.676993964000005  L24.997457864000005 12.583664864000003  L26.058118064000006 11.523004664000002  L28.179438464 13.644324964000003  L27.118778264 14.704985164000002  L22.025449364000004 19.798314364  L27.118778264 24.891643464000005  L28.179438464 25.952303664000006  L26.058118064000006 28.073623964000003  L24.997457864000005 27.012963764000006  L19.904129064000003 21.919634764  L14.810800164000003 27.012963764000006  L13.750140064000002 28.073623964000003  L11.628819664000003 25.952303664000006  L12.689479764000003 24.891643464000005  L17.782808764000002 19.798314364  L12.689479764000003 14.704985164000002  L11.628819664000003 13.644324964000003  L13.750140064000002 11.523004664000002  L14.810800164000003 12.583664864000003  L19.904129064000003 17.676993964000005  z",this.itemSize=20,this.bpmnInfo={type:17,name:"ExclusiveGateway"},this.render(t)}o.prototype.render=function(t){var e=2*this.itemSize,n={x:-e/2,y:-e/2,width:e,height:e},i=a.makePath(this.startIcon,{style:{stroke:"#000",fill:"#fff"},z:2},n,"center");i.name="Path",this.add(i);var r=this.itemSize,o={x:-r/2,y:-r/2,width:r,height:r};this.add(a.makePath(this.nextIcon,{style:{stroke:"#000"},z:2},o,"center")),this.position=[t.get("bounds.upperLeft.x")+r,t.get("bounds.upperLeft.y")+r];var s=this.drawText(t.get("properties.name"));s.text.name="Title",this.add(s.text)},r.inherits(o,i),t.exports=o},function(t,e,n){var i=n(100),r=n(4),a=n(3);function o(t,e){i.call(this,t,e),this.startIcon="M0 19.506393964  L19.506393964 0  L39.012787964 19.506393964  L19.506393964 39.012787964  L0 19.506393964  L0 19.506393964  z",this.nextIcon="M8.275862069 11.965517269000001  L1.499999999 11.965517269000001  L0 11.965517269000001  L0 8.965517239  L1.499999999 8.965517239  L8.275862069 8.965517239  L8.275862069 1.499999999  L8.275862069 0  L11.275862069 0  L11.275862069 1.499999999  L11.275862069 8.965517239  L18.741379269 8.965517239  L20.241379269 8.965517239  L20.241379269 11.965517269000001  L18.741379269 11.965517269000001  L11.275862069 11.965517269000001  L11.275862069 18.741379269  L11.275862069 20.241379269  L8.275862069 20.241379269  L8.275862069 18.741379269  L8.275862069 11.965517269000001  z",this.itemSize=20,this.bpmnInfo={type:20,name:"ParallelGateway"},this.render(t)}o.prototype.render=function(t){var e=2*this.itemSize,n={x:-e/2,y:-e/2,width:e,height:e},i=a.makePath(this.startIcon,{style:{stroke:"#000",fill:"#fff"},z:2},n,"center");i.name="Path",this.add(i);var r=this.itemSize,o={x:-r/2,y:-r/2,width:r,height:r};this.add(a.makePath(this.nextIcon,{style:{stroke:"#000"},z:2},o,"center")),this.position=[t.get("bounds.upperLeft.x")+r,t.get("bounds.upperLeft.y")+r];var s=this.drawText(t.get("properties.name"));s.text.name="Title",this.add(s.text)},r.inherits(o,i),t.exports=o},function(t,e,n){n(104);var r=n(79),s=n(4),o=n(26),i=n(3),a=n(105);function h(t,e){var n,i;r.call(this,t,e),this.bpmnInfo={type:-1,name:"SubProcess"},this.model=t,this.slot=[],this.slotEvent=[],this.isCanSlot=!0,(!(n=t.get("bounds.lowerRight.x")-t.get("bounds.upperLeft.x"))||n<=0)&&(n=160),(!(i=t.get("bounds.lowerRight.y")-t.get("bounds.upperLeft.y"))||i<=0)&&(i=100),this.rectSize={width:n,height:i},this.render(t)}h.prototype.initEvent=function(r){var o=this;s.each(["dblclick","click"],function(i){o.on(i,function(t){var e={},n=(e.event=t).target;n.parent&&n.parent instanceof a||(e.type=i,e.target=o,r.trigger(i,e))},this)})},h.prototype.render=function(t){var e=new i.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#f9f9f9",stroke:"#bbbbbb"},z:0});e.name="subprocess-rect",this.add(e),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var n=this.drawText(t.get("properties.name"));n.text.name="Title",this.add(n.text)},h.prototype.getRect=function(){var t=this.getBoundingRect(),e=s.clone(t);e.x=parseInt(e.x,10),e.y=parseInt(e.y,10),e.width=parseInt(e.width,10),e.height=parseInt(e.height,10);var n=[];n[0]=[-e.width/2,-e.height/2],n[1]=[e.width/2,-e.height/2],n[2]=[e.width/2,e.height/2],n[3]=[-e.width/2,e.height/2],n[4]=[-e.width/2,-e.height/2];var i=new o(this.position[0],this.position[1],e.width,e.height);return{x:this.position[0]+e.width/2,y:this.position[1]+e.height/2,width:e.width,height:e.height,points:n,boundingRect:i}},h.prototype.setPosition=function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},h.prototype.refresh=function(t){this.childOfName("subprocess-rect").setShape(t.shape),this.attr("position",t.position),this.refreshText()},h.prototype.getBoundingRect=function(){return this.childOfName("subprocess-rect").getBoundingRect()},h.prototype.toJSON=function(){if(this.model.set("resourceId",this.resourceId),this.model.set("properties.type",this.bpmnInfo.type),this.model.set("stencil.type",this.bpmnInfo.name),this.slotEvent&&0<this.slotEvent.length){for(var t=[],e=this.slotEvent.length-1;0<=e;e--)t.push(this.slotEvent[e].resourceId);this.model.set("properties.slotEvent",t)}var n=this.getRect().boundingRect;this.model.set("bounds.upperLeft.x",parseInt(n.x)),this.model.set("bounds.upperLeft.y",parseInt(n.y)),this.model.set("bounds.lowerRight.x",parseInt(n.x+n.width)),this.model.set("bounds.lowerRight.y",parseInt(n.y+n.height));var i=[];return this.eachChild(function(t){(t instanceof r||t instanceof a)&&i.push(t.toJSON())}),this.model.set("childShapes",i),this.model.option},h.prototype.updateShape=function(t,e,n){var i=this.childOfName("subprocess-rect"),r=Number(t),o=i.shape,s=Number(o.width*r),a=Number(s*o.height/o.width);e&&(s=2*(Math.round(s/2/n)*n)-1,a=2*(Math.round(a/2/n)*n)-1);i.setShape({width:s,height:a}),this.refreshText()},h.prototype.nodeType="SubProcess",s.inherits(h,r),t.exports=h},function(t,e){var n={BPMN_TYPE:"stencil.type",BPMN_SCRIPT_TASK:"ScriptTask",BPMN_EVENT_SUB_PROCESS:"SubProcessTask",BPMN_TASK:"Task",TEMPLATE:"BPMNDiagram",RESOURCE_ID:"resourceId",SEQUENCE_FLOW:"SequenceFlow",SUB_PROCESS:"SubProcess",USER_DATA:"properties.userData",START_EVENT:"StartNoneEvent",END_EVENT:"EndNoneEvent",USER_TASK:"UserTask",MANUAL_TASK:"ManualTask",SCRIPT_TASK:"ScriptTask",MAIL_TASK:"MailTask",SERVICE_TASK:"ServiceTask",SMS_TASK:"SmsTask",COMMENT:"Comment",CATCH_TIMER_EVENT:"CatchTimerEvent",CATCH_SIGNAL_EVENT:"CatchSignalEvent",THROW_SIGNAL_EVENT:"ThrowSignalEvent",CATCH_MESSAGE_EVENT:"CatchMessageEvent",INCLUSIVE_GATEWAY:"InclusiveGateway",EXCLUSIVE_GATEWAY:"ExclusiveGateway",PARALLEL_GATEWAY:"ParallelGateway",isTemplate:function(t){return t.model.get(n.BPMN_TYPE)===n.TEMPLATE},isActivity:function(t){var e=t.model.get(n.BPMN_TYPE);return-1!=e.indexOf("Task")||e===n.COMMENT},isSubProcess:function(t){return t.nodeType==n.SUB_PROCESS},isGateway:function(t){return-1!=t.model.get(n.BPMN_TYPE).indexOf("Gateway")},isFlow:function(t){return t.model.get(n.BPMN_TYPE)===n.SEQUENCE_FLOW},isFlowModel:function(t){return t.get(n.BPMN_TYPE)===n.SEQUENCE_FLOW},isEvent:function(t){return-1!=t.model.get(n.BPMN_TYPE).indexOf("Event")},isSlotEvent:function(t){var e=t.model.get(n.BPMN_TYPE);return e==n.CATCH_TIMER_EVENT||e==n.CATCH_SIGNAL_EVENT||e==n.THROW_SIGNAL_EVENT},isComment:function(t){return t.model.get(n.BPMN_TYPE)===n.COMMENT},getType:function(t){return t.model.get(n.BPMN_TYPE)},getStyle:function(t){return t.model.option.style},getProp:function(t){return t.model.option.properties},getUserData:function(t){return t.model.get(n.USER_DATA)},setUserData:function(t,e){t.model.set(n.USER_DATA,e)}};t.exports=n},function(t,e,n){var b=n(77),w=n(4),a=n(14),p=n(3),i=n(80),s=n(106),c=n(107),h=n(108),r=n(109),C=n(64),o=n(83);function P(t){i.call(this),this.opt=t||{},this.opt.model?(this.resourceId=this.opt.model.get("resourceId"),this.model=this.opt.model,this.opt=this.opt.model.option):(this.resourceId=b.getUUID(),this.model=new o({}));var e={symbol:{type:"arrow",size:10,color:P.NORMAL_COLOR,both:!1,offset:0},style:{lineWidth:1,stroke:P.NORMAL_COLOR,lineType:P.TYPE_STRAIGHT},hoverStyle:{lineWidth:2,stroke:P.SELECTED_COLOR},arrowHoverStyle:{fill:P.SELECTED_COLOR},shape:{points:null,smooth:!1,smoothConstraint:null},position:{startPos:null,endPos:null,startOffset:[0,0],endOffset:[0,0],escapeDistance:[30,30],points:null},autoChangePosition:!1,textContextMenu:null,isEdit:!0,text:{text:null,textFill:"#000000",textFont:"12px Microsoft YaHei",textPos:"center",textRotateable:!0},image:{image:null,width:50,height:50,imagePos:"center",imageRotateable:!0},z:0};this.options=b.mergeOpt(e,this.opt,!0,"textContextMenu"),this.handles=[],this.conPointsGroup=new p.Group,this.startNode=null,this.endNode=null,this.line=null,this.groupCurve=new p.Group,this.icons=[],this.render()}P.TYPE_STRAIGHT="straight",P.TYPE_JAGGED="jagged",P.TYPE_CURVE="curve",P.TYPE_CHAIN="chain",P.RADIUS=3,P.START_NODE="startNode",P.END_NODE="endNode",P.LEFT="left",P.RIGHT="right",P.TOP="top",P.BOTTOM=P.BOTTOM="bottom",P.SEPERATOR="-",P.NORMAL_COLOR="#000",P.SELECTED_COLOR="#74B7E0",P.CHILD_NAME=["lineText","lineImage"],P.prototype.createLineNode=function(t,r){var o=this,e=null;r=r||"text";var s=w.find(P.CHILD_NAME,function(t){return-1<t.toLocaleLowerCase().indexOf(r)});w.isArray(t[r])&&this.options.style.lineType==P.TYPE_CHAIN?t[r].forEach(function(t,e){var n=o.drawText(s+"-"+e,t,0,0,r);if(w.isString(t)){var i={};i[r]=t,i[r+"Id"]=n.text.id,o.options[r][r][e]=i}else o.options[r][r][e].textId=n.text.id;o.add(n.text),o.createNodeContextMenu(n.text)}):(e=this.drawText(s,t,0,0,r),this.add(e.text)),e&&o.createNodeContextMenu(e.text)},P.prototype.ifLineNodeRotateable=function(t){return t=t||"text",!(this.options.style.lineType!=P.TYPE_STRAIGHT||!("text"===t&&this.options.text.textRotateable||"image"===t&&this.options.image.imageRotateable))},P.prototype.refreshLineNode=function(t,l,c){var u=this,n=[],i=P.CHILD_NAME[0];if(c=c||"text",i=w.find(P.CHILD_NAME,function(t){return-1<t.toLocaleLowerCase().indexOf(c)}),this.options.style.lineType==P.TYPE_CHAIN&&w.isArray(l[c]))l[c].forEach(function(t,e){n.push(u.childOfName(i+"-"+e))});else if(!t&&l[c]){var e=this.drawText(i,l,0,0,c);this.add(e.text),t=this.childOfName(i)}if(0<n.length){var r=n.length,o=this.turningPoints[1].x-this.turningPoints[0].x,p=parseInt(o/r),d=-p*parseInt(r/2);n.forEach(function(t,e){var n=u.getTextPostion(l,t),i="",r=u.getTextRotation(n,t);0===Math.abs(r)?r=0:i=0<r?"plus":"minus";var o=180*(r=Math.abs(r))/Math.PI,s=null,a=null;if("text"===c){t.setStyle("text",w.isString(l[c][e])?l[c][e]:l[c][e].text);var h=u.getTextBoundingRect(t.style);t.setShape({width:h.width,height:h.height})}s=i?(s=90<o?(o-45)*Math.PI/180:(45+o)*Math.PI/180,"minus"===i?-s:s):45*Math.PI/180,t.attr("rotation",s),90==o?n[1]-=d:(n[0]+=d,0!==r&&(a=Math.tan(o*Math.PI/180)*d,0<d?n[1]-="plus"===i?a:-a:n[1]+="plus"===i?-a:a)),t.attr("position",n),d+=p})}if(t){if("text"===c){t.setStyle("text",l[c]);var s=this.getTextBoundingRect(l);t.setShape({width:s.width,height:s.height})}var a=this.getTextPostion(l,t);this.ifLineNodeRotateable(c)&&t.attr("rotation",this.getTextRotation(a,t)),t.attr("position",a)}},P.prototype.refresh=function(t){var i=this;t&&(this.turningPoints=t);var e=b.traslatePoints(this.turningPoints);this.options.style.lineType==P.TYPE_CURVE&&2<e.length?this.modifyCurve(this.turningPoints):this.line.attr("shape",{points:e}),P.CHILD_NAME.forEach(function(t){var e=i.childOfName(t),n=t===P.CHILD_NAME[0]?"text":"image";i.refreshLineNode(e,i.options[n],n)}),this.refreshFromToSymbol(e),this.refreshHandles()},P.prototype.createNodeContextMenu=function(t){if(t&&this.opt.textContextMenu){var e=this.opt.textContextMenu;t.on("contextmenu",function(t){t.event.preventDefault(),t.event.stopPropagation(),e.buildMenu(t.event,this)})}},P.prototype.render=function(){var i=this;this.renderFromToSymbol(),this.curveLine=new p.BezierCurve({style:this.options.style,z:this.options.z}),this.groupCurve.add(this.curveLine),this.add(this.groupCurve),this.add(this.conPointsGroup),this.polyLine=new p.Polyline({shape:this.options.shape,style:this.options.style,z:this.options.z}),this.add(this.polyLine),this.options.style.lineType==P.TYPE_CURVE?(this.line=this.groupCurve,this.createHoverStyle(this.curveLine),this.polyLine.hide()):(this.line=this.polyLine,this.createHoverStyle(this.polyLine),this.curveLine.hide());w.each(["dblclick","click"],function(n){this.line.on(n,w.bind(function(t){t.cancelBubble=!0;var e={};e.event=t,e.type="Connector:"+n,e.target=i,this.trigger(e.type,e),0!=this.options.isEdit&&(i.setSelectedStyle(this),this.handles.length<1&&this.shapeSetHandle())},this))},this),this.options.text.text&&this.createLineNode(this.options.text,"text"),this.options.image.image&&this.createLineNode(this.options.image,"image")},P.prototype.renderFromToSymbol=function(t){var e=this.createSymbol("toSymbol",this.options);if(e&&this.add(e),this.options.symbol.both){var n=this.createSymbol("fromSymbol",this.options);n&&this.add(n)}},P.prototype.refreshFromToSymbol=function(t){var e=this.childOfName("toSymbol"),n=this.childOfName("fromSymbol"),i=[],r=this.options.symbol.offset;if(e)if(this.options.effect&&this.options.effect.show)new h(e,this.options,this.groupCurve,this.polyLine);else{if(i=t[t.length-1],this.options.style.lineType!==P.TYPE_CURVE){var o=a.distance(t[t.length-1],t[t.length-2]);i=r<=o?a.lerp([],t[t.length-1],t[t.length-2],r/o):t[t.length-1]}e.attr("position",i),e.attr("rotation",b.tangentRotation(this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]))}if(n){if(i=t[0],this.options.style.lineType!==P.TYPE_CURVE){var s=a.distance(t[0],t[1]);i=r<=s?a.lerp([],t[0],t[1],r/s):t[0]}n.attr("position",i),n.attr("rotation",b.tangentRotation(this.turningPoints[1],this.turningPoints[0]))}},P.prototype.setStyle=function(e,t){var n={},i=null,r=["text","image","symbol"];if(e.text){var o=this.childOfName(P.CHILD_NAME[0]);if(!o&&e.text.text){var s=this.drawText(P.CHILD_NAME[0],e.text,0,0);this.add(s.text),o=this.childOfName(P.CHILD_NAME[0])}!e.text.text&&""!=e.text.text||(o.setStyle("text",e.text.text),this.options.text.text=e.text.text);var a=this.getTextPostion(e.text);o.attr("position",a),e.text.textPos&&(this.options.text.textPos=e.text.textPos),e.text.offset&&(this.options.text.offset=e.text.offset),e.text.color&&(o.attr("style",{textFill:e.text.color}),this.options.text.textFill=e.text.color),e.text.textFont&&(o.attr("style",{textFont:e.text.textFont}),this.options.text.textFont=e.text.textFont),e.text.textFill&&(o.attr("style",{textFill:e.text.textFill}),this.options.text.textFill=e.text.textFill),this.model.set("options.text",e.text)}if(e.image){var h=this.childOfName(P.CHILD_NAME[1]);if(!h&&e.image.image){var l=this.drawText(P.CHILD_NAME[1],e.image,0,0,"image");this.add(l.text),h=this.childOfName(P.CHILD_NAME[1])}var c=this.getTextPostion(e.image,h);h.attr("position",c),Object.keys(e).forEach(function(t){this.options.image[t]=e[t]}.bind(this)),e.image.offset&&(this.options.image.offset=e.image.offset),this.model.set("options.image",e.image)}if(e.symbol){e.symbol.type&&(this.options.symbol.type=e.symbol.type,this.model.set("options.symbol.type",e.symbol.type)),e.symbol.size&&(this.options.symbol.size=e.symbol.size,this.model.set("options.symbol.size",e.symbol.size)),e.symbol.color&&(this.options.symbol.color=e.symbol.color,this.model.set("options.symbol.color",e.symbol.color)),e.symbol.z&&(this.options.symbol.z=e.symbol.z,this.model.set("options.symbol.z",e.symbol.z)),(i=this.childOfName("toSymbol"))&&this.remove(i);var u=this.createSymbol("toSymbol",this.model.get("options"));u&&this.add(u)}Object.keys(e).forEach(function(t){r.indexOf(t)<0&&(n[t]=e[t])}),"{}"!==JSON.stringify(n)&&(n.color&&(n.stroke=n.color),n.stroke&&(n.color=n.stroke),this.options.style.lineType==P.TYPE_CURVE?this.groupCurve.eachChild(function(t){t.attr("style",n),p.setNormalStyle(t,n)}):(this.polyLine.attr("style",n),p.setNormalStyle(this.polyLine,n)),(i=this.childOfName("toSymbol"))&&n.color&&(i.attr("style",{fill:n.color}),p.setNormalStyle(i,{fill:n.color})),t||(Object.keys(n).forEach(function(t){this.options.style[t]=n[t],this.model.set("options.style"+t,n[t])}.bind(this)),n.color&&(this.options.symbol.color=n.color))),this.refresh()},P.prototype.setSelectedStyle=function(){var t;this.setStyle(this.options.hoverStyle,!0),this.options.style.lineType==P.TYPE_CURVE?this.groupCurve.eachChild(function(t){t.attr("z",this.options.z+2)}.bind(this)):this.polyLine.attr("z",this.options.z+2),(t=this.childOfName("toSymbol"))&&t.attr("z",this.options.z+2)},P.prototype.removeSelectedStyle=function(){var t;this.setStyle({color:this.options.style.stroke,lineWidth:this.options.style.lineWidth},!0),this.options.style.lineType==P.TYPE_CURVE?this.groupCurve.eachChild(function(t){t.attr("z",this.options.z)}.bind(this)):this.polyLine.attr("z",this.options.z),(t=this.childOfName("toSymbol"))&&t.attr("z",this.options.z)},P.prototype.getTextPostion=function(t,e){var n,i=[],r=t.image&&e?e.getBoundingRect():this.getTextBoundingRect(t),o=r.width,s=r.height||12;if(t&&(t.textPos||t.imagePos)){var a=t.offset||0,h=a;n=t.textPos||t.imagePos,w.isArray(a)||(h=[a,0]);var l,c,u=b.getMaxLineLength([this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]]),p=[],d=[],f=b.getAngle(u[0],u[1]);switch(this.options.style.lineType==P.TYPE_CURVE&&(d=this.getPointsFromCurve()),u.forEach(function(t){var e=new C(t.x,u[1].x>=u[0].x?t.y-s/2:t.y+s/2);p.push(e)}),n){case"start":i=this.options.style.lineType===P.TYPE_STRAIGHT?(l=h[0],[(c=b.getEndPoint(p[0],l,f)).x,c.y+h[1]]):[this.turningPoints[0].x-o/2+h[0],this.turningPoints[0].y+h[1]-s/2];break;case"end":i=this.options.style.lineType!==P.TYPE_STRAIGHT||this.options.text.textRotateable?(l=b.distance(p[0],p[1])-o+h[0],[(c=b.getEndPoint(p[0],l,f)).x,c.y+h[1]]):(l=b.distance(p[0],p[1]),[(c=b.getEndPoint(p[0],l,f)).x-o+h[0],c.y+h[1]]);break;default:var g=this.middle(t);if(this.ifLineNodeRotateable(t.image?"image":"text")){var v=this.getTextRotation(t),y=[g[0]-o/2,g[1]-s/2];i=b.calculatePoints(y,{x:g[0],y:g[1]},v)}else if(this.options.style.lineType==P.TYPE_CURVE){var m=[];d.forEach(function(t){m=m.concat(t)});var _=Math.round(m.length/2);i=[m[_].x-o/2,m[_].y-s/2]}else i=[g[0]+h[0],g[1]+h[1]],this.options.style.lineType!==P.TYPE_CHAIN&&(i=[i[0]-o/2,i[1]-s/2])}}else{var x=this.middle(t);i=[x[0]-o/2,x[1]]}return i},P.prototype.getTextRotation=function(t){var e=b.getMaxLineLength(this.turningPoints),n=this.middle(t);return-Math.atan2(e[1].y-n[1],e[1].x-n[0])},P.prototype.createHoverStyle=function(o){if(this.options.hoverStyle&&this.options.isEdit){p.setElementHoverStl(o,this.options.hoverStyle);var t=this.childOfName("toSymbol");t&&p.setElementHoverStl(t,this.options.arrowHoverStyle),o.on("mouseover",w.bind(function(){p.doEnterHover(o),t&&p.doEnterHover(t),this.groupCurve.eachChild(function(t){p.doEnterHover(t)})},this)).on("mousemove",w.bind(function(t){var e=this.turningPoints[0],n=this.turningPoints[this.turningPoints.length-1],i=Math.abs(t.event.offsetX-e.x)+Math.abs(t.event.offsetY-e.y),r=Math.abs(t.event.offsetX-n.x)+Math.abs(t.event.offsetY-n.y);i<=15||r<=15?(o.cursor="move",o.draggable=!0):(o.cursor="pointer",o.draggable=!1)},this)).on("mouseout",w.bind(function(){p.doLeaveHover(o),t&&p.doLeaveHover(t),this.groupCurve.eachChild(function(t){p.doLeaveHover(t)})},this))}},P.prototype.createAllconnectionPoint=function(){this.connectionPointCreate(this,this.turningPoints[0].clone(),r.TYPE_CONNECTOR),this.connectionPointCreate(this,this.turningPoints[this.turningPoints.length-1].clone(),r.TYPE_CONNECTOR)},P.prototype.connectionPointCreate=function(t,e,n){var i=new r(this,e,n,this.options);this.conPointsGroup.add(i.shape)},P.prototype.clearHandles=function(){for(var t=0;t<this.handles.length;t++)this.remove(this.handles[t].handleShape);this.handles=[],this.conPointsGroup&&this.conPointsGroup.removeAll(),this.removeSelectedStyle()},P.prototype.refreshHandles=function(){var n,i,r,t=this.turningPoints,e=[];if(0<this.handles.length){this.options.style.lineType==P.TYPE_CURVE&&(e=this.getPointsFromCurve());for(var o=0;o<this.handles.length;o++){var s=this.handles[o].associatedPoint;r=this.handles[o].type;var a=t.findIndex(function(t){return t.x==s.x&&t.y==s.y});if(1<a){if("h"==r?(n=t[a-1].x,i=(t[a-1].y+t[a].y)/2):"v"==r&&(n=(t[a-1].x+t[a].x)/2,i=t[a-1].y),this.options.style.lineType==P.TYPE_CURVE&&0<e.length){var h=w.find(e[a-2],function(t){var e;return"h"===r?e=Math.abs(t.y-i):"v"===r&&(e=Math.abs(t.x-n)),e<1});h&&(n=h.x,i=h.y)}this.handles[o].update(n,i)}}}},P.prototype.shapeSetHandle=function(){for(var n,t=this.turningPoints,e=this.getPointsFromCurve(),i=1;i<t.length-2;i++){var r,o,s,a=b.collinearity(t[i-1],t[i],t[i+1]),h=b.collinearity(t[i],t[i+1],t[i+2]);if(!a&&(!h||t[i+1].equals(t[i+2]))||(!a||t[i-1].equals(t[i]))&&!h){if(t[i].x===t[i+1].x?(o=t[i].x,s=(t[i].y+t[i+1].y)/2,n="h"):t[i].y===t[i+1].y&&(o=(t[i].x+t[i+1].x)/2,s=t[i].y,n="v"),o&&s){if(this.options.style.lineType==P.TYPE_CURVE&&0<e.length){var l=w.find(e[i-1],function(t){var e;return"h"===n?e=Math.abs(t.y-s):"v"===n&&(e=Math.abs(t.x-o)),e<1});l&&(o=l.x,s=l.y)}(r=new c(n,o,s,this)).associatedPoint=t[i+1]}r&&(this.add(r.handleShape),this.handles.push(r))}}},P.prototype.createSymbol=function(t,e){var n=e.symbol.type,i=e.symbol.size;if("none"!==n){w.isArray(i)||(i=[i,i]);var r=e.z;e.symbol.z&&(r=e.symbol.z);var o=s.createSymbol(n,-i[0]/2,-i[1]/2,i[0],i[1],r,e.symbol.color);return o.name=t,o}},P.prototype.draw=function(t,e){},P.prototype.drawText=function(t,e,n,i,r){r=r||"text";var o,s=w.isString(e)?"text"===r?{text:e,x:n,y:i}:{image:e,x:n,y:i}:w.defaults({x:n,y:i},e,!0),a=w.defaults(w.clone(this.options.text),s,!0);if("text"===r){var h=this.getTextBoundingRect(a);a=w.defaults(a,{fill:"#F9F9F9",transformText:!0},!0),o=new p.Rect({shape:{width:h.width,height:h.height},style:a,zlevel:20,name:t})}else o=new p.Image({type:"LinkImage",style:a,zlevel:20,name:t});return{text:o,rect:o.getBoundingRect()}},P.prototype.getTextBoundingRect=function(t){var e=p.textContain.getBoundingRect(t.text,t.textFont);return{width:p.textContain.getWidth(t.text,t.textFont),height:e.height||12}},P.prototype.middle=function(){if(this.options.style.lineType==P.TYPE_STRAIGHT||this.options.style.lineType==P.TYPE_CHAIN){var t=b.getMaxLineLength(this.turningPoints);return[(t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2]}if(this.options.style.lineType==P.TYPE_JAGGED){for(var e=this.getLength(),n=-1,i=0,r=0;r<this.turningPoints.length-1;r++){n=r;var o=b.getLength(this.turningPoints[r],this.turningPoints[r+1]);if(!(i+o<e/2))break;i+=o}if(-1!=n){var s=e/2-i;if(b.round(this.turningPoints[n].x,3)==b.round(this.turningPoints[n+1].x,3))return[this.turningPoints[n].x,Math.min(this.turningPoints[n].y,this.turningPoints[n+1].y)+s];if(b.round(this.turningPoints[n].y,3)==b.round(this.turningPoints[n+1].y,3))return[Math.min(this.turningPoints[n].x,this.turningPoints[n+1].x)+s,this.turningPoints[n].y];console.error("Connector:middle() - this should never happen "+this.turningPoints[n]+" "+this.turningPoints[n+1]+" nr of points "+this.turningPoints.length)}}else if(this.options.style.lineType==P.TYPE_CURVE){for(var a=this.getLength(),h=0,l=0;l<this.turningPoints.length-1&&!(h+b.distance(this.turningPoints[l],this.turningPoints[l+1])>.5*a);l++)h+=b.distance(this.turningPoints[l],this.turningPoints[l+1]);var c=(.5*a-h)/b.distance(this.turningPoints[l],this.turningPoints[l+1]);return[c*(this.turningPoints[l+1].x-this.turningPoints[l].x)+this.turningPoints[l].x,c*(this.turningPoints[l+1].y-this.turningPoints[l].y)+this.turningPoints[l].y]}return null},P.prototype.getLength=function(){for(var t=0,e=0;e<this.turningPoints.length-1;e++)t+=b.getLength(this.turningPoints[e],this.turningPoints[e+1]);return t},P.prototype.toJSON=function(){return this.model.set("resourceId",this.resourceId),this.model.set("properties.type",14),this.model.set("bounds.upperLeft.x",this.position[0]),this.model.set("bounds.upperLeft.y",this.position[1]),this.model.set("bounds.lowerRight.x",parseInt(this.position[0]+this.getBoundingRect().width)),this.model.set("bounds.lowerRight.y",parseInt(this.position[1]+this.getBoundingRect().height)),this.model.set("style.sPos",this.options.position.startPos),this.model.set("style.ePos",this.options.position.endPos),this.model.set("style.lineDash",this.options.style.lineDash),this.model.set("style.stroke",this.options.style.stroke),this.model.set("symbol.type",this.options.symbol.type),this.model.set("dockers",this.turningPoints),this.model.option},P.prototype.refreshModel=function(){this.model.set("options",w.clone(this.options)),this.model.set("options.dockers",this.turningPoints);for(var t=[],e=0;e<this.icons.length;e++){var n=this.icons[e],i=[n.key,{icon:n.style.image,width:n.style.width,height:n.style.height}];t.push(i)}this.model.set("icons",t)},P.prototype.modifyCurve=function(t){for(var e=this.getCurvePoint(t),n=[],i=e.length,r=this.groupCurve.childCount();i<r;i++)n.push(this.groupCurve.childAt(i));w.each(n,function(t){this.groupCurve.remove(t)},this);for(var o=0;o<e.length;o++){var s=this.groupCurve.childAt(o);if(s)s.attr("shape",e[o]);else{var a=new p.BezierCurve({style:this.options.style,shape:e[o],z:this.options.z});this.groupCurve.add(a),this.createHoverStyle(a)}}},P.prototype.getBezierPoints=function(t,e){var n=[],i=null,r=t.start,o=t.cp1,s=t.cp2,a=t.end;(!e||e<=50)&&(e=50),o||s?o&&!s?i=this.twoBezier:o&&s&&(i=this.threeBezier):i=this.oneBezier;for(var h=0;h<e;h++)n.push(i(h/e,r,o,s,a));return n.push(a),n},P.prototype.oneBezier=function(t,e,n,i,r){var o=e.x1,s=e.y1;return{x:o+(r.x2-o)*t,y:s+(r.y2-s)*t}},P.prototype.twoBezier=function(t,e,n,i,r){var o=e.x1,s=e.y1,a=r.x2,h=r.y2;return{x:(1-t)*(1-t)*o+2*t*(1-t)*n.cpx1+t*t*a,y:(1-t)*(1-t)*s+2*t*(1-t)*n.cpy1+t*t*h}},P.prototype.threeBezier=function(t,e,n,i,r){var o=e.x1,s=e.y1,a=r.x2,h=r.y2,l=n.cpx1,c=n.cpy1;return{x:o*(1-t)*(1-t)*(1-t)+3*l*t*(1-t)*(1-t)+3*i.cpx2*t*t*(1-t)+a*t*t*t,y:s*(1-t)*(1-t)*(1-t)+3*c*t*(1-t)*(1-t)+3*i.cpy2*t*t*(1-t)+h*t*t*t}},P.prototype.getPointsFromCurve=function(){var e,n=this,t=this.turningPoints,i=b.getMaxLineLength(t),r=[];if(e=parseInt(i[0].x-i[1].x),this.options.style.lineType==P.TYPE_CURVE&&2<t.length){var o=this.transformCurvePoint(this.getCurvePoint(t));0<o.length&&o.forEach(function(t){r.push(n.getBezierPoints(t,e))})}return r},P.prototype.transformCurvePoint=function(t){var n=[];return t.forEach(function(t){var e={};t.x1&&t.y1&&(e.start={x1:t.x1,y1:t.y1}),t.cpx1&&t.cpy1&&(e.cp1={cpx1:t.cpx1,cpy1:t.cpy1}),t.cpx2&&t.cpy2&&(e.cp2={cpx2:t.cpx2,cpy2:t.cpy2}),t.x2&&t.y2&&(e.end={x2:t.x2,y2:t.y2}),n.push(e)}),n},P.prototype.getCurvePoint=function(t){var e=t.length,n=[];if(3===e)return n.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,x2:t[2].x,y2:t[2].y}),n;if(4===e)return n.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,cpx2:t[2].x,cpy2:t[2].y,x2:t[3].x,y2:t[3].y}),n;function i(t,e){return new C(t.x+e.x,t.y+e.y)}function r(t,e){if(0==e)throw"Division by zero not allowed (yet :) "+this.callee;return new C(t.x/e,t.y/e)}function o(t,e){return new C(t.x*e,t.y*e)}var s,a=[0,0,0];for(s=0;s<=e-3;s++)a.push(s);a.push(e-3,e-3);for(var h=1;h<=e-3;h++){var l=r(i(o(t[h],a[h+4]-a[h+2]),o(t[h+1],a[h+2]-a[h+1])),a[h+4]-a[h+1]),c=(a[h+3]-a[h+2])/(a[h+3]-a[h+1]),u=r(i(o(t[h-1],a[h+3]-a[h+2]),o(t[h],a[h+2]-a[h])),a[h+3]-a[h]),p=o(l,(a[h+2]-a[h+1])/(a[h+3]-a[h+1])),d=i(o(u,c),p),f=r(i(o(t[h],a[h+4]-a[h+3]),o(t[h+1],a[h+3]-a[h+1])),a[h+4]-a[h+1]),g=(a[h+3]-a[h+2])/(a[h+4]-a[h+2]),v=r(i(o(t[h+1],a[h+5]-a[h+3]),o(t[h+2],a[h+3]-a[h+2])),a[h+5]-a[h+2]),y=o(f,(a[h+4]-a[h+3])/(a[h+4]-a[h+2])),m=i(o(v,g),y);n.push({x1:d.x,y1:d.y,cpx1:l.x,cpy1:l.y,cpx2:f.x,cpy2:f.y,x2:m.x,y2:m.y})}return n},b.inherits(P,i),t.exports=P},function(t,e,n){"use strict";var l=n(3),c=n(26),i=l.extendShape({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=e.width/2,o=e.height/2;t.moveTo(n,i-o),t.lineTo(n+r,i+o),t.lineTo(n-r,i+o),t.closePath()}}),r=l.extendShape({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=e.width/2,o=e.height/2;t.moveTo(n,i-o),t.lineTo(n+r,i),t.lineTo(n,i+o),t.lineTo(n-r,i),t.closePath()}}),o=l.extendShape({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.x,i=e.y,r=e.width/5*3,o=Math.max(r,e.height),s=r/2,a=s*s/(o-s),h=i-o+s+a,l=Math.asin(a/s),c=Math.cos(l)*s,u=Math.sin(l),p=Math.cos(l);t.arc(n,h,s,Math.PI-l,2*Math.PI+l);var d=.6*s,f=.7*s;t.bezierCurveTo(n+c-u*d,h+a+p*d,n,i-f,n,i),t.bezierCurveTo(n,i-f,n-c+u*d,h+a+p*d,n-c,h+a),t.closePath()}}),s=l.extendShape({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.height,i=e.width,r=e.x,o=e.y,s=i/3*2;t.moveTo(r,o),t.lineTo(r+s,o+n),t.lineTo(r,o+n/4*3),t.lineTo(r-s,o+n),t.lineTo(r,o),t.closePath()}}),a={line:l.Line,rect:l.Rect,roundRect:l.Rect,square:l.Rect,circle:l.Circle,diamond:r,pin:o,arrow:s,triangle:i},h={line:function(t,e,n,i,r){r.x1=t,r.y1=e+i/2,r.x2=t+n,r.y2=e+i/2},rect:function(t,e,n,i,r){r.x=t,r.y=e,r.width=n,r.height=i},roundRect:function(t,e,n,i,r){r.x=t,r.y=e,r.width=n,r.height=i,r.r=Math.min(n,i)/4},square:function(t,e,n,i,r){var o=Math.min(n,i);r.x=t,r.y=e,r.width=o,r.height=o},circle:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.r=Math.min(n,i)/2},diamond:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.width=n,r.height=i},pin:function(t,e,n,i,r){r.x=t+n/2,r.y=e+i/2,r.width=n,r.height=i},arrow:function(t,e,n,i,r){r.x=t+n/2,r.y=e+i/2,r.width=n,r.height=i},triangle:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.width=n,r.height=i}},u={};for(var p in a)u[p]=new a[p];function d(t){if("image"!==this.type){var e=this.style,n=this.shape;n&&"line"===n.symbolType?e.stroke=t:this.__isEmptyBrush?(e.stroke=t,e.fill="#fff"):(e.fill&&(e.fill=t),e.stroke&&(e.stroke=t)),this.dirty()}}var f=l.extendShape({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function(){var t=this.style;"pin"===this.shape.symbolType&&"inside"===t.textPosition&&(t.textPosition=["50%","40%"],t.textAlign="center",t.textVerticalAlign="middle")},buildPath:function(t,e){var n=e.symbolType,i=u[n];"none"!==e.symbolType&&(i=i||u[n="rect"],h[n](e.x,e.y,e.width,e.height,i.shape),i.buildPath(t,i.shape))}}),g={createSymbol:function(t,e,n,i,r,o,s){var a,h=0===t.indexOf("empty");return h&&(t=t.substr(5,1).toLowerCase()+t.substr(6)),(a=0===t.indexOf("image://")?new l.Image({style:{image:t.slice(8),x:e,y:n,width:i,height:r},z:o}):0===t.indexOf("path://")?l.makePath(t.slice(7),{z:o,rectHover:!0},new c(e,n,i,r)):new f({shape:{symbolType:t,x:e,y:n,width:i,height:r},z:o})).__isEmptyBrush=h,a.setColor=d,a.setColor(s),a}};t.exports=g},function(t,e,n){var o=n(3),a=n(77);function s(t,e,n,i){this.type=t,this.x=e,this.y=n,this.visible=!0,this.connector=i,this.handleShape=new o.Circle({shape:{cx:e,cy:n,r:s.RADIUS},style:{fill:"rgb(0,255,0)",stroke:"rgb(0,0,0)"},zlevel:i.options.z+2,draggable:!0});var r=this;this.handleShape.on("drag",function(t){r.actionConnector(t.offsetX,t.offsetY)})}s.RADIUS=4,s.prototype={constructor:s,equals:function(t){return!(!t instanceof s)&&(this.type==t.type&&this.x==t.x&&this.y==t.y&&this.visible==t.visible)},update:function(t,e){this.handleShape.attr("position",[0,0]),this.x=t,this.y=e,this.handleShape.setShape({cx:t,cy:e})},actionConnector:function(t,e){switch(this.type){case"v":for(var n=1;n<this.connector.turningPoints.length-1;n++){if(this.associatedPoint&&this.connector.turningPoints[n].x==this.associatedPoint.x&&this.connector.turningPoints[n].y==this.associatedPoint.y){o=n;break}this.connector.turningPoints[n-1].y==this.connector.turningPoints[n].y&&this.connector.turningPoints[n].y==this.y&&Math.min(this.connector.turningPoints[n].x,this.connector.turningPoints[n-1].x)<=this.x&&Math.max(this.connector.turningPoints[n].x,this.connector.turningPoints[n-1].x)>=this.x&&(o=n)}var i=e-this.y,r=a.translationMatrix(0,i);this.connector.turningPoints[o-1].transform(r),this.connector.turningPoints[o].transform(r),this.connector.refresh();break;case"h":var o;for(n=1;n<this.connector.turningPoints.length-1;n++){if(this.associatedPoint&&this.connector.turningPoints[n].x==this.associatedPoint.x&&this.connector.turningPoints[n].y==this.associatedPoint.y){o=n;break}this.connector.turningPoints[n-1].x==this.connector.turningPoints[n].x&&this.connector.turningPoints[n].x==this.x&&Math.min(this.connector.turningPoints[n].y,this.connector.turningPoints[n-1].y)<=this.y&&Math.max(this.connector.turningPoints[n].y,this.connector.turningPoints[n-1].y)>=this.y&&(o=n)}var s=t-this.x;r=a.translationMatrix(s,0);this.connector.turningPoints[o-1].transform(r),this.connector.turningPoints[o].transform(r),this.connector.refresh()}}},t.exports=s},function(t,e,n){n(4);var a=n(14),p=n(30);n(106);function i(t,e,n,i){this._lastFrame=0,this._lastFramePercent=0,this.symbol=t,this.groupCurve=n,this.initSymbol(e,i)}var r=i.prototype;r.initSymbol=function(t,e){var n=this;this.symbol.z2=100,this.symbol.culling=!0;var i=1e3*t.effect.period;if(this.symbol.__t=0,this.symbol.stopAnimation(),"curve"==t.style.lineType){if(this.groupCurve){i/=this.groupCurve._children.length,this.groupCurveAnimate(this.groupCurve._children[0],0,i)}}else this.symbol.animate("",!0).when(i,{__t:1}).delay(0).during(function(){n.updateSymbolPositionPolyline()}).start(),this.setAnimationPointsPolyline(e.shape.points)},r.groupCurveAnimate=function(t,e,n){var i,r=this;null==t&&(t=this.groupCurve._children[0],e=0);var o=t.shape;i=[[o.x1,o.y1],[o.x2,o.y2],[o.cpx1,o.cpy1],[o.cpx2,o.cpy2]],this.setAnimationPointsBezierCurve(i),this.symbol.animate("").when(n,{__t:1}).delay(0).during(function(){r.updateSymbolPositionBezierCurve()}).done(function(){r.symbol.__t=0,r.groupCurveAnimate(r.groupCurve._children[e+1],e+1,n)}).start()},r.setAnimationPointsBezierCurve=function(t){this.symbol.__p1=t[0],this.symbol.__p2=t[1],this.symbol.__cp1=t[2]||[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],this.symbol.__cp2=t[3]},r.updateSymbolPositionBezierCurve=function(){var t,e,n=this.symbol.__p1,i=this.symbol.__p2,r=this.symbol.__cp1,o=this.symbol.__cp2,s=this.symbol.__t,a=this.symbol.position;if(null!=o[0]){var h=p.cubicAt,l=p.cubicDerivativeAt;a[0]=h(n[0],r[0],o[0],i[0],s),a[1]=h(n[1],r[1],o[1],i[1],s),t=l(n[0],r[0],o[0],i[0],s),e=l(n[1],r[1],o[1],i[1],s)}else{var c=p.quadraticAt,u=p.quadraticDerivativeAt;a[0]=c(n[0],r[0],i[0],s),a[1]=c(n[1],r[1],i[1],s),t=u(n[0],r[0],i[0],s),e=u(n[1],r[1],i[1],s)}this.symbol.rotation=-Math.atan2(e,t)-Math.PI/2,this.symbol.ignore=!1},r.setAnimationPointsPolyline=function(t){this._points=t;for(var e=[0],n=0,i=1;i<t.length;i++){var r=t[i-1],o=t[i];n+=a.dist(r,o),e.push(n)}if(0!==n){for(var s=0;s<e.length;s++)e[s]/=n;this._offsets=e,this._length=n,this.symbol._lastFrame=0,this.symbol.__lastFramePercent=0}},r.updateSymbolPositionPolyline=function(){var t=this.symbol.__t,e=this._points,n=this._offsets,i=e.length;if(n){var r=this._lastFrame;if(t<this._lastFramePercent){for(o=Math.min(r+1,i-1);0<=o&&!(n[o]<=t);o--);o=Math.min(o,i-2)}else{for(var o=r;o<i&&!(n[o]>t);o++);o=Math.min(o-1,i-2)}a.lerp(this.symbol.position,e[o],e[o+1],(t-n[o])/(n[o+1]-n[o])),this._lastFrame=o,this._lastFramePercent=t;var s=-Math.atan2(e[o+1][1]-e[o][1],e[o+1][0]-e[o][0]);this.symbol.rotation=s-Math.PI/2,this.symbol.ignore=!1}},t.exports=i},function(t,e,n){var r=n(3);function o(t,e,n,i){this.connector=t,this.point=e.clone(),this.type=n,this.color=o.NORMAL_COLOR,this.oType="ConnectionPoint",this.shape=new r.Circle({shape:{cx:this.point.x,cy:this.point.y,r:o.RADIUS},style:{fill:this.color,stroke:"#000000"},z:i.z+2}),this.shape.type=this.type,this.shape.connector=t}o.NORMAL_COLOR="#FFFF33",o.OVER_COLOR="#FF9900",o.CONNECTED_COLOR="#ff0000",o.RADIUS=4,o.TYPE_FIGURE="figure",o.TYPE_CONNECTOR="connector",o.prototype={constructor:o,equals:function(t){return this.point.equals(t.point)&&this.connector==t.connector&&this.type==t.type&&this.color==t.color&&this.radius==t.radius}},t.exports=o},function(t,e,n){var r=n(4),o=n(26),i=n(3),s=n(77),a=n(83),h=n(105);function l(t){var e=new a({});t.id||(t.id=s.getUUID()),t.style&&0!==t.style.textLineHeight&&!t.style.rich&&(t.style.rich={}),e.set("elementType","GroupNode"),t.style&&t.style.host&&delete t.style.host,e.set("options",r.clone(t)),"draggable"in t&&(t.isdraggable=t.draggable,delete t.draggable),t.z||(t.z=1),s.isUndefined(t.hoverAnimation)&&(t.hoverAnimation=!1),s.isUndefined(t.selectable)&&(t.selectable=!0),this.model=e,i.Group.call(this,t);this.options=r.merge({shape:{width:5,height:5,r:5},style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)"},position:[0,0]},t,!0),this.render(this.options)}l.RECT_NAME="GROUP_RECT_NAME",l.prototype={constructor:l,type:"GroupNode",render:function(t){var e=new i.Rect({shape:t.shape,style:t.style,z:3});e.name=l.RECT_NAME,this.add(e),this.position=t.position},rectContain:function(t,e){return s.getRect(this).boundingRect.contain(t,e)},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this._api&&this._api._addGroupNode(this,t),this},each:function(t,e){for(var n=this._children,i=0;i<n.length;i++){var r=n[i];r.name!=l.RECT_NAME&&t.call(e,r,i)}return this},getRect:function(){var t=this.getBoundingRect(),e=r.clone(t);e.x=parseInt(e.x,10),e.y=parseInt(e.y,10),e.width=parseInt(e.width,10),e.height=parseInt(e.height,10);var n=[];n[0]=[-e.width/2,-e.height/2],n[1]=[e.width/2,-e.height/2],n[2]=[e.width/2,e.height/2],n[3]=[-e.width/2,e.height/2],n[4]=[-e.width/2,-e.height/2];var i=new o(this.position[0],this.position[1],e.width,e.height);return{x:this.position[0]+e.width/2,y:this.position[1]+e.height/2,width:e.width,height:e.height,points:n,boundingRect:i}},setPosition:function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},setProperties:function(t){this.childOfName(l.RECT_NAME).setShape(t.shape),this.attr("position",t.position)},updateShape:function(i,r){var o=Number(i),t=this.options.shape,e=Number(t.width*o),n=Number(e*t.height/t.width);r&&(e=parseInt(e,10),n=parseInt(n,10)),this.setProperties({shape:{width:e,height:n}}),this.children().forEach(function(t){var e=t.position;if(t.name===l.RECT_NAME||t instanceof h||"ZPath"===t.type){var n=t.rect;n.height=n.height*o,n.width=n.width*o,t.attr({position:[e[0]*o,e[1]*o],rect:n})}else t.updateShape(i,r),t.attr("position",[e[0]*o,e[1]*o])})}},r.inherits(l,i.Group),t.exports=l},function(t,e,n){var a=n(4),h=n(104),l=n(76),i=n(112),c=n(77);function r(t,e,n){i.call(this,t,e,n)}r.prototype.refreshPositionOther=function(t,e){t.parent?h.isSubProcess(t.parent)&&this.attr("position",[e.x+l.parentX(t.parent),e.y+l.parentY(t.parent)]):this.attr("position",[e.x,e.y])},r.prototype.refreshPostion=function(t,e){t.parent&&h.isSubProcess(t.parent)&&(e.x-=l.parentX(t.parent),e.y-=l.parentY(t.parent),e.boundingRect.x=e.boundingRect.x-l.parentX(t.parent),e.boundingRect.y=e.boundingRect.y-l.parentY(t.parent));var n=0,i=a.clone(e.points[2]),r=e.rotation||t.rotation,o=r/(Math.PI/180);if(0<Math.abs(r)){var s=c.getConnectorControls(e,t).br;i=[s.x-e.x,s.y-e.y]}this.virtualRect&&(this.virtualRect.setShape({points:e.points}),this.virtualRect.attr("rotation",r)),this.eachChild(function(t){t.isSelfComputePos||t.attr("position",[0<=o?i[0]+8+20*n++:i[0]-20-20*n++,i[1]-10])}),this.refreshPositionOther(t,e)},r.ARROW_DRAGEND="OperationNode:dragendArrow",r.ARROW_DRAG="OperationNode:dragArrow",r.ARROW_DRAGSTART="OperationNode:dragstartArrow",r.DELETE_CLICK="OperationNode:deleteClick",a.inherits(r,i),t.exports=r},function(t,e,n){var r=n(80),a=n(4),h=n(77),o=n(3),s=n(105),i=(n(49),n(113)),l=n(106);function c(t,e,n,i){r.call(this),this.node=t,this.zr=e,this.forbidEdit=i,this._api=n,this.render()}c.ARROW_DRAGEND="OperationNode:dragendArrow",c.ARROW_DRAG="OperationNode:dragArrow",c.ARROW_DRAGSTART="OperationNode:dragstartArrow",c.DELETE_CLICK="OperationNode:deleteClick",c.DEL="DEL",c.COMMENT_CLICK="OperationNode:commentClick",c.COMMENT="COMMENT",c.opicons={STRAIGHT:i.STRAIGHT_SVG,JAGGED:i.JAGGED_SVG,CURVE:i.CURVE_SVG,DEL:i.DEL_SVG,COMMENT:i.COMMENT_SVG},c.prototype.render=function(){this.renderBase(),this.forbidEdit||this.renderOther()},c.prototype.renderBase=function(){this.createOperation()},c.prototype.createOperation=function(){var r=this,t=this.node.operationIcons;this.node.parent&&"dragSelect"===this.node.parent.type&&(t=!1),this.node.selectStyle?"ZPath"===this.node.type?(this.node._zCloneStyle=this.node.style.clone(),this.node.setStyle(this.node.selectStyle)):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!0):this._api.getZr().addHover(this.node,this.node.selectStyle):(this.virtualRect=new o.Polyline({style:{lineDash:[2]}}),this.virtualRect.isSelfComputePos=!0,this.add(this.virtualRect)),t&&a.each(this.node.operationIcons,function(i){var t=null,e=c.opicons[i.name.toUpperCase()+""];if(e){if(this.forbidEdit)return;if(i.hidden)return;if(i.name==c.DEL)t=o.makePath(e,{style:{fill:"#aaaaac"},z:r.node.z+1,rectHover:!0},{x:0,y:0,width:10,height:15}),i.callback?t.on("click",function(t){t.data=i,t.node=r.node,i.callback&&i.callback(t)}):t.on("click",function(t){var e={};e.event=t,e.target=this,e.type=c.DELETE_CLICK,r.trigger(e.type,e)});else if(i.name==c.COMMENT){(t=o.makePath(e,{style:{fill:"#aaaaac"},z:r.node.z+2,rectHover:!0},{x:0,y:0,width:16,height:16})).on("click",function(t){var e={};e.event=t,e.target=this,e.type=c.COMMENT_CLICK,r.trigger(e.type,e)})}else{t=o.makePath(e,{style:{fill:"#aaaaac"},draggable:!0,z:r.node.z+2,lineType:s["TYPE_"+i.name.toUpperCase()],rectHover:!0},{x:0,y:0,width:15,height:15});a.each(["dragstart","drag","dragend"],function(n){t.on(n,function(t){var e={};e.event=t,e.data=i.options,e.type="OperationNode:"+n+"Arrow",r.trigger(e.type,e)})})}}else(t=l.createSymbol(i.iconPath,0,0,i.width||15,i.height||15,r.node.z+1,i.color||"#000")).on("click",function(t){t.data=i,t.node=r.node,i.callback&&i.callback(t);var e={event:t,type:"OperationNode:"+i.name+"Click"};r._api.trigger(e.type,e)});t.name=i.name,r.add(t)})},c.prototype.refreshPostion=function(t,e){var n=0,i=a.clone(e.points[2]),r=t.rotation,o=r/(Math.PI/180);if(0<Math.abs(r)){var s=h.getConnectorControls(e,t).br;i=[s.x-e.x,s.y-e.y]}this.virtualRect&&(this.virtualRect.setShape({points:e.points}),t.parent&&t.parent.childDraggable&&this.virtualRect.attr("z",t.parent.z+1),this.virtualRect.attr("rotation",r)),this.eachChild(function(t){t.isSelfComputePos||t.attr("position",[0<=o?i[0]+8+20*n++:i[0]-20-20*n++,i[1]-10])}),this.refreshPositionOther(t,e)},c.prototype.renderOther=function(){},c.prototype.refreshPositionOther=function(t,e){if(t.parent&&t.parent.isBg&&1==t.parent.isBg||"GroupNode"===t.parent.type)this.attr("position",[e.x,e.y]);else{var n=t.shape?t.shape.x:0,i=t.shape?t.shape.y:0;this.attr("position",[e.x+t.parent.position[0]+n,e.y+t.parent.position[1]+i])}},c.prototype.cleanup=function(){this.node.selectStyle&&("ZPath"===this.node.type?this.node.setStyle(this.node._zCloneStyle):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!1):this._api.getZr().removeHover(this.node))},a.inherits(c,r),t.exports=c},function(t,e){t.exports={STRAIGHT_SVG:"M937.353846 724.676923C882.215385 669.538462 795.569231 661.661538 732.553846 701.046154L362.338462 330.830769C401.723077 267.815385 393.846154 181.169231 338.707692 126.030769 267.815385 55.138462 165.415385 55.138462 94.523077 126.030769 23.630769 196.923077 23.630769 299.323077 94.523077 370.215385 149.661538 425.353846 236.307692 433.230769 299.323077 393.846154L669.538462 764.061538C630.153846 827.076923 638.030769 913.723077 693.169231 968.861538 764.061538 1039.753846 866.461538 1039.753846 937.353846 968.861538 1000.369231 897.969231 1000.369231 795.569231 937.353846 724.676923L937.353846 724.676923ZM275.692308 307.2C244.184615 338.707692 189.046154 338.707692 157.538462 307.2 126.030769 275.692308 126.030769 220.553846 157.538462 189.046154 189.046154 157.538462 244.184615 157.538462 275.692308 189.046154 307.2 220.553846 307.2 267.815385 275.692308 307.2L275.692308 307.2ZM874.338462 913.723077C842.830769 945.230769 787.692308 945.230769 756.184615 913.723077 724.676923 882.215385 724.676923 827.076923 756.184615 795.569231 787.692308 764.061538 842.830769 764.061538 874.338462 795.569231 905.846154 827.076923 905.846154 874.338462 874.338462 913.723077L874.338462 913.723077Z",JAGGED_SVG:"M204.8 819.2l-51.2-102.4 204.8-307.2 51.2 102.4-204.8 307.2zM409.6 512l51.2-102.4 153.6 204.8-51.2 102.4-153.6-204.8zM819.2 204.8l51.2 102.4-204.8 409.6-51.2-102.4 204.8-409.6z                                    M153.6 716.8c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H102.4v-102.4h102.4v102.4zM409.6 204.8C322.56 204.8 256 271.36 256 358.4s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H358.4V307.2h102.4v102.4zM614.4 614.4c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4v-102.4h102.4v102.4zM870.4 0c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4V102.4h102.4v102.4z",CURVE_SVG:"M1014.285039 824.024234l-145.168428-144.37205c-12.969593-12.855825-37.543559-14.505466-44.597197 2.332252-1.877178 4.550734-2.275367 17.179022-2.275368 17.179022v97.556369H330.935383a118.319095 118.319095 0 0 1-118.546632-117.920905A118.319095 118.319095 0 0 1 330.992267 560.878016h445.516899c121.561493 0 220.426198-98.352747 220.426198-219.23163s-98.864705-219.174746-220.426198-219.174746H340.491925A174.236244 174.236244 0 0 0 174.105698 0 173.78117 173.78117 0 0 0 0.040107 173.09856a173.78117 173.78117 0 0 0 174.065591 173.09856 174.236244 174.236244 0 0 0 166.386227-122.471639h436.017241c65.416807 0 118.603516 52.902288 118.603515 117.920905A118.319095 118.319095 0 0 1 776.509166 459.624176H330.992267c-121.504609 0-220.369314 98.352747-220.369314 219.23163s98.864705 219.174746 220.369314 219.174746h491.194895v92.550561s0 14.221045 2.332252 19.795695c7.053638 16.894602 31.627604 17.577212 44.597197 4.664502l145.111543-144.315165a32.879056 32.879056 0 0 0 0-46.645027zM174.105698 244.94328c-39.818926 0-72.242909-32.25333-72.242909-71.84472s32.423983-71.787835 72.242909-71.787835c39.818926 0 72.186025 32.196446 72.186025 71.787835 0 39.591389-32.423983 71.787835-72.242909 71.787836z",DEL_SVG:"M980.992 256h-84.992v683.008c0 47.104-37.888 84.992-84.992 84.992H212.992c-47.104 0-84.992-37.888-84.992-84.992V256H43.008C19.456 256 0 236.544 0 212.992c0-23.552 19.456-43.008 43.008-43.008H256V84.992C256 37.888 293.888 0 340.992 0h340.992C730.112 0 768 37.888 768 84.992v84.992h214.016c23.552 0 43.008 19.456 43.008 43.008-1.024 23.552-20.48 43.008-44.032 43.008zM683.008 84.992H340.992v84.992h340.992V84.992zM212.992 939.008h596.992V256H212.992v683.008z m171.008-470.016v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-23.552 19.456-43.008 43.008-43.008 23.552 1.024 43.008 19.456 43.008 43.008zM512 427.008c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z m171.008 0c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z",COMMENT_SVG:"M209.92 152.064l572.416 1.536c12.8 0 23.04 10.24 23.04 23.04v237.568c0 12.8 10.24 23.04 23.04 23.04s23.04-10.24 23.04-23.04V125.44c0-12.8-10.24-23.04-23.04-23.04H158.72c-12.8 0-23.04 10.24-23.04 23.04v773.12c0 12.8 10.24 23.04 23.04 23.04h236.032c12.8 0 23.04-10.24 23.04-23.04s-10.24-22.528-22.528-23.04l-185.856-1.536c-12.8 0-22.528-10.24-22.528-23.04V174.592c0-12.288 10.24-22.528 23.04-22.528z                                            M268.8 570.368h159.232c13.312 0 24.064 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.064-10.752-24.576-24.064v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0-312.32h441.344c13.312 0 24.576 10.752 24.576 24.576v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.576-10.752-24.576-24.576v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0.512 155.648h269.312c13.312 0 24.576 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H269.312c-13.312 0-24.576-10.752-24.576-24.064v-2.56c0-13.824 10.752-24.576 24.576-24.576z m471.04 13.312l-246.784 339.456c-1.536 2.56-2.56 5.632-2.56 8.704l-1.536 132.096c0 9.728 9.728 16.896 18.944 14.336l122.88-37.888c3.072-1.024 5.632-3.072 7.68-5.632l246.784-338.944c4.608-6.144 3.584-15.36-2.56-19.968l-121.344-94.72c-7.168-5.632-16.896-4.096-21.504 2.56z m23.04 67.584l51.2 39.936c2.048 1.536 2.56 5.12 1.024 7.168l-26.112 35.84c-1.536 2.56-5.12 3.072-7.68 1.024l-51.712-38.912c-2.048-1.536-2.56-4.608-1.024-7.168l26.624-37.376c2.048-1.536 5.632-2.048 7.68-0.512z m-165.888 341.504l-35.328 10.752c-9.216 3.072-18.944-4.096-18.944-13.824l0.512-40.96c0-3.072 1.024-6.144 2.56-8.704l137.216-187.904c1.536-2.56 5.12-2.56 7.168-1.024l51.2 38.4c2.56 2.048 3.072 5.12 1.024 7.68l-137.728 189.952c-2.048 2.56-4.608 4.608-7.68 5.632z",CHANGE_LINE_TYPE_SVG:"M1008 335.2 1008 335.2l-160 144 0 0c-8.8 8-20 12.8-32 12.8-26.4 0-48-21.6-48-48 0-14.4 6.4-26.4 16-35.2l0 0 67.2-60L560 348.8c0 0 0 0 0 0L464 348.8l0 0L352 348.8 48 348.8c-26.4 0-48-21.6-48-48 0-26.4 21.6-48 48-48l124.8 0 0 0L416 252.8l0 0 208 0 0 0 227.2 0L784 192l0 0c-9.6-8.8-16-21.6-16-35.2 0-26.4 21.6-48 48-48 12 0 23.2 4.8 32 12.8l0 0 160 144 0 0c9.6 8.8 16 21.6 16 35.2C1024 314.4 1017.6 326.4 1008 335.2zM16 680.8 16 680.8l160-144 0 0c8.8-8 20-12.8 32-12.8 26.4 0 48 21.6 48 48 0 14.4-6.4 26.4-16 35.2l0 0-67.2 60L400 667.2l0 0 208 0 0 0 243.2 0 0 0L976 667.2c26.4 0 48 21.6 48 48 0 26.4-21.6 48-48 48L672 763.2 560 763.2c0 0 0 0 0 0L464 763.2l0 0L172.8 763.2 240 824l0 0c9.6 8.8 16 21.6 16 35.2 0 26.4-21.6 48-48 48-12 0-23.2-4.8-32-12.8l0 0L16 752l0 0c-9.6-8.8-16-21.6-16-35.2C0 701.6 6.4 689.6 16 680.8z"}},function(t,e,n){var l=n(4),i=n(115),a=n(82),c=n(105),u=n(64),h=n(77);function r(){i.call(this),this.stencilType="SequenceFlow"}r.prototype.connectorCreate=function(t,e,n,i,r,o){var s=new a({});return s.set("resourceId",h.getUUID()),s.set("style",n.style),s.set("stencil.type",this.stencilType),r&&s.set("style.sPos",r),o&&s.set("style.ePos",o),this.connectorCreateByOptions(t,e,{model:s,isEdit:!0,style:n},i)},r.prototype.connectorCreateByOptions=function(t,e,n,r){var o=this,i=n.model;i.option.text={text:i.option.properties.name},n.text={text:i.option.properties.name};var s=new c(n);s.startNode=t,s.endNode=e,this.connectors.push(s),s.options.position.startPos=i.get("style.sPos"),s.options.position.endPos=i.get("style.ePos");var a=i.get("dockers");if(a&&2<=a.length){var h=u.loadArray(a);s.refresh(h)}else this.refreshConnector(s,!0);s.conPointsGroup.on("click",function(t){var e=t.target.type.split(c.SEPERATOR),n=t.target.connector;e[0]===c.START_NODE?n.options.position.startPos=e[1]:e[0]===c.END_NODE&&(n.options.position.endPos=e[1]),o.refreshConnector(n,!0);var i={};i.event=t,i.type="conPointsGroup:click",i.lineNode=o.selConnector,r.trigger(i.type,i)});l.each(["dblclick","click"],function(i){s.on("Connector:"+i,function(t){var e=t.target;o.selConnector!==e&&(o.selConnector&&o.refreshConnector(o.selConnector),o.selConnector=e);var n={};n.event=t,n.type=i,n.target=o.selConnector,r.trigger(n.type,n)})}),n.isFromModel||(t.model.get("outgoing").push(s.resourceId),s.model.get("outgoing").push(e.resourceId));return s},r.prototype.setModel=function(t,e){var n=t.options.text.text;t.options.text.text=e.properties.name,t.model.mergeOption(e),n!=e.properties.name&&this.refreshConnector(t,!0)},r.prototype.deleteByLine=function(t,e){if(t.startNode){var n=t.startNode.model.get("outgoing");if(-1!=(r=l.indexOf(n,t.resourceId))&&n.splice(r,1),this.connectorMap){var i=this.getTwoNodeId(t.startNode,t.endNode,t.options.position);this.connectorMap.removeItem(i,t)}}e.remove(t);var r=l.indexOf(this.connectors,t);-1!=r&&this.connectors.splice(r,1),this.selConnector===t&&(this.selConnector=null)},r.prototype.refreshLineByNode=function(t){for(var e=0,n=this.connectors.length;e<n;e++)this.connectors[e].startNode!=t&&this.connectors[e].endNode!=t||this.refreshConnector(this.connectors[e],!0)},l.inherits(r,i),t.exports=r},function(t,e,n){var nt=n(77),it=n(64),rt=n(105),ot=n(116),st=n(4);function i(){this.connectors=[],this.selConnector=null,this.tempConnector=null}i.prototype.connectorForbidEdit=function(t){for(var e=0;e<this.connectors.length;e++)this.connectors[e].options.isEdit=!t;t&&this.removeConnectorEventListener()},i.prototype.removeConnectorEventListener=function(){0<this.connectors.length&&this.connectors.forEach(function(t){t.polyLine.off("mouseover"),t.polyLine.off("mousemove"),t.polyLine.off("mouseout"),t.curveLine.off("mouseover"),t.curveLine.off("mousemove"),t.curveLine.off("mouseout")})},i.prototype.clearSelectCon=function(){null!=this.selConnector&&this.refreshConnector(this.selConnector)},i.prototype.deleteSelectCon=function(t,e){for(var n=0;n<this.connectors.length;n++)if(this.connectors[n].startNode==t||this.connectors[n].endNode==t){var i=this.connectors[n].startNode.model.get("outgoing"),r=st.indexOf(i,this.connectors[n].resourceId);-1!=r&&i.splice(r,1),e.remove(this.connectors[n]),this.connectors.splice(n,1),n--,this.selConnector=null}},i.prototype.removeLine=function(t,e){this.selConnector=t,this.deleteLine(e)},i.prototype.deleteLine=function(t){if(this.selConnector.startNode){var e=this.selConnector.startNode.model.get("outgoing");if(-1!=(i=st.indexOf(e,this.selConnector.resourceId))&&e.splice(i,1),this.connectorMap){var n=this.getTwoNodeId(this.selConnector.startNode,this.selConnector.endNode,this.selConnector.options.position);this.connectorMap.removeItem(n,this.selConnector)}}t.remove(this.selConnector);var i=st.indexOf(this.connectors,this.selConnector);-1!=i&&this.connectors.splice(i,1),this.selConnector=null},i.prototype.refreshConnector=function(t,e){if(e||!t.turningPoints||t.turningPoints.length<2){t.model&&t.model.get("style.lineType")&&(t.options.style.lineType=t.model.get("style.lineType"));var n=this.getStartEndPoint(t),i=null;t.options.position&&t.options.position.escapeDistance&&(i=t.options.position.escapeDistance);var r=this.connector2Points(t.options.style.lineType,n[0],n[1],n[2],n[3],i);t.refresh(r[0][2])}t.clearHandles()},i.prototype.getStartEndPoint=function(t){var e,n=t.startNode,i=t.endNode;e=n.parent!==i.parent;var r=nt.getRect(n,e).boundingRect,o=[Number(r.x),Number(r.y),Number(r.x)+Number(r.width),Number(r.y)+Number(r.height)],s=nt.getRect(i,e).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)],h=nt.getConnectorPoints(r,n),l=nt.getConnectorPoints(s,i),c=t.options.position;if(c.direction){var u=c.direction.split(",");c.startPos=u[0],c.endPos=u[1]}c.startPos&&c.endPos||(r.x<s.x?(c.startPos="right",c.endPos="left"):(c.startPos="left",c.endPos="right"));var p=this.calcPointExpression(c.startPos,h),d=this.calcPointExpression(c.endPos,l);return p.add(new it(c.startOffset[0],c.startOffset[1])),d.add(new it(c.endOffset[0],c.endOffset[1])),[p,d,o,a]},i.prototype.calcPointExpression=function(t,e){var n={top:e.top.x,left:e.left.y,right:e.right.y,bottom:e.bottom.x,center:e.center.x},i="<% print("+t+") %>",r=parseInt(nt.template(i)(n));if(-1!=t.indexOf("top"))return new it(r,e.top.y);if(-1!=t.indexOf("left"))return new it(e.left.x,r);if(-1!=t.indexOf("right"))return new it(e.right.x,r);if(-1!=t.indexOf("bottom"))return new it(r,e.bottom.y);if(-1!=t.indexOf("center"))return new it(r,e.bottom.y);throw new Error("pos")},i.prototype.manageTempConnector=function(t,e,n,i,r,o){var s=null,a=null,h=nt.getRect(t,!0).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)],c=nt.getConnectorPoints(h,t);this.tempConnector||(this.tempConnector=new rt({isEdit:!1,style:{lineType:n}}));var u=this.tempConnector,p=u.options.position;p.startPos=i||(h.x<e.x?"right":"left"),p.endPos=r||(h.x<e.x?"left":"right"),u.options.style.lineType=n,o&&(s=nt.getRect(o,!0).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)]);var d=this.connector2Points(n,c[p.startPos],e,l,a);return u.refresh(d[0][2]),u},i.prototype.manageReverseTempConnector=function(t,e,n,i,r,o){var s=null,a=null,h=nt.getRect(e,!0).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)],c=nt.getConnectorPoints(h,e);this.tempConnector||(this.tempConnector=new rt({isEdit:!1,style:{lineType:n}}));var u=this.tempConnector,p=u.options.position;p.endPos=i||(h.x<t.x?"right":"left"),p.startPos=r||(h.x<t.x?"left":"right"),u.options.style.lineType=n,o&&(s=nt.getRect(o,!0).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)]);var d=this.connector2Points(n,t,c[p.endPos],a,l);return u.refresh(d[0][2]),u},i.prototype.removeTempConnector=function(t){this.tempConnector&&(t.remove(this.tempConnector),this.tempConnector=null)},i.prototype.connector2Points=function(t,e,n,i,r,o){var s=[30,30];o&&(s=st.isArray(o)?o:[o,o]),ot.group("connectionManager: connector2Points"),ot.info("ConnectionManager: connector2Points ("+t+", "+e+", "+n+", "+i+", "+r+")");var a=[];switch(t){case rt.TYPE_CHAIN:case rt.TYPE_STRAIGHT:var h=[e.clone(),n.clone()];a.push(["straight","straight",h]);break;case rt.TYPE_CURVE:case rt.TYPE_JAGGED:var l=null,c=null;if(null!=i){(p=[]).push(new it(e.x,i[1]-s[0])),p.push(new it(i[2]+s[0],e.y)),p.push(new it(e.x,i[3]+s[0])),p.push(new it(i[0]-s[0],e.y)),l=p[0];for(var u=1;u<p.length;u++)nt.distance(e,p[u])<nt.distance(e,l)&&(l=p[u])}if(null!=r){var p;(p=[]).push(new it(n.x,r[1]-s[1])),p.push(new it(r[2]+s[1],n.y)),p.push(new it(n.x,r[3]+s[1])),p.push(new it(r[0]-s[1],n.y)),c=p[0];for(u=1;u<p.length;u++)nt.distance(n,p[u])<nt.distance(n,c)&&(c=p[u])}var d=[e],f=0;l&&(d.push(l),f=1),c&&d.push(c),d.push(n);var g=it.cloneArray(d);a.push(["s0","s0",g]);var v=it.cloneArray(d),y=it.cloneArray(v);y.splice(f+1,0,new it(y[f].x,y[f+1].y)),a.push(["s1","s1_1",y]);var m=it.cloneArray(v);m.splice(f+1,0,new it(m[f+1].x,m[f].y)),a.push(["s1","s1_2",m]);var _=it.cloneArray(d),x=new it((_[f].x+_[f+1].x)/2,_[f].y),b=new it((_[f].x+_[f+1].x)/2,_[f+1].y);_.splice(f+1,0,x,b),a.push(["s2","s2_1",_]);var w=it.cloneArray(d),C=new it(w[f].x,(w[f].y+w[f+1].y)/2),P=new it(w[f+1].x,(w[f].y+w[f+1].y)/2);w.splice(f+1,0,C,P),a.push(["s2","s2_2",w]);var S=it.cloneArray(d),T=[S[f].x+20,S[f+1].x+20];i&&T.push(i[2]+20),r&&T.push(r[2]+20);var E=nt.max(T),R=new it(E,S[f].y),N=new it(E,S[f+1].y);S.splice(f+1,0,R,N),a.push(["s2","s2_3",S]);var M=it.cloneArray(d),k=[M[f].y-20,M[f+1].y-20];i&&k.push(i[1]-20),r&&k.push(r[1]-20);var A=nt.min(k),L=new it(M[f].x,A),O=new it(M[f+1].x,A);M.splice(f+1,0,L,O),a.push(["s2","s2_4",M]);var z=it.cloneArray(d),I=[z[f].x-20,z[f+1].x-20];i&&I.push(i[0]-20),r&&I.push(r[0]-20);var F=nt.min(I),B=new it(F,z[f].y),j=new it(F,z[f+1].y);z.splice(f+1,0,B,j),a.push(["s2","s2_5",z]);var D=it.cloneArray(d),H=[D[f].y+20,D[f+1].y+20];i&&H.push(i[3]+20),r&&H.push(r[3]+20);var G=nt.max(H),V=new it(D[f].x,G),Y=new it(D[f+1].x,G);D.splice(f+1,0,V,Y),a.push(["s2","s2_6",D]),ot.info("Filter orthogonal solutions. Initial number of solutions = "+a.length);for(var U=[],W=0;W<a.length;W++){var X=a[W][2];nt.orthogonalPath(X)&&U.push(a[W])}if(a=U,ot.info("\n\tOrthogonalSolutions = "+a.length),e.equals(n))ot.info("Start and end point coincide...skip backward solution. I think we will just fall on s0 :)");else{ot.info("Filter backward solutions. Initial number of solutions = "+a.length);var q=[],Q="";for(W=0;W<a.length;W++){X=a[W][2];nt.forwardPath(X)?q.push(a[W]):Q=Q+"\n\t"+X}a=q,ot.info("\n\t ForwardSolutions = "+a.length),0==a.length&&ot.info("Discarded solutions: "+Q)}ot.info("Filter non intersecting solutions. Initial number of solutions = "+a.length);var Z=[];for(W=0;W<a.length;W++){var J=!1,$=(X=a[W][2]).slice();(r||i)&&($=$.slice(1,$.length-1)),i&&(J=J||nt.polylineIntersectsRectangle($,i)),r&&(J=J||nt.polylineIntersectsRectangle($,r)),J||Z.push(a[W])}0!=Z.length&&(a=Z),ot.info("\n\t nonIntersectionSolutions = "+a.length),ot.info("Get first class of solutions with same nr of points"),0==a.length&&ot.info("This is not possible");var K=a[0][2].length,tt=[];for(W=0;W<a.length;W++){(X=a[W][2]).length==K&&tt.push(a[W])}a=tt,ot.info("pick the first solution with 90 degree angles (less turnarounds)");var et=0;for(W=0;W<a.length;W++){X=a[W][2];nt.scorePath(a[et][2])<nt.scorePath(a[W][2])&&(et=W)}a=[a[et]]}return t===rt.TYPE_CURVE&&this.smoothCurve(a),ot.groupEnd(),a},i.prototype.smoothCurve=function(t){st.each(t,function(t){if("s1"==t[0]){var e=t[2],n=nt.collinearReduction(e);t[2]=n}})},t.exports=i},function(t,e){var n={LOG_LEVEL_NONE:0,LOG_LEVEL_DEBUG:1,LOG_LEVEL_INFO:2,LOG_LEVEL_ERROR:3,level:this.LOG_LEVEL_ERROR,debug:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_DEBUG&&"function"==typeof console.debug&&console.debug(t)},info:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_INFO&&console.info(t)},error:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_ERROR&&console.error(t)},group:function(t){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.group&&console.group(t)},groupEnd:function(){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.groupEnd&&console.groupEnd()}};n.level=n.LOG_LEVEL_ERROR,t.exports=n},function(t,e,n){var i=n(106),l=n(4),r=n(113);function o(t,e){this.lineOperations=[],this.isEdit=!0,this.connectionManager=t,this._api=e}o.prototype.addIcon=function(e,t){if(!l.find(t.lineNode.icons,function(t){return t.key===e})){var n=this.creatOperation(e,t);return this._api._getParentZr().add(n),this.bindOperation(t.lineNode),n}this.bindOperation(t.lineNode)},o.prototype.creatOperation=function(t,n){var e=i.createSymbol(n.iconPath,0,0,n.width||15,n.height||15,0,n.color||"#aaaaac");return e.key=t,e._width=n.width||15,e._isLineOperationIcon=!0,e.hide(),n.lineNode.icons.push(e),this.lineOperations.push(e),e.on("click",function(t){if(n.callback)t.data=n,t.lineNode=n.lineNode,n.callback(t);else{var e={};e.event=t,e.type="click",e.elementType="LineOperationIcon",this._api.trigger(e.type,e)}}.bind(this)),e},o.prototype.bindOperation=function(r){if(0!=this.isEdit){var o,s,t=r.middle();s=r.parent&&"SubProcess"==r.parent.nodeType?(o=t[0]+function t(e){return e.parent&&"SubProcess"==e.parent.nodeType?e.position[0]+t(e.parent):e.position[0]}(r.parent),t[1]+function t(e){return e.parent&&"SubProcess"==e.parent.nodeType?e.position[1]+t(e.parent):e.position[1]}(r.parent)):(o=t[0],t[1]);var a=l.map(r.icons,function(t){return t._width}),h=l.reduce(a,function(t,e){return t+e+10},0);l.each(r.icons,function(t,e){for(var n=0,i=0;i<e;i++)n+=a[i]+10;t.attr("position",[o+n-h/2,s+5]),t.show(),t.attachLine=r})}},o.prototype.hideAllLineOperation=function(){l.each(this.lineOperations,function(t){t.hide()})},o.prototype.addDeleteIcon=function(t,e){var n=l.defaults({iconPath:"path://"+r.DEL_SVG,width:12,height:14,lineNode:t,callback:function(t){this._api.remove(t.target.attachLine)}.bind(this)},e,!0);this.addIcon("delete",n)},o.prototype.addChangeLineTypeIcon=function(t,e){var n=l.defaults({iconPath:"path://"+r.CHANGE_LINE_TYPE_SVG,width:15,height:15,lineNode:t,callback:function(){this._api.changeSelectConnectorType()}.bind(this)},e,!0);this.addIcon("change",n)},t.exports=o},function(t,e,n){var i=n(3),u=n(4),p=n(77),o=["virtualXTop","virtualXCenter","virtualXBottom"],s=["virtualYLeft","virtualYCenter","virtualYRight"],r={virtualXLines:[],virtualYLines:[],createLine:function(t){return new i.Line({style:{stroke:"#5693f78c"},z:3,name:t})},createGuidelines:function(t){if(this.virtualXLines.length<3){this.virtualXLines=[];for(var e=0;e<3;e++){var n=this.createLine(o[e]);this.virtualXLines.push(n),t.add(n)}}if(this.virtualYLines.length<3){this.virtualYLines=[];for(var i=0;i<3;i++){var r=this.createLine(s[e]);this.virtualYLines.push(r),t.add(r)}}},resetLines:function(){u.each(this.virtualXLines,function(t){t.attr("shape",{x2:0})}),u.each(this.virtualYLines,function(t){t.attr("shape",{y2:0})})},destoryLines:function(t){for(var e=0;e<this.virtualXLines.length;e++)t.remove(this.virtualXLines[e]);for(var n=0;n<this.virtualYLines.length;n++)t.remove(this.virtualYLines[n]);this.virtualXLines=[],this.virtualYLines=[]},getMinMax:function(t){var e=t[0].x,n=t[0].y,i=t[0].x,r=t[0].y;return u.each(t,function(t){e>t.x&&(e=t.x),n>t.y&&(n=t.y),i<t.x&&(i=t.x),r<t.y&&(r=t.y)}),{minX:e,minY:n,maxX:i,maxY:r}},judgeAlignment:function(e,r,t,i,o){var s=this,a=e.rotation,h=u.find(t,function(t){return t.id==e.id});if(h){var n=h.points,l={};if(n[0].x=r[0]-h.width/2,n[0].y=r[1]-h.height/2,n[1].x=r[0]+h.width/2,n[1].y=r[1]-h.height/2,n[2].x=r[0]-h.width/2,n[2].y=r[1]+h.height/2,n[3].x=r[0]+h.width/2,n[3].y=r[1]+h.height/2,0<Math.abs(a)){var c=[];u.each(n,function(t){var e=p.calculatePoints(t,{x:r[0],y:r[1]},a),n=parseInt(e.x,10),i=parseInt(e.y,10);c.push({x:n,y:i})}),l=this.getMinMax(c)}else l=this.getMinMax(n);this.resetLines(),u.each(t,function(t){if(t.id!=h.id){var e=t.position,n=s.getMinMax(t.points);l.minY!=n.minY&&l.minY!=e[1]&&l.minY!=n.maxY||s.virtualXLines[0].attr({position:[0,l.minY],shape:{x2:i}}),r[1]!=e[1]&&r[1]!=n.minY&&r[1]!=n.maxY||s.virtualXLines[1].attr({position:[0,r[1]],shape:{x2:i}}),l.maxY!=n.maxY&&l.maxY!=e[1]&&l.maxY!=n.minY||s.virtualXLines[2].attr({position:[0,l.maxY],shape:{x2:i}}),l.minX!=n.minX&&l.minX!=e[0]&&l.minX!=n.maxX||s.virtualYLines[0].attr({position:[l.minX,0],shape:{y2:o}}),r[0]!=e[0]&&r[0]!=n.minX&&r[0]!=n.maxX||s.virtualYLines[1].attr({position:[r[0],0],shape:{y2:o}}),l.maxX!=n.maxX&&l.maxX!=e[0]&&l.maxX!=n.minX||s.virtualYLines[2].attr({position:[l.maxX,0],shape:{y2:o}})}})}}};t.exports=r},function(t,e,n){"use strict";var i;"undefined"!=typeof Promise&&(i=Promise);var r=n(120)();r.noConflict=function(){try{Promise===r&&(Promise=i)}catch(t){}return r},t.exports=r},function(k,t,A){(function(M){"use strict";k.exports=function(){function h(){return new u("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")}function a(){return new T.PromiseInspection(this._target())}function s(t){return T.reject(new u(t))}function l(){}var d,c={},f=A(122);d=f.isNode?function(){var t=M.domain;return void 0===t&&(t=null),t}:function(){return null},f.notEnumerableProp(T,"_getDomain",d);var t=A(123),e=A(124),g=new e;t.defineProperty(T,"_async",{value:g});var n=A(129),u=T.TypeError=n.TypeError;T.RangeError=n.RangeError;var v=T.CancellationError=n.CancellationError;T.TimeoutError=n.TimeoutError,T.OperationalError=n.OperationalError,T.RejectionError=n.OperationalError,T.AggregateError=n.AggregateError;var y=function(){},p={},m={},_=A(130)(T,y),x=A(131)(T,y,_,s,l),i=A(132)(T),r=i.create,b=A(133)(T,i),w=(b.CapturedTrace,A(134)(T,_,m)),C=A(135)(m),o=A(136),P=f.errorObj,S=f.tryCatch;function T(t){t!==y&&function(t,e){if(null==t||t.constructor!==T)throw new u("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new u("expecting a function but got "+f.classString(e))}(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function E(t){this.promise._resolveCallback(t)}function R(t){this.promise._rejectCallback(t,!1)}function N(t){var e=new T(y);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return T.prototype.toString=function(){return"[object Promise]"},T.prototype.caught=T.prototype.catch=function(t){var e=arguments.length;if(1<e){var n,i=new Array(e-1),r=0;for(n=0;n<e-1;++n){var o=arguments[n];if(!f.isObject(o))return s("Catch statement predicate: expecting an object but got "+f.classString(o));i[r++]=o}return i.length=r,t=arguments[n],this.then(void 0,C(i,t,this))}return this.then(void 0,t)},T.prototype.reflect=function(){return this._then(a,a,void 0,this,void 0)},T.prototype.then=function(t,e){if(b.warnings()&&0<arguments.length&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+f.classString(t);1<arguments.length&&(n+=", "+f.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},T.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},T.prototype.spread=function(t){return"function"!=typeof t?s("expecting a function but got "+f.classString(t)):this.all()._then(t,void 0,void 0,p,void 0)},T.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},T.prototype.all=function(){return 0<arguments.length&&this._warn(".all() was passed arguments but it does not take any"),new x(this).promise()},T.prototype.error=function(t){return this.caught(f.originatesFromRejection,t)},T.getNewLibraryCopy=k.exports,T.is=function(t){return t instanceof T},T.fromNode=T.fromCallback=function(t){var e=new T(y);e._captureStackTrace();var n=1<arguments.length&&!!Object(arguments[1]).multiArgs,i=S(t)(o(e,n));return i===P&&e._rejectCallback(i.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},T.all=function(t){return new x(t).promise()},T.resolve=T.fulfilled=T.cast=function(t){var e=_(t);return e instanceof T||((e=new T(y))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},T.reject=T.rejected=function(t){var e=new T(y);return e._captureStackTrace(),e._rejectCallback(t,!0),e},T.setScheduler=function(t){if("function"!=typeof t)throw new u("expecting a function but got "+f.classString(t));return g.setScheduler(t)},T.prototype._then=function(t,e,n,i,r){var o=void 0!==r,s=o?r:new T(y),a=this._target(),h=a._bitField;o||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===i&&0!=(2097152&this._bitField)&&(i=0!=(50397184&h)?this._boundValue():a===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var l=d();if(0!=(50397184&h)){var c,u,p=a._settlePromiseCtx;0!=(33554432&h)?(u=a._rejectionHandler0,c=t):0!=(16777216&h)?(u=a._fulfillmentHandler0,c=e,a._unsetRejectionIsUnhandled()):(p=a._settlePromiseLateCancellationObserver,u=new v("late cancellation observer"),a._attachExtraTrace(u),c=e),g.invoke(p,a,{handler:null===l?c:"function"==typeof c&&f.domainBind(l,c),promise:s,receiver:i,value:u})}else a._addCallbacks(t,e,s,i,l);return s},T.prototype._length=function(){return 65535&this._bitField},T.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},T.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},T.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},T.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},T.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},T.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},T.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},T.prototype._isFinal=function(){return 0<(4194304&this._bitField)},T.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},T.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},T.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},T.prototype._setAsyncGuaranteed=function(){g.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},T.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==c)return void 0===e&&this._isBound()?this._boundValue():e},T.prototype._promiseAt=function(t){return this[4*t-4+2]},T.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},T.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},T.prototype._boundValue=function(){},T.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,n=t._rejectionHandler0,i=t._promise0,r=t._receiverAt(0);void 0===r&&(r=c),this._addCallbacks(e,n,i,r,null)},T.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),i=t._rejectionHandlerAt(e),r=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=c),this._addCallbacks(n,i,r,o,null)},T.prototype._addCallbacks=function(t,e,n,i,r){var o=this._length();if(65531<=o&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=i,"function"==typeof t&&(this._fulfillmentHandler0=null===r?t:f.domainBind(r,t)),"function"==typeof e&&(this._rejectionHandler0=null===r?e:f.domainBind(r,e));else{var s=4*o-4;this[2+s]=n,this[3+s]=i,"function"==typeof t&&(this[0+s]=null===r?t:f.domainBind(r,t)),"function"==typeof e&&(this[1+s]=null===r?e:f.domainBind(r,e))}return this._setLength(o+1),o},T.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},T.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(h(),!1);var n=_(t,this);if(!(n instanceof T))return this._fulfill(t);e&&this._propagateFrom(n,2);var i=n._target();if(i!==this){var r=i._bitField;if(0==(50397184&r)){var o=this._length();0<o&&i._migrateCallback0(this);for(var s=1;s<o;++s)i._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!=(33554432&r))this._fulfill(i._value());else if(0!=(16777216&r))this._reject(i._reason());else{var a=new v("late cancellation observer");i._attachExtraTrace(a),this._reject(a)}}else this._reject(h())}},T.prototype._rejectCallback=function(t,e,n){var i=f.ensureErrorObject(t),r=i===t;if(!r&&!n&&b.warnings()){var o="a promise was rejected with a non-error: "+f.classString(t);this._warn(o,!0)}this._attachExtraTrace(i,!!e&&r),this._reject(t)},T.prototype._resolveFromExecutor=function(t){if(t!==y){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,i=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==i&&e._rejectCallback(i,!0)}},T.prototype._settlePromiseFromHandler=function(t,e,n,i){var r=i._bitField;if(0==(65536&r)){var o;i._pushContext(),e===p?n&&"number"==typeof n.length?o=S(t).apply(this._boundValue(),n):(o=P).e=new u("cannot .spread() a non-array: "+f.classString(n)):o=S(t).call(e,n);var s=i._popContext();0==(65536&(r=i._bitField))&&(o===m?i._reject(n):o===P?i._rejectCallback(o.e,!1):(b.checkForgottenReturns(o,s,"",i,this),i._resolveCallback(o)))}},T.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},T.prototype._followee=function(){return this._rejectionHandler0},T.prototype._setFollowee=function(t){this._rejectionHandler0=t},T.prototype._settlePromise=function(t,e,n,i){var r=t instanceof T,o=this._bitField,s=0!=(134217728&o);0!=(65536&o)?(r&&t._invokeInternalOnCancel(),n instanceof w&&n.isFinallyHandler()?(n.cancelPromise=t,S(e).call(n,i)===P&&t._reject(P.e)):e===a?t._fulfill(a.call(n)):n instanceof l?n._promiseCancelled(t):r||t instanceof x?t._cancel():n.cancel()):"function"==typeof e?r?(s&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,i,t)):e.call(n,i,t):n instanceof l?n._isResolved()||(0!=(33554432&o)?n._promiseFulfilled(i,t):n._promiseRejected(i,t)):r&&(s&&t._setAsyncGuaranteed(),0!=(33554432&o)?t._fulfill(i):t._reject(i))},T.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,i=t.receiver,r=t.value;"function"==typeof e?n instanceof T?this._settlePromiseFromHandler(e,i,r,n):e.call(i,r,n):n instanceof T&&n._reject(r)},T.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},T.prototype._settlePromise0=function(t,e,n){var i=this._promise0,r=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,t,r,e)},T.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[2+e]=this[3+e]=this[0+e]=this[1+e]=void 0},T.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=h();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,0<(65535&e)&&(0!=(134217728&e)?this._settlePromises():g.settlePromises(this))}},T.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return g.fatalError(t,f.isNode);0<(65535&e)?g.settlePromises(this):this._ensurePossibleRejectionHandled()}},T.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var i=this._fulfillmentHandlerAt(n),r=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(r,i,o,e)}},T.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var i=this._rejectionHandlerAt(n),r=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(r,i,o,e)}},T.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(0<e){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,t),this._fulfillPromises(e,i)}this._setLength(0)}this._clearCancellationData()},T.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},T.defer=T.pending=function(){return b.deprecated("Promise.defer","new Promise"),{promise:new T(y),resolve:E,reject:R}},f.notEnumerableProp(T,"_makeSelfResolutionError",h),A(137)(T,y,_,s,b),A(138)(T,y,_,b),A(139)(T,x,s,b),A(140)(T),A(141)(T),A(142)(T,x,_,y,g,d),(T.Promise=T).version="3.5.0",A(143)(T,x,s,_,y,b),A(144)(T),A(145)(T,s,_,r,y,b),A(146)(T,y,b),A(147)(T,s,y,_,l,b),A(148)(T),A(149)(T,y),A(150)(T,x,_,s),A(151)(T,y,_,s),A(152)(T,x,s,_,y,b),A(153)(T,x,b),A(154)(T,x,s),A(155)(T,y),A(156)(T,y),A(157)(T),f.toFastProperties(T),f.toFastProperties(T.prototype),N({a:1}),N({b:2}),N({c:3}),N(1),N(function(){}),N(void 0),N(!1),N(new T(y)),b.setBounds(e.firstLineError,f.lastLineError),T}}).call(t,A(121))},function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var h,l=[],c=!1,u=-1;function p(){c&&h&&(c=!1,h.length?l=h.concat(l):u=-1,l.length&&d())}function d(){if(!c){var t=a(p);c=!0;for(var e=l.length;e;){for(h=l,l=[];++u<e;)h&&h[u].run();u=-1,e=l.length}h=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||c||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(H,t,G){(function(t,e){"use strict";var l=G(123),n="undefined"==typeof navigator,i={e:{}},r,o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0!==this?this:null;function s(){try{var t=r;return r=null,t.apply(this,arguments)}catch(t){return i.e=t,i}}function a(t){return r=t,s}var h=function(e,n){var i={}.hasOwnProperty;function t(){for(var t in this.constructor=e,(this.constructor$=n).prototype)i.call(n.prototype,t)&&"$"!==t.charAt(t.length-1)&&(this[t+"$"]=n.prototype[t])}return t.prototype=n.prototype,e.prototype=new t,e.prototype};function c(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function u(t){return"function"==typeof t||"object"==typeof t&&null!==t}function p(t){return c(t)?new Error(P(t)):t}function d(t,e){var n,i=t.length,r=new Array(i+1);for(n=0;n<i;++n)r[n]=t[n];return r[n]=e,r}function f(t,e,n){if(!l.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var i=Object.getOwnPropertyDescriptor(t,e);return null!=i?null==i.get&&null==i.set?i.value:n:void 0}function g(t,e,n){if(c(t))return t;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return l.defineProperty(t,e,i),t}function v(t){throw t}var y=function(){function a(t){for(var e=0;e<r.length;++e)if(r[e]===t)return!0;return!1}var r=[Array.prototype,Object.prototype,Function.prototype];if(l.isES5){var h=Object.getOwnPropertyNames;return function(t){for(var e=[],n=Object.create(null);null!=t&&!a(t);){var i;try{i=h(t)}catch(t){return e}for(var r=0;r<i.length;++r){var o=i[r];if(!n[o]){n[o]=!0;var s=Object.getOwnPropertyDescriptor(t,o);null!=s&&null==s.get&&null==s.set&&e.push(o)}}t=l.getPrototypeOf(t)}return e}}var o={}.hasOwnProperty;return function(t){if(a(t))return[];var e=[];t:for(var n in t)if(o.call(t,n))e.push(n);else{for(var i=0;i<r.length;++i)if(o.call(r[i],n))continue t;e.push(n)}return e}}(),m=/this\s*\.\s*\S+\s*=/;function _(t){try{if("function"==typeof t){var e=l.names(t.prototype),n=l.isES5&&1<e.length,i=0<e.length&&!(1===e.length&&"constructor"===e[0]),r=m.test(t+"")&&0<l.names(t).length;if(n||i||r)return!0}return!1}catch(t){return!1}}function x(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}var b=/^[a-z$_][a-z$_0-9]*$/i;function w(t){return b.test(t)}function C(t,e,n){for(var i=new Array(t),r=0;r<t;++r)i[r]=e+r+n;return i}function P(t){try{return t+""}catch(t){return"[no string representation]"}}function S(t){return null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function T(t){try{g(t,"isOperational",!0)}catch(t){}}function E(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function R(t){return S(t)&&l.propertyIsWritable(t,"stack")}var N="stack"in new Error?function(t){return R(t)?t:new Error(P(t))}:function(t){if(R(t))return t;try{throw new Error(P(t))}catch(t){return t}};function M(t){return{}.toString.call(t)}function k(t,e,n){for(var i=l.names(t),r=0;r<i.length;++r){var o=i[r];if(n(o))try{l.defineProperty(e,o,l.getDescriptor(t,o))}catch(t){}}}var A=function(t){return l.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var L="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],i=t[Symbol.iterator]();!(e=i.next()).done;)n.push(e.value);return n};A=function(t){return l.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?L(t):null}}var O=void 0!==e&&"[object process]"===M(e).toLowerCase(),z=void 0!==e&&void 0!==e.env;function I(t){return z?e.env[t]:void 0}function F(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}}function B(t,e){return t.bind(e)}var j={isClass:_,isIdentifier:w,inheritedDataKeys:y,getDataPropertyOrDefault:f,thrower:v,isArray:l.isArray,asArray:A,notEnumerableProp:g,isPrimitive:c,isObject:u,isError:S,canEvaluate:n,errorObj:i,tryCatch:a,inherits:h,withAppended:d,maybeWrapAsError:p,toFastProperties:x,filledRange:C,toString:P,canAttachTrace:R,ensureErrorObject:N,originatesFromRejection:E,markAsOriginatingFromRejection:T,classString:M,copyDescriptors:k,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:O,hasEnvVariables:z,env:I,global:o,getNativePromise:F,domainBind:B},D;j.isRecentNode=j.isNode&&(D=e.versions.node.split(".").map(Number),0===D[0]&&10<D[1]||0<D[0]),j.isNode&&j.toFastProperties(e);try{throw new Error}catch(t){j.lastLineError=t}H.exports=j}).call(t,function(){return this}(),G(121))},function(t,e){var n=function(){"use strict";return void 0===this}();if(n)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{function i(t){var e=[];for(var n in t)r.call(t,n)&&e.push(n);return e}var r={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype;t.exports={isArray:function(t){try{return"[object Array]"===o.call(t)}catch(t){return!1}},keys:i,names:i,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return s}},isES5:n,propertyIsWritable:function(){return!0}}}},function(l,t,c){(function(n){"use strict";var e;try{throw new Error}catch(t){e=t}var i=c(125),r=c(128),t=c(122);function o(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new r(16),this._normalQueue=new r(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=i}function s(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function a(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function h(t){this._normalQueue._pushOne(t),this._queueTick()}o.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},o.prototype.hasCustomScheduler=function(){return this._customScheduler},o.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},o.prototype.disableTrampolineIfNecessary=function(){t.hasDevTools&&(this._trampolineEnabled=!1)},o.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},o.prototype.fatalError=function(t,e){e?(n.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),n.exit(2)):this.throwLater(t)},o.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},o.prototype.settlePromises=t.hasDevTools?(o.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?s.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},o.prototype.invoke=function(t,e,n){this._trampolineEnabled?a.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},function(t){this._trampolineEnabled?h.call(this,t):this._schedule(function(){t._settlePromises()})}):(o.prototype.invokeLater=s,o.prototype.invoke=a,h),o.prototype._drainQueue=function(t){for(;0<t.length();){var e=t.shift();if("function"==typeof e){var n=t.shift(),i=t.shift();e.call(n,i)}else e._settlePromises()}},o.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},o.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},o.prototype._reset=function(){this._isTickUsed=!1},l.exports=o,l.exports.firstLineError=e}).call(t,c(121))},function(l,t,c){(function(e,n,i){"use strict";var t,r=c(122),o=r.getNativePromise();if(r.isNode&&"undefined"==typeof MutationObserver){var s=e.setImmediate,a=n.nextTick;t=r.isRecentNode?function(t){s.call(e,t)}:function(t){a.call(n,t)}}else if("function"==typeof o&&"function"==typeof o.resolve){var h=o.resolve();t=function(t){h.then(t)}}else t="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?void 0!==i?function(t){i(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var n=document.createElement("div"),i={attributes:!0},r=!1,o=document.createElement("div");new MutationObserver(function(){n.classList.toggle("foo"),r=!1}).observe(o,i);return function(t){var e=new MutationObserver(function(){e.disconnect(),t()});e.observe(n,i),r||(r=!0,o.classList.toggle("foo"))}}();l.exports=t}).call(t,function(){return this}(),c(121),c(126).setImmediate)},function(t,r,o){(function(t){var e=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}r.setTimeout=function(){return new i(n.call(setTimeout,e,arguments),clearTimeout)},r.setInterval=function(){return new i(n.call(setInterval,e,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(e,this._id)},r.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},o(127),r.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,r.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(r,function(){return this}())},function(t,e,n){(function(t,f){!function(n,i){"use strict";if(!n.setImmediate){var r,o,e,s,a=1,h={},l=!1,c=n.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(n);t=t&&t.setTimeout?t:n,r="[object process]"==={}.toString.call(n.process)?function(t){f.nextTick(function(){p(t)})}:function(){if(n.postMessage&&!n.importScripts){var t=!0,e=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=e,t}}()?(s="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",d,!1):n.attachEvent("onmessage",d),function(t){n.postMessage(s+t,"*")}):n.MessageChannel?((e=new MessageChannel).port1.onmessage=function(t){p(t.data)},function(t){e.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(o=c.documentElement,function(t){var e=c.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):function(t){setTimeout(p,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return h[a]=i,r(a),a++},t.clearImmediate=u}function u(t){delete h[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=h[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n)}}(e)}finally{u(t),l=!1}}}}function d(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(s)&&p(+t.data.slice(s.length))}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,function(){return this}(),n(121))},function(t,e){"use strict";function n(t){this._capacity=t,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(t){return this._capacity<t},n.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},n.prototype.push=function(t,e,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var r=this._front+i-3;this._checkCapacity(i);var o=this._capacity-1;this[0+r&o]=t,this[1+r&o]=e,this[2+r&o]=n,this._length=i},n.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,n,i,r){for(var o=0;o<r;++o)n[o+i]=t[o+e],t[o+e]=void 0}(this,0,this,e,this._front+this._length&e-1)},t.exports=n},function(t,e,n){"use strict";var i,r,o=n(123),s=o.freeze,a=n(122),h=a.inherits,l=a.notEnumerableProp;function c(e,n){function i(t){if(!(this instanceof i))return new i(t);l(this,"message","string"==typeof t?t:n),l(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return h(i,Error),i}var u=c("Warning","warning"),p=c("CancellationError","cancellation error"),d=c("TimeoutError","timeout error"),f=c("AggregateError","aggregate error");try{i=TypeError,r=RangeError}catch(t){i=c("TypeError","type error"),r=c("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<g.length;++v)"function"==typeof Array.prototype[g[v]]&&(f.prototype[g[v]]=Array.prototype[g[v]]);o.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var y=0;function m(t){if(!(this instanceof m))return new m(t);l(this,"name","OperationalError"),l(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(l(this,"message",t.message),l(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}f.prototype.toString=function(){var t=Array(4*y+1).join(" "),e="\n"+t+"AggregateError of:\n";y++,t=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",r=i.split("\n"),o=0;o<r.length;++o)r[o]=t+r[o];e+=(i=r.join("\n"))+"\n"}return y--,e},h(m,Error);var _=Error.__BluebirdErrorTypes__;_||(_=s({CancellationError:p,TimeoutError:d,OperationalError:m,RejectionError:m,AggregateError:f}),o.defineProperty(Error,"__BluebirdErrorTypes__",{value:_,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:i,RangeError:r,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:u}},function(t,e,n){"use strict";t.exports=function(a,h){var l=n(122),c=l.errorObj,r=l.isObject;var o={}.hasOwnProperty;return function(t,e){if(r(t)){if(t instanceof a)return t;var n=function(t){try{return function(t){return t.then}(t)}catch(t){return c.e=t,c}}(t);if(n===c){e&&e._pushContext();var i=a.reject(n.e);return e&&e._popContext(),i}if("function"==typeof n){if(function(t){try{return o.call(t,"_promise0")}catch(t){return!1}}(t)){i=new a(h);return t._then(i._fulfill,i._reject,void 0,i,null),i}return function(t,e,n){var i=new a(h),r=i;n&&n._pushContext();i._captureStackTrace(),n&&n._popContext();var o=!0,s=l.tryCatch(e).call(t,function(t){if(!i)return;i._resolveCallback(t),i=null},function(t){if(!i)return;i._rejectCallback(t,o,!0),i=null});o=!1,i&&s===c&&(i._rejectCallback(s.e,!0,!0),i=null);return r}(t,n,e)}}return t}}},function(t,e,i){"use strict";t.exports=function(a,n,h,s,t){var l=i(122);l.isArray;function e(t){var e=this._promise=new a(n);t instanceof a&&e._propagateFrom(t,3),e._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return l.inherits(e,t),e.prototype.length=function(){return this._length},e.prototype.promise=function(){return this._promise},e.prototype._init=function t(e,n){var i=h(this._values,this._promise);if(i instanceof a){var r=(i=i._target())._bitField;if(this._values=i,0==(50397184&r))return this._promise._setAsyncGuaranteed(),i._then(t,this._reject,void 0,this,n);if(0==(33554432&r))return 0!=(16777216&r)?this._reject(i._reason()):this._cancel();i=i._value()}if(null!==(i=l.asArray(i)))0!==i.length?this._iterate(i):-5===n?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(n));else{var o=s("expecting an array or an iterable object but got "+l.classString(i)).reason();this._promise._rejectCallback(o,!1)}},e.prototype._iterate=function(t){var e=this.getActualLength(t.length);this._length=e,this._values=this.shouldCopyValues()?new Array(e):this._values;for(var n=this._promise,i=!1,r=null,o=0;o<e;++o){var s=h(t[o],n);r=s instanceof a?(s=s._target())._bitField:null,i?null!==r&&s.suppressUnhandledRejections():null!==r?0==(50397184&r)?(s._proxy(this,o),this._values[o]=s):i=0!=(33554432&r)?this._promiseFulfilled(s._value(),o):0!=(16777216&r)?this._promiseRejected(s._reason(),o):this._promiseCancelled(o):i=this._promiseFulfilled(s,o)}i||n._setAsyncGuaranteed()},e.prototype._isResolved=function(){return null===this._values},e.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},e.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},e.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},e.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},e.prototype._promiseCancelled=function(){return this._cancel(),!0},e.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},e.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof a)t.cancel();else for(var e=0;e<t.length;++e)t[e]instanceof a&&t[e].cancel()}},e.prototype.shouldCopyValues=function(){return!0},e.prototype.getActualLength=function(t){return t},e}},function(t,e){"use strict";t.exports=function(o){var s=!1,n=[];function a(){this._trace=new a.CapturedTrace(h())}function h(){var t=n.length-1;if(0<=t)return n[t]}return o.prototype._promiseCreated=function(){},o.prototype._pushContext=function(){},o.prototype._popContext=function(){return null},o._peekContext=o.prototype._peekContext=function(){},a.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},a.prototype._popContext=function(){if(void 0===this._trace)return null;var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e},a.CapturedTrace=null,a.create=function(){if(s)return new a},a.deactivateLongStackTraces=function(){},a.activateLongStackTraces=function(){var t=o.prototype._pushContext,e=o.prototype._popContext,n=o._peekContext,i=o.prototype._peekContext,r=o.prototype._promiseCreated;a.deactivateLongStackTraces=function(){o.prototype._pushContext=t,o.prototype._popContext=e,o._peekContext=n,o.prototype._peekContext=i,o.prototype._promiseCreated=r,s=!1},s=!0,o.prototype._pushContext=a.prototype._pushContext,o.prototype._popContext=a.prototype._popContext,o._peekContext=o.prototype._peekContext=h,o.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},a}},function(t,e,J){(function(Z){"use strict";t.exports=function(s,n){var i,r,o,a=s._getDomain,h=s._async,l=J(129).Warning,c=J(122),u=c.canAttachTrace,p=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,f=/\((?:timers\.js):\d+:\d+\)/,g=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,d=null,v=null,y=!1,t=!(0==c.env("BLUEBIRD_DEBUG")||!c.env("BLUEBIRD_DEBUG")&&"development"!==c.env("NODE_ENV")),e=!(0==c.env("BLUEBIRD_WARNINGS")||!t&&!c.env("BLUEBIRD_WARNINGS")),m=!(0==c.env("BLUEBIRD_LONG_STACK_TRACES")||!t&&!c.env("BLUEBIRD_LONG_STACK_TRACES")),_=0!=c.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(e||!!c.env("BLUEBIRD_W_FORGOTTEN_RETURN"));s.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},s.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),h.invokeLater(this._notifyUnhandledRejection,this,void 0))},s.prototype._notifyUnhandledRejectionIsHandled=function(){H("rejectionHandled",i,void 0,this)},s.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},s.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},s.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),H("unhandledRejection",r,t,this)}},s.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},s.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},s.prototype._isUnhandledRejectionNotified=function(){return 0<(262144&this._bitField)},s.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},s.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},s.prototype._isRejectionUnhandled=function(){return 0<(1048576&this._bitField)},s.prototype._warn=function(t,e,n){return F(t,e,n||this)},s.onPossiblyUnhandledRejection=function(t){var e=a();r="function"==typeof t?null===e?t:c.domainBind(e,t):void 0},s.onUnhandledRejectionHandled=function(t){var e=a();i="function"==typeof t?null===e?t:c.domainBind(e,t):void 0};var x=function(){};s.longStackTraces=function(){if(h.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!Q.longStackTraces&&V()){var t=s.prototype._captureStackTrace,e=s.prototype._attachExtraTrace;Q.longStackTraces=!0,x=function(){if(h.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");s.prototype._captureStackTrace=t,s.prototype._attachExtraTrace=e,n.deactivateLongStackTraces(),h.enableTrampoline(),Q.longStackTraces=!1},s.prototype._captureStackTrace=z,s.prototype._attachExtraTrace=I,n.activateLongStackTraces(),h.disableTrampolineIfNecessary()}},s.hasLongStackTraces=function(){return Q.longStackTraces&&V()};var b=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return c.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!c.global.dispatchEvent(n)}}if("function"!=typeof Event)return(t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),c.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!c.global.dispatchEvent(n)};var t=new Event("CustomEvent");return c.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!c.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),w=c.isNode?function(){return Z.emit.apply(Z,arguments)}:c.global?function(t){var e="on"+t.toLowerCase(),n=c.global[e];return!!n&&(n.apply(c.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function C(t,e){return{promise:e}}var P={promiseCreated:C,promiseFulfilled:C,promiseRejected:C,promiseResolved:C,promiseCancelled:C,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:C},S=function(t){var e=!1;try{e=w.apply(null,arguments)}catch(t){h.throwLater(t),e=!0}var n=!1;try{n=b(t,P[t].apply(null,arguments))}catch(t){h.throwLater(t),n=!0}return n||e};function T(){return!1}function E(t,e,n){var i=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+c.toString(t));i._attachCancellationCallback(t)})}catch(t){return t}}function R(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?c.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function N(){return this._onCancelField}function M(t){this._onCancelField=t}function k(){this._cancellationParent=void 0,this._onCancelField=void 0}function A(t,e){if(0!=(1&e)){var n=(this._cancellationParent=t)._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}s.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?s.longStackTraces():!t.longStackTraces&&s.hasLongStackTraces()&&x()),"warnings"in t){var e=t.warnings;Q.warnings=!!e,_=Q.warnings,c.isObject(e)&&"wForgottenReturn"in e&&(_=!!e.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!Q.cancellation){if(h.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");s.prototype._clearCancellationData=k,s.prototype._propagateFrom=A,s.prototype._onCancel=N,s.prototype._setOnCancel=M,s.prototype._attachCancellationCallback=R,s.prototype._execute=E,L=A,Q.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!Q.monitoring?(Q.monitoring=!0,s.prototype._fireEvent=S):!t.monitoring&&Q.monitoring&&(Q.monitoring=!1,s.prototype._fireEvent=T)),s},s.prototype._fireEvent=T,s.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},s.prototype._onCancel=function(){},s.prototype._setOnCancel=function(t){},s.prototype._attachCancellationCallback=function(t){},s.prototype._captureStackTrace=function(){},s.prototype._attachExtraTrace=function(){},s.prototype._clearCancellationData=function(){},s.prototype._propagateFrom=function(t,e){};var L=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)};function O(){var t=this._boundTo;return void 0!==t&&t instanceof s?t.isFulfilled()?t.value():void 0:t}function z(){this._trace=new X(this._peekContext())}function I(t,e){if(u(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var i=j(t);c.notEnumerableProp(t,"stack",i.message+"\n"+i.stack.join("\n")),c.notEnumerableProp(t,"__stackCleaned__",!0)}}}function F(t,e,n){if(Q.warnings){var i,r=new l(t);if(e)n._attachExtraTrace(r);else if(Q.longStackTraces&&(i=s._peekContext()))i.attachExtraTrace(r);else{var o=j(r);r.stack=o.message+"\n"+o.stack.join("\n")}S("warning",r)||D(r,"",!0)}}function B(t){for(var e=[],n=0;n<t.length;++n){var i=t[n],r="    (No stack trace)"===i||d.test(i),o=r&&Y(i);r&&!o&&(y&&" "!==i.charAt(0)&&(i="    "+i),e.push(i))}return e}function j(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&0<e.length?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var i=e[n];if("    (No stack trace)"===i||d.test(i))break}return 0<n&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:B(e)}}function D(t,e,n){if("undefined"!=typeof console){var i;if(c.isObject(t)){var r=t.stack;i=e+v(r,t)}else i=e+String(t);"function"==typeof o?o(i,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(i)}}function H(t,e,n,i){var r=!1;try{"function"==typeof e&&(r=!0,"rejectionHandled"===t?e(i):e(n,i))}catch(t){h.throwLater(t)}"unhandledRejection"===t?S(t,n,i)||r||D(n,"Unhandled rejection "):S(t,i)}function G(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():c.toString(t);if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){if(t.length<41)return t;return t.substr(0,38)+"..."}(e)+">, no stack trace)"}function V(){return"function"==typeof q}var Y=function(){return!1},U=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function W(t){var e=t.match(U);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function X(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);q(this,X),32<e&&this.uncycle()}c.inherits(X,Error),(n.CapturedTrace=X).prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},i=0,r=this;void 0!==r;++i)e.push(r),r=r._parent;for(i=(t=this._length=i)-1;0<=i;--i){var o=e[i].stack;void 0===n[o]&&(n[o]=i)}for(i=0;i<t;++i){var s=n[e[i].stack];if(void 0!==s&&s!==i){0<s&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[i]._parent=void 0,e[i]._length=1;var a=0<i?e[i-1]:this;s<t-1?(a._parent=e[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var h=a._length+1,l=i-2;0<=l;--l)e[l]._length=h,h++;return}}}},X.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=j(t),n=e.message,i=[e.stack],r=this;void 0!==r;)i.push(B(r.stack.split("\n"))),r=r._parent;!function(t){for(var e=t[0],n=1;n<t.length;++n){for(var i=t[n],r=e.length-1,o=e[r],s=-1,a=i.length-1;0<=a;--a)if(i[a]===o){s=a;break}for(a=s;0<=a;--a){var h=i[a];if(e[r]!==h)break;e.pop(),r--}e=i}}(i),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(i),c.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,i)),c.notEnumerableProp(t,"__stackCleaned__",!0)}};var q=function(){function t(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():G(e)}var e=/^\s*at\s*/;if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,d=e,v=t;var n=Error.captureStackTrace;return Y=function(t){return p.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var i,r=new Error;if("string"==typeof r.stack&&0<=r.stack.split("\n")[0].indexOf("stackDetection@"))return d=/@/,v=t,y=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){i="stack"in t}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(v=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?G(e):e.toString()},null):(d=e,v=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(o=function(t){console.warn(t)},c.isNode&&Z.stderr.isTTY?o=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:c.isNode||"string"!=typeof(new Error).stack||(o=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var Q={warnings:e,longStackTraces:!1,cancellation:!1,monitoring:!1};return m&&s.longStackTraces(),{longStackTraces:function(){return Q.longStackTraces},warnings:function(){return Q.warnings},cancellation:function(){return Q.cancellation},monitoring:function(){return Q.monitoring},propagateFromFunction:function(){return L},boundValueFunction:function(){return O},checkForgottenReturns:function(t,e,n,i,r){if(void 0===t&&null!==e&&_){if(void 0!==r&&r._returnedNonUndefined())return;if(0==(65535&i._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),h=B(a),l=h.length-1;0<=l;--l){var c=h[l];if(!f.test(c)){var u=c.match(g);u&&(o="at "+u[1]+":"+u[2]+":"+u[3]+" ");break}}if(0<h.length){var p=h[0];for(l=0;l<a.length;++l)if(a[l]===p){0<l&&(s="\n"+a[l-1]);break}}}var d="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;i._warn(d,!0,e)}},setBounds:function(t,e){if(V()){for(var n,i,r=t.stack.split("\n"),o=e.stack.split("\n"),s=-1,a=-1,h=0;h<r.length;++h){if(l=W(r[h])){n=l.fileName,s=l.line;break}}for(h=0;h<o.length;++h){var l;if(l=W(o[h])){i=l.fileName,a=l.line;break}}s<0||a<0||!n||!i||n!==i||a<=s||(Y=function(t){if(p.test(t))return!0;var e=W(t);return!!(e&&e.fileName===n&&s<=e.line&&e.line<=a)})}},warn:F,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),F(n)},CapturedTrace:X,fireDomEvent:b,fireGlobalEvent:w}}}).call(e,J(121))},function(t,e,n){"use strict";t.exports=function(a,s,h){var l=n(122),c=a.CancellationError,u=l.errorObj,p=n(135)(h);function r(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function d(t){this.finallyHandler=t}function f(t,e){return null!=t.cancelPromise&&(1<arguments.length?t.cancelPromise._reject(e):t.cancelPromise._cancel(),!(t.cancelPromise=null))}function g(){return y.call(this,this.promise._target()._settledValue())}function v(t){if(!f(this,t))return u.e=t,u}function y(t){var e=this.promise,n=this.handler;if(!this.called){this.called=!0;var i=this.isFinallyHandler()?n.call(e._boundValue()):n.call(e._boundValue(),t);if(i===h)return i;if(void 0!==i){e._setReturnedNonUndefined();var r=s(i,e);if(r instanceof a){if(null!=this.cancelPromise){if(r._isCancelled()){var o=new c("late cancellation observer");return e._attachExtraTrace(o),u.e=o,u}r.isPending()&&r._attachCancellationCallback(new d(this))}return r._then(g,v,void 0,this,void 0)}}}return e.isRejected()?(f(this),u.e=t,u):(f(this),t)}return r.prototype.isFinallyHandler=function(){return 0===this.type},d.prototype._resultCancelled=function(){f(this.finallyHandler)},a.prototype._passThrough=function(t,e,n,i){return"function"!=typeof t?this.then():this._then(n,i,void 0,new r(this,e,t),void 0)},a.prototype.lastly=a.prototype.finally=function(t){return this._passThrough(t,0,y,y)},a.prototype.tap=function(t){return this._passThrough(t,1,y)},a.prototype.tapCatch=function(t){var e=arguments.length;if(1===e)return this._passThrough(t,1,void 0,y);var n,i=new Array(e-1),r=0;for(n=0;n<e-1;++n){var o=arguments[n];if(!l.isObject(o))return a.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+l.classString(o)));i[r++]=o}i.length=r;var s=arguments[n];return this._passThrough(p(i,s,this),1,void 0,y)},r}},function(t,e,n){"use strict";t.exports=function(u){var p=n(122),d=n(123).keys,f=p.tryCatch,g=p.errorObj;return function(h,l,c){return function(t){var e=c._boundValue();t:for(var n=0;n<h.length;++n){var i=h[n];if(i===Error||null!=i&&i.prototype instanceof Error){if(t instanceof i)return f(l).call(e,t)}else if("function"==typeof i){var r=f(i).call(e,t);if(r===g)return r;if(r)return f(l).call(e,t)}else if(p.isObject(t)){for(var o=d(i),s=0;s<o.length;++s){var a=o[s];if(i[a]!=t[a])continue t}return f(l).call(e,t)}}return u}}}},function(t,e,n){"use strict";var o=n(122),h=o.maybeWrapAsError,s=n(129).OperationalError,a=n(123);var l=/^(?:name|message|stack|cause)$/;function c(t){var e;if(function(t){return t instanceof Error&&a.getPrototypeOf(t)===Error.prototype}(t)){(e=new s(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=a.keys(t),i=0;i<n.length;++i){var r=n[i];l.test(r)||(e[r]=t[r])}return e}return o.markAsOriginatingFromRejection(t),t}t.exports=function(s,a){return function(t,e){if(null!==s){if(t){var n=c(h(t));s._attachExtraTrace(n),s._reject(n)}else if(a){for(var i=arguments.length,r=new Array(Math.max(i-1,0)),o=1;o<i;++o)r[o-1]=arguments[o];s._fulfill(r)}else s._fulfill(e);s=null}}}},function(t,e,n){"use strict";t.exports=function(s,a,t,h,l){var c=n(122),u=c.tryCatch;s.method=function(i){if("function"!=typeof i)throw new s.TypeError("expecting a function but got "+c.classString(i));return function(){var t=new s(a);t._captureStackTrace(),t._pushContext();var e=u(i).apply(this,arguments),n=t._popContext();return l.checkForgottenReturns(e,n,"Promise.method",t),t._resolveFromSyncValue(e),t}},s.attempt=s.try=function(t){if("function"!=typeof t)return h("expecting a function but got "+c.classString(t));var e,n=new s(a);if(n._captureStackTrace(),n._pushContext(),1<arguments.length){l.deprecated("calling Promise.try with more than 1 argument");var i=arguments[1],r=arguments[2];e=c.isArray(i)?u(t).apply(r,i):u(t).call(r,i)}else e=u(t)();var o=n._popContext();return l.checkForgottenReturns(e,o,"Promise.try",n),n._resolveFromSyncValue(e),n},s.prototype._resolveFromSyncValue=function(t){t===c.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},function(t,e){"use strict";t.exports=function(o,s,a,h){function n(t,e){this._reject(e)}function l(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(n,n,null,this,t)}function c(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)}function u(t,e){e.promiseRejectionQueued||this._reject(t)}var p=!1;o.prototype.bind=function(t){p||(p=!0,o.prototype._propagateFrom=h.propagateFromFunction(),o.prototype._boundValue=h.boundValueFunction());var e=a(t),n=new o(s);n._propagateFrom(this,1);var i=this._target();if(n._setBoundTo(e),e instanceof o){var r={promiseRejectionQueued:!1,promise:n,target:i,bindingPromise:e};i._then(s,l,void 0,n,r),e._then(c,u,void 0,n,r),n._setOnCancel(e)}else n._resolveCallback(i);return n},o.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},o.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},o.bind=function(t,e){return o.resolve(e).bind(t)}}},function(t,e,h){"use strict";t.exports=function(t,e,n,i){var r=h(122),o=r.tryCatch,s=r.errorObj,a=t._async;t.prototype.break=t.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),a.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){0<this._length()&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(t,e){if(r.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var i=o(t).call(this._boundValue());i===s&&(this._attachExtraTrace(i.e),a.throwLater(i.e))}}else t._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),a.invoke(this._doInvokeOnCancel,this,t)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},function(t,e){"use strict";t.exports=function(n){function i(){return this.value}function r(){throw this.reason}n.prototype.return=n.prototype.thenReturn=function(t){return t instanceof n&&t.suppressUnhandledRejections(),this._then(i,void 0,void 0,{value:t},void 0)},n.prototype.throw=n.prototype.thenThrow=function(t){return this._then(r,void 0,void 0,{reason:t},void 0)},n.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,function(){throw e})},n.prototype.catchReturn=function(t){if(arguments.length<=1)return t instanceof n&&t.suppressUnhandledRejections(),this._then(void 0,i,void 0,{value:t},void 0);var e=arguments[1];e instanceof n&&e.suppressUnhandledRejections();return this.caught(t,function(){return e})}}},function(t,e){"use strict";t.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return r.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),i.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},function(t,e,n){"use strict";t.exports=function(p,d,f,g,h,v){var y,m=n(122),_=m.canEvaluate,l=m.tryCatch,c=m.errorObj;if(_){for(var t=function(t){for(var e=new Array(t),n=0;n<e.length;++n)e[n]="this.p"+(n+1);var i=e.join(" = ")+" = null;",r="var promise;\n"+e.map(function(t){return"                                                         \n\t                promise = "+t+";                                      \n\t                if (promise instanceof Promise) {                            \n\t                    promise.cancel();                                        \n\t                }                                                            \n\t            "}).join("\n"),o=e.join(", "),s="Holder$"+t,a="return function(tryCatch, errorObj, Promise, async) {    \n\t            'use strict';                                                    \n\t            function [TheName](fn) {                                         \n\t                [TheProperties]                                              \n\t                this.fn = fn;                                                \n\t                this.asyncNeeded = true;                                     \n\t                this.now = 0;                                                \n\t            }                                                                \n\t                                                                             \n\t            [TheName].prototype._callFunction = function(promise) {          \n\t                promise._pushContext();                                      \n\t                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n\t                promise._popContext();                                       \n\t                if (ret === errorObj) {                                      \n\t                    promise._rejectCallback(ret.e, false);                   \n\t                } else {                                                     \n\t                    promise._resolveCallback(ret);                           \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype.checkFulfillment = function(promise) {       \n\t                var now = ++this.now;                                        \n\t                if (now === [TheTotal]) {                                    \n\t                    if (this.asyncNeeded) {                                  \n\t                        async.invoke(this._callFunction, this, promise);     \n\t                    } else {                                                 \n\t                        this._callFunction(promise);                         \n\t                    }                                                        \n\t                                                                             \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype._resultCancelled = function() {              \n\t                [CancellationCode]                                           \n\t            };                                                               \n\t                                                                             \n\t            return [TheName];                                                \n\t        }(tryCatch, errorObj, Promise, async);                               \n\t        ";return a=a.replace(/\[TheName\]/g,s).replace(/\[TheTotal\]/g,t).replace(/\[ThePassedArguments\]/g,o).replace(/\[TheProperties\]/g,i).replace(/\[CancellationCode\]/g,r),new Function("tryCatch","errorObj","Promise","async",a)(l,c,p,h)},x=[],b=[],w=[],e=0;e<8;++e)x.push(t(e+1)),b.push(new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,e+1))),w.push(new Function("promise","holder","                           \n\t            'use strict';                                                    \n\t            holder.pIndex = promise;                                         \n\t            ".replace(/Index/g,e+1)));y=function(t){this._reject(t)}}p.join=function(){var t,e=arguments.length-1;if(0<e&&"function"==typeof arguments[e]&&(t=arguments[e],e<=8&&_)){(u=new p(g))._captureStackTrace();for(var n=new x[e-1](t),i=b,r=0;r<e;++r){var o=f(arguments[r],u);if(o instanceof p){var s=(o=o._target())._bitField;0==(50397184&s)?(o._then(i[r],y,void 0,u,n),w[r](o,n),n.asyncNeeded=!1):0!=(33554432&s)?i[r].call(u,o._value(),n):0!=(16777216&s)?u._reject(o._reason()):u._cancel()}else i[r].call(u,o,n)}if(!u._isFateSealed()){if(n.asyncNeeded){var a=v();null!==a&&(n.fn=m.domainBind(a,n.fn))}u._setAsyncGuaranteed(),u._setOnCancel(n)}return u}for(var h=arguments.length,l=new Array(h),c=0;c<h;++c)l[c]=arguments[c];t&&l.pop();var u=new d(l).promise();return void 0!==t?u.spread(t):u}}},function(t,e,n){"use strict";t.exports=function(d,t,o,f,s,g){var a=d._getDomain,h=n(122),v=h.tryCatch,y=h.errorObj,l=d._async;function c(t,e,n,i){this.constructor$(t),this._promise._captureStackTrace();var r=a();this._callback=null===r?e:h.domainBind(r,e),this._preservedValues=i===s?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],l.invoke(this._asyncInit,this,void 0)}function r(t,e,n,i){if("function"!=typeof e)return o("expecting a function but got "+h.classString(e));var r=0;if(void 0!==n){if("object"!=typeof n||null===n)return d.reject(new TypeError("options argument must be an object but it is "+h.classString(n)));if("number"!=typeof n.concurrency)return d.reject(new TypeError("'concurrency' must be a number but it is "+h.classString(n.concurrency)));r=n.concurrency}return new c(t,e,r="number"==typeof r&&isFinite(r)&&1<=r?r:0,i).promise()}h.inherits(c,t),c.prototype._asyncInit=function(){this._init$(void 0,-2)},c.prototype._init=function(){},c.prototype._promiseFulfilled=function(t,e){var n=this._values,i=this.length(),r=this._preservedValues,o=this._limit;if(e<0){if(n[e=-1*e-1]=t,1<=o&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(1<=o&&this._inFlight>=o)return n[e]=t,this._queue.push(e),!1;null!==r&&(r[e]=t);var s=this._promise,a=this._callback,h=s._boundValue();s._pushContext();var l=v(a).call(h,t,e,i),c=s._popContext();if(g.checkForgottenReturns(l,c,null!==r?"Promise.filter":"Promise.map",s),l===y)return this._reject(l.e),!0;var u=f(l,this._promise);if(u instanceof d){var p=(u=u._target())._bitField;if(0==(50397184&p))return 1<=o&&this._inFlight++,(n[e]=u)._proxy(this,-1*(e+1)),!1;if(0==(33554432&p))return 0!=(16777216&p)?this._reject(u._reason()):this._cancel(),!0;l=u._value()}n[e]=l}return i<=++this._totalResolved&&(null!==r?this._filter(n,r):this._resolve(n),!0)},c.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;0<t.length&&this._inFlight<e;){if(this._isResolved())return;var i=t.pop();this._promiseFulfilled(n[i],i)}},c.prototype._filter=function(t,e){for(var n=e.length,i=new Array(n),r=0,o=0;o<n;++o)t[o]&&(i[r++]=e[o]);i.length=r,this._resolve(i)},c.prototype.preservedValues=function(){return this._preservedValues},d.prototype.map=function(t,e){return r(this,t,e,null)},d.map=function(t,e,n,i){return r(t,e,n,i)}}},function(t,e,f){"use strict";var n=Object.create;if(n){var g=n(null),v=n(null);g[" size"]=v[" size"]=0}t.exports=function(r){function e(t){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,t))(c)}function n(t){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",t))}function i(t,e,n){var i=n[t];if("function"!=typeof i){if(!l(t))return null;if(i=e(t),n[t]=i,n[" size"]++,512<n[" size"]){for(var r=Object.keys(n),o=0;o<256;++o)delete n[r[o]];n[" size"]=r.length-256}}return i}var o,s,a=f(122),h=a.canEvaluate,l=a.isIdentifier;function c(t,e){var n;if(null!=t&&(n=t[e]),"function"==typeof n)return n;var i="Object "+a.classString(t)+" has no method '"+a.toString(e)+"'";throw new r.TypeError(i)}function u(t){return c(t,this.pop()).apply(t,this)}function p(t){return t[this]}function d(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}o=function(t){return i(t,e,g)},s=function(t){return i(t,n,v)},r.prototype.call=function(t){for(var e=arguments.length,n=new Array(Math.max(e-1,0)),i=1;i<e;++i)n[i-1]=arguments[i];if(h){var r=o(t);if(null!==r)return this._then(r,void 0,void 0,n,void 0)}return n.push(t),this._then(u,void 0,void 0,n,void 0)},r.prototype.get=function(t){var e;if("number"==typeof t)e=d;else if(h){var n=s(t);e=null!==n?n:p}else e=p;return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,s){"use strict";t.exports=function(p,d,f,e,t,g){var v=s(122),n=s(129).TypeError,i=s(122).inherits,y=v.errorObj,m=v.tryCatch,r={};function a(t){setTimeout(function(){throw t},0)}function _(n,i){var r=0,o=n.length,s=new p(t);return function t(){if(o<=r)return s._fulfill();var e=function(t){var e=f(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(n[r++]);if(e instanceof p&&e._isDisposable()){try{e=f(e._getDisposer().tryDispose(i),n.promise)}catch(t){return a(t)}if(e instanceof p)return e._then(t,a,null,null,null)}t()}(),s}function x(t,e,n){this._data=t,this._promise=e,this._context=n}function o(t,e,n){this.constructor$(t,e,n)}function b(t){return x.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function w(t){this.length=t,this.promise=null,this[t-1]=null}x.prototype.data=function(){return this._data},x.prototype.promise=function(){return this._promise},x.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():r},x.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=e!==r?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},x.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},i(o,x),o.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},w.prototype._resultCancelled=function(){for(var t=this.length,e=0;e<t;++e){var n=this[e];n instanceof p&&n.cancel()}},p.using=function(){var t=arguments.length;if(t<2)return d("you must pass at least 2 arguments to Promise.using");var e,o=arguments[t-1];if("function"!=typeof o)return d("expecting a function but got "+v.classString(o));var s=!0;2===t&&Array.isArray(arguments[0])?(t=(e=arguments[0]).length,s=!1):(e=arguments,t--);for(var n=new w(t),i=0;i<t;++i){var r=e[i];if(x.isDisposer(r)){var a=r;(r=r.promise())._setDisposable(a)}else{var h=f(r);h instanceof p&&(r=h._then(b,null,null,{resources:n,index:i},void 0))}n[i]=r}var l=new Array(n.length);for(i=0;i<l.length;++i)l[i]=p.resolve(n[i]).reflect();var c=p.all(l).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return y.e=n.error(),y;if(!n.isFulfilled())return void c.cancel();t[e]=n.value()}u._pushContext(),o=m(o);var i=s?o.apply(void 0,t):o(t),r=u._popContext();return g.checkForgottenReturns(i,r,"Promise.using",u),i}),u=c.lastly(function(){var t=new p.PromiseInspection(c);return _(n,t)});return(n.promise=u)._setOnCancel(n),u},p.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},p.prototype._isDisposable=function(){return 0<(131072&this._bitField)},p.prototype._getDisposer=function(){return this._disposer},p.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},p.prototype.disposer=function(t){if("function"==typeof t)return new o(t,this,e());throw new n}}},function(t,e,n){"use strict";t.exports=function(r,o,s){var a=n(122),h=r.TimeoutError;function l(t){this.handle=t}l.prototype._resultCancelled=function(){clearTimeout(this.handle)};function c(t){return e(+this).thenReturn(t)}var e=r.delay=function(t,e){var n,i;return void 0!==e?(n=r.resolve(e)._then(c,null,null,t,void 0),s.cancellation()&&e instanceof r&&n._setOnCancel(e)):(n=new r(o),i=setTimeout(function(){n._fulfill()},+t),s.cancellation()&&n._setOnCancel(new l(i)),n._captureStackTrace()),n._setAsyncGuaranteed(),n};r.prototype.delay=function(t){return e(t,this)};function u(t){return clearTimeout(this.handle),t}function p(t){throw clearTimeout(this.handle),t}r.prototype.timeout=function(t,e){var n,i;t=+t;var r=new l(setTimeout(function(){n.isPending()&&function(t,e,n){var i;i="string"!=typeof e?e instanceof Error?e:new h("operation timed out"):new h(e),a.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._reject(i),null!=n&&n.cancel()}(n,e,i)},t));return s.cancellation()?(i=this.then(),(n=i._then(u,p,void 0,r,void 0))._setOnCancel(r)):n=this._then(u,p,void 0,r,void 0),n}}},function(t,e,n){"use strict";t.exports=function(a,i,s,h,t,l){var c=n(129).TypeError,e=n(122),u=e.errorObj,p=e.tryCatch,d=[];function f(t,e,n,i){if(l.cancellation()){var r=new a(s),o=this._finallyPromise=new a(s);this._promise=r.lastly(function(){return o}),r._captureStackTrace(),r._setOnCancel(this)}else{(this._promise=new a(s))._captureStackTrace()}this._stack=i,this._generatorFunction=t,this._receiver=e,this._generator=void 0,this._yieldHandlers="function"==typeof n?[n].concat(d):d,this._yieldedPromise=null,this._cancellationPhase=!1}e.inherits(f,t),f.prototype._isResolved=function(){return null===this._promise},f.prototype._cleanup=function(){this._promise=this._generator=null,l.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},f.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=p(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var e=new a.CancellationError("generator .return() sentinel");a.coroutine.returnSentinel=e,this._promise._attachExtraTrace(e),this._promise._pushContext(),t=p(this._generator.throw).call(this._generator,e),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},f.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=p(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},f.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=p(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},f.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof a){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},f.prototype.promise=function(){return this._promise},f.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},f.prototype._continue=function(t){var e=this._promise;if(t===u)return this._cleanup(),this._cancellationPhase?e.cancel():e._rejectCallback(t.e,!1);var n=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?e.cancel():e._resolveCallback(n);var i=h(n,this._promise);if(i instanceof a||null!==(i=function(t,e,n){for(var i=0;i<e.length;++i){n._pushContext();var r=p(e[i])(t);if(n._popContext(),r===u){n._pushContext();var o=a.reject(u.e);return n._popContext(),o}var s=h(r,n);if(s instanceof a)return s}return null}(i,this._yieldHandlers,this._promise))){var r=(i=i._target())._bitField;0==(50397184&r)?(this._yieldedPromise=i)._proxy(this,null):0!=(33554432&r)?a._async.invoke(this._promiseFulfilled,this,i._value()):0!=(16777216&r)?a._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled()}else this._promiseRejected(new c("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},a.coroutine=function(i,t){if("function"!=typeof i)throw new c("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,o=f,s=(new Error).stack;return function(){var t=i.apply(this,arguments),e=new o(void 0,void 0,r,s),n=e.promise();return e._generator=t,e._promiseFulfilled(void 0),n}},a.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new c("expecting a function but got "+e.classString(t));d.push(t)},a.spawn=function(t){if(l.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return i("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var e=new f(t,this),n=e.promise();return e._run(a.spawn),n}}},function(t,e,n){"use strict";t.exports=function(t){var i=n(122),r=t._async,o=i.tryCatch,s=i.errorObj;function a(t,e){if(!i.isArray(t))return h.call(this,t,e);var n=o(e).apply(this._boundValue(),[null].concat(t));n===s&&r.throwLater(n.e)}function h(t,e){var n=this._boundValue(),i=void 0===t?o(e).call(n,null):o(e).call(n,null,t);i===s&&r.throwLater(i.e)}function l(t,e){if(!t){var n=new Error(t+"");n.cause=t,t=n}var i=o(e).call(this._boundValue(),t);i===s&&r.throwLater(i.e)}t.prototype.asCallback=t.prototype.nodeify=function(t,e){if("function"==typeof t){var n=h;void 0!==e&&Object(e).spread&&(n=a),this._then(n,l,void 0,this,t)}return this}}},function(t,e,n){"use strict";t.exports=function(p,d){var f={},g=n(122),v=n(136),y=g.withAppended,m=g.maybeWrapAsError,t=g.canEvaluate,_=n(129).TypeError,x={__isPromisified__:!0},e=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),b=function(t){return g.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function i(t){return!e.test(t)}function w(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function C(t,e,n,i){for(var r,o,s,a,h=g.inheritedDataKeys(t),l=[],c=0;c<h.length;++c){var u=h[c],p=t[u],d=i===b||b(u,p,t);"function"!=typeof p||w(p)||(r=t,o=u,s=e,void 0,(a=g.getDataPropertyOrDefault(r,o+s,x))&&w(a))||!i(u,p,t,d)||l.push(u,p)}return function(t,e,n){for(var i=0;i<t.length;i+=2){var r=t[i];if(n.test(r))for(var o=r.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new _("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}(l,e,n),l}var P=function(t){return t.replace(/([$])/,"\\$")};var S=t?function(t,i,e,n,r,o){var s=Math.max(0,function(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}(n)-1),a=function(t){for(var e=[t],n=Math.max(0,t-1-3),i=t-1;n<=i;--i)e.push(i);for(i=t+1;i<=3;++i)e.push(i);return e}(s),h="string"==typeof t||i===f;function l(t){var e=function(t){return g.filledRange(t,"_arg","")}(t).join(", "),n=0<t?", ":"";return(h?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===i?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",e).replace(", ",n)}var c="string"==typeof t?"this != null ? this['"+t+"'] : fn":"fn",u="'use strict';                                                \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise, "+o+");   \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t    ".replace("[CodeForSwitchCase]",function(){for(var t="",e=0;e<a.length;++e)t+="case "+a[e]+":"+l(a[e]);return t+="                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",h?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",c);return u=u.replace("Parameters",function(t){return g.filledRange(Math.max(t,3),"_arg","")}(s)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",u)(p,n,i,y,m,v,g.tryCatch,g.errorObj,g.notEnumerableProp,d)}:function(r,o,t,e,n,s){var a=function(){return this}(),h=r;function i(){var t=o;o===f&&(t=this);var e=new p(d);e._captureStackTrace();var n="string"==typeof h&&this!==a?this[h]:r,i=v(e,s);try{n.apply(t,y(arguments,i))}catch(t){e._rejectCallback(m(t),!0,!0)}return e._isFateSealed()||e._setAsyncGuaranteed(),e}return"string"==typeof h&&(r=e),g.notEnumerableProp(i,"__isPromisified__",!0),i};function l(t,e,n,i,r){for(var o=new RegExp(P(e)+"$"),s=C(t,e,o,n),a=0,h=s.length;a<h;a+=2){var l=s[a],c=s[a+1],u=l+e;if(i===S)t[u]=S(l,f,l,c,e,r);else{var p=i(c,function(){return S(l,f,l,c,e,r)});g.notEnumerableProp(p,"__isPromisified__",!0),t[u]=p}}return g.toFastProperties(t),t}p.promisify=function(t,e){if("function"!=typeof t)throw new _("expecting a function but got "+g.classString(t));if(w(t))return t;var n=function(t,e,n){return S(t,e,void 0,t,null,n)}(t,void 0===(e=Object(e)).context?f:e.context,!!e.multiArgs);return g.copyDescriptors(t,n,i),n},p.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new _("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,i=e.suffix;"string"!=typeof i&&(i="Async");var r=e.filter;"function"!=typeof r&&(r=b);var o=e.promisifier;if("function"!=typeof o&&(o=S),!g.isIdentifier(i))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=g.inheritedDataKeys(t),a=0;a<s.length;++a){var h=t[s[a]];"constructor"!==s[a]&&g.isClass(h)&&(l(h.prototype,i,r,o,n),l(h,i,r,o,n))}return l(t,i,r,o,n)}}},function(t,e,f){"use strict";t.exports=function(i,t,r,o){var a,e=f(122),s=e.isObject,h=f(123);"function"==typeof Map&&(a=Map);var n,l,c=(l=n=0,function(t){l=t.size,n=0;var e=new Array(2*t.size);return t.forEach(u,e),e});function u(t,e){this[n]=t,this[n+l]=e,n++}function p(t){var e,n=!1;if(void 0!==a&&t instanceof a)e=c(t),n=!0;else{var i=h.keys(t),r=i.length;e=new Array(2*r);for(var o=0;o<r;++o){var s=i[o];e[o]=t[s],e[o+r]=s}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function d(t){var e,n=r(t);return s(n)?(e=n instanceof i?n._then(i.props,void 0,void 0,void 0,void 0):new p(n).promise(),n instanceof i&&e._propagateFrom(n,2),e):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}e.inherits(p,t),p.prototype._init=function(){},p.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(t){for(var e=new a,n=t.length/2|0,i=0;i<n;++i){var r=t[n+i],o=t[i];e.set(r,o)}return e}(this._values);else{n={};for(var i=this.length(),r=0,o=this.length();r<o;++r)n[this._values[r+i]]=this._values[r]}return this._resolve(n),!0}return!1},p.prototype.shouldCopyValues=function(){return!1},p.prototype.getActualLength=function(t){return t>>1},i.prototype.props=function(){return d(this)},i.props=function(t){return d(t)}}},function(t,e,i){"use strict";t.exports=function(l,c,u,p){var d=i(122),f=function(e){return e.then(function(t){return n(t,e)})};function n(t,e){var n=u(t);if(n instanceof l)return f(n);if(null===(t=d.asArray(t)))return p("expecting an array or an iterable object but got "+d.classString(t));var i=new l(c);void 0!==e&&i._propagateFrom(e,3);for(var r=i._fulfill,o=i._reject,s=0,a=t.length;s<a;++s){var h=t[s];(void 0!==h||s in t)&&l.cast(h)._then(r,o,void 0,i,null)}return i}l.race=function(t){return n(t,void 0)},l.prototype.race=function(){return n(this,void 0)}}},function(t,e,g){"use strict";t.exports=function(s,t,r,n,o,a){var h=s._getDomain,l=g(122),c=l.tryCatch;function u(t,e,n,i){this.constructor$(t);var r=h();this._fn=null===r?e:l.domainBind(r,e),void 0!==n&&(n=s.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=i===o?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function p(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function d(t,e,n,i){return"function"!=typeof e?r("expecting a function but got "+l.classString(e)):new u(t,e,n,i).promise()}function f(t){this.accum=t,this.array._gotAccum(t);var e=n(this.value,this.array._promise);return e instanceof s?(this.array._currentCancellable=e)._then(i,void 0,void 0,this,void 0):i.call(this,e)}function i(t){var e,n=this.array,i=n._promise,r=c(n._fn);i._pushContext(),(e=void 0!==n._eachValues?r.call(i._boundValue(),t,this.index,this.length):r.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof s&&(n._currentCancellable=e);var o=i._popContext();return a.checkForgottenReturns(e,o,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),e}l.inherits(u,t),u.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof s&&this._currentCancellable.cancel(),this._initialValue instanceof s&&this._initialValue.cancel())},u.prototype._iterate=function(t){var e,n,i=(this._values=t).length;if(n=void 0!==this._initialValue?(e=this._initialValue,0):(e=s.resolve(t[0]),1),!(this._currentCancellable=e).isRejected())for(;n<i;++n){var r={accum:null,value:t[n],index:n,length:i,array:this};e=e._then(f,void 0,void 0,r,void 0)}void 0!==this._eachValues&&(e=e._then(this._eachComplete,void 0,void 0,this,void 0)),e._then(p,p,void 0,e,this)},s.prototype.reduce=function(t,e){return d(this,t,e,null)},s.reduce=function(t,e,n,i){return d(t,e,n,i)}}},function(t,e,o){"use strict";t.exports=function(t,e,n){var i=t.PromiseInspection;function r(t){this.constructor$(t)}o(122).inherits(r,e),r.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},r.prototype._promiseFulfilled=function(t,e){var n=new i;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},r.prototype._promiseRejected=function(t,e){var n=new i;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},t.settle=function(t){return n.deprecated(".settle()",".reflect()"),new r(t).promise()},t.prototype.settle=function(){return t.settle(this)}}},function(t,e,c){"use strict";t.exports=function(t,e,r){var n=c(122),i=c(129).RangeError,o=c(129).AggregateError,s=n.isArray,a={};function h(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new h(t),i=n.promise();return n.setHowMany(e),n.init(),i}n.inherits(h,e),h.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=s(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},h.prototype.init=function(){this._initialized=!0,this._init()},h.prototype.setUnwrap=function(){this._unwrap=!0},h.prototype.howMany=function(){return this._howMany},h.prototype.setHowMany=function(t){this._howMany=t},h.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},h.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},h.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(a),this._checkOutcome())},h.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new o,e=this.length();e<this._values.length;++e)this._values[e]!==a&&t.push(this._values[e]);return 0<t.length?this._reject(t):this._cancel(),!0}return!1},h.prototype._fulfilled=function(){return this._totalResolved},h.prototype._rejected=function(){return this._values.length-this.length()},h.prototype._addRejected=function(t){this._values.push(t)},h.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},h.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},h.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new i(e)},h.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return l(t,e)},t.prototype.some=function(t){return l(this,t)},t._SomePromiseArray=h}},function(t,e){"use strict";t.exports=function(t,i){var r=t.map;t.prototype.filter=function(t,e){return r(this,t,e,i)},t.filter=function(t,e,n){return r(t,e,n,i)}}},function(t,e){"use strict";t.exports=function(t,n){var i=t.reduce,e=t.all;function r(){return e(this)}t.prototype.each=function(t){return i(this,t,n,0)._then(r,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,n,n)},t.each=function(t,e){return i(t,e,n,0)._then(r,void 0,void 0,t,void 0)},t.mapSeries=function(t,e){return i(t,e,n,n)}}},function(t,e){"use strict";t.exports=function(t){var i=t._SomePromiseArray;function e(t){var e=new i(t),n=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),n}t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},function(t,e){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function e(){}function n(){return r.apply(this instanceof e&&t?this:t||window,i.concat(Array.prototype.slice.call(arguments)))}var i=Array.prototype.slice.call(arguments,1),r=this;return e.prototype=this.prototype,n.prototype=new e,n}),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var n=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>n.length)&&(e=n.length),e-=t.length;var i=n.indexOf(t,e);return-1!==i&&i===e})},function(t,e,n){n(160),(0,n(65).registerPainter)("vml",n(162))},function(t,e,n){var i=n(49),H=n(14).applyTransform,r=n(26),O=n(19),R=n(25),N=n(24),o=n(23),s=n(7),a=n(44),h=n(45),l=n(6),c=n(29),z=n(41),j=n(161),G=c.CMD,V=Math.round,Y=Math.sqrt,u=Math.abs,U=Math.cos,W=Math.sin,D=Math.max;if(!i.canvasSupported){function X(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=J+","+J,t.coordorigin="0,0"}function I(t,e,n){return"rgb("+[t,e,n].join(",")+")"}function q(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e)}function p(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)}function Q(t,e,n){return 1e5*(parseFloat(t)||0)+1e3*(parseFloat(e)||0)+n}function M(t,e){return"string"==typeof t?0<=t.lastIndexOf("%")?parseFloat(t)/100*e:parseFloat(t):t}function F(t,e,n){var i=O.parse(e);n=+n,isNaN(n)&&(n=1),i&&(t.color=I(i[0],i[1],i[2]),t.opacity=n*i[3])}function k(t,e,n,i){var r="fill"==e,o=t.getElementsByTagName(e)[0];null!=n[e]&&"none"!==n[e]&&(r||!r&&n.lineWidth)?(t[r?"filled":"stroked"]="true",n[e]instanceof z&&p(t,o),o=o||j.createNode(e),r?function(t,e,n){var i,r,o=e.fill;if(null!=o)if(o instanceof z){var s,a=0,h=[0,0],l=0,c=1,u=n.getBoundingRect(),p=u.width,d=u.height;if("linear"===o.type){s="gradient";var f=n.transform,g=[o.x*p,o.y*d],v=[o.x2*p,o.y2*d];f&&(H(g,g,f),H(v,v,f));var y=v[0]-g[0],m=v[1]-g[1];(a=180*Math.atan2(y,m)/Math.PI)<0&&(a+=360),a<1e-6&&(a=0)}else{s="gradientradial";g=[o.x*p,o.y*d],f=n.transform;var _=n.scale,x=p,b=d;h=[(g[0]-u.x)/x,(g[1]-u.y)/b],f&&H(g,g,f),x/=_[0]*J,b/=_[1]*J;var w=D(x,b);l=0/w,c=2*o.r/w-l}var C=o.colorStops.slice();C.sort(function(t,e){return t.offset-e.offset});for(var P=C.length,S=[],T=[],E=0;E<P;E++){var R=C[E],N=(i=R.color,void 0,r=O.parse(i),[I(r[0],r[1],r[2]),r[3]]);T.push(R.offset*c+l+" "+N[0]),0!==E&&E!==P-1||S.push(N)}if(2<=P){var M=S[0][0],k=S[1][0],A=S[0][1]*e.opacity,L=S[1][1]*e.opacity;t.type=s,t.method="none",t.focus="100%",t.angle=a,t.color=M,t.color2=k,t.colors=T.join(","),t.opacity=L,t.opacity2=A}"radial"===s&&(t.focusposition=h.join(","))}else F(t,o,e.opacity)}(o,n,i):function(t,e){null!=e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof z||F(t,e.stroke,e.opacity)}(o,n),q(t,o)):(t[r?"filled":"stroked"]="false",p(t,o))}var Z="progid:DXImageTransform.Microsoft",J=21600,$=10800,K=[[],[],[]];l.prototype.brushVML=function(t){var e=this.style,n=this._vmlEl;n||(n=j.createNode("shape"),X(n),this._vmlEl=n),k(n,"fill",e,this),k(n,"stroke",e,this);var i=this.transform,r=null!=i,o=n.getElementsByTagName("stroke")[0];if(o){var s=e.lineWidth;if(r&&!e.strokeNoScale){var a=i[0]*i[3]-i[1]*i[2];s*=Y(u(a))}o.weight=s+"px"}var h=this.path||(this.path=new c);this.__dirtyPath&&(h.beginPath(),this.buildPath(h,this.shape),h.toStatic(),this.__dirtyPath=!1),n.path=function(t,e){var n,i,r,o,s,a,h=G.M,l=G.C,c=G.L,u=G.A,p=G.Q,d=[],f=t.data,g=t.len();for(o=0;o<g;){switch(i="",n=0,r=f[o++]){case h:i=" m ",n=1,s=f[o++],a=f[o++],K[0][0]=s,K[0][1]=a;break;case c:i=" l ",n=1,s=f[o++],a=f[o++],K[0][0]=s,K[0][1]=a;break;case p:case l:i=" c ",n=3;var v,y,m=f[o++],_=f[o++],x=f[o++],b=f[o++];r===p?(x=((v=x)+2*m)/3,b=((y=b)+2*_)/3,m=(s+2*m)/3,_=(a+2*_)/3):(v=f[o++],y=f[o++]),K[0][0]=m,K[0][1]=_,K[1][0]=x,K[1][1]=b,s=K[2][0]=v,a=K[2][1]=y;break;case u:var w=0,C=0,P=1,S=1,T=0;e&&(w=e[4],C=e[5],P=Y(e[0]*e[0]+e[1]*e[1]),S=Y(e[2]*e[2]+e[3]*e[3]),T=Math.atan2(-e[1]/S,e[0]/P));var E=f[o++],R=f[o++],N=f[o++],M=f[o++],k=f[o++]+T,A=f[o++]+k+T;o++;var L=f[o++],O=E+U(k)*N,z=R+W(k)*M,I=(m=E+U(A)*N,_=R+W(A)*M,L?" wa ":" at ");Math.abs(O-m)<1e-4&&(.01<Math.abs(A-k)?L&&(O+=.0125):Math.abs(z-R)<1e-4?L&&O<E||!L&&E<O?_-=.0125:_+=.0125:L&&z<R||!L&&R<z?m+=.0125:m-=.0125),d.push(I,V(((E-N)*P+w)*J-$),",",V(((R-M)*S+C)*J-$),",",V(((E+N)*P+w)*J-$),",",V(((R+M)*S+C)*J-$),",",V((O*P+w)*J-$),",",V((z*S+C)*J-$),",",V((m*P+w)*J-$),",",V((_*S+C)*J-$)),s=m,a=_;break;case G.R:var F=K[0],B=K[1];F[0]=f[o++],F[1]=f[o++],B[0]=F[0]+f[o++],B[1]=F[1]+f[o++],e&&(H(F,F,e),H(B,B,e)),F[0]=V(F[0]*J-$),B[0]=V(B[0]*J-$),F[1]=V(F[1]*J-$),B[1]=V(B[1]*J-$),d.push(" m ",F[0],",",F[1]," l ",B[0],",",F[1]," l ",B[0],",",B[1]," l ",F[0],",",B[1]);break;case G.Z:d.push(" x ")}if(0<n){d.push(i);for(var j=0;j<n;j++){var D=K[j];e&&H(D,D,e),d.push(V(D[0]*J-$),",",V(D[1]*J-$),j<n-1?",":"")}}}return d.join("")}(h,this.transform),n.style.zIndex=Q(this.zlevel,this.z,this.z2),q(t,n),null!=e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t)},l.prototype.onRemove=function(t){p(t,this._vmlEl),this.removeRectText(t)},l.prototype.onAdd=function(t){q(t,this._vmlEl),this.appendRectText(t)};a.prototype.brushVML=function(t){var e,n,i=this.style,r=i.image;if(function(t){return"object"==typeof t&&t.tagName&&"IMG"===t.tagName.toUpperCase()}(r)){var o=r.src;if(o===this._imageSrc)e=this._imageWidth,n=this._imageHeight;else{var s=r.runtimeStyle,a=s.width,h=s.height;s.width="auto",s.height="auto",e=r.width,n=r.height,s.width=a,s.height=h,this._imageSrc=o,this._imageWidth=e,this._imageHeight=n}r=o}else r===this._imageSrc&&(e=this._imageWidth,n=this._imageHeight);if(r){var l=i.x||0,c=i.y||0,u=i.width,p=i.height,d=i.sWidth,f=i.sHeight,g=i.sx||0,v=i.sy||0,y=d&&f,m=this._vmlEl;m||(m=j.doc.createElement("div"),X(m),this._vmlEl=m);var _,x=m.style,b=!1,w=1,C=1;if(this.transform&&(_=this.transform,w=Y(_[0]*_[0]+_[1]*_[1]),C=Y(_[2]*_[2]+_[3]*_[3]),b=_[1]||_[2]),b){var P=[l,c],S=[l+u,c],T=[l,c+p],E=[l+u,c+p];H(P,P,_),H(S,S,_),H(T,T,_),H(E,E,_);var R=D(P[0],S[0],T[0],E[0]),N=D(P[1],S[1],T[1],E[1]),M=[];M.push("M11=",_[0]/w,",","M12=",_[2]/C,",","M21=",_[1]/w,",","M22=",_[3]/C,",","Dx=",V(l*w+_[4]),",","Dy=",V(c*C+_[5])),x.padding="0 "+V(R)+"px "+V(N)+"px 0",x.filter=Z+".Matrix("+M.join("")+", SizingMethod=clip)"}else _&&(l=l*w+_[4],c=c*C+_[5]),x.filter="",x.left=V(l)+"px",x.top=V(c)+"px";var k=this._imageEl,A=this._cropEl;k||(k=j.doc.createElement("div"),this._imageEl=k);var L=k.style;if(y){if(e&&n)L.width=V(w*e*u/d)+"px",L.height=V(C*n*p/f)+"px";else{var O=new Image,z=this;O.onload=function(){O.onload=null,e=O.width,n=O.height,L.width=V(w*e*u/d)+"px",L.height=V(C*n*p/f)+"px",z._imageWidth=e,z._imageHeight=n,z._imageSrc=r},O.src=r}A||((A=j.doc.createElement("div")).style.overflow="hidden",this._cropEl=A);var I=A.style;I.width=V((u+g*u/d)*w),I.height=V((p+v*p/f)*C),I.filter=Z+".Matrix(Dx="+-g*u/d*w+",Dy="+-v*p/f*C+")",A.parentNode||m.appendChild(A),k.parentNode!=A&&A.appendChild(k)}else L.width=V(w*u)+"px",L.height=V(C*p)+"px",m.appendChild(k),A&&A.parentNode&&(m.removeChild(A),this._cropEl=null);var F="",B=i.opacity;B<1&&(F+=".Alpha(opacity="+V(100*B)+") "),F+=Z+".AlphaImageLoader(src="+r+", SizingMethod=scale)",L.filter=F,m.style.zIndex=Q(this.zlevel,this.z,this.z2),q(t,m),null!=i.text&&this.drawRectText(t,this.getBoundingRect())}},a.prototype.onRemove=function(t){p(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t)},a.prototype.onAdd=function(t){q(t,this._vmlEl),this.appendRectText(t)};var d,A="normal",L={},B=0,tt=document.createElement("div");R.$override("measureText",function(t,e){var n=j.doc;d||((d=n.createElement("div")).style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",j.doc.body.appendChild(d));try{d.style.font=e}catch(t){}return d.innerHTML="",d.appendChild(n.createTextNode(t)),{width:d.offsetWidth}});function f(t,e,n,i){var r=this.style;this.__dirty&&N.normalizeTextStyle(r,!0);var o=r.text;if(null!=o&&(o+=""),o){if(r.rich){var s=R.parseRichText(o,r);o=[];for(var a=0;a<s.lines.length;a++){for(var h=s.lines[a].tokens,l=[],c=0;c<h.length;c++)l.push(h[c].text);o.push(l.join(""))}o=o.join("\n")}var u,p,d=r.textAlign,f=r.textVerticalAlign,g=function(t){var e=L[t];if(!e){100<B&&(B=0,L={});var n,i=tt.style;try{i.font=t,n=i.fontFamily.split(",")[0]}catch(t){}e={style:i.fontStyle||A,variant:i.fontVariant||A,weight:i.fontWeight||A,size:0|parseFloat(i.fontSize||12),family:n||"Microsoft YaHei"},L[t]=e,B++}return e}(r.font),v=g.style+" "+g.variant+" "+g.weight+" "+g.size+'px "'+g.family+'"';n=n||R.getBoundingRect(o,v,d,f);var y=this.transform;if(y&&!i&&(et.copy(e),et.applyTransform(y),e=et),i)u=e.x,p=e.y;else{var m=r.textPosition,_=r.textDistance;if(m instanceof Array)u=e.x+M(m[0],e.width),p=e.y+M(m[1],e.height),d=d||"left";else{var x=R.adjustTextPositionOnRect(m,e,_);u=x.x,p=x.y,d=d||x.textAlign,f=f||x.textVerticalAlign}}u=R.adjustTextX(u,n.width,d),p=R.adjustTextY(p,n.height,f),p+=n.height/2;var b,w,C,P=j.createNode,S=this._textVmlEl;S?w=(b=(C=S.firstChild).nextSibling).nextSibling:(S=P("line"),b=P("path"),w=P("textpath"),C=P("skew"),w.style["v-text-align"]="left",X(S),b.textpathok=!0,w.on=!0,S.from="0 0",S.to="1000 0.05",q(S,C),q(S,b),q(S,w),this._textVmlEl=S);var T=[u,p],E=S.style;y&&i?(H(T,T,y),C.on=!0,C.matrix=y[0].toFixed(3)+","+y[2].toFixed(3)+","+y[1].toFixed(3)+","+y[3].toFixed(3)+",0,0",C.offset=(V(T[0])||0)+","+(V(T[1])||0),C.origin="0 0",E.left="0px",E.top="0px"):(C.on=!1,E.left=V(u)+"px",E.top=V(p)+"px"),w.string=function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}(o);try{w.style.font=v}catch(t){}k(S,"fill",{fill:r.textFill,opacity:r.opacity},this),k(S,"stroke",{stroke:r.textStroke,opacity:r.opacity,lineDash:r.lineDash},this),S.style.zIndex=Q(this.zlevel,this.z,this.z2),q(t,S)}}function g(t){p(t,this._textVmlEl),this._textVmlEl=null}function v(t){q(t,this._textVmlEl)}for(var et=new r,y=[o,s,a,l,h],m=0;m<y.length;m++){var _=y[m].prototype;_.drawRectText=f,_.removeRectText=g,_.appendRectText=v}h.prototype.brushVML=function(t){var e=this.style;null!=e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t)},h.prototype.onRemove=function(t){this.removeRectText(t)},h.prototype.onAdd=function(t){this.appendRectText(t)}}},function(t,e,n){var i,r=n(49),o="urn:schemas-microsoft-com:vml",s="undefined"==typeof window?null:window,a=!1,h=s&&s.document;if(h&&!r.canvasSupported)try{h.namespaces.zrvml||h.namespaces.add("zrvml",o),i=function(t){return h.createElement("<zrvml:"+t+' class="zrvml">')}}catch(t){i=function(t){return h.createElement("<"+t+' xmlns="'+o+'" class="zrvml">')}}e.doc=h,e.createNode=function(t){return i(t)},e.initVML=function(){if(!a&&h){a=!0;var t=h.styleSheets;t.length<31?h.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)")}}},function(t,e,n){var i=n(21),s=n(161),r=n(4).each;function o(t){return parseInt(t,10)}function a(t,e){s.initVML(),this.root=t,this.storage=e;var n=document.createElement("div"),i=document.createElement("div");n.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",i.style.cssText="position:absolute;left:0;top:0;",t.appendChild(n),this._vmlRoot=i,this._vmlViewport=n,this.resize();var r=e.delFromStorage,o=e.addToStorage;e.delFromStorage=function(t){r.call(e,t),t&&t.onRemove&&t.onRemove(i)},e.addToStorage=function(t){t.onAdd&&t.onAdd(i),o.call(e,t)},this._firstPaint=!0}a.prototype={constructor:a,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t)},_paintList:function(t){for(var e=this._vmlRoot,n=0;n<t.length;n++){var i=t[n];i.invisible||i.ignore?(i.__alreadyNotVisible||i.onRemove(e),i.__alreadyNotVisible=!0):(i.__alreadyNotVisible&&i.onAdd(e),i.__alreadyNotVisible=!1,i.__dirty&&(i.beforeBrush&&i.beforeBrush(),(i.brushVML||i.brush).call(i,e),i.afterBrush&&i.afterBrush())),i.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1)},resize:function(t,e){t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;if(this._width!=t||this._height!=e){this._width=t,this._height=e;var n=this._vmlViewport.style;n.width=t+"px",n.height=e+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var t=this.root,e=t.currentStyle;return(t.clientWidth||o(e.width))-o(e.paddingLeft)-o(e.paddingRight)|0},_getHeight:function(){var t=this.root,e=t.currentStyle;return(t.clientHeight||o(e.height))-o(e.paddingTop)-o(e.paddingBottom)|0}},r(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){a.prototype[t]=function(t){return function(){i('In IE8.0 VML mode painter not support method "'+t+'"')}}(t)});var h=a;t.exports=h}],r={},n.m=i,n.c=r,n.p="",n(0);function n(t){if(r[t])return r[t].exports;var e=r[t]={exports:{},id:t,loaded:!1};return i[t].call(e.exports,e,e.exports,n),e.loaded=!0,e.exports}var i,r});
//# sourceMappingURL=fish-topo-bpmn.min.js.map

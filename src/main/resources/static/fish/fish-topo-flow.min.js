!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fishTopoFlow=e():t.fishTopoFlow=e()}(this,function(){return o={},i.m=n=[function(t,e,i){t.exports=i(1)},function(t,e,i){t.exports=i(2),i(137)},function(t,e,i){i(3);var a=i(4),r=i(64),A=i(65),y=i(66),n=i(68),o=i(12),s=i(69),E=i(5),h=i(80),l=i(90),g=i(94),c=i(93),u=i(87),d=i(77),p=i(82),f=i(123),L=i(119),v=i(96),m=i(95),x=i(117),_=i(124),b=i(26),w=i(132),P=i(133),C=i(136),N=27;function T(t,e){this.id,this.group=null,this._dom=t,this.nowZoom=1,this.canScale=!0,this.eagleEye=!1,this.eagleEyeNode=null,this.initScaleRatio=1,this.operationNode=null,this.step=0,this.stepJson=[],this.selectedNode=null,this.allNodes=[],this.minimap=null,this._api=new n(this),this.connectionManager=new l(this._api),this.lineOperationManager=new f(this.connectionManager,this._api),this._zr=s.init(t,{renderer:e.renderer||"canvas",devicePixelRatio:e.devicePixelRatio}),this._tooltipView=new P(new C(e.tooltip),this._api),this.Shape=a,this.lineOpt={},this.selectedNodes=[],this.model=new u({}),this.model.set(c.ELEMENT_TYPE,"scene"),this.model.set(c.MODE,"normal"),this.options=e,this.cursorMap={tl:"nw-resize",tr:"ne-resize",bl:"sw-resize",br:"se-resize",mtr:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAYFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD6T+iNAAAAH3RSTlMA7sUMoYXnEkYYzaaTjQiAQCweBcG7fvnULh2ZdjMy6Fzd7wAAALJJREFUGNN1kFkOwzAIBQHvW/Y6Sbfc/5Y1ltqoljIf2BohBA8qU096xeV5L/+uFH4SpsGAGSKmThCyMz64Ud38Te0meIpHcTP1ndTKvqzSUuQILFMQJAUwIngBLCd0UrJhSRGqzHHU3FcHBVMokqxS38YNGQLQbhmgZZ23sVEXnXVmS467Fq0892SSLaW5SHrN9rz9bXv9EHIB+E9pdMG7Ys48Z2cjxo7FL3k8kPIE13wAmEUIO2ML9YMAAAAASUVORK5CYII=) 10 10, auto"},this.cursorMaps=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],this.cursorOffset={tr:1,br:3,bl:5,tl:7},o.call(this)}var S=T.prototype;S.getDom=function(){return this._dom},S.getZr=function(){return this._zr},S.getWidth=function(){return this._zr.getWidth()},S.getHeight=function(){return this._zr.getHeight()},S.isDisposed=function(){return this._disposed},S.dispose=function(){this._disposed=!0,this._zr.dispose(),R[this.id]=null},S.resize=function(){this._zr.resize()},S.dispatchAction=function(t){t.type},S.option=function(t,e){var i=new u(this.options);return 0===arguments.length?E.clone(this.options):1===arguments.length?i.get(t):2===arguments.length?("roam"===t&&this.setRoam(e),i.set(t,e)):void 0},S.init=function(){var n=this,t="ontouchstart"in window?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"];this.group=new a.Group,this.group.model=this.model,this.group.isBg=!0,this._zr.add(this.group),!0===this.options.roam&&this.zrScale(),this.connectionManager.connectors=[],this._zr.on("mouseup",function(t){var e=t.target;e&&e.model&&L.isLink(e.model)||e&&e.connector instanceof p||(this.connectionManager.clearSelectCon(),e&&e._isLineOperationIcon&&1==e._isLineOperationIcon||this.lineOperationManager.hideAllLineOperation())}.bind(this)),this._zr.on("click",function(t){var e=(t.target||{}).type;if("ConnectControlLine"!==e&&"ConnectControl"!==e){this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode();var i,n=t.target;if(n&&(i=n.model),n&&i&&L.isLink(i)||n&&i&&L.isNode(i))return}var o={};o.event=t,o.type="click",(o.target=this)._api.trigger(o.type,o)}.bind(this)),this._zr.on("mousedown",function(t){if("drag-select"===this.options.mouseMode){if(t.target&&t.target.model||t.target&&t.target.lineType&&t.target.parent||t.target&&t.target.connector instanceof p||t.target&&t.target instanceof a.Circle||t.target&&"GROUP_RECT_NAME"===t.target.name)return;this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),this._dragSelect(t.target,t.offsetX,t.offsetY)}if("drag-move"===this.options.mouseMode){if(t.target&&t.target.model||t.target&&t.target.lineType&&t.target.parent||t.target&&t.target.connector instanceof p||t.target&&t.target instanceof a.Circle)return;this._groupDragHandler(t.offsetX,t.offsetY)}}.bind(this)),this.on("conPointsGroup:click",function(t){this.lineOperationManager.bindOperation(t.lineNode)}.bind(this)),E.each(t,function(i){this._zr.on(i,function(t){if(!n.judgeIfReadMode()){var e={};e.event=t,e.type=i,(e.target=this)._api.trigger(e.type,e)}},this)},this)},S.setRoam=function(t){this._zr.off("mousewheel"),!0===t&&this.zrScale()},S.addGroupModel=function(t){var n=this;t.eachChild(function(e){if(e.model&&e instanceof m&&e.model&&!e.model.option.childs&&0<e.children().length){var i=[];e.eachChild(function(t){t.model&&(t instanceof m&&!t.model.option.childs&&0<t.children().length&&n.addGroupModel(e),i.push(t.model.option),e.model.option.childs=i)})}})},S.toJson=function(){return this.addGroupModel(this.group),g.toJson(this.model,this.group)},S.fromJson=function(t,e){this.clear(!0);var i=new u(t);this.setBackground(i.get(c.BACKGROUND));g.fromJson(this,this.group,i.get(c.CHILDS),!1,[],e)},S.addGroupNodeEvent=function(e){var i=this;if(L.isGroupNode(e)){e.willRender(this._api);var t=e.model.get(c.OPTIONS);if(t.mergedImage){var n={image:t.mergedImage};t.style&&t.style.text&&(n.text=t.style.text,n.textPosition="bottom"),n.width=30,n.height=30;var o=new v.Image({name:"GROUP_RELATION_IMAGE",relatedGroupId:e.id,style:n,z:e.z||4,position:[-5e3,-5e3]});this.drag(o),e._relationImage=o,this.group.add(o),setTimeout(function(){o.hide()},300),e.on("dblclick",function(t){t.cancelBubble=!0,i.hideConnectorPoint(),i.hideConnectorControl(),i._removeOperationNode(),i.toggleAllConNodeLine(e,"hide"),e.merged(i)})}e.each(function(t){L.isGroupNode(t)?this.addGroupNodeEvent(t):this._addGroupNode(e,t)},this)}this.addNodeAttrEvent(e,!0)},S.add=S.addNode=function(t,e,i){return t&&(!1===(e||{}).trigger||this._trigger("beforeCreate",{target:t}))?(t instanceof p?this.addConnectorAttrEvent(t):this.addGroupNodeEvent(t),this._trigger("create",{target:t}),t.hoverStyle&&a.setHoverStyle(t),this.group.add(t),t.relative&&this._handleRelativePostion(t),t.hoverAnimation&&this.options.isAnimationEnabled&&v.addHoverAnimation(t),1!=i&&this.stepCounter(),t):null},S._addGroupNode=function(t,e){e instanceof p?this.addConnectorAttrEvent(e):(this.addNodeAttrEvent(e,t.options.childDraggable),A.isUndefined(e.selectable)&&(e.selectable=!1),e.relative&&this._handleRelativePostion(e),e.hoverStyle&&a.setHoverStyle(e)),this._trigger("create",{target:e})},S.addTextOnChain=function(t,e){if(t.options.style.lineType===p.TYPE_CHAIN){this.connectionManager.removeLine(t,this._getParentZr(t)),t.options.text.text.push(e),t.options.textContextMenu=t.opt.textContextMenu;var i=new x.Chain(t.startNode,t.endNode,t.options);return this.add(i),i}},S.delTextOnChain=function(t){var i,n=t.id,e=t.parent;if(e.options.style.lineType===p.TYPE_CHAIN&&E.isArray(e.options.text.text)){e.options.text.text.forEach(function(t,e){t.textId===n&&(i=e)}),e.options.text.text.splice(i,1),this.connectionManager.removeLine(e,this._getParentZr(e)),e.options.textContextMenu=e.opt.textContextMenu;var o=new x.Chain(e.startNode,e.endNode,e.options);return this.add(o),o}},S.modifyTextOnChain=function(t,i){var n=t.id,e=t.parent;e.options.style.lineType===p.TYPE_CHAIN&&E.isArray(e.options.text.text)&&(e.options.text.text.forEach(function(t,e){t.textId===n&&(t.text=i)}),t.setStyle("text",i),t.parent.refresh())},S.getparentIgnore=function(t){return!!t.parent&&(!1!==t.parent.ignore||this.getparentIgnore(t.parent))},S.findGroupNodes=function(t,i){var n=[t];return i&&t._relationImage&&n.push(t._relationImage),function e(t){L.isGroupNode(t)&&t._children.forEach(function(t){t instanceof p||t.isIcon||"GROUP_RECT_NAME"===t.name||(n.push(t),i&&t._relationImage&&n.push(t._relationImage)),L.isGroupNode(t)&&e(t)})}(t),n},S.toggleAllConNodeLine=function(t,o){var i,r=this,s=[];L.isGroupNode(t)&&(s=this.findGroupNodes(t,!0),i=function(t,e){if("hide"===o&&t.hide(),"show"===o){var i=t[e];if(i.parent&&r.getparentIgnore(i))t.hide();else if(L.isGroupNode(i)&&i.ignore)t.hide();else if("GROUP_RELATION_IMAGE"===i.name){var n=E.find(s,function(t){return t.id===i.relatedGroupId});n&&r.getparentIgnore(n)?t.hide():t.show()}else t.show()}});var e=this.connectionManager.connectors;E.isArray(e)&&e.forEach(function(e){L.isGroupNode(t)&&0<s.length?(s.some(function(t){return t.id===e.startNode.id})&&i(e,"startNode"),s.some(function(t){return t.id===e.endNode.id})&&i(e,"endNode")):e.startNode.id!==t.id&&e.endNode.id!==t.id||("hide"===o?e.hide():e.show())})},S.addConnectorAttrEvent=function(t){var e=this,i=null;if(t.options.style.lineType===p.TYPE_CHAIN){var n=this.connectionManager.getTwoNodeId(t.startNode,t.endNode,t.options.position),o=this.connectionManager.connectorMap.get(n),r=[].concat(t.options.text.text);0<o.length&&o.forEach(function(t){t.options.style.lineType===p.TYPE_CHAIN&&(r=r.concat(t.options.text.text),i=t)})}i&&(t.options.text.text=r,this.connectionManager.removeLine(i,this._getParentZr(i))),t.options.isEdit=!!this.options.linkModify,this.createConnectorDragEvents(t),t.on("mousedown",function(){this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),this.isNode=!1}.bind(this)),this.connectionManager.add(t),this.connectionManager.connectorForbidEdit(!this.options.linkModify),t.on("dblclick",function(){void 0===this.options.text.textEditable?e.options.textEditable&&e.connectorEdit(this):this.options.text.textEditable&&e.connectorEdit(this)})},S.addNodeAttrEvent=function(t,e){var o=this;e&&this.drag(t),t.attr("operationIcons",t.model.get("options.operationIcons")),t.on("click",function(t){var e=this;if(!(o.judgeIfReadMode(e)||e.style&&"none"===e.style.fill)){o.nodeClickHandler(e);var i={};if(i.event=t,i.type="click",i.target=e,o._api.trigger(i.type,i),t.cancelBubble=!0,L.isInGroup(e)){var n=e.parent;n.childDraggable||n.trigger("click",{event:t,type:"click",target:n})}}}),t.on("dblclick",function(t){var e=this;e.style&&void 0!==e.style.textEditable?e.style.textEditable&&o.nodeEdit(e):o.options.textEditable&&o.nodeEdit(e);var i={};i.event=t,i.type="dblclick",i.target=e,o._api.trigger(i.type,i),t.cancelBubble=!0}),this.allNodes.push(t)},S._handleRelativePostion=function(t){var e=t.parent,i=e===this.group?{width:this._api.getWidth(),height:this._api.getHeight()}:{width:e.getBoundingRect().width,height:e.getBoundingRect().height};_.positionElement(t,t.relative,i,t.relative.padding,{boundingMode:t.relative.bounding||"all"})},S._getParentZr=function(t){return t&&t.parent?t.parent:this.group},S._removeOperationNode=function(){this.operationNode&&(this.group.remove(this.operationNode),this.operationNode.cleanup(),this.operationNode=null)},S.clear=function(t){for(var e=0;e<this.allNodes.length;e++){var i=this._getParentZr(this.allNodes[e]);this.connectionManager.deleteSelectCon(this.allNodes[e],i)}this.connectionManager.connectorMap.clear(),this.allNodes=[],this.operationNode=null,this.selectedNode=null,this.dragSelectRect=null,this.selectedNodes=[],this.hideConnectorPoint(),this.hideConnectorControl(),this.connectionManager.connectors=[],this._zr.clear(),this.group=new a.Group,this.group.isBg=!0,this._zr.add(this.group),1!=t&&this.stepCounter()},S.addLineIcon=S.addIcon=function(t,e){this.lineOperationManager.addIcon(t,e)},S.lineDefaultIcon=function(t){this.addLineDeleteIcon(t),this.addLineChangeIcon(t)},S.addLineDeleteIcon=function(t,e){this.lineOperationManager.addDeleteIcon(t,e)},S.addLineChangeIcon=function(t,e){this.lineOperationManager.addChangeLineTypeIcon(t,e)},S.changeSelectConnectorType=function(t){var e=t,i=this.connectionManager.selConnector,n=i.options.style.lineType;if(e){if(e==n)return}else{var o=[p.TYPE_STRAIGHT,p.TYPE_JAGGED,p.TYPE_CURVE];e=o[(E.indexOf(o,n)+1)%o.length]}this.connectionManager.deleteLine(this._getParentZr(i)),this.lineOperationManager.hideAllLineOperation(),E.merge(i.options,{dockers:[]},!0),E.merge(i.options.style,{lineType:e},!0);var r=this.createConnectorByNodes(i.startNode,i.endNode,i.options,!1);r&&(r.icons=i.icons,r.on("Connector:click",function(){this.lineOperationManager.bindOperation(r)}.bind(this)))},S.createConnectorPoint=function(t,e,i){var n=this,o=new a.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:4,cursor:"crosshair",draggable:!0,lineType:i});o.type="ConnectPoint",o.pos=e;E.each(["dragstart","drag","dragend"],function(i){o.on(i,function(t){var e={};e.event=t,e.type="ConnectPoint:"+i,n.group.trigger(e.type,e)})}),this.group.add(o)},S.hideConnectorPoint=function(){var e=this;this.group.children().forEach(function(t){"ConnectPoint"===t.type&&e.group.remove(t)}),this.group.off("ConnectPoint:dragstart"),this.group.off("ConnectPoint:drag"),this.group.off("ConnectPoint:dragend")},S.filterConnectPoint=function(t,n){if(!this.judgeIfReadMode()&&this.ifShowConnectorPoint()){var o=this,e=[],i=[],r=[];1<t.length?(t.forEach(function(t){L.isGroupNode(t)?(r.push(t),e=e.concat(t.children())):i.push(t)}),i.forEach(function(t){e.includes(t)||r.push(t)})):r=t,r.forEach(function(t){if(!o.judgeIfReadMode(t)&&o.ifShowConnectorPoint(t)){var e=A.getRect(t);t.parent&&L.isGroupNode(t.parent)&&(e.boundingRect.x+=L.parentX(t.parent),e.boundingRect.y+=L.parentY(t.parent));var i=A.getConnectorPoints(e,t);o.createConnectorPoint(i.left,"left",n),o.createConnectorPoint(i.right,"right",n),o.createConnectorPoint(i.top,"top",n),o.createConnectorPoint(i.bottom,"bottom",n)}})}},S.showConnectorPoint=function(t,e,s){var l=this;this.hideConnectorPoint(),t&&(this.lineType=t),this.lineType||(this.lineType="jagged"),e&&(this.lineOpt=e);var i=(s=s||!1)?[l.selectedNode]:l.allNodes;s||(l._removeOperationNode(),l._releaseSelectNode(),l.hideConnectorControl()),this.filterConnectPoint(i,this.lineType),this.group.on("ConnectPoint:dragstart",function(t){s&&l.filterConnectPoint(l.allNodes,l.lineType);var e=(t.event.offsetX-l.group.position[0])/l.nowZoom,i=(t.event.offsetY-l.group.position[1])/l.nowZoom,n=t.event.target;l.reverseConnect=!1,l.startPos=n.pos,l.selectConnNode=function(n,o,r,s){var a,h=null;return l.allNodes.forEach(function(t){var e=A.getRect(t);t.parent&&L.isGroupNode(t.parent)&&(e.boundingRect.x+=L.parentX(t.parent),e.boundingRect.y+=L.parentY(t.parent));var i=A.getConnectorPoints(e,t);s?Math.abs(i[s].x-n)<=r&&Math.abs(i[s].y-o)<=r&&(a=t):Math.abs(i.left.x-n)<=r&&Math.abs(i.left.y-o)<=r?(h="left",a=t):Math.abs(i.top.x-n)<=r&&Math.abs(i.top.y-o)<=r?(h="top",a=t):Math.abs(i.right.x-n)<=r&&Math.abs(i.right.y-o)<=r?(h="right",a=t):Math.abs(i.bottom.x-n)<=r&&Math.abs(i.bottom.y-o)<=r&&(h="bottom",a=t)}),{node:a,endPos:h}}(n.shape.cx,n.shape.cy,0,l.startPos).node,n.hide(),l.lineOperationManager.hideAllLineOperation(),l.originNode=null;var o=new y(e,i),r=l.connectionManager.manageTempConnector(l.selectConnNode,o,n.lineType,l.startPos);l.group.add(r)}),this.group.on("ConnectPoint:drag",function(t){var e=t.event.target;l._handleLineDrag("drag",t,e.lineType)}),this.group.on("ConnectPoint:dragend",function(t){var e=t.event.target;l._handleLineDrag("dragend",t,e.lineType),e.show(),e.position=[0,0]})},S.createLineConnectorPoint=function(t,e,i){var n=new a.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:4,draggable:!0,lineType:i});n.type="ConnectPoint",n.pos=e,this.group.add(n)},S.getRotatedCornerCursor=function(t,e){var i=t.rotation;if("mtr"===e)return this.cursorMap[e];if(0<Math.abs(i)){var n=-i/(Math.PI/180),o=Math.round(n%360/45);return o<0&&(o+=8),o+=this.cursorOffset[e],o%=8,this.cursorMaps[o]}return this.cursorMap[e]},S.createConnectorControl=function(t,e,n){var o=this;if(e.split(",").length<2){var r=o.getRotatedCornerCursor(n,e),s=new a.Rect({shape:{x:t.x-4,y:t.y-4,width:8,height:8},style:{fill:"#ffffff",stroke:"#000000"},z:4,rotation:n.rotation,origin:[t.x,t.y],cursor:r,draggable:!0});s.type="ConnectControl",s.pos=e;E.each(["dragstart","drag","dragend"],function(i){s.on(i,function(t){var e={};e.event=t,e.type="ConnectControl:"+i,e.nodeId=n.id,e.cursor=r,o.group.trigger(e.type,e)})}),this.group.add(s)}else{var i=new a.Line({shape:{x1:t.top.x,y1:t.top.y,x2:t.bottom.x,y2:t.bottom.y},style:{lineWidth:1},z:1,draggable:!1,cursor:"default"});i.type="ConnectControlLine",i.nodeId=n.id,this.group.add(i)}},S.returnConnectorControlParam=function(t){return{scaleable:"boolean"==typeof t.scaleable?t.scaleable:this.options.scaleable,rotatable:"boolean"==typeof t.rotatable?t.rotatable:this.options.rotatable}},S.ifShowConnectorPoint=function(t){return t&&"boolean"==typeof t.connectable?t.connectable:this.options.connectable},S.hideConnectorControl=function(){var e=this,i=["ConnectControl","ConnectControlLine"];this.group.children().forEach(function(t){i.includes(t.type)&&e.group.remove(t)}),this.group.off("ConnectControl:dragstart"),this.group.off("ConnectControl:drag"),this.group.off("ConnectControl:dragend")},S.showConnectorControl=function(){if(!this.judgeIfReadMode(this.selectedNode)){var R=this;this.hideConnectorControl();var t=A.getRect(this.selectedNode),e=A.getConnectorControls(t,this.selectedNode),i=this.returnConnectorControlParam(this.selectedNode);i.scaleable&&(R.createConnectorControl(e.tl,"tl",this.selectedNode),R.createConnectorControl(e.tr,"tr",this.selectedNode),R.createConnectorControl(e.bl,"bl",this.selectedNode),R.createConnectorControl(e.br,"br",this.selectedNode)),i.rotatable&&(R.createConnectorControl(e.mtr,"mtr",this.selectedNode),R.createConnectorControl({top:e.mtr,bottom:e.tc},"mtr,tc",this.selectedNode)),this.group.on("ConnectControl:dragstart",function(t){var e=t.event.target.cursor,i=t.event.target.pos,n={tl:"br",tr:"bl",bl:"tr",br:"tl"};if(R.selectConnNode=function(e){var i=null;return R.group.children().forEach(function(t){t.id===e&&(i=t)}),i}(t.nodeId),e&&"mtr"!==i){var o=E.find(R.group.children(),function(t){return t.pos===n[i]}),r=E.find(R.group.children(),function(t){return t.pos===i}),s=R.selectConnNode.getBoundingRect();R.oppositeShape=E.clone(o.shape),R.currentShape=E.clone(r.shape);var a=E.clone(A.getRect(R.selectConnNode,!0)),h=Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2));R.diagonal=h,R.originRect=E.clone(a),R.ifPointCenter=s.x<-1,R.selectConnNode.selectStyle&&R._api.getZr().removeHover(R.selectConnNode)}}),this.group.on("ConnectControl:drag",function(t){var e=t.event.target.cursor,i=t.event.target.pos,n=R.selectConnNode,o=(t.event.offsetX-R.group.position[0])/R.nowZoom,r=(t.event.offsetY-R.group.position[1])/R.nowZoom,s=A.getRect(n,!0);if("mtr"===i){var a=o-n.position[0],h=r-n.position[1],l={x:s.x-n.position[0],y:s.y-n.position[1]},c=Math.atan2(h,a);R.selectedNode.attr({origin:[l.x,l.y],rotation:-c});var u=A.getConnectorPoints(s,R.selectedNode),d=A.getConnectorControls(s,R.selectedNode);R.group.children().forEach(function(t){var e=t.pos;"ConnectControl"===t.type?("mtr"===e&&(t.attr("position",[0,0]),t.attr("rotation",0)),t.setShape({x:d[e].x-4,y:d[e].y-4}),t.attr({origin:[t.shape.x+4,t.shape.y+4],rotation:-c})):"ConnectControlLine"===t.type?t.setShape({x1:d.mtr.x,x2:d.tc.x,y1:d.mtr.y,y2:d.tc.y}):"ConnectPoint"===t.type&&t.setShape({cx:u[e].x,cy:u[e].y})})}else{var p,f,g,y=1,v=[],m={tl:"br",tr:"bl",bl:"tr",br:"tl"},x=R.group.children().filter(function(t){return"ConnectControl"===t.type&&"mtr"!==t.pos}),_=E.find(x,function(t){return t.pos===i});if(o<=8&&(o=8),r<=8&&(r=8),["n-resize","s-resize"].includes(e)){var b=_.shape.y+4;y=R.currentShape.y>=R.oppositeShape.y?(r-R.oppositeShape.y-4)/(b-R.oppositeShape.y):(R.oppositeShape.y+4-r)/(R.oppositeShape.y-b)}else{var w=_.shape.x+4;y=R.currentShape.x>=R.oppositeShape.x?(o-R.oppositeShape.x-4)/(w-R.oppositeShape.x):(R.oppositeShape.x+4-o)/(R.oppositeShape.x-w)}/^[0-9]+.?[0-9]*/.test(y)||(y=1),n.updateShape(y);var P=A.getRect(n,!0);p=R.ifPointCenter?{x:R.originRect.x,y:R.originRect.y}:{x:R.originRect.boundingRect.x,y:R.originRect.boundingRect.y};var C=Math.sqrt(Math.pow(P.width,2)+Math.pow(P.height,2));switch(e){case"n-resize":case"nw-resize":f=(R.oppositeShape.x+4-p.x)*C/R.diagonal,g=(R.oppositeShape.y+4-p.y)*C/R.diagonal,v.push(R.oppositeShape.x-f+4,R.oppositeShape.y-g+4);break;case"e-resize":case"ne-resize":f=(p.x-R.oppositeShape.x-4)*C/R.diagonal,g=(R.oppositeShape.y+4-p.y)*C/R.diagonal,v.push(R.oppositeShape.x+f+4,R.oppositeShape.y-g+4);break;case"s-resize":case"se-resize":f=(p.x-R.oppositeShape.x-4)*C/R.diagonal,g=(p.y-R.oppositeShape.y-4)*C/R.diagonal,v.push(R.oppositeShape.x+f+4,R.oppositeShape.y+g+4);break;case"w-resize":case"sw-resize":f=(R.oppositeShape.x+4-p.x)*C/R.diagonal,g=(p.y-R.oppositeShape.y-4)*C/R.diagonal,v.push(R.oppositeShape.x-f+4,R.oppositeShape.y+g+4)}var N={x:P.x-v[0],y:P.y-v[1]};n.attr({position:v,origin:[N.x,N.y]});var T=A.getRect(n,!0),S=A.getConnectorPoints(T,n),M=A.getConnectorControls(T,n);R.group.children().forEach(function(t){var e=t.pos;e===i&&t.attr("position",[0,0]),"ConnectControl"===t.type&&e!==m[i]?(t.setShape({x:M[e].x-4,y:M[e].y-4}),t.attr("origin",[M[e].x,M[e].y])):"ConnectControlLine"===t.type?t.setShape({x1:M.mtr.x,x2:M.tc.x,y1:M.mtr.y,y2:M.tc.y}):"ConnectPoint"===t.type&&t.setShape({cx:S[e].x,cy:S[e].y})})}R.operationNode.refreshPostion(R.selectedNode,A.getRect(R.selectedNode)),R.connectionManager.refreshLineByNode(R.selectedNode),L.isGroupNode(R.selectedNode)&&R.selectedNode.each(function(t){R.connectionManager.refreshLineByNode(t)})}),this.group.on("ConnectControl:dragend",function(t){var e=R.selectConnNode,i=e.position,n=e.origin;R.selectConnNode.attr("position",[parseInt(i[0],10),parseInt(i[1],10)]),Array.isArray(n)&&R.selectConnNode.attr("origin",[parseInt(n[0],10),parseInt(n[1],10)]),e.updateShape(1,!0),e.model&&(e.model.set("options.rotation",e.rotation),e.model.set("options.origin",e.origin),"Image"===e.model.option.elementType?e.model.set("options.style",e.style):e.model.set("options.shape",e.shape));R.nodeClickHandler(e),R.stepCounter(),R.oppositeShape=null,R.currentShape=null,R.diagonal=null,R.originRect=null,R.ifPointCenter=null})}},S.initOperationNode=function(t,e){var d=this;function p(n,o,r,s){var a,h=null;return d.allNodes.forEach(function(t){var e=A.getRect(t);t.parent&&L.isGroupNode(t.parent)&&(e.boundingRect.x+=L.parentX(t.parent),e.boundingRect.y+=L.parentY(t.parent));var i=A.getConnectorPoints(e,t);s?Math.abs(i[s].x-n)<=r&&Math.abs(i[s].y-o)<=r&&(a=t):Math.abs(i.left.x-n)<=r&&Math.abs(i.left.y-o)<=r?(h="left",a=t):Math.abs(i.top.x-n)<=r&&Math.abs(i.top.y-o)<=r?(h="top",a=t):Math.abs(i.right.x-n)<=r&&Math.abs(i.right.y-o)<=r?(h="right",a=t):Math.abs(i.bottom.x-n)<=r&&Math.abs(i.bottom.y-o)<=r&&(h="bottom",a=t)}),{node:a,endPos:h}}this.operationNode=new h(t,this.group,this._api),this.operationNode.on(h.ARROW_DRAGSTART,function(t){this.hideConnectorPoint(),d.filterConnectPoint(d.allNodes,t.event.target.lineType);var e=(t.event.offsetX-this.group.position[0])/this.nowZoom,i=(t.event.offsetY-this.group.position[1])/this.nowZoom;t.data&&(this.lineOpt=t.data);var n=t.event.target;n.hide();var o=new y(e,i),r=this.connectionManager.manageTempConnector(this.selectedNode,o,n.lineType);this.group.add(r),t.cancelBubble=!0}.bind(this)),this.operationNode.on(h.ARROW_DRAG,function(t){var i=(t.event.offsetX-this.group.position[0])/this.nowZoom,n=(t.event.offsetY-this.group.position[1])/this.nowZoom,o=t.event.target,r=new y(i,n);this.connectionManager.manageTempConnector(this.selectedNode,r,o.lineType),d.group.children().forEach(function(t){if("ConnectPoint"===t.type&&(t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy]}),Math.abs(t.shape.cx-i)<=10&&Math.abs(t.shape.cy-n)<=10)){var e=p(i,n,10);d.connectionManager.manageTempConnector(d.selectedNode,r,o.lineType,"right",e.endPos,e.node),t.attr({style:{fill:"#ff0000"},scale:[1.5,1.5],origin:[t.shape.cx,t.shape.cy],cursor:"pointer"})}}),t.cancelBubble=!0}.bind(this)),this.operationNode.on(h.ARROW_DRAGEND,function(t){t.cancelBubble=!0;var e=p((t.event.offsetX-d.group.position[0])/d.nowZoom,(t.event.offsetY-d.group.position[1])/d.nowZoom,10),i=e.node,n=e.endPos||"left",o=t.event.target;if(o.show(),this.connectionManager.removeTempConnector(this.group),i&&this.selectedNode!=i){var r={},s={style:{lineType:o.lineType},position:{startPos:"right",endPos:n}},a=A.mergeOpt(s,d.lineOpt,!0,"position"),h=d.selectedNode,l=i;if(d.originNode&&(r.startNode=d.selectedNode,r.endNode=d.originNode,r.options=A.mergeOpt({style:{lineType:o.lineType},position:{startPos:d.startPos,endPos:d.originPos}},d.lineOpt,!0,"position")),!this._trigger("beforeCreate",{target:this.selectedNode,endNode:i,connectOptions:s,origin:{}}))return null;d.createConnectorByNodes(h,l,a)}d.hideConnectorPoint();var c=d.selectedNode,u=A.getRect(c,!0);d.showConnectorPoint(void 0,void 0,!0),d.operationNode.refreshPostion(c,u)}.bind(this)),this.operationNode.on(h.DELETE_CLICK,function(){this.removeNode(this.selectedNode)}.bind(this)),this.group.add(this.operationNode)},S.removeSelectedNodes=function(){var i=this;this.selectedNodes.length?(this.selectedNodes.forEach(function(t,e){i.removeNode(t,{},!0),e===i.selectedNodes.length-1&&i.stepCounter()}),this.selectedNodes=[],this.dragSelectRect.off("mousedown"),this.group.remove(this.dragSelectRect)):i.selectedNode&&(i.removeNode(i.selectedNode),this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode())},S.findNodeChildIds=function(t,e){e.push(t.id),t.children().filter(function(e){return-1!==this.allNodes.findIndex(function(t){return t.id===e.id})}.bind(this)).forEach(function(t){L.isGroupNode(t)?this.findNodeChildIds(t,e):e.push(t.id)}.bind(this))},S.remove=S.removeNode=function(t,e,i){if(!1===(e||{}).trigger||this._trigger("beforeDelete",{target:t})){var n=this._getParentZr(t);if(t instanceof p)E.each(t.icons,function(t){n.remove(t)}),this.connectionManager.deleteByLine(t,n);else{n.remove(t);var o=[];L.isGroupNode(t)?this.findNodeChildIds(t,o):o.push(t.id),this.allNodes=this.allNodes.filter(function(t){return-1===o.indexOf(t.id)}),this.connectionManager.deleteSelectCon(t,this.group),this._removeOperationNode()}this.hideConnectorPoint(),this.hideConnectorControl(),this.connectionManager.clearSelectCon(),this.lineOperationManager.hideAllLineOperation(),1!=i&&this.stepCounter(),this._trigger("delete",{target:t})}},S.selectNode=function(t){t&&(this.nodeClickHandler(t),this._trigger("selectNode",{target:t}))},S.createConnectorByNodes=function(t,e,i,n){var o=i.style.lineType||p.TYPE_STRAIGHT;if(!x[o])return null;var r=new x[o](t,e,i);return this.connectionManager.add(r),t.parent&&e.parent&&t.parent==e.parent?e.parent.add(r):this.group.add(r),this.connectionManager.connectorForbidEdit(!this.options.linkModify),this.createConnectorDragEvents(r),r.on("mousedown",function(t){this.isNode=!1,this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode()}.bind(this)),r.on("dblclick",function(){this.options.textEditable&&this.connectorEdit(this)}.bind(this)),!1!==n&&this._trigger("create",{target:r}),this.stepCounter(),r},S._handleLineDrag=function(t,e,i){var l=this;function n(n,o,r,s){var a,h=null;return l.allNodes.forEach(function(t){var e=A.getRect(t);t.parent&&L.isGroupNode(t.parent)&&(e.boundingRect.x+=L.parentX(t.parent),e.boundingRect.y+=L.parentY(t.parent));var i=A.getConnectorPoints(e,t);s?Math.abs(i[s].x-n)<=r&&Math.abs(i[s].y-o)<=r&&(a=t):Math.abs(i.left.x-n)<=r&&Math.abs(i.left.y-o)<=r?(h="left",a=t):Math.abs(i.top.x-n)<=r&&Math.abs(i.top.y-o)<=r?(h="top",a=t):Math.abs(i.right.x-n)<=r&&Math.abs(i.right.y-o)<=r?(h="right",a=t):Math.abs(i.bottom.x-n)<=r&&Math.abs(i.bottom.y-o)<=r&&(h="bottom",a=t)}),{node:a,endPos:h}}var o=(e.event.offsetX-l.group.position[0])/l.nowZoom,r=(e.event.offsetY-l.group.position[1])/l.nowZoom,s=new y(o,r);if("drag"===t&&(l.reverseConnect?l.connectionManager.manageReverseTempConnector(s,l.selectConnNode,i,l.endPos):l.connectionManager.manageTempConnector(l.selectConnNode,s,i,l.startPos),l.group.children().forEach(function(t){if("ConnectPoint"===t.type&&(t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy]}),Math.abs(t.shape.cx-o)<=10&&Math.abs(t.shape.cy-r)<=10)){var e=n(o,r,10);l.reverseConnect?l.connectionManager.manageReverseTempConnector(s,l.selectConnNode,i,l.endPos,e.endPos,e.node):l.connectionManager.manageTempConnector(l.selectConnNode,s,i,l.startPos,e.endPos,e.node),t.attr({style:{fill:"#ff0000"},scale:[1.5,1.5],origin:[t.shape.cx,t.shape.cy],cursor:"pointer"})}})),"dragend"===t){var a=n(o,r,10),h=a.node,c=a.endPos||"left";if(l.connectionManager.removeTempConnector(l.group),h&&l.selectConnNode.id!==h.id){var u={},d={style:{lineType:i},position:{startPos:l.reverseConnect?c:l.startPos,endPos:l.reverseConnect?l.endPos:c}},p=A.mergeOpt(d,l.lineOpt,!0,"position"),f=l.reverseConnect?h:l.selectConnNode,g=l.reverseConnect?l.selectConnNode:h;if(l.originNode&&(u.startNode=l.reverseConnect?l.originNode:l.selectConnNode,u.endNode=l.reverseConnect?l.selectConnNode:l.originNode,u.options=A.mergeOpt({style:{lineType:i},position:{startPos:l.reverseConnect?l.originPos:l.startPos,endPos:l.reverseConnect?l.endPos:l.originPos}},l.lineOpt,!0,"position")),!l._trigger("beforeCreate",{target:f,endNode:g,connectOptions:p,origin:u}))return!1;l.createConnectorByNodes(f,g,p),l.hideConnectorPoint(),l.operationNode&&l.showConnectorPoint(void 0,void 0,!0)}else l.group.children().forEach(function(t){"ConnectPoint"===t.type&&t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy],cursor:"crosshair"})})}},S.createConnectorDragEvents=function(d){var p=this;d.on("dragstart",function(t){var e=(t.event.offsetX-p.group.position[0])/p.nowZoom,i=(t.event.offsetY-p.group.position[1])/p.nowZoom,n=this.opt,o=n.style.lineType,r=this.model.option.options.dockers,s=r[0],a=r[r.length-1],h=Math.abs(e-s.x)+Math.abs(i-s.y),l=Math.abs(e-a.x)+Math.abs(i-a.y);if(!(15<h&&15<l)){var c,u=new y(e,i);p.filterConnectPoint(p.allNodes,o),p.reverseConnect=!1,p.selectConnNode=d.startNode,l<=15&&(p.selectConnNode=d.startNode,p.startPos=n.position.startPos,p.originNode=this.endNode,p.originPos=n.position.endPos),h<=15&&(p.reverseConnect=!0,p.selectConnNode=d.endNode,p.endPos=n.position.endPos,p.originNode=this.startNode,p.originPos=n.position.startPos),p.connectionManager.deleteByLine(this,p.group),c=p.reverseConnect?p.connectionManager.manageReverseTempConnector(u,p.selectConnNode,o,p.endPos):p.connectionManager.manageTempConnector(p.selectConnNode,u,o,p.startPos),p.group.add(c),c.setSelectedStyle()}}),d.on("drag",function(t){p._handleLineDrag("drag",t,this.opt.style.lineType)}),d.on("dragend",function(t){p._handleLineDrag("dragend",t,this.opt.style.lineType),p.hideConnectorPoint(),p.hideConnectorControl()})},S._trigger=function(t,e,i){var n=this.options[t];return void 0===i&&(i={}),null===e?e={type:t,target:this}:e.type=t,e.data=i,this._api.trigger(e.type,e),!(E.isFunction(n)&&!1===n.apply(this,[e].concat(i)))},S.nodeClickHandler=function(t){if("GROUP_RELATION_IMAGE"!==t.name){var e="dragSelect"!==t.type;if(t.parent&&"dragSelect"===t.parent.type&&(e=!1),this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),!1===t.selectable){if(!L.isInGroup(t))return;var i=t.parent;if(!1===i.selectable)return;t=i}this.selectedNode=t;var n=A.getRect(t,!0);if(this.operationNode||this.initOperationNode(t,!0),e){this.showConnectorPoint(void 0,void 0,!0);var o=this.returnConnectorControlParam(t);(o.scaleable||o.rotatable)&&this.showConnectorControl()}this.operationNode.refreshPostion(t,n)}},S.drag=function(e){var i=this;e.on("mousedown",function(t){i.judgeIfReadMode(this)||this.parent&&"dragSelect"===this.parent.type||e.style&&"none"===e.style.fill||(i._nodeDragHandler(this,t.offsetX,t.offsetY),t.cancelBubble=!0)})},S._recurmodifyGroupRect=function(t,e,i){if("GROUP_RELATION_IMAGE"===t.name&&e&&(this._removeOperationNode(),this._recurmodifyRelationImageGroupRect(t,e,i,!0)),L.isInGroup(t)){var n={node:t,position:t.position};t.parent.modifyGroupRect(n),t.parent&&L.isGroupNode(t.parent)&&this._recurmodifyGroupRect(t.parent)}},S._recurmodifyRelationImageGroupRect=function(t,e,i,n){if(L.isInGroup(e)){var o=E.clone(e.position);n&&(o=[o[0]+i.moveX,o[1]+i.moveY]);var r={node:e,position:o};e.parent.modifyGroupRect(r),e.parent&&L.isGroupNode(e.parent)&&this._recurmodifyRelationImageGroupRect(t,e.parent,i,!1)}},S._recureRefreshLine=function(t){L.isGroupNode(t)&&t._relationImage?t.each(function(t){this.connectionManager.refreshLineByNode(t),L.isGroupNode(t)&&(t.ignore&&t._relationImage&&this.connectionManager.refreshLineByNode(t._relationImage),this._recureRefreshLine(t))}.bind(this)):this.connectionManager.refreshLineByNode(t)},S._createRelationImageLine=function(i,t){var e=this,n=[],o=[],r=this.group._children.filter(function(t){return t instanceof p&&"GROUP_RELATION_LINE"!==t.name}),s=this.findGroupNodes(t);r.forEach(function(e,t){s.some(function(t){return t.id===e.endNode.id})&&s.filter(function(t){return t.id===e.startNode.id}).length<=0&&o.push({options:E.clone(e.opt),startNode:e.startNode,endNode:i}),s.some(function(t){return t.id===e.startNode.id})&&s.filter(function(t){return t.id===e.endNode.id}).length<=0&&n.push({options:E.clone(e.opt),startNode:i,endNode:e.endNode})});function a(t){if(!(t.length<=0)){var n=[];t.forEach(function(t,e){if(0===e)n.push([t]);else{var i=function(t,e){for(var i=-1,n=0;n<t.length;n++){var o=t[n][0];if(o.startNode.id===e.startNode.id&&o.endNode.id===e.endNode.id&&JSON.stringify(o.options.position)===JSON.stringify(e.options.position)&&o.options.style.lineType===e.options.style.lineType){i=n;break}}return i}(n,t);-1<i?n[i].push(t):n.push([t])}}),n.forEach(function(t){1<t.length&&function(t){var e=t.length,i=E.clone(t[0].options.position),n=t[0].startNode,o=t[0].endNode,r=n.getBoundingRect(),s=o.getBoundingRect(),a="top"===i.startPos||"bottom"===i.startPos?"width":"height",h="top"===i.endPos||"bottom"===i.endPos?"width":"height",l=r[a],c=s[h],u=parseInt(l/(e+1),10),d=parseInt(c/(e+1),10),p=e%2!=0,f=p?Math.ceil(e/2):e/2;t.forEach(function(t,e){p?e+1<f?(t.options.position.startPos=i.startPos+"-"+u*(f-e-1),t.options.position.endPos=i.endPos+"-"+d*(f-e-1)):f<e+1&&(t.options.position.startPos=i.startPos+"+"+u*(e+1-f),t.options.position.endPos=i.endPos+"+"+d*(e+1-f)):e+1<=f?(t.options.position.startPos=i.startPos+"-"+u*(f-e),t.options.position.endPos=i.endPos+"-"+d*(f-e)):(t.options.position.startPos=i.startPos+"+"+u*(e+1-f),t.options.position.endPos=i.endPos+"+"+d*(e+1-f))})}(t)}),t.forEach(function(t){e.createConnectorByNodes(t.startNode,t.endNode,t.options).name="GROUP_RELATION_LINE"})}}a(o),a(n)},S._removeRelationImageLine=function(e){var i=this,t=this.group._children.filter(function(t){return t instanceof p&&"GROUP_RELATION_LINE"===t.name});0<t.length&&t.forEach(function(t){t.startNode.id!==e.id&&t.endNode.id!==e.id||i.remove(t)})},S._refreshRelationImagePosition=function(t,e){L.isGroupNode(t)&&1===e&&t.refreshRelationImage()},S._nodeDragHandler=function(a,t,e){var h,l=0,o=this,c=a.position,u=a.position[0],d=a.position[1];if(a._startX=t,a._startY=e,"GROUP_RELATION_IMAGE"===a.name&&(h=E.find(this.allNodes,function(t){return t.id===a.relatedGroupId})),"dragSelect"===a.type){var i=this.group.children().filter(function(t){return t.model&&"connection"===t.model.option.elementType}),r=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&t.model&&"connection"!==t.model.option.elementType}),s=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&t.model&&"connection"===t.model.option.elementType});i.forEach(function(e){var t=E.find(this.allNodes,function(t){return t.id===e.startNode.id}),i=E.find(r,function(t){return t.id===e.endNode.id}),n=s.findIndex(function(t){return t.id===e.id});(t||i)&&-1===n&&o.connectionManager.removeLine(e,o._getParentZr(e))})}a.trigger("dragstart");var p=function(t){t.cancelBubble=!0;var e=(t.offsetX-a._startX)/this.nowZoom,i=(t.offsetY-a._startY)/this.nowZoom;if(0==e&&0==i||(l=1),a.trigger("drag"),this._recurmodifyGroupRect(a,h,{moveX:e,moveY:i,isMove:l}),c[0]=u+e,c[1]=d+i,a.attr("position",c),this._refreshRelationImagePosition(a,l),a.alarm){var n=[c[0]+a.getBoundingRect().width-(a.alarm.getBoundingRect().width-6),c[1]-a.alarm.getBoundingRect().height-3];a.alarm.attr("position",n)}if(this.nodeClickHandler(a),this._recureRefreshLine(a),!L.isInGroup(a)){if(this.group._children.some(function(t){return"GROUP_RELATION_IMAGE"===t.name}))return;for(var o=this.isPosInGroup(this.allNodes,a),r=0;r<this.allNodes.length;r++){var s=this.allNodes[r];L.isGroupNode(s)&&(o&&s.id===o.id&&s.id!==a.id?s.children().find(function(t){return"GROUP_RECT_NAME"===t.name}).attr("style",{fill:"#b6e3f5"}):s.children().find(function(t){return"GROUP_RECT_NAME"===t.name}).attr("style",{fill:"rgba(0,0,0,0)"}))}}}.bind(this);this._zr.on("mousemove",p);var f=function(){if(a.model&&a.model.set("options.position",g.truncPosition(a.position)),this._zr.off("mousemove",p),this._zr.off("mouseup",f),this._zr.off("globalout",f),1==l){if(this._trigger("dropDrag",{target:a}),a.trigger("dragend"),1==this.eagleEye&&this.openEagleEye(this.eagleEyeNode),!L.isInGroup(a)){if(this.group._children.some(function(t){return"GROUP_RELATION_IMAGE"===t.name}))return;var t=this.isPosInGroup(this.allNodes,a);if(t)for(var e=0;e<this.allNodes.length;e++){var i=this.allNodes[e];if(L.isGroupNode(i)&&i.id===t.id&&i.id!==a.id){this._getParentZr(a).remove(a),i.add(a);var n=L.isGroupNode(a)?a.position[0]+a.options.shape.x:a.position[0],o=L.isGroupNode(a)?a.position[1]+a.options.shape.y:a.position[1],r=this.parentX(t),s=this.parentY(t);a.attr("position",[n-r+i.options.shape.x,o-s+i.options.shape.y]),i.children().find(function(t){return"GROUP_RECT_NAME"===t.name}).attr("style",{fill:"rgba(0,0,0,0)"})}}}this.stepCounter()}}.bind(this);this._zr.on("mouseup",f),this._zr.on("globalout",f)},S.parentX=function(t){return t.parent&&L.isGroupNode(t.parent)&&this.group.id!==t.parent.id?t.position[0]+t.options.shape.x+this.parentX(t.parent):t.position[0]+t.options.shape.x},S.parentY=function(t){return t.parent&&L.isGroupNode(t.parent)&&this.group.id!==t.parent.id?t.position[1]+t.options.shape.y+this.parentY(t.parent):t.position[1]+t.options.shape.y},S.isPosInGroup=function(t,e){if(0<t.length){for(var i=null,n=0;n<t.length;n++){var o=t[n];if(L.isGroupNode(o)){var r=o.options.shape.width,s=o.options.shape.height,a=this.parentX(o),h=this.parentY(o),l=A.getRect(e,!0),c=l.width,u=l.height,d=l.x-c/2,p=l.y-u/2;if(a<=d&&h<=p&&d+c<=a+r&&p+u<=h+s){var f=o.children(),g=this.isPosInGroup(f,e);i=g||o;break}}}return i}return null},S.createNode=S.creatNode=function(t,e,i){if(!v[t])return null;var n=new v[t](e);return L.setUserData(n,i),n},S.childOfName=function(t){for(var e=[],i=this.allNodes,n=this.connectionManager.connectors,o=0;o<i.length;o++)i[o].model.get("options.name")&&i[o].model.get("options.name")==t?e.push(i[o]):i[o].model.get("userData.name")==t&&e.push(i[o]);for(var r=0;r<n.length;r++)n[r].model.get("options.name")&&n[r].model.get("options.name")==t?e.push(n[r]):n[r].model.get("userData.name")==t&&e.push(n[r]);return 1<e.length?e:e[0]},S.findElements=function(t,e){for(var i=this.allNodes,n=this.connectionManager.connectors,o=[],r=0;r<i.length;r++){var s=i[r];t.call(e,s,r)&&o.push(s)}for(var a=0;a<n.length;a++){var h=n[a];t.call(e,h,a)&&o.push(h)}return o},S.findConnectorsByNode=function(t,e){var i=e||{},n=[];E.defaults(i,{startNode:!0});for(var o=this.connectionManager.connectors,r=0;r<o.length;r++){var s=o[r];i.startNode?s.startNode.id===t.id&&n.push(s):s.endNode.id===t.id&&n.push(s)}return n},S.setBackground=function(t,e){if(t&&0<t.length)if(this.model.set(c.BACKGROUND,t),"#"==t.substr(0,1)||"rgba"==t.substr(0,4))if(document.createElement("canvas").getContext){var i=new this.Shape.Rect({shape:{width:this._zr.getWidth(),height:this._zr.getHeight()},style:{fill:t},cursor:"default",z:-1});this._zr.add(i)}else this._dom.style.backgroundColor=t;else if("gridLine"==t)this.gridLineGroup=new a.Group,this.gridLine(.2),this._zr.add(this.gridLineGroup);else if(!document.createElement("canvas").getContext||e)this._dom.style.backgroundImage="url("+t+")",this._dom.style.backgroundRepeat="repeat";else{var n=new this.Shape.Image({position:[0,0],scale:[1,1],style:{x:0,y:0,image:t,width:this._zr.getWidth(),height:this._zr.getHeight()},cursor:"default",z:-1});this._zr.add(n)}},S.gridLine=function(t){for(var e=parseInt(this.getWidth()/10),i=0;i<=e;i++){var n=new a.Line({shape:{x1:10*i,y1:0,x2:10*i,y2:this.getHeight()},style:{lineDash:[1],opacity:t},z:0,draggable:!1,cursor:"default"});this.gridLineGroup.add(n)}for(var o=parseInt(this.getHeight()/10,10),r=0;r<=o;r++){var s=new a.Line({shape:{x1:0,y1:10*r,x2:this.getWidth(),y2:10*r},style:{lineDash:[1],opacity:t},z:0,draggable:!1,cursor:"default"});this.gridLineGroup.add(s)}},S.createLink=S.creatLink=function(t,e,i,n){var o=p.TYPE_STRAIGHT;if(i&&i.style&&i.style.lineType&&(o=i.style.lineType),!x[o])return null;var r=new x[o](t,e,i);return n&&r.model.set(c.USERDATA,E.clone(n)),r},S.refreshLineByNode=function(t){this.connectionManager.refreshLineByNode(t)},S.connectorEdit=function(t){var e=t.childOfName("lineText");if(e){var i={},n=this.createTextArea(),o=b.getBoundingRect(e.style.text,e.style.textFont),r=1.2*A.getRect(e).width*this.nowZoom+10;Object.keys(e.style).forEach(function(t){"host"!==t&&"text"!==t&&(i[t]=e.style[t])}),n.style.width=1.2*A.getRect(e).width*this.nowZoom+"px",n.style.height=(2*o.height||12)*this.nowZoom+"px",n.style.border="1px dashed #2e2e2e",n.innerHTML=e.style.text,t.setStyle({text:{text:""}}),this._dom.appendChild(n),this._dom.style.position="relative",n.style.lineHeight=(1.2*o.lineHeight||12)+"px",n.style.top=(e.position[1]-o.height)*this.nowZoom+this.group.position[1]+"px",n.style.left=(e.position[0]-.55*o.width)*this.nowZoom+this.group.position[0]+"px",n.focus(),n.select(),this._textareaResize(o,n,r),n.onkeyup=function(){n.style.width=o.width<60?"80px":n.style.width,n.style.height=n.scrollHeight+"px"},n.onfocusout=function(){i.text=n.value||"",t.setStyle({text:i}),t.refresh(),n.remove()}}},S.nodeEdit=function(e){var i=!1,n=this.createTextArea(),o=E.clone(e.style.text),t=b.getBoundingRect(o,e.style.textFont),r=t.width<25?1.2*t.width*this.nowZoom+10:36,s=(2*t.height||24)*this.nowZoom;n.style.width=r+"px",n.style.height=s+"px";var a=A.getRect(e),h=1.2*a.width*this.nowZoom;n.style.lineHeight=(1.2*t.lineHeight||14.4)+"px",n.style.border="1px dashed #2e2e2e",n.innerHTML=e.style.text,n.style.maxWidth=h+"px",this.setStyle(e,{text:""}),this._dom.appendChild(n),this._dom.style.position="relative";var l=1;"left"==e.style.textAlign&&(l=0),"right"==e.style.textAlign&&(l=2);var c=0;e.style.textPosition&&"bottom"==e.style.textPosition&&(c=1,h=3.3*a.width*this.nowZoom,n.style.maxWidth=h+"px"),e.style.textPosition&&"top"==e.style.textPosition&&(c=-1,h=3.3*a.width*this.nowZoom,n.style.maxWidth=h+"px"),n.style.top=(a.y-s/2+c*(a.height-t.height/2))*this.nowZoom+this.group.position[1]+"px",n.style.left=(a.x-l*r/2)*this.nowZoom+this.group.position[0]+"px",n.focus(),n.select(),n.onkeyup=function(){if(event.keyCode==N)i=!0,n.blur();else{var t=b.getBoundingRect(n.value,e.style.textFont);this._textareaResize(t,n,h)}}.bind(this),n.onblur=function(){if(i)this.setStyle(e,{text:o});else{var t=this.handleWrap(n.value,n.style.maxWidth);this.setStyle(e,{text:t})}n.remove()}.bind(this)},S.createTextArea=function(){var t=document.createElement("textarea");return t.style.position="absolute",t.style.padding="6px",t.style.resize="none",t.style.whiteSpace="pre",t.style.lineHeight="125%",t.style.overflow="hidden",t.style.border="0",t.spellcheck=!1,t},S.handleWrap=function(t,a){var h=document.createElement("span");h.style.position="absolute",h.style.overflow="hidden",h.style.border="0",h.style.padding="0",h.style.left="0",h.style.top="0",this._dom.appendChild(h);var l=t.split("\n"),c="";return l.forEach(function(t,e){var i=t.length;if(0==i);else for(var n,o,r="",s=0;s<i;s++)n=t.charAt(s),h.innerHTML=h.innerHTML+n,o=h.clientWidth,Number(a.substring(0,a.length-2))<o?(c+=r,c+="\n",r=h.innerHTML=n):s==i-1?(c+=r+n,e<l.length-1&&(c+="\n"),r=h.innerHTML=""):r+=n}),this._dom.removeChild(h),c},S._textareaResize=function(t,e,i){var n=0;e.style.width=0,e.style.width=1.2*t.width*this.nowZoom+"px",n=i<60?i:80,t.width<=n&&(e.style.width=n+"px"),e.style.height="0px",e.style.height=e.scrollHeight+"px",e.scrollHeight<=0&&(e.style.height="12px")},S.setStyle=function(t,e){t.setStyle(e),E.merge(t.model.get("options.style"),e,!0)},S.setShape=function(t,e){t.setShape(e),t.model&&E.merge(t.model.get("options.shape"),e,!0)},S.createAlarm=S.creatAlarm=function(t,e){var i=this.createNode("Group",{style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)"}});i.isdraggable=!1;var n=this.createNode("Text",{style:{text:e.text,textFont:e.textFont,fill:e.textFill,textBaseline:"top"},selectable:!1,position:[2,0],z:2});n.isdraggable=!1,i.add(n),L.isInGroup(t)?t.parent.add(i):this.group.add(i);var o=i.getBoundingRect().width+2,r=i.getBoundingRect().height+6,s=[[0,0],[o,0],[o,r],[o-3,r],[o-6,r+3],[o-9,r],[0,r],[0,0]],a=this.createNode("Polyline",{shape:{points:s},style:{fill:e.textBackground,stroke:e.textBackground},selectable:!1,z:1});a.isdraggable=!1,i.add(a);var h=[t.position[0]+t.getBoundingRect().width-(i.getBoundingRect().width-6),t.position[1]-i.getBoundingRect().height-3];i.attr("position",h),t.alarm=i;var l=new u({});return l.set(c.ELEMENT_TYPE,c.ALARM),l.set(c.OPTIONS,E.clone(e)),l.set(c.RELATIONID,t.model.get(c.ID)),i.model=l,i},S.toDataURL=function(t){return g.toDataURL(this._zr,t)},S._releaseSelectNode=function(){if(this.dragSelectRect){for(var t=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name}),e=this.group.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name}).map(function(t){return t.id}),i=this.dragSelectRect.position[0],n=this.dragSelectRect.position[1],o=0;o<t.length;o++){var r=t[o],s=L.isGroupNode(r)?r.position[0]+r.options.shape.x:r.position[0],a=L.isGroupNode(r)?r.position[1]+r.options.shape.y:r.position[1];this.dragSelectRect.remove(r),e.includes(r.id)||this.group.add(r),"connection"!==r.model.option.elementType&&(r.attr("position",[s+i,a+n]),this.connectionManager.refreshLineByNode(r))}this.dragSelectRect.off("mousedown"),this.group.remove(this.dragSelectRect)}},S._dragSelect=function(t,r,s){var a=this.group.position[0],h=this.group.position[1];this._releaseSelectNode(),this.dragSelectRect=new m({shape:{width:0,height:0},position:[(r-a)/this.nowZoom,(s-h)/this.nowZoom],childDraggable:!1,style:{lineDash:[2,2],fill:"rgba(239,222,221,0.7)",stroke:"#ddd"}}),this.dragSelectRect.type="dragSelect",this.group.add(this.dragSelectRect),this.drag(this.dragSelectRect);var n=function(t){var e=r<=t.offsetX?r:t.offsetX,i=s<=t.offsetY?s:t.offsetY,n=Math.abs(t.offsetX-r),o=Math.abs(t.offsetY-s);this.dragSelectRect.shape={width:n/this.nowZoom,height:o/this.nowZoom},this.dragSelectRect.setProperties({shape:{width:n/this.nowZoom,height:o/this.nowZoom},position:[(e-a)/this.nowZoom,(i-h)/this.nowZoom]})}.bind(this);this._zr.on("mousemove",n);var o=function(t){this._zr.off("mousemove",n),this._zr.off("mouseup",o),this._zr.off("globalout",o);var s=this,e=this.group.children().filter(function(t){return t.id!==s.dragSelectRect.id&&t.model&&"connection"!==t.model.option.elementType}),i=this.group.children().filter(function(t){return t.model&&"connection"===t.model.option.elementType}),a=this.dragSelectRect.position[0],h=this.dragSelectRect.position[1],l=this.dragSelectRect.options.shape.width,c=this.dragSelectRect.options.shape.height,u=0;e.forEach(function(t){var e=A.getRect(t,!0),i=e.width,n=e.height,o=e.x-i/2,r=e.y-n/2;a<=o&&h<=r&&o+i<=a+l&&r+n<=h+c&&(s.group.remove(t),s.dragSelectRect.add(t),s.selectedNodes.push(t),t.attr("position",[t.position[0]-a,t.position[1]-h]),u++)}),i.forEach(function(e){var t=s.dragSelectRect.children().find(function(t){return t.id===e.startNode.id}),i=s.dragSelectRect.children().find(function(t){return t.id===e.endNode.id});t&&i?(s.group.remove(e),s.dragSelectRect.add(e),s.selectedNodes.push(e),s.connectionManager.refreshLineByNode(e.startNode)):(t||i)&&s.group.remove(e)}),u?this.dragSelectRect.childOfName("GROUP_RECT_NAME").attr("style",{fill:"rgba(0,0,0,0)"}):(this.dragSelectRect.off("mousedown"),this.group.remove(this.dragSelectRect)),this.dragSelectRect.model.set("options.position",g.truncPosition(this.dragSelectRect.position)),this.dragSelectRect.model.set("options.shape",this.dragSelectRect.shape)}.bind(this);this._zr.on("mouseup",o),this._zr.on("globalout",o)},S._groupDragHandler=function(l,c){var u=this.group.position,d=this.group.position[0],p=this.group.position[1],t=function(t){var e=this.group.getBoundingRect().width*this.nowZoom,i=this.group.getBoundingRect().height*this.nowZoom,n=this.group.getBoundingRect().x*this.nowZoom,o=this.group.getBoundingRect().y*this.nowZoom,r=[10-(e+n),10-(i+o)],s=[this._zr.getWidth()-n-10,this._zr.getHeight()-o-10],a=t.offsetX-l,h=t.offsetY-c;u[0]=d+a,u[1]=p+h,u[0]>s[0]||u[1]>s[1]||u[0]<r[0]||u[1]<r[1]||(this.group.attr("position",u),1==this.eagleEye&&this.minimap.updataSelectionPosition(u,this.nowZoom))}.bind(this);this._zr.on("mousemove",t);var e=function(){this._zr.off("mousemove",t),this._zr.off("mouseup",e),this._zr.off("globalout",e)}.bind(this);this._zr.on("mouseup",e),this._zr.on("globalout",e)},S.initScale=function(){var t=this.group.getBoundingRect().width,e=this.group.getBoundingRect().height,i=this.getWidth(),n=this.getHeight(),o=1,r=[];return i/n<t/e?i<t&&(o=i/t):n<e&&(o=n/e),r[0]=Math.abs(this.group.getBoundingRect().x)*o,r[1]=Math.abs(this.group.getBoundingRect().y)*o,this.group.attr("position",[r[0],r[1]]),this.group.attr("scale",[o,o]),this.initScaleRatio=o,[r[0],r[1],this.initScaleRatio,t,e]},S.zrCenter=function(t){var e,i=this.group.position;e=E.isArray(t)?E.extend({},{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}):E.extend({},t),i[0]=this._zr.dom.offsetWidth/2-(e.minX+(e.maxX-e.minX)/2),i[1]=this._zr.dom.offsetHeight/2-(e.minY+(e.maxY-e.minY)/2),this.group.attr("position",i)},S.stepCounter=function(){this.stepJson.splice(this.step,this.stepJson.length-this.step),this.step+=1;var t=this.toJson();this.stepJson.push(JSON.stringify(t))},S.zrScale=function(t){if(!this.options.readonly)if(t){var e=0;if("narrowing"==t&&(e=-.07,this.zoom(e,this._zr.getWidth()/2,this._zr.getHeight()/2)),"enlarge"==t&&(e=.07,this.zoom(e,this._zr.getWidth()/2,this._zr.getHeight()/2)),!isNaN(t)){var i=this.group;if(i){var n=t/i.scale[0];this._zoom=t,this.nowZoom=t,this.setScale(this._zr.getWidth()/2,this._zr.getHeight()/2,n)}}}else this._zr.on("mousewheel",E.bind(function(t){d.stop(t.event);var e=0<t.wheelDelta?.07:-.07;this.zoom(e,this._zr.getWidth()/2,this._zr.getHeight()/2)},this))},S.zoom=function(t,e,i){if(0!=this.canScale&&this.group){var n=this._zoom=this._zoom||1;n+=t;var o=(n=Number(n.toFixed(2)))/this._zoom;if(n>this.options.maxScale||n<this.options.minScale)return;this._zoom=n,this.nowZoom=n,this.setScale(e,i,o)}},S.setScale=function(t,e,i){var n=this.group,o=n.position,r=n.scale;o[0]-=(t-o[0])*(i-1),o[1]-=(e-o[1])*(i-1),r[0]*=i,r[1]*=i,n.attr("position",[o[0],o[1]]),n.attr("scale",[r[0],r[1]]),1==this.eagleEye&&this.minimap.updataSelection(o[0],o[1],i,this.nowZoom)},S.openEagleEye=function(t){this.eagleEye=!0,this.eagleEyeNode=t;var e=E.clone(this.group.position),i=E.clone(this.group.scale);this.group.attr("position",[0,0]),this.group.attr("scale",[1,1]);var n=this.initScale(),o=this.toDataURL();this.group.attr("position",e),this.group.attr("scale",i),this.minimap?this.minimap.updataMap(o,this.group.getBoundingRect()):(this.minimap=new r(this,this.group.position,this.group.getBoundingRect(),t,n,o),setTimeout(E.bind(function(){this.openEagleEye(this.eagleEyeNode)},this),10)),this.minimap.selection.addEventListener("mousedown",function(t){var n=t.clientX,o=t.clientY,r=Number(this.minimap.selection.style.left.substring(0,this.minimap.selection.style.left.length-2)),s=Number(this.minimap.selection.style.top.substring(0,this.minimap.selection.style.top.length-2)),e=function(t){var e=t.clientX-n,i=t.clientY-o;this.minimap.selection.style.left=r+e+"px",this.minimap.selection.style.top=s+i+"px",this.minimap.updataGroupPosition(this.group,this.nowZoom)}.bind(this);this.minimap.selection.addEventListener("mousemove",e);var i=function(){this.minimap.selection.removeEventListener("mousemove",e),this.minimap.selection.removeEventListener("mouseup",i)}.bind(this);this.minimap.selection.addEventListener("mouseup",i)}.bind(this))},S.refreshGroupByNode=function(t){L.isInGroup(t)&&this._recurmodifyGroupRect(t),this.connectionManager.refreshLineByNode(t),L.isGroupNode(t)&&t.each(function(t){this.connectionManager.refreshLineByNode(t)}.bind(this))},E.mixin(T,o);var M=new Date-0,R={},k="_fishTopoFlow_instance_",O={version:"3.2.0",dependencies:{zrender:"3.6.3"},init:function(t,e){if(!t)throw new Error("Initialize failed: invalid dom.");e=e||{},E.defaults(e,{type:"flow",linkModify:!1,textEditable:!1,roam:!0,mouseMode:"default",tooltip:{show:!0},isAnimationEnabled:!0,readonly:!1,connectable:!0,scaleable:!1,rotatable:!1,beforeDelete:null,beforeCreate:null,maxScale:1.7,minScale:.3});var i=new T(t,e);return i.init(),i.Flow=L,i.id="ft_"+M++,R[i.id]=i,t.setAttribute&&t.setAttribute(k,i.id),i}};S.judgeIfReadMode=function(t){var e=this.options.readonly;return!!e||!(e||!t||0!=t.isdraggable)},O.getInstanceByDom=function(t){var e=t.getAttribute(k);return R[e]},O.dispose=function(t){var e;E.isDom(t)?e=O.getInstanceByDom(t):"string"==typeof t&&(e=R[t]),e instanceof O&&!e.isDisposed()&&e.dispose()},O.graphic=a,O.node=g.registerFlowNode(v),O.link=x,O.layout=_,O.Flow=L,O.constants=c,O.util=A,O.util.initImagePool=w.initImagePool,E.each(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","merge","mergeAll"],function(t){O.util[t]=E[t]}),t.exports=O},function(t,e){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function e(){}function i(){return o.apply(this instanceof e&&t?this:t||window,n.concat(Array.prototype.slice.call(arguments)))}var n=Array.prototype.slice.call(arguments,1),o=this;return e.prototype=this.prototype,i.prototype=new e,i}),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var i=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;var n=i.indexOf(t,e);return-1!==n&&n===e})},function(t,e,i){"use strict";var u=i(5),d=i(6),o=Math.round,n=i(7),a=i(20),r=i(14),s=i(15),h=i(42),p=i(43),l={};function c(t){if(!t.__isHover){if(t.__hoverStlDirty){var e=t.style.stroke,i=t.style.fill,n=t.__hoverStl,o=a.lift;n.fill=n.fill||i&&(i instanceof h?i:o(i,-.1)),n.stroke=n.stroke||e&&(e instanceof h?e:o(e,-.1));var r={};for(var s in n)n.hasOwnProperty(s)&&(r[s]=t.style[s]);t.__normalStl=r,t.__hoverStlDirty=!1}t.setStyle(t.__hoverStl),t.z2+=1,t.__isHover=!0}}function f(t){if(t.__isHover){var e=t.__normalStl;e&&t.setStyle(e),t.z2-=1,t.__isHover=!1}}function g(t){"group"===t.type||"GroupNode"===t.type?t.traverse(function(t){"group"!==t.type&&c(t)}):c(t)}function y(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&f(t)}):f(t)}function v(t,e){t.__hoverStl=t.hoverStyle||e||{},t.__hoverStlDirty=!0}function m(){this.__isEmphasis||g(this)}function x(){this.__isEmphasis||y(this)}function _(){this.__isEmphasis=!0,g(this)}function b(){this.__isEmphasis=!1,y(this)}function w(t,e,i,n,o){var r=t?"Update":"",s=n&&n.getShallow("animationDuration"+r),a=n&&n.getShallow("animationEasing"+r);n&&n.getShallow("animation")?e.animateTo(i,s,a,o):(e.attr(i),o&&o())}l.Util=u,l.Group=i(44),l.Image=i(45),l.Text=i(46),l.textContain=i(26),l.Circle=i(47),l.Sector=i(48),l.Ring=i(51),l.Polygon=i(52),l.Polyline=i(56),l.Rect=i(57),l.Line=i(58),l.BezierCurve=i(59),l.Arc=i(60),l.LinearGradient=i(61),l.RadialGradient=i(62),l.BoundingRect=i(27),l.States=i(63),l.extendShape=function(t){return n.extend(t)},l.extendPath=function(t,e){return d.extendFromString(t,e)},l.makePath=function(t,e,i,n){var o=d.createFromString(t,e);p.call(o);var r=o.getBoundingRect();if(i){var s=r.width/r.height;if("center"===n){var a,h=i.height*s;a=h<=i.width?i.height:(h=i.width)/s;var l=i.x+i.width/2,c=i.y+i.height/2;i.x=l-h/2,i.y=c-a/2,i.width=h,i.height=a}this.resizePath(o,i)}return u.inherits(o,p),o},l.mergePath=d.mergePath,l.resizePath=function(t,e){if(t.applyTransform){var i=t.getBoundingRect().calculateTransform(e);t.applyTransform(i)}},l.subPixelOptimizeLine=function(t){var e=l.subPixelOptimize,i=t.shape,n=t.style.lineWidth;return o(2*i.x1)===o(2*i.x2)&&(i.x1=i.x2=e(i.x1,n,!0)),o(2*i.y1)===o(2*i.y2)&&(i.y1=i.y2=e(i.y1,n,!0)),t},l.subPixelOptimizeRect=function(t){var e=l.subPixelOptimize,i=t.shape,n=t.style.lineWidth,o=i.x,r=i.y,s=i.width,a=i.height;return i.x=e(i.x,n,!0),i.y=e(i.y,n,!0),i.width=Math.max(e(o+s,n,!1)-i.x,0===s?0:1),i.height=Math.max(e(r+a,n,!1)-i.y,0===a?0:1),t},l.subPixelOptimize=function(t,e,i){var n=o(2*t);return(n+o(e))%2==0?n/2:(n+(i?1:-1))/2},l.doEnterHover=g,l.doLeaveHover=y,l.setElementHoverStl=v,l.setHoverStyle=function(t,e){"group"===t.type?t.traverse(function(t){"group"!==t.type&&v(t,e)}):v(t,e),t.on("mouseover",m).on("mouseout",x),t.on("emphasis",_).on("normal",b)},l.setNormalStyle=function(t,e){if(t.__normalStl)for(var i in e)t.__normalStl.hasOwnProperty(i)&&(t.__normalStl[i]=e[i])},l.setText=function(t,e,i){var n=e.getShallow("position")||"inside",o=0<=n.indexOf("inside")?"white":i,r=e.getModel("textStyle");u.extend(t,{textDistance:e.getShallow("distance")||5,textFont:r.getFont(),textPosition:n,textFill:r.getTextColor()||o})},l.updateProps=u.curry(w,!0),l.initProps=u.curry(w,!1),l.getTransform=function(t,e){for(var i=r.identity([]);t&&t!==e;)r.mul(i,t.getLocalTransform(),i),t=t.parent;return i},l.applyTransform=function(t,e,i){return i&&(e=r.invert([],e)),s.applyTransform([],t,e)},l.transformDirection=function(t,e,i){var n=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),o=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),r=["left"===t?-n:"right"===t?n:0,"top"===t?-o:"bottom"===t?o:0];return r=l.applyTransform(r,e,i),Math.abs(r[0])>Math.abs(r[1])?0<r[0]?"right":"left":0<r[1]?"bottom":"top"},t.exports=l},function(t,e){var a={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},h={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},l=Object.prototype.toString,i=Array.prototype,s=i.forEach,c=i.filter,n=i.slice,u=i.map,d=i.reduce,o={};function p(t){if(null==t||"object"!=typeof t)return t;var e=t,i=l.call(t);if("[object Array]"===i){e=[];for(var n=0,o=t.length;n<o;n++)e[n]=p(t[n])}else if(h[i]){var r=t.constructor;if(t.constructor.from)e=r.from(t);else{e=new r(t.length);for(n=0,o=t.length;n<o;n++)e[n]=p(t[n])}}else if(!a[i]&&!C(t)&&!w(t))for(var s in e={},t)t.hasOwnProperty(s)&&(e[s]=p(t[s]));return e}function f(t,e,i){if(!_(e)||!_(t))return i?p(e):t;for(var n in e)if(e.hasOwnProperty(n)){var o=t[n],r=e[n];!_(r)||!_(o)||x(r)||x(o)||w(r)||w(o)||b(r)||b(o)||C(r)||C(o)?!i&&n in t||(t[n]=p(e[n])):f(o,r,i)}return t}function r(t,e,i){for(var n in e)e.hasOwnProperty(n)&&(i?null!=e[n]:null==t[n])&&(t[n]=e[n]);return t}function g(){return o.createCanvas()}var y;function v(t,e,i){if(t&&e)if(t.forEach&&t.forEach===s)t.forEach(e,i);else if(t.length===+t.length)for(var n=0,o=t.length;n<o;n++)e.call(i,t[n],n,t);else for(var r in t)t.hasOwnProperty(r)&&e.call(i,t[r],r,t)}function m(t,e){var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}function x(t){return"[object Array]"===l.call(t)}function _(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function b(t){return!!a[l.call(t)]}function w(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}o.createCanvas=function(){return document.createElement("canvas")};var P="__ec_primitive__";function C(t){return t[P]}function N(t){t&&v(t,function(t,e){this.set(e,t)},this)}var T="_ec_";N.prototype={constructor:N,get:function(t){return this[T+t]},set:function(t,e){return this[T+t]=e},each:function(t,e){for(var i in void 0!==e&&(t=m(t,e)),this)this.hasOwnProperty(i)&&t(this[i],i.slice(4))},removeKey:function(t){delete this[T+t]}},e.$override=function(t,e){o[t]=e},e.clone=p,e.merge=f,e.mergeAll=function(t,e){for(var i=t[0],n=1,o=t.length;n<o;n++)i=f(i,t[n],e);return i},e.extend=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},e.defaults=r,e.createCanvas=g,e.getContext=function(){return y=y||g().getContext("2d")},e.indexOf=function(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i}return-1},e.inherits=function(t,e){var i=t.prototype;function n(){}for(var o in n.prototype=e.prototype,t.prototype=new n,i)t.prototype[o]=i[o];(t.prototype.constructor=t).superClass=e},e.mixin=function(t,e,i){r(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,i)},e.isArrayLike=function(t){if(t)return"string"!=typeof t&&"number"==typeof t.length},e.each=v,e.map=function(t,e,i){if(t&&e){if(t.map&&t.map===u)return t.map(e,i);for(var n=[],o=0,r=t.length;o<r;o++)n.push(e.call(i,t[o],o,t));return n}},e.reduce=function(t,e,i,n){if(t&&e){if(t.reduce&&t.reduce===d)return t.reduce(e,i,n);for(var o=0,r=t.length;o<r;o++)i=e.call(n,i,t[o],o,t);return i}},e.filter=function(t,e,i){if(t&&e){if(t.filter&&t.filter===c)return t.filter(e,i);for(var n=[],o=0,r=t.length;o<r;o++)e.call(i,t[o],o,t)&&n.push(t[o]);return n}},e.find=function(t,e,i){if(t&&e)for(var n=0,o=t.length;n<o;n++)if(e.call(i,t[n],n,t))return t[n]},e.bind=m,e.curry=function(t){var e=n.call(arguments,1);return function(){return t.apply(this,e.concat(n.call(arguments)))}},e.isArray=x,e.isFunction=function(t){return"function"==typeof t},e.isString=function(t){return"[object String]"===l.call(t)},e.isObject=_,e.isBuiltInObject=b,e.isDom=w,e.eqNaN=function(t){return t!=t},e.retrieve=function(t){for(var e=0,i=arguments.length;e<i;e++)if(null!=arguments[e])return arguments[e]},e.retrieve2=function(t,e){return null!=t?t:e},e.retrieve3=function(t,e,i){return null!=t?t:null!=e?e:i},e.slice=function(){return Function.call.apply(n,arguments)},e.normalizeCssArray=function(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t},e.assert=function(t,e){if(!t)throw new Error(e)},e.setAsPrimitive=function(t){t[P]=!0},e.isPrimitive=C,e.createHashMap=function(t){return new N(t)},e.noop=function(){}},function(t,e,i){function n(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}var a=i(7),T=i(30),o=i(41),S=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],C=Math.sqrt,N=Math.sin,M=Math.cos,R=Math.PI,A=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(n(t)*n(e))},E=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(A(t,e))};function L(t,e,i,n,o,r,s,a,h,l,c){var u=h*(R/180),d=M(u)*(t-i)/2+N(u)*(e-n)/2,p=-1*N(u)*(t-i)/2+M(u)*(e-n)/2,f=d*d/(s*s)+p*p/(a*a);1<f&&(s*=C(f),a*=C(f));var g=(o===r?-1:1)*C((s*s*(a*a)-s*s*(p*p)-a*a*(d*d))/(s*s*(p*p)+a*a*(d*d)))||0,y=g*s*p/a,v=g*-a*d/s,m=(t+i)/2+M(u)*y-N(u)*v,x=(e+n)/2+N(u)*y+M(u)*v,_=E([1,0],[(d-y)/s,(p-v)/a]),b=[(d-y)/s,(p-v)/a],w=[(-1*d-y)/s,(-1*p-v)/a],P=E(b,w);A(b,w)<=-1&&(P=R),1<=A(b,w)&&(P=0),0===r&&0<P&&(P-=2*R),1===r&&P<0&&(P+=2*R),c.addData(l,m,x,s,a,_,P,u,r)}function r(t,e){var i=function(t){if(!t)return[];var e,i=t.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(e=0;e<S.length;e++)i=i.replace(new RegExp(S[e],"g"),"|"+S[e]);var n,o=i.split("|"),r=0,s=0,a=new T,h=T.CMD;for(e=1;e<o.length;e++){var l,c=o[e],u=c.charAt(0),d=0,p=c.slice(1).replace(/e,-/g,"e-").split(",");0<p.length&&""===p[0]&&p.shift();for(var f=0;f<p.length;f++)p[f]=parseFloat(p[f]);for(;d<p.length&&!isNaN(p[d])&&!isNaN(p[0]);){var g,y,v,m,x,_,b,w=r,P=s;switch(u){case"l":r+=p[d++],s+=p[d++],l=h.L,a.addData(l,r,s);break;case"L":r=p[d++],s=p[d++],l=h.L,a.addData(l,r,s);break;case"m":r+=p[d++],s+=p[d++],l=h.M,a.addData(l,r,s),u="l";break;case"M":r=p[d++],s=p[d++],l=h.M,a.addData(l,r,s),u="L";break;case"h":r+=p[d++],l=h.L,a.addData(l,r,s);break;case"H":r=p[d++],l=h.L,a.addData(l,r,s);break;case"v":s+=p[d++],l=h.L,a.addData(l,r,s);break;case"V":s=p[d++],l=h.L,a.addData(l,r,s);break;case"C":l=h.C,a.addData(l,p[d++],p[d++],p[d++],p[d++],p[d++],p[d++]),r=p[d-2],s=p[d-1];break;case"c":l=h.C,a.addData(l,p[d++]+r,p[d++]+s,p[d++]+r,p[d++]+s,p[d++]+r,p[d++]+s),r+=p[d-2],s+=p[d-1];break;case"S":g=r,y=s;var C=a.len(),N=a.data;n===h.C&&(g+=r-N[C-4],y+=s-N[C-3]),l=h.C,w=p[d++],P=p[d++],r=p[d++],s=p[d++],a.addData(l,g,y,w,P,r,s);break;case"s":g=r,y=s;C=a.len(),N=a.data;n===h.C&&(g+=r-N[C-4],y+=s-N[C-3]),l=h.C,w=r+p[d++],P=s+p[d++],r+=p[d++],s+=p[d++],a.addData(l,g,y,w,P,r,s);break;case"Q":w=p[d++],P=p[d++],r=p[d++],s=p[d++],l=h.Q,a.addData(l,w,P,r,s);break;case"q":w=p[d++]+r,P=p[d++]+s,r+=p[d++],s+=p[d++],l=h.Q,a.addData(l,w,P,r,s);break;case"T":g=r,y=s;C=a.len(),N=a.data;n===h.Q&&(g+=r-N[C-4],y+=s-N[C-3]),r=p[d++],s=p[d++],l=h.Q,a.addData(l,g,y,r,s);break;case"t":g=r,y=s;C=a.len(),N=a.data;n===h.Q&&(g+=r-N[C-4],y+=s-N[C-3]),r+=p[d++],s+=p[d++],l=h.Q,a.addData(l,g,y,r,s);break;case"A":v=p[d++],m=p[d++],x=p[d++],_=p[d++],b=p[d++],L(w=r,P=s,r=p[d++],s=p[d++],_,b,v,m,x,l=h.A,a);break;case"a":v=p[d++],m=p[d++],x=p[d++],_=p[d++],b=p[d++],L(w=r,P=s,r+=p[d++],s+=p[d++],_,b,v,m,x,l=h.A,a)}}"z"!==u&&"Z"!==u||(l=h.Z,a.addData(l)),n=l}return a.toStatic(),a}(t);return(e=e||{}).buildPath=function(t){if(t.setData){t.setData(i.data),(e=t.getContext())&&t.rebuildPath(e)}else{var e=t;i.rebuildPath(e)}},e.applyTransform=function(t){o(i,t),this.dirty(!0)},e}e.createFromString=function(t,e){return new a(r(t,e))},e.extendFromString=function(t,e){return a.extend(r(t,e))},e.mergePath=function(t,e){for(var i=[],n=t.length,o=0;o<n;o++){var r=t[o];r.path||r.createPathProxy(),r.__dirtyPath&&r.buildPath(r.path,r.shape,!0),i.push(r.path)}var s=new a(e);return s.createPathProxy(),s.buildPath=function(t){t.appendPath(i);var e=t.getContext();e&&t.rebuildPath(e)},s}},function(t,e,i){var n=i(8),r=i(5),a=i(30),h=i(33),v=i(40).prototype.getCanvasPattern,o=Math.abs,m=new a(!0);function s(t){n.call(this,t),this.path=null}s.prototype={constructor:s,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function(t,e){var i,n=this.style,o=this.path||m,r=n.hasStroke(),s=n.hasFill(),a=n.fill,h=n.stroke,l=s&&!!a.colorStops,c=r&&!!h.colorStops,u=s&&!!a.image,d=r&&!!h.image;n.bind(t,this,e),this.setTransform(t),this.__dirty&&(l&&(i=i||this.getBoundingRect(),this._fillGradient=n.getGradient(t,a,i)),c&&(i=i||this.getBoundingRect(),this._strokeGradient=n.getGradient(t,h,i)));l?t.fillStyle=this._fillGradient:u&&(t.fillStyle=v.call(a,t)),c?t.strokeStyle=this._strokeGradient:d&&(t.strokeStyle=v.call(h,t));var p=n.lineDash,f=n.lineDashOffset,g=!!t.setLineDash,y=this.getGlobalScale();o.setScale(y[0],y[1]),this.__dirtyPath||p&&!g&&r?(o.beginPath(t),p&&!g&&(o.setLineDash(p),o.setLineDashOffset(f)),this.buildPath(o,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(t.beginPath(),this.path.rebuildPath(t)),s&&o.fill(t),p&&g&&(t.setLineDash(p),t.lineDashOffset=f),r&&o.stroke(t),p&&g&&t.setLineDash([]),this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect())},buildPath:function(t,e,i){},createPathProxy:function(){this.path=new a},getBoundingRect:function(){var t=this._rect,e=this.style,i=!t;if(i){var n=this.path;n=n||(this.path=new a),this.__dirtyPath&&(n.beginPath(),this.buildPath(n,this.shape,!1)),t=n.getBoundingRect()}if(this._rect=t,e.hasStroke()){var o=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||i){o.copy(t);var r=e.lineWidth,s=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(r=Math.max(r,this.strokeContainThreshold||4)),1e-10<s&&(o.width+=r/s,o.height+=r/s,o.x-=r/s/2,o.y-=r/s/2)}return o}return t},contain:function(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect(),o=this.style;if(t=i[0],e=i[1],n.contain(t,e)){var r=this.path.data;if(o.hasStroke()){var s=o.lineWidth,a=o.strokeNoScale?this.getLineScale():1;if(1e-10<a&&(o.hasFill()||(s=Math.max(s,this.strokeContainThreshold)),h.containStroke(r,s/a,t,e)))return!0}if(o.hasFill())return h.contain(r,t,e)}return!1},dirty:function(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(t){return this.animate("shape",t)},attrKV:function(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):n.prototype.attrKV.call(this,t,e)},setShape:function(t,e){var i=this.shape;if(i){if(r.isObject(t))for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);else i[t]=e;this.dirty(!0)}return this},getLineScale:function(){var t=this.transform;return t&&1e-10<o(t[0]-1)&&1e-10<o(t[3]-1)?Math.sqrt(o(t[0]*t[3]-t[2]*t[1])):1}},s.extend=function(o){function t(t){s.call(this,t),o.style&&this.style.extendFrom(o.style,!1);var e=o.shape;if(e){this.shape=this.shape||{};var i=this.shape;for(var n in e)!i.hasOwnProperty(n)&&e.hasOwnProperty(n)&&(i[n]=e[n])}o.init&&o.init.call(this,t)}for(var e in r.inherits(t,s),o)"style"!==e&&"shape"!==e&&(t.prototype[e]=o[e]);return t},r.inherits(s,n);var l=s;t.exports=l},function(t,e,i){var n=i(5),o=i(9),r=i(10),s=i(24);function a(t){for(var e in t=t||{},r.call(this,t),t)t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);this.style=new o(t.style,this),this._rect=null,this.__clipPaths=[]}a.prototype={constructor:a,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:-1,beforeBrush:function(t){},afterBrush:function(t){},brush:function(t,e){},getBoundingRect:function(){},contain:function(t,e){return this.rectContain(t,e)},traverse:function(t,e){t.call(e,this)},rectContain:function(t,e){var i=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(i[0],i[1])},dirty:function(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(t){return this.animate("style",t)},attrKV:function(t,e){"style"!==t?r.prototype.attrKV.call(this,t,e):this.style.set(e)},setStyle:function(t,e){return this.style.set(t,e),this.dirty(!1),this},useStyle:function(t){return this.style=new o(t,this),this.dirty(!1),this}},n.inherits(a,r),n.mixin(a,s);var h=a;t.exports=h},function(t,e){function i(t,e){this.extendFrom(t,!1),this.host=e}var c=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function s(t,e,i){var n=null==e.x?0:e.x,o=null==e.x2?1:e.x2,r=null==e.y?0:e.y,s=null==e.y2?0:e.y2;return e.global||(n=n*i.width+i.x,o=o*i.width+i.x,r=r*i.height+i.y,s=s*i.height+i.y),t.createLinearGradient(n,r,o,s)}function a(t,e,i){var n=i.width,o=i.height,r=Math.min(n,o),s=null==e.x?.5:e.x,a=null==e.y?.5:e.y,h=null==e.r?.5:e.r;return e.global||(s=s*n+i.x,a=a*o+i.y,h*=r),t.createRadialGradient(s,a,0,s,a,h)}for(var n=i.prototype={constructor:i,host:null,fill:"#000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(t,e,i){for(var n=this,o=i&&i.style,r=!o,s=0;s<c.length;s++){var a=c[s],h=a[0];!r&&n[h]===o[h]||(t[h]=n[h]||a[1])}if(!r&&n.fill===o.fill||(t.fillStyle=n.fill),!r&&n.stroke===o.stroke||(t.strokeStyle=n.stroke),!r&&n.opacity===o.opacity||(t.globalAlpha=null==n.opacity?1:n.opacity),!r&&n.blend===o.blend||(t.globalCompositeOperation=n.blend||"source-over"),this.hasStroke()){var l=n.lineWidth;t.lineWidth=l/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1)}},hasFill:function(){var t=this.fill;return null!=t&&"none"!==t},hasStroke:function(){var t=this.stroke;return null!=t&&"none"!==t&&0<this.lineWidth},extendFrom:function(t,e){if(t)for(var i in t)!t.hasOwnProperty(i)||!0!==e&&(!1===e?this.hasOwnProperty(i):null==t[i])||(this[i]=t[i])},set:function(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0)},clone:function(){var t=new this.constructor;return t.extendFrom(this,!0),t},getGradient:function(t,e,i){for(var n=("radial"===e.type?a:s)(t,e,i),o=e.colorStops,r=0;r<o.length;r++)n.addColorStop(o[r].offset,o[r].color);return n}},o=0;o<c.length;o++){var r=c[o];r[0]in n||(n[r[0]]=r[1])}i.getGradient=n.getGradient;var h=i;t.exports=h},function(t,e,i){function n(t){s.call(this,t),r.call(this,t),a.call(this,t),this.id=t.id||o()}var o=i(11),r=i(12),s=i(13),a=i(16),h=i(5);n.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,drift:function(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var i=this.transform;(i=i||(this.transform=[1,0,0,1,0,0]))[4]+=t,i[5]+=e,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(t,e){},attrKV:function(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var i=this[t];(i=i||(this[t]=[]))[0]=e[0],i[1]=e[1]}}else this[t]=e},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(h.isObject(t))for(var i in t)t.hasOwnProperty(i)&&this.attrKV(i,t[i]);return this.dirty(!1),this},setClipPath:function(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),(this.clipPath=t).__zr=e,(t.__clipTarget=this).dirty(!1)},removeClipPath:function(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(t){this.__zr=t;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.addAnimator(e[i]);this.clipPath&&this.clipPath.addSelfToZr(t)},removeSelfFromZr:function(t){this.__zr=null;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.removeAnimator(e[i]);this.clipPath&&this.clipPath.removeSelfFromZr(t)}},h.mixin(n,a),h.mixin(n,s),h.mixin(n,r);var l=n;t.exports=l},function(t,e){var i=2311;t.exports=function(){return i++}},function(t,e){function i(){this._$handlers={}}var a=Array.prototype.slice;i.prototype={constructor:i,one:function(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var o=0;o<n[t].length;o++)if(n[t][o].h===e)return this;return n[t].push({h:e,one:!0,ctx:i||this}),this},on:function(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var o=0;o<n[t].length;o++)if(n[t][o].h===e)return this;return n[t].push({h:e,one:!1,ctx:i||this}),this},isSilent:function(t){var e=this._$handlers;return e[t]&&e[t].length},off:function(t,e){var i=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(i[t]){for(var n=[],o=0,r=i[t].length;o<r;o++)i[t][o].h!=e&&n.push(i[t][o]);i[t]=n}i[t]&&0===i[t].length&&delete i[t]}else delete i[t];return this},trigger:function(t){if(this._$handlers[t]){var e=arguments,i=e.length;3<i&&(e=a.call(e,1));for(var n=this._$handlers[t],o=n.length,r=0;r<o;){switch(i){case 1:n[r].h.call(n[r].ctx);break;case 2:n[r].h.call(n[r].ctx,e[1]);break;case 3:n[r].h.call(n[r].ctx,e[1],e[2]);break;default:n[r].h.apply(n[r].ctx,e)}n[r].one?(n.splice(r,1),o--):r++}}return this},triggerWithContext:function(t){if(this._$handlers[t]){var e=arguments,i=e.length;4<i&&(e=a.call(e,1,e.length-1));for(var n=e[e.length-1],o=this._$handlers[t],r=o.length,s=0;s<r;){switch(i){case 1:o[s].h.call(n);break;case 2:o[s].h.call(n,e[1]);break;case 3:o[s].h.call(n,e[1],e[2]);break;default:o[s].h.apply(n,e)}o[s].one?(o.splice(s,1),r--):s++}}return this}};var n=i;t.exports=n},function(t,e,i){var s=i(14),o=i(15),a=s.identity;function h(t){return 5e-5<t||t<-5e-5}function n(t){(t=t||{}).position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null}var r=n.prototype;r.transform=null,r.needLocalTransform=function(){return h(this.rotation)||h(this.position[0])||h(this.position[1])||h(this.scale[0]-1)||h(this.scale[1]-1)},r.updateTransform=function(){var t=this.parent,e=t&&t.transform,i=this.needLocalTransform(),n=this.transform;i||e?(n=n||s.create(),i?this.getLocalTransform(n):a(n),e&&(i?s.mul(n,t.transform,n):s.copy(n,t.transform)),this.transform=n,this.invTransform=this.invTransform||s.create(),s.invert(this.invTransform,n)):n&&a(n)},r.getLocalTransform=function(t){return n.getLocalTransform(this,t)},r.setTransform=function(t){var e=this.transform,i=t.dpr||1;e?t.setTransform(i*e[0],i*e[1],i*e[2],i*e[3],i*e[4],i*e[5]):t.setTransform(i,0,0,i,0,0)},r.restoreTransform=function(t){var e=t.dpr||1;t.setTransform(e,0,0,e,0,0)};var l=[];r.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(s.mul(l,t.invTransform,e),e=l);var i=e[0]*e[0]+e[1]*e[1],n=e[2]*e[2]+e[3]*e[3],o=this.position,r=this.scale;h(i-1)&&(i=Math.sqrt(i)),h(n-1)&&(n=Math.sqrt(n)),e[0]<0&&(i=-i),e[3]<0&&(n=-n),o[0]=e[4],o[1]=e[5],r[0]=i,r[1]=n,this.rotation=Math.atan2(-e[1]/n,e[0]/i)}},r.getGlobalScale=function(){var t=this.transform;if(!t)return[1,1];var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i=Math.sqrt(t[2]*t[2]+t[3]*t[3]);return t[0]<0&&(e=-e),t[3]<0&&(i=-i),[e,i]},r.transformCoordToLocal=function(t,e){var i=[t,e],n=this.invTransform;return n&&o.applyTransform(i,i,n),i},r.transformCoordToGlobal=function(t,e){var i=[t,e],n=this.transform;return n&&o.applyTransform(i,i,n),i},n.getLocalTransform=function(t,e){a(e=e||[]);var i=t.origin,n=t.scale||[1,1],o=t.rotation||0,r=t.position||[0,0];return i&&(e[4]-=i[0],e[5]-=i[1]),s.scale(e,e,n),o&&s.rotate(e,e,o),i&&(e[4]+=i[0],e[5]+=i[1]),e[4]+=r[0],e[5]+=r[1],e};var c=n;t.exports=c},function(t,e){var i="undefined"==typeof Float32Array?Array:Float32Array;function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}e.create=function(){var t=new i(6);return n(t),t},e.identity=n,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.mul=function(t,e,i){var n=e[0]*i[0]+e[2]*i[1],o=e[1]*i[0]+e[3]*i[1],r=e[0]*i[2]+e[2]*i[3],s=e[1]*i[2]+e[3]*i[3],a=e[0]*i[4]+e[2]*i[5]+e[4],h=e[1]*i[4]+e[3]*i[5]+e[5];return t[0]=n,t[1]=o,t[2]=r,t[3]=s,t[4]=a,t[5]=h,t},e.translate=function(t,e,i){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+i[0],t[5]=e[5]+i[1],t},e.rotate=function(t,e,i){var n=e[0],o=e[2],r=e[4],s=e[1],a=e[3],h=e[5],l=Math.sin(i),c=Math.cos(i);return t[0]=n*c+s*l,t[1]=-n*l+s*c,t[2]=o*c+a*l,t[3]=-o*l+c*a,t[4]=c*r+l*h,t[5]=c*h-l*r,t},e.scale=function(t,e,i){var n=i[0],o=i[1];return t[0]=e[0]*n,t[1]=e[1]*o,t[2]=e[2]*n,t[3]=e[3]*o,t[4]=e[4]*n,t[5]=e[5]*o,t},e.invert=function(t,e){var i=e[0],n=e[2],o=e[4],r=e[1],s=e[3],a=e[5],h=i*s-r*n;return h?(h=1/h,t[0]=s*h,t[1]=-r*h,t[2]=-n*h,t[3]=i*h,t[4]=(n*a-s*o)*h,t[5]=(r*o-i*a)*h,t):null}},function(t,e){var n="undefined"==typeof Float32Array?Array:Float32Array;function o(t){return Math.sqrt(r(t))}var i=o;function r(t){return t[0]*t[0]+t[1]*t[1]}var s=r;function a(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var h=a;function l(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}var c=l;e.create=function(t,e){var i=new n(2);return null==t&&(t=0),null==e&&(e=0),i[0]=t,i[1]=e,i},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.clone=function(t){var e=new n(2);return e[0]=t[0],e[1]=t[1],e},e.set=function(t,e,i){return t[0]=e,t[1]=i,t},e.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},e.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},e.sub=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},e.len=o,e.length=i,e.lenSquare=r,e.lengthSquare=s,e.mul=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},e.div=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},e.normalize=function(t,e){var i=o(e);return 0===i?(t[0]=0,t[1]=0):(t[0]=e[0]/i,t[1]=e[1]/i),t},e.distance=a,e.dist=h,e.distanceSquare=l,e.distSquare=c,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.lerp=function(t,e,i,n){return t[0]=e[0]+n*(i[0]-e[0]),t[1]=e[1]+n*(i[1]-e[1]),t},e.applyTransform=function(t,e,i){var n=e[0],o=e[1];return t[0]=i[0]*n+i[2]*o+i[4],t[1]=i[1]*n+i[3]*o+i[5],t},e.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},e.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}},function(t,e,i){function n(){this.animators=[]}var d=i(17),p=i(22),o=i(5),c=o.isString,u=o.isFunction,l=o.isObject,f=o.isArrayLike,g=o.indexOf;n.prototype={constructor:n,animate:function(t,e){var i,n=!1,o=this,r=this.__zr;if(t){var s=t.split("."),a=o;n="shape"===s[0];for(var h=0,l=s.length;h<l;h++)a=a&&a[s[h]];a&&(i=a)}else i=o;if(i){var c=o.animators,u=new d(i,e);return u.during(function(t){o.dirty(n)}).done(function(){c.splice(g(c,u),1)}),c.push(u),r&&r.animation.addAnimator(u),u}p('Property "'+t+'" is not existed in element '+o.id)},stopAnimation:function(t){for(var e=this.animators,i=e.length,n=0;n<i;n++)e[n].stop(t);return e.length=0,this},animateTo:function(t,e,i,n,o,r){c(i)?(o=n,n=i,i=0):u(n)?(o=n,n="linear",i=0):u(i)?(o=i,i=0):e=u(e)?(o=e,500):e||500,this.stopAnimation(),this._animateToShallow("",this,t,e,i);var s=this.animators.slice(),a=s.length;function h(){--a||o&&o()}a||o&&o();for(var l=0;l<s.length;l++)s[l].done(h).start(n,r)},_animateToShallow:function(t,e,i,n,o){var r={},s=0;for(var a in i)if(i.hasOwnProperty(a))if(null!=e[a])l(i[a])&&!f(i[a])?this._animateToShallow(t?t+"."+a:a,e[a],i[a],n,o):(r[a]=i[a],s++);else if(null!=i[a])if(t){var h={};h[t]={},h[t][a]=i[a],this.attr(h)}else this.attr(a,i[a]);return 0<s&&this.animate(t,!1).when(null==n?500:n,r).delay(o||0),this}};var r=n;t.exports=r},function(t,e,i){var k=i(18),O=i(20),I=i(5).isArrayLike,h=Array.prototype.slice;function o(t,e){return t[e]}function r(t,e,i){t[e]=i}function z(t,e,i){return(e-t)*i+t}function B(t,e,i){return.5<i?e:t}function D(t,e,i,n,o){var r=t.length;if(1==o)for(var s=0;s<r;s++)n[s]=z(t[s],e[s],i);else{var a=r&&t[0].length;for(s=0;s<r;s++)for(var h=0;h<a;h++)n[s][h]=z(t[s][h],e[s][h],i)}}function H(t,e,i){var n=t.length,o=e.length;if(n!==o)if(o<n)t.length=o;else for(var r=n;r<o;r++)t.push(1===i?e[r]:h.call(e[r]));var s=t[0]&&t[0].length;for(r=0;r<t.length;r++)if(1===i)isNaN(t[r])&&(t[r]=e[r]);else for(var a=0;a<s;a++)isNaN(t[r][a])&&(t[r][a]=e[r][a])}function G(t,e,i){if(t===e)return!0;var n=t.length;if(n!==e.length)return!1;if(1===i){for(var o=0;o<n;o++)if(t[o]!==e[o])return!1}else{var r=t[0].length;for(o=0;o<n;o++)for(var s=0;s<r;s++)if(t[o][s]!==e[o][s])return!1}return!0}function F(t,e,i,n,o,r,s,a,h){var l=t.length;if(1==h)for(var c=0;c<l;c++)a[c]=Y(t[c],e[c],i[c],n[c],o,r,s);else{var u=t[0].length;for(c=0;c<l;c++)for(var d=0;d<u;d++)a[c][d]=Y(t[c][d],e[c][d],i[c][d],n[c][d],o,r,s)}}function Y(t,e,i,n,o,r,s){var a=.5*(i-t),h=.5*(n-e);return(2*(e-i)+a+h)*s+(-3*(e-i)-2*a-h)*r+a*o+e}function s(t){if(I(t)){var e=t.length;if(I(t[0])){for(var i=[],n=0;n<e;n++)i.push(h.call(t[n]));return i}return h.call(t)}return t}function W(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}function l(t,e,i,n,r,o){var s=t._getter,a=t._setter,h="spline"===e,l=n.length;if(l){var c,u=n[0].value,d=I(u),p=!1,f=!1,g=d?function(t){var e=t[t.length-1].value;return I(e&&e[0])?2:1}(n):0;n.sort(function(t,e){return t.time-e.time}),c=n[l-1].time;for(var y=[],v=[],m=n[0].value,x=!0,_=0;_<l;_++){y.push(n[_].time/c);var b=n[_].value;if(d&&G(b,m,g)||!d&&b===m||(x=!1),"string"==typeof(m=b)){var w=O.parse(b);w?(b=w,p=!0):f=!0}v.push(b)}if(o||!x){var P=v[l-1];for(_=0;_<l-1;_++)d?H(v[_],P,g):!isNaN(v[_])||isNaN(P)||f||p||(v[_]=P);d&&H(s(t._target,r),P,g);var C,N,T,S,M,R=0,A=0;if(p)var E=[0,0,0,0];var L=new k({target:t._target,life:c,loop:t._loop,delay:t._delay,onframe:function(t,e){var i;if(e<0)i=0;else if(e<A){for(i=Math.min(R+1,l-1);0<=i&&!(y[i]<=e);i--);i=Math.min(i,l-2)}else{for(i=R;i<l&&!(y[i]>e);i++);i=Math.min(i-1,l-2)}A=e;var n=y[(R=i)+1]-y[i];if(0!=n)if(C=(e-y[i])/n,h)if(T=v[i],N=v[0===i?i:i-1],S=v[l-2<i?l-1:i+1],M=v[l-3<i?l-1:i+2],d)F(N,T,S,M,C,C*C,C*C*C,s(t,r),g);else{if(p)o=F(N,T,S,M,C,C*C,C*C*C,E,1),o=W(E);else{if(f)return B(T,S,C);o=Y(N,T,S,M,C,C*C,C*C*C)}a(t,r,o)}else if(d)D(v[i],v[i+1],C,s(t,r),g);else{var o;if(p)D(v[i],v[i+1],C,E,1),o=W(E);else{if(f)return B(v[i],v[i+1],C);o=z(v[i],v[i+1],C)}a(t,r,o)}},ondestroy:i});return e&&"spline"!==e&&(L.easing=e),L}}}function n(t,e,i,n){this._tracks={},this._target=t,this._loop=e||!1,this._getter=i||o,this._setter=n||r,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]}n.prototype={when:function(t,e){var i=this._tracks;for(var n in e)if(e.hasOwnProperty(n)){if(!i[n]){i[n]=[];var o=this._getter(this._target,n);if(null==o)continue;0!==t&&i[n].push({time:0,value:s(o)})}i[n].push({time:t,value:e[n]})}return this},during:function(t){return this._onframeList.push(t),this},pause:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].pause();this._paused=!0},resume:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,i=0;i<e;i++)t[i].call(this)},start:function(t,e){function i(){--r||o._doneCallback()}var n,o=this,r=0;for(var s in this._tracks)if(this._tracks.hasOwnProperty(s)){var a=l(this,t,i,this._tracks[s],s,e);a&&(this._clipList.push(a),r++,this.animation&&this.animation.addClip(a),n=a)}if(n){var h=n.onframe;n.onframe=function(t,e){h(t,e);for(var i=0;i<o._onframeList.length;i++)o._onframeList[i](t,e)}}return r||this._doneCallback(),this},stop:function(t){for(var e=this._clipList,i=this.animation,n=0;n<e.length;n++){var o=e[n];t&&o.onframe(this._target,1),i&&i.removeClip(o)}e.length=0},delay:function(t){return this._delay=t,this},done:function(t){return t&&this._doneList.push(t),this},getClips:function(){return this._clipList}};var a=n;t.exports=a},function(t,e,i){var s=i(19);function n(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1}n.prototype={constructor:n,step:function(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)this._pausedTime+=e;else{var i=(t-this._startTime-this._pausedTime)/this._life;if(!(i<0)){i=Math.min(i,1);var n=this.easing,o="string"==typeof n?s[n]:n,r="function"==typeof o?o(i):i;return this.fire("frame",r),1==i?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(t){var e=(t-this._startTime-this._pausedTime)%this._life;this._startTime=t-e+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(t,e){this[t="on"+t]&&this[t](this._target,e)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var o=n;t.exports=o},function(t,e){var i={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},elasticOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},elasticInOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(e=!i||i<1?(i=1,.1):.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)},backIn:function(t){return t*t*(2.70158*t-1.70158)},backOut:function(t){return--t*t*(2.70158*t+1.70158)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)},bounceIn:function(t){return 1-i.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5}},n=i;t.exports=n},function(t,e,i){var n=i(21),c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(t){return(t=Math.round(t))<0?0:255<t?255:t}function d(t){return t<0?0:1<t?1:t}function p(t){return t.length&&"%"===t.charAt(t.length-1)?u(parseFloat(t)/100*255):u(parseInt(t,10))}function f(t){return t.length&&"%"===t.charAt(t.length-1)?d(parseFloat(t)/100):d(parseFloat(t))}function a(t,e,i){return i<0?i+=1:1<i&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function g(t,e,i){return t+(e-t)*i}function y(t,e,i,n,o){return t[0]=e,t[1]=i,t[2]=n,t[3]=o,t}function v(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}var m=new n(20),o=null;function x(t,e){o&&v(o,e),o=m.put(t,o||e.slice())}function _(t,e){if(t){e=e||[];var i=m.get(t);if(i)return v(e,i);var n,o=(t+="").replace(/ /g,"").toLowerCase();if(o in c)return v(e,c[o]),x(t,e),e;if("#"===o.charAt(0))return 4===o.length?0<=(n=parseInt(o.substr(1),16))&&n<=4095?(y(e,(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1),x(t,e),e):void y(e,0,0,0,1):7===o.length?0<=(n=parseInt(o.substr(1),16))&&n<=16777215?(y(e,(16711680&n)>>16,(65280&n)>>8,255&n,1),x(t,e),e):void y(e,0,0,0,1):void 0;var r=o.indexOf("("),s=o.indexOf(")");if(-1!==r&&s+1===o.length){var a=o.substr(0,r),h=o.substr(r+1,s-(r+1)).split(","),l=1;switch(a){case"rgba":if(4!==h.length)return void y(e,0,0,0,1);l=f(h.pop());case"rgb":return 3!==h.length?void y(e,0,0,0,1):(y(e,p(h[0]),p(h[1]),p(h[2]),l),x(t,e),e);case"hsla":return 4!==h.length?void y(e,0,0,0,1):(h[3]=f(h[3]),b(h,e),x(t,e),e);case"hsl":return 3!==h.length?void y(e,0,0,0,1):(b(h,e),x(t,e),e);default:return}}y(e,0,0,0,1)}}function b(t,e){var i=(parseFloat(t[0])%360+360)%360/360,n=f(t[1]),o=f(t[2]),r=o<=.5?o*(n+1):o+n-o*n,s=2*o-r;return y(e=e||[],u(255*a(s,r,i+1/3)),u(255*a(s,r,i)),u(255*a(s,r,i-1/3)),1),4===t.length&&(e[3]=t[3]),e}function r(t,e,i){if(e&&e.length&&0<=t&&t<=1){i=i||[];var n=t*(e.length-1),o=Math.floor(n),r=Math.ceil(n),s=e[o],a=e[r],h=n-o;return i[0]=u(g(s[0],a[0],h)),i[1]=u(g(s[1],a[1],h)),i[2]=u(g(s[2],a[2],h)),i[3]=d(g(s[3],a[3],h)),i}}var s=r;function h(t,e,i){if(e&&e.length&&0<=t&&t<=1){var n=t*(e.length-1),o=Math.floor(n),r=Math.ceil(n),s=_(e[o]),a=_(e[r]),h=n-o,l=w([u(g(s[0],a[0],h)),u(g(s[1],a[1],h)),u(g(s[2],a[2],h)),d(g(s[3],a[3],h))],"rgba");return i?{color:l,leftIndex:o,rightIndex:r,value:n}:l}}var l=h;function w(t,e){if(t&&t.length){var i=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(i+=","+t[3]),e+"("+i+")"}}e.parse=_,e.lift=function(t,e){var i=_(t);if(i){for(var n=0;n<3;n++)i[n]=e<0?i[n]*(1-e)|0:(255-i[n])*e+i[n]|0;return w(i,4===i.length?"rgba":"rgb")}},e.toHex=function(t){var e=_(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1)},e.fastLerp=r,e.fastMapToColor=s,e.lerp=h,e.mapToColor=l,e.modifyHSL=function(t,e,i,n){if(t=_(t))return t=function(t){if(t){var e,i,n=t[0]/255,o=t[1]/255,r=t[2]/255,s=Math.min(n,o,r),a=Math.max(n,o,r),h=a-s,l=(a+s)/2;if(0==h)i=e=0;else{i=l<.5?h/(a+s):h/(2-a-s);var c=((a-n)/6+h/2)/h,u=((a-o)/6+h/2)/h,d=((a-r)/6+h/2)/h;n===a?e=d-u:o===a?e=1/3+c-d:r===a&&(e=2/3+u-c),e<0&&(e+=1),1<e&&(e-=1)}var p=[360*e,i,l];return null!=t[3]&&p.push(t[3]),p}}(t),null!=e&&(t[0]=function(t){return(t=Math.round(t))<0?0:360<t?360:t}(e)),null!=i&&(t[1]=f(i)),null!=n&&(t[2]=f(n)),w(b(t),"rgba")},e.modifyAlpha=function(t,e){if((t=_(t))&&null!=e)return t[3]=d(e),w(t,"rgba")},e.stringify=w},function(t,e){function i(){this.head=null,this.tail=null,this._len=0}var n=i.prototype;n.insert=function(t){var e=new h(t);return this.insertEntry(e),e},n.insertEntry=function(t){this.head?((this.tail.next=t).prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},n.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--},n.len=function(){return this._len},n.clear=function(){this.head=this.tail=null,this._len=0};function o(t){this._list=new i,this._map={},this._maxSize=t||10,this._lastRemovedEntry=null}var h=function(t){this.value=t,this.next,this.prev},r=o.prototype;r.put=function(t,e){var i=this._list,n=this._map,o=null;if(null==n[t]){var r=i.len(),s=this._lastRemovedEntry;if(r>=this._maxSize&&0<r){var a=i.head;i.remove(a),delete n[a.key],o=a.value,this._lastRemovedEntry=a}s?s.value=e:s=new h(e),s.key=t,i.insertEntry(s),n[t]=s}return o},r.get=function(t){var e=this._map[t],i=this._list;if(null!=e)return e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value},r.clear=function(){this._list.clear(),this._map={}};var s=o;t.exports=s},function(t,e,i){var n=i(23).debugMode,o=function(){};1===n?o=function(){for(var t in arguments)throw new Error(arguments[t])}:1<n&&(o=function(){for(var t in arguments)console.log(arguments[t])});var r=o;t.exports=r},function(t,e){var i=1;"undefined"!=typeof window&&(i=Math.max(window.devicePixelRatio||1,1));var n=i;e.debugMode=0,e.devicePixelRatio=n},function(t,e,i){function n(){}var r=i(25),s=new(i(27));n.prototype={constructor:n,drawRectText:function(t,e){var i=this.style;e=i.textRect||e,this.__dirty&&r.normalizeTextStyle(i,!0);var n=i.text;if(null!=n&&(n+=""),r.needDrawText(n,i)){t.save();var o=this.transform;i.transformText?this.setTransform(t):o&&(s.copy(e),s.applyTransform(o),e=s),r.renderText(this,t,n,i,e),t.restore()}}};var o=n;t.exports=o},function(t,e,i){var n=i(5),g=n.retrieve2,y=n.retrieve3,o=n.each,r=n.normalizeCssArray,p=n.isString,f=n.isObject,A=i(26),v=i(29),m=i(28),s={left:1,right:1,center:1},a={top:1,bottom:1,middle:1};function h(t){if(t){t.font=A.makeFont(t);var e=t.textAlign;"middle"===e&&(e="center"),t.textAlign=null==e||s[e]?e:"left";var i=t.textVerticalAlign||t.textBaseline;"center"===i&&(i="middle"),t.textVerticalAlign=null==i||a[i]?i:"top",t.textPadding&&(t.textPadding=r(t.textPadding))}}function E(t,e,i,n,o){if(i&&e.textRotation){var r=e.textOrigin;"center"===r?(n=i.width/2+i.x,o=i.height/2+i.y):r&&(n=r[0]+i.x,o=r[1]+i.y),t.translate(n,o),t.rotate(-e.textRotation),t.translate(-n,-o)}}function L(t,e,i,n,o,r,s,a){var h=n.rich[i.styleName]||{},l=i.textVerticalAlign,c=r+o/2;"top"===l?c=r+i.height/2:"bottom"===l&&(c=r+o-i.height/2),!i.isLineHolder&&k(h)&&O(t,e,h,"right"===a?s-i.width:"center"===a?s-i.width/2:s,c-i.height/2,i.width,i.height);var u=i.textPadding;u&&(s=R(s,a,u),c-=i.height/2-u[2]-i.textHeight/2),T(e,"shadowBlur",y(h.textShadowBlur,n.textShadowBlur,0)),T(e,"shadowColor",h.textShadowColor||n.textShadowColor||"transparent"),T(e,"shadowOffsetX",y(h.textShadowOffsetX,n.textShadowOffsetX,0)),T(e,"shadowOffsetY",y(h.textShadowOffsetY,n.textShadowOffsetY,0)),T(e,"textAlign",a),T(e,"textBaseline","middle"),T(e,"font",i.font||A.DEFAULT_FONT);var d=S(h.textStroke||n.textStroke,f),p=M(h.textFill||n.textFill),f=g(h.textStrokeWidth,n.textStrokeWidth);d&&(T(e,"lineWidth",f),T(e,"strokeStyle",d),e.strokeText(i.text,s,c)),p&&(T(e,"fillStyle",p),e.fillText(i.text,s,c))}function k(t){return t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor}function O(t,e,i,n,o,r,s){var a=i.textBackgroundColor,h=i.textBorderWidth,l=i.textBorderColor,c=p(a);if(T(e,"shadowBlur",i.textBoxShadowBlur||0),T(e,"shadowColor",i.textBoxShadowColor||"transparent"),T(e,"shadowOffsetX",i.textBoxShadowOffsetX||0),T(e,"shadowOffsetY",i.textBoxShadowOffsetY||0),c||h&&l){e.beginPath();var u=i.textBorderRadius;u?v.buildPath(e,{x:n,y:o,width:r,height:s,r:u}):e.rect(n,o,r,s),e.closePath()}if(c)T(e,"fillStyle",a),e.fill();else if(f(a)){var d=a.image;(d=m.createOrUpdateImage(d,null,t,x,a))&&m.isImageReady(d)&&e.drawImage(d,n,o,r,s)}h&&l&&(T(e,"lineWidth",h),T(e,"strokeStyle",l),e.stroke())}function x(t,e){e.image=t}function I(t,e,i){var n=e.x||0,o=e.y||0,r=e.textAlign,s=e.textVerticalAlign;if(i){var a=e.textPosition;if(a instanceof Array)n=i.x+c(a[0],i.width),o=i.y+c(a[1],i.height);else{var h=A.adjustTextPositionOnRect(a,i,e.textDistance);n=h.x,o=h.y,r=r||h.textAlign,s=s||h.textVerticalAlign}var l=e.textOffset;l&&(n+=l[0],o+=l[1])}return{baseX:n,baseY:o,textAlign:r,textVerticalAlign:s}}function T(t,e,i){return t[e]=i,t[e]}function S(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function M(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function c(t,e){return"string"==typeof t?0<=t.lastIndexOf("%")?parseFloat(t)/100*e:parseFloat(t):t}function R(t,e,i){return"right"===e?t-i[1]:"center"===e?t+i[3]/2-i[1]/2:t+i[3]}e.normalizeTextStyle=function(t){return h(t),o(t.rich,h),t},e.renderText=function(t,e,i,n,o){n.rich?function(t,e,i,n,o){var r=t.__textCotentBlock;r&&!t.__dirty||(r=t.__textCotentBlock=A.parseRichText(i,n));!function(t,e,i,n,o){var r=i.width,s=i.outerWidth,a=i.outerHeight,h=n.textPadding,l=I(a,n,o),c=l.baseX,u=l.baseY,d=l.textAlign,p=l.textVerticalAlign;E(e,n,o,c,u);var f=A.adjustTextX(c,s,d),g=A.adjustTextY(u,a,p),y=f,v=g;h&&(y+=h[3],v+=h[0]);var m=y+r;k(n)&&O(t,e,n,f,g,s,a);for(var x=0;x<i.lines.length;x++){for(var _,b=i.lines[x],w=b.tokens,P=w.length,C=b.lineHeight,N=b.width,T=0,S=y,M=m,R=P-1;T<P&&(!(_=w[T]).textAlign||"left"===_.textAlign);)L(t,e,_,n,C,v,S,"left"),N-=_.width,S+=_.width,T++;for(;0<=R&&"right"===(_=w[R]).textAlign;)L(t,e,_,n,C,v,M,"right"),N-=_.width,M-=_.width,R--;for(S+=(r-(S-y)-(m-M)-N)/2;T<=R;)_=w[T],L(t,e,_,n,C,v,S+_.width/2,"center"),S+=_.width,T++;v+=C}}(t,e,r,n,o)}(t,e,i,n,o):function(t,e,i,n,o){var r=T(e,"font",n.font||A.DEFAULT_FONT),s=n.textPadding,a=t.__textCotentBlock;a&&!t.__dirty||(a=t.__textCotentBlock=A.parsePlainText(i,r,s,n.truncate));var h=a.outerHeight,l=a.lines,c=a.lineHeight,u=I(h,n,o),d=u.baseX,p=u.baseY,f=u.textAlign,g=u.textVerticalAlign;E(e,n,o,d,p);var y=A.adjustTextY(p,h,g),v=d,m=y,x=k(n);if(x||s){var _=A.getWidth(i,r);s&&(_+=s[1]+s[3]);var b=A.adjustTextX(d,_,f);x&&O(t,e,n,b,y,_,h),s&&(v=R(d,f,s),m+=s[0])}T(e,"textAlign",f||"left"),T(e,"textBaseline","middle"),T(e,"shadowBlur",n.textShadowBlur||0),T(e,"shadowColor",n.textShadowColor||"transparent"),T(e,"shadowOffsetX",n.textShadowOffsetX||0),T(e,"shadowOffsetY",n.textShadowOffsetY||0),m+=c/2;var w=n.textStrokeWidth,P=S(n.textStroke,w),C=M(n.textFill);P&&(T(e,"lineWidth",w),T(e,"strokeStyle",P));C&&T(e,"fillStyle",C);for(var N=0;N<l.length;N++)P&&e.strokeText(l[N],v,m),C&&e.fillText(l[N],v,m),m+=c}(t,e,i,n,o)},e.getStroke=S,e.getFill=M,e.needDrawText=function(t,e){return null!=t&&(t||e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor||e.textPadding)}},function(t,e,i){var d=i(27),E=i(28),n=i(5),o=n.getContext,l=n.extend,L=n.retrieve2,k=n.retrieve3,a={},h=0,c=5e3,O=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,u="12px sans-serif",r={};function I(t,e){var i=t+":"+(e=e||u);if(a[i])return a[i];for(var n=(t+"").split("\n"),o=0,r=0,s=n.length;r<s;r++)o=Math.max(m(n[r],e).width,o);return c<h&&(h=0,a={}),h++,a[i]=o}function p(t,e,i){return"right"===i?t-=e:"center"===i&&(t-=e/2),t}function f(t,e,i){return"middle"===i?t-=e/2:"bottom"===i&&(t-=e),t}function z(t,e,i,n,o){if(!e)return"";var r=(t+"").split("\n");o=g(e,i,n,o);for(var s=0,a=r.length;s<a;s++)r[s]=y(r[s],o);return r.join("\n")}function g(t,e,i,n){(n=l({},n)).font=e;i=L(i,"...");n.maxIterations=L(n.maxIterations,2);var o=n.minChar=L(n.minChar,0);n.cnCharWidth=I("",e);var r=n.ascCharWidth=I("a",e);n.placeholder=L(n.placeholder,"");for(var s=t=Math.max(0,t-1),a=0;a<o&&r<=s;a++)s-=r;var h=I(i);return s<h&&(i="",h=0),s=t-h,n.ellipsis=i,n.ellipsisWidth=h,n.contentWidth=s,n.containerWidth=t,n}function y(t,e){var i=e.containerWidth,n=e.font,o=e.contentWidth;if(!i)return"";var r=I(t,n);if(r<=i)return t;for(var s=0;;s++){if(r<=o||s>=e.maxIterations){t+=e.ellipsis;break}var a=0===s?v(t,o,e.ascCharWidth,e.cnCharWidth):0<r?Math.floor(t.length*o/r):0;r=I(t=t.substr(0,a),n)}return""===t&&(t=e.placeholder),t}function v(t,e,i,n){for(var o=0,r=0,s=t.length;r<s&&o<e;r++){var a=t.charCodeAt(r);o+=0<=a&&a<=127?i:n}return r}function B(t){return I("",t)}function m(t,e){return r.measureText(t,e)}function x(t,e,i,n){null!=t&&(t+="");var o=B(e),r=t?t.split("\n"):[],s=r.length*o,a=s;if(i&&(a+=i[0]+i[2]),t&&n){var h=n.outerHeight,l=n.outerWidth;if(null!=h&&h<a)t="",r=[];else if(null!=l)for(var c=g(l-(i?i[1]+i[3]:0),e,n.ellipsis,{minChar:n.minChar,placeholder:n.placeholder}),u=0,d=r.length;u<d;u++)r[u]=y(r[u],c)}return{lines:r,height:s,outerHeight:a,lineHeight:o}}function _(t,e){var i={lines:[],width:0,height:0};if(null!=t&&(t+=""),!t)return i;for(var n,o=O.lastIndex=0;null!=(n=O.exec(t));){var r=n.index;o<r&&D(i,t.substring(o,r)),D(i,n[2],n[1]),o=O.lastIndex}o<t.length&&D(i,t.substring(o,t.length));var s=i.lines,a=0,h=0,l=[],c=e.textPadding,u=e.truncate,d=u&&u.outerWidth,p=u&&u.outerHeight;c&&(null!=d&&(d-=c[1]+c[3]),null!=p&&(p-=c[0]+c[2]));for(var f=0;f<s.length;f++){for(var g=s[f],y=0,v=0,m=0;m<g.tokens.length;m++){var x=(R=g.tokens[m]).styleName&&e.rich[R.styleName]||{},_=R.textPadding=x.textPadding,b=R.font=x.font||e.font,w=R.textHeight=L(x.textHeight,B(b));if(_&&(w+=_[0]+_[2]),R.height=w,R.lineHeight=k(x.textLineHeight,e.textLineHeight,w),R.textAlign=x&&x.textAlign||e.textAlign,R.textVerticalAlign=x&&x.textVerticalAlign||"middle",null!=p&&a+R.lineHeight>p)return{lines:[],width:0,height:0};R.textWidth=I(R.text,b);var P=x.textWidth,C=null==P||"auto"===P;if("string"==typeof P&&"%"===P.charAt(P.length-1))R.percentWidth=P,l.push(R),P=0;else{if(C){P=R.textWidth;var N=x.textBackgroundColor,T=N&&N.image;T&&(T=E.findExistImage(T),E.isImageReady(T)&&(P=Math.max(P,T.width*w/T.height)))}var S=_?_[1]+_[3]:0;P+=S;var M=null!=d?d-v:null;null!=M&&M<P&&(!C||M<S?(R.text="",R.textWidth=P=0):(R.text=z(R.text,M-S,b,u.ellipsis,{minChar:u.minChar}),R.textWidth=I(R.text,b),P=R.textWidth+S))}v+=R.width=P,x&&(y=Math.max(y,R.lineHeight))}g.width=v,a+=g.lineHeight=y,h=Math.max(h,v)}i.outerWidth=i.width=L(e.textWidth,h),i.outerHeight=i.height=L(e.textHeight,a),c&&(i.outerWidth+=c[1]+c[3],i.outerHeight+=c[0]+c[2]);for(f=0;f<l.length;f++){var R,A=(R=l[f]).percentWidth;R.width=parseInt(A,10)/100*h}return i}function D(t,e,i){for(var n=""===e,o=e.split("\n"),r=t.lines,s=0;s<o.length;s++){var a=o[s],h={styleName:i,text:a,isLineHolder:!a&&!n};if(s)r.push({tokens:[h]});else{var l=(r[r.length-1]||(r[0]={tokens:[]})).tokens,c=l.length;1===c&&l[0].isLineHolder?l[0]=h:!a&&c&&!n||l.push(h)}}}r.measureText=function(t,e){var i=o();return i.font=e||u,i.measureText(t)},e.DEFAULT_FONT=u,e.$override=function(t,e){r[t]=e},e.getWidth=I,e.getBoundingRect=function(t,e,i,n,o,r,s){return r?function(t,e,i,n,o,r,s){var a=_(t,{rich:r,truncate:s,font:e,textAlign:i,textPadding:o}),h=a.outerWidth,l=a.outerHeight,c=p(0,h,i),u=f(0,l,n);return new d(c,u,h,l)}(t,e,i,n,o,r,s):function(t,e,i,n,o,r){var s=x(t,e,o,r),a=I(t,e);o&&(a+=o[1]+o[3]);var h=s.outerHeight,l=p(0,a,i),c=f(0,h,n),u=new d(l,c,a,h);return u.lineHeight=s.lineHeight,u}(t,e,i,n,o,s)},e.adjustTextX=p,e.adjustTextY=f,e.adjustTextPositionOnRect=function(t,e,i){var n=e.x,o=e.y,r=e.height,s=e.width,a=r/2,h="left",l="top";switch(t){case"left":n-=i,o+=a,h="right",l="middle";break;case"right":n+=i+s,o+=a,l="middle";break;case"top":n+=s/2,o-=i,h="center",l="bottom";break;case"bottom":n+=s/2,o+=r+i,h="center";break;case"inside":n+=s/2,o+=a,h="center",l="middle";break;case"insideLeft":n+=i,o+=a,l="middle";break;case"insideRight":n+=s-i,o+=a,h="right",l="middle";break;case"insideTop":n+=s/2,o+=i,h="center";break;case"insideBottom":n+=s/2,o+=r-i,h="center",l="bottom";break;case"insideTopLeft":n+=i,o+=i;break;case"insideTopRight":n+=s-i,o+=i,h="right";break;case"insideBottomLeft":n+=i,o+=r-i,l="bottom";break;case"insideBottomRight":n+=s-i,o+=r-i,h="right",l="bottom"}return{x:n,y:o,textAlign:h,textVerticalAlign:l}},e.truncateText=z,e.getLineHeight=B,e.measureText=m,e.parsePlainText=x,e.parseRichText=_,e.makeFont=function(t){return(t.fontSize||t.fontFamily)&&[t.fontStyle,t.fontWeight,(t.fontSize||12)+"px",t.fontFamily||"sans-serif"].join(" ")||t.textFont||t.font}},function(t,e,i){var n,o,r,s,a=i(15),h=i(14),l=a.applyTransform,c=Math.min,u=Math.max;function d(t,e,i,n){i<0&&(t+=i,i=-i),n<0&&(e+=n,n=-n),this.x=t,this.y=e,this.width=i,this.height=n}d.prototype={constructor:d,union:function(t){var e=c(t.x,this.x),i=c(t.y,this.y);this.width=u(t.x+t.width,this.x+this.width)-e,this.height=u(t.y+t.height,this.y+this.height)-i,this.x=e,this.y=i},applyTransform:(n=[],o=[],r=[],s=[],function(t){if(t){n[0]=r[0]=this.x,n[1]=s[1]=this.y,o[0]=s[0]=this.x+this.width,o[1]=r[1]=this.y+this.height,l(n,n,t),l(o,o,t),l(r,r,t),l(s,s,t),this.x=c(n[0],o[0],r[0],s[0]),this.y=c(n[1],o[1],r[1],s[1]);var e=u(n[0],o[0],r[0],s[0]),i=u(n[1],o[1],r[1],s[1]);this.width=e-this.x,this.height=i-this.y}}),calculateTransform:function(t){var e=t.width/this.width,i=t.height/this.height,n=h.create();return h.translate(n,n,[-this.x,-this.y]),h.scale(n,n,[e,i]),h.translate(n,n,[t.x,t.y]),n},intersect:function(t){if(!t)return!1;t instanceof d||(t=d.create(t));var e=this,i=e.x,n=e.x+e.width,o=e.y,r=e.y+e.height,s=t.x,a=t.x+t.width,h=t.y,l=t.y+t.height;return!(n<s||a<i||r<h||l<o)},contain:function(t,e){var i=this;return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height},clone:function(){return new d(this.x,this.y,this.width,this.height)},copy:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},d.create=function(t){return new d(t.x,t.y,t.width,t.height)};var p=d;t.exports=p},function(t,e,i){var a=new(i(21))(50);function h(){var t=this.__cachedImgObj;this.onload=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var i=t.pending[e],n=i.cb;n&&n(this,i.cbPayload),i.hostEl.dirty()}t.pending.length=0}function l(t){return t&&t.width&&t.height}e.findExistImage=function(t){if("string"!=typeof t)return t;var e=a.get(t);return e&&e.image},e.createOrUpdateImage=function(t,e,i,n,o){if(t){if("string"!=typeof t)return t;if(e&&e.__zrImageSrc===t||!i)return e;var r=a.get(t),s={hostEl:i,cb:n,cbPayload:o};return r?l(e=r.image)||r.pending.push(s):((e=e||new Image).onload=h,a.put(t,e.__cachedImgObj={image:e,pending:[s]}),e.src=e.__zrImageSrc=t),e}return e},e.isImageReady=l},function(t,e){e.buildPath=function(t,e){var i,n,o,r,s,a=e.x,h=e.y,l=e.width,c=e.height,u=e.r;l<0&&(a+=l,l=-l),c<0&&(h+=c,c=-c),"number"==typeof u?i=n=o=r=u:u instanceof Array?1===u.length?i=n=o=r=u[0]:2===u.length?(i=o=u[0],n=r=u[1]):3===u.length?(i=u[0],n=r=u[1],o=u[2]):(i=u[0],n=u[1],o=u[2],r=u[3]):i=n=o=r=0,l<i+n&&(i*=l/(s=i+n),n*=l/s),l<o+r&&(o*=l/(s=o+r),r*=l/s),c<n+o&&(n*=c/(s=n+o),o*=c/s),c<i+r&&(i*=c/(s=i+r),r*=c/s),t.moveTo(a+i,h),t.lineTo(a+l-n,h),0!==n&&t.quadraticCurveTo(a+l,h,a+l,h+n),t.lineTo(a+l,h+c-o),0!==o&&t.quadraticCurveTo(a+l,h+c,a+l-o,h+c),t.lineTo(a+r,h+c),0!==r&&t.quadraticCurveTo(a,h+c,a,h+c-r),t.lineTo(a,h+i),0!==i&&t.quadraticCurveTo(a,h,a+i,h)}},function(t,e,i){function n(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null}var w=i(31),y=i(15),v=i(32),m=i(27),o=i(23).devicePixelRatio,N={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},x=[],_=[],b=[],P=[],C=Math.min,T=Math.max,S=Math.cos,M=Math.sin,R=Math.sqrt,A=Math.abs,a="undefined"!=typeof Float32Array;n.prototype={constructor:n,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(t,e){this._ux=A(1/o/t)||0,this._uy=A(1/o/e)||0},getContext:function(){return this._ctx},beginPath:function(t){return(this._ctx=t)&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(t,e){return this.addData(N.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},lineTo:function(t,e){var i=A(t-this._xi)>this._ux||A(e-this._yi)>this._uy||this._len<5;return this.addData(N.L,t,e),this._ctx&&i&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),i&&(this._xi=t,this._yi=e),this},bezierCurveTo:function(t,e,i,n,o,r){return this.addData(N.C,t,e,i,n,o,r),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,i,n,o,r):this._ctx.bezierCurveTo(t,e,i,n,o,r)),this._xi=o,this._yi=r,this},quadraticCurveTo:function(t,e,i,n){return this.addData(N.Q,t,e,i,n),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,i,n):this._ctx.quadraticCurveTo(t,e,i,n)),this._xi=i,this._yi=n,this},arc:function(t,e,i,n,o,r){return this.addData(N.A,t,e,i,i,n,o-n,0,r?0:1),this._ctx&&this._ctx.arc(t,e,i,n,o,r),this._xi=S(o)*i+t,this._yi=M(o)*i+t,this},arcTo:function(t,e,i,n,o){return this._ctx&&this._ctx.arcTo(t,e,i,n,o),this},rect:function(t,e,i,n){return this._ctx&&this._ctx.rect(t,e,i,n),this.addData(N.R,t,e,i,n),this},closePath:function(){this.addData(N.Z);var t=this._ctx,e=this._x0,i=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,i),t.closePath()),this._xi=e,this._yi=i,this},fill:function(t){t&&t.fill(),this.toStatic()},stroke:function(t){t&&t.stroke(),this.toStatic()},setLineDash:function(t){if(t instanceof Array){this._lineDash=t;for(var e=this._dashIdx=0,i=0;i<t.length;i++)e+=t[i];this._dashSum=e}return this},setLineDashOffset:function(t){return this._dashOffset=t,this},len:function(){return this._len},setData:function(t){var e=t.length;this.data&&this.data.length==e||!a||(this.data=new Float32Array(e));for(var i=0;i<e;i++)this.data[i]=t[i];this._len=e},appendPath:function(t){t instanceof Array||(t=[t]);for(var e=t.length,i=0,n=this._len,o=0;o<e;o++)i+=t[o].len();a&&this.data instanceof Float32Array&&(this.data=new Float32Array(n+i));for(o=0;o<e;o++)for(var r=t[o].data,s=0;s<r.length;s++)this.data[n++]=r[s];this._len=n},addData:function(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var i=0;i<arguments.length;i++)e[this._len++]=arguments[i];this._prevCmd=t}},_expandData:function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(t,e){var i,n,o=this._dashSum,r=this._dashOffset,s=this._lineDash,a=this._ctx,h=this._xi,l=this._yi,c=t-h,u=e-l,d=R(c*c+u*u),p=h,f=l,g=s.length;for(r<0&&(r=o+r),p-=(r%=o)*(c/=d),f-=r*(u/=d);0<c&&p<=t||c<0&&t<=p||0==c&&(0<u&&f<=e||u<0&&e<=f);)p+=c*(i=s[n=this._dashIdx]),f+=u*i,this._dashIdx=(n+1)%g,0<c&&p<h||c<0&&h<p||0<u&&f<l||u<0&&l<f||a[n%2?"moveTo":"lineTo"](0<=c?C(p,t):T(p,t),0<=u?C(f,e):T(f,e));c=p-t,u=f-e,this._dashOffset=-R(c*c+u*u)},_dashedBezierTo:function(t,e,i,n,o,r){var s,a,h,l,c,u=this._dashSum,d=this._dashOffset,p=this._lineDash,f=this._ctx,g=this._xi,y=this._yi,v=w.cubicAt,m=0,x=this._dashIdx,_=p.length,b=0;for(d<0&&(d=u+d),d%=u,s=0;s<1;s+=.1)a=v(g,t,i,o,s+.1)-v(g,t,i,o,s),h=v(y,e,n,r,s+.1)-v(y,e,n,r,s),m+=R(a*a+h*h);for(;x<_&&!(d<(b+=p[x]));x++);for(s=(b-d)/m;s<=1;)l=v(g,t,i,o,s),c=v(y,e,n,r,s),x%2?f.moveTo(l,c):f.lineTo(l,c),s+=p[x]/m,x=(x+1)%_;x%2!=0&&f.lineTo(o,r),a=o-l,h=r-c,this._dashOffset=-R(a*a+h*h)},_dashedQuadraticTo:function(t,e,i,n){var o=i,r=n;i=(i+2*t)/3,n=(n+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,i,n,o,r)},toStatic:function(){var t=this.data;t instanceof Array&&(t.length=this._len,a&&(this.data=new Float32Array(t)))},getBoundingRect:function(){x[0]=x[1]=b[0]=b[1]=Number.MAX_VALUE,_[0]=_[1]=P[0]=P[1]=-Number.MAX_VALUE;for(var t=this.data,e=0,i=0,n=0,o=0,r=0;r<t.length;){var s=t[r++];switch(1==r&&(n=e=t[r],o=i=t[r+1]),s){case N.M:e=n=t[r++],i=o=t[r++],b[0]=n,b[1]=o,P[0]=n,P[1]=o;break;case N.L:v.fromLine(e,i,t[r],t[r+1],b,P),e=t[r++],i=t[r++];break;case N.C:v.fromCubic(e,i,t[r++],t[r++],t[r++],t[r++],t[r],t[r+1],b,P),e=t[r++],i=t[r++];break;case N.Q:v.fromQuadratic(e,i,t[r++],t[r++],t[r],t[r+1],b,P),e=t[r++],i=t[r++];break;case N.A:var a=t[r++],h=t[r++],l=t[r++],c=t[r++],u=t[r++],d=t[r++]+u,p=(t[r++],1-t[r++]);1==r&&(n=S(u)*l+a,o=M(u)*c+h),v.fromArc(a,h,l,c,u,d,p,b,P),e=S(d)*l+a,i=M(d)*c+h;break;case N.R:n=e=t[r++],o=i=t[r++];var f=t[r++],g=t[r++];v.fromLine(n,o,n+f,o+g,b,P);break;case N.Z:e=n,i=o}y.min(x,x,b),y.max(_,_,P)}return 0===r&&(x[0]=x[1]=_[0]=_[1]=0),new m(x[0],x[1],_[0]-x[0],_[1]-x[1])},rebuildPath:function(t){for(var e,i,n,o,r,s,a=this.data,h=this._ux,l=this._uy,c=this._len,u=0;u<c;){var d=a[u++];switch(1==u&&(e=n=a[u],i=o=a[u+1]),d){case N.M:e=n=a[u++],i=o=a[u++],t.moveTo(n,o);break;case N.L:r=a[u++],s=a[u++],(A(r-n)>h||A(s-o)>l||u===c-1)&&(t.lineTo(r,s),n=r,o=s);break;case N.C:t.bezierCurveTo(a[u++],a[u++],a[u++],a[u++],a[u++],a[u++]),n=a[u-2],o=a[u-1];break;case N.Q:t.quadraticCurveTo(a[u++],a[u++],a[u++],a[u++]),n=a[u-2],o=a[u-1];break;case N.A:var p=a[u++],f=a[u++],g=a[u++],y=a[u++],v=a[u++],m=a[u++],x=a[u++],_=a[u++],b=y<g?g:y,w=y<g?1:g/y,P=y<g?y/g:1,C=v+m;.001<Math.abs(g-y)?(t.translate(p,f),t.rotate(x),t.scale(w,P),t.arc(0,0,b,v,C,1-_),t.scale(1/w,1/P),t.rotate(-x),t.translate(-p,-f)):t.arc(p,f,b,v,C,1-_),1==u&&(e=S(v)*g+p,i=M(v)*y+f),n=S(C)*g+p,o=M(C)*y+f;break;case N.R:e=n=a[u],i=o=a[u+1],t.rect(a[u++],a[u++],a[u++],a[u++]);break;case N.Z:t.closePath(),n=e,o=i}}}},n.CMD=N;var r=n;t.exports=r},function(t,e,i){var n=i(15),o=n.create,_=n.distSquare,T=Math.pow,S=Math.sqrt,r=1e-8,M=S(3),b=o(),w=o(),P=o();function R(t){return-r<t&&t<r}function p(t){return r<t||t<-r}function C(t,e,i,n,o){var r=1-o;return r*r*(r*t+3*o*e)+o*o*(o*n+3*r*i)}function m(t,e,i,n){var o=1-n;return o*(o*t+2*n*e)+n*n*i}e.cubicAt=C,e.cubicDerivativeAt=function(t,e,i,n,o){var r=1-o;return 3*(((e-t)*r+2*(i-e)*o)*r+(n-i)*o*o)},e.cubicRootAt=function(t,e,i,n,o,r){var s=n+3*(e-i)-t,a=3*(i-2*e+t),h=3*(e-t),l=t-o,c=a*a-3*s*h,u=a*h-9*s*l,d=h*h-3*a*l,p=0;if(R(c)&&R(u)){if(R(a))r[0]=0;else 0<=(C=-h/a)&&C<=1&&(r[p++]=C)}else{var f=u*u-4*c*d;if(R(f)){var g=u/c,y=-g/2;0<=(C=-a/s+g)&&C<=1&&(r[p++]=C),0<=y&&y<=1&&(r[p++]=y)}else if(0<f){var v=S(f),m=c*a+1.5*s*(-u+v),x=c*a+1.5*s*(-u-v);0<=(C=(-a-((m=m<0?-T(-m,1/3):T(m,1/3))+(x=x<0?-T(-x,1/3):T(x,1/3))))/(3*s))&&C<=1&&(r[p++]=C)}else{var _=(2*c*a-3*s*u)/(2*S(c*c*c)),b=Math.acos(_)/3,w=S(c),P=Math.cos(b),C=(-a-2*w*P)/(3*s),N=(y=(-a+w*(P+M*Math.sin(b)))/(3*s),(-a+w*(P-M*Math.sin(b)))/(3*s));0<=C&&C<=1&&(r[p++]=C),0<=y&&y<=1&&(r[p++]=y),0<=N&&N<=1&&(r[p++]=N)}}return p},e.cubicExtrema=function(t,e,i,n,o){var r=6*i-12*e+6*t,s=9*e+3*n-3*t-9*i,a=3*e-3*t,h=0;if(R(s)){if(p(r))0<=(c=-a/r)&&c<=1&&(o[h++]=c)}else{var l=r*r-4*s*a;if(R(l))o[0]=-r/(2*s);else if(0<l){var c,u=S(l),d=(-r-u)/(2*s);0<=(c=(-r+u)/(2*s))&&c<=1&&(o[h++]=c),0<=d&&d<=1&&(o[h++]=d)}}return h},e.cubicSubdivide=function(t,e,i,n,o,r){var s=(e-t)*o+t,a=(i-e)*o+e,h=(n-i)*o+i,l=(a-s)*o+s,c=(h-a)*o+a,u=(c-l)*o+l;r[0]=t,r[1]=s,r[2]=l,r[3]=u,r[4]=u,r[5]=c,r[6]=h,r[7]=n},e.cubicProjectPoint=function(t,e,i,n,o,r,s,a,h,l,c){var u,d,p,f,g,y=.005,v=1/0;b[0]=h,b[1]=l;for(var m=0;m<1;m+=.05)w[0]=C(t,i,o,s,m),w[1]=C(e,n,r,a,m),(f=_(b,w))<v&&(u=m,v=f);v=1/0;for(var x=0;x<32&&!(y<1e-4);x++)d=u-y,p=u+y,w[0]=C(t,i,o,s,d),w[1]=C(e,n,r,a,d),f=_(w,b),0<=d&&f<v?(u=d,v=f):(P[0]=C(t,i,o,s,p),P[1]=C(e,n,r,a,p),g=_(P,b),p<=1&&g<v?(u=p,v=g):y*=.5);return c&&(c[0]=C(t,i,o,s,u),c[1]=C(e,n,r,a,u)),S(v)},e.quadraticAt=m,e.quadraticDerivativeAt=function(t,e,i,n){return 2*((1-n)*(e-t)+n*(i-e))},e.quadraticRootAt=function(t,e,i,n,o){var r=t-2*e+i,s=2*(e-t),a=t-n,h=0;if(R(r)){if(p(s))0<=(c=-a/s)&&c<=1&&(o[h++]=c)}else{var l=s*s-4*r*a;if(R(l))0<=(c=-s/(2*r))&&c<=1&&(o[h++]=c);else if(0<l){var c,u=S(l),d=(-s-u)/(2*r);0<=(c=(-s+u)/(2*r))&&c<=1&&(o[h++]=c),0<=d&&d<=1&&(o[h++]=d)}}return h},e.quadraticExtremum=function(t,e,i){var n=t+i-2*e;return 0==n?.5:(t-e)/n},e.quadraticSubdivide=function(t,e,i,n,o){var r=(e-t)*n+t,s=(i-e)*n+e,a=(s-r)*n+r;o[0]=t,o[1]=r,o[2]=a,o[3]=a,o[4]=s,o[5]=i},e.quadraticProjectPoint=function(t,e,i,n,o,r,s,a,h){var l,c=.005,u=1/0;b[0]=s,b[1]=a;for(var d=0;d<1;d+=.05){w[0]=m(t,i,o,d),w[1]=m(e,n,r,d),(y=_(b,w))<u&&(l=d,u=y)}u=1/0;for(var p=0;p<32&&!(c<1e-4);p++){var f=l-c,g=l+c;w[0]=m(t,i,o,f),w[1]=m(e,n,r,f);var y=_(w,b);if(0<=f&&y<u)l=f,u=y;else{P[0]=m(t,i,o,g),P[1]=m(e,n,r,g);var v=_(P,b);g<=1&&v<u?(l=g,u=v):c*=.5}}return h&&(h[0]=m(t,i,o,l),h[1]=m(e,n,r,l)),S(u)}},function(t,e,i){var f=i(15),y=i(31),v=Math.min,m=Math.max,g=Math.sin,x=Math.cos,_=2*Math.PI,b=f.create(),w=f.create(),P=f.create();var C=[],N=[];e.fromPoints=function(t,e,i){if(0!==t.length){var n,o=t[0],r=o[0],s=o[0],a=o[1],h=o[1];for(n=1;n<t.length;n++)o=t[n],r=v(r,o[0]),s=m(s,o[0]),a=v(a,o[1]),h=m(h,o[1]);e[0]=r,e[1]=a,i[0]=s,i[1]=h}},e.fromLine=function(t,e,i,n,o,r){o[0]=v(t,i),o[1]=v(e,n),r[0]=m(t,i),r[1]=m(e,n)},e.fromCubic=function(t,e,i,n,o,r,s,a,h,l){var c,u=y.cubicExtrema,d=y.cubicAt,p=u(t,i,o,s,C);for(h[0]=1/0,h[1]=1/0,l[0]=-1/0,l[1]=-1/0,c=0;c<p;c++){var f=d(t,i,o,s,C[c]);h[0]=v(f,h[0]),l[0]=m(f,l[0])}for(p=u(e,n,r,a,N),c=0;c<p;c++){var g=d(e,n,r,a,N[c]);h[1]=v(g,h[1]),l[1]=m(g,l[1])}h[0]=v(t,h[0]),l[0]=m(t,l[0]),h[0]=v(s,h[0]),l[0]=m(s,l[0]),h[1]=v(e,h[1]),l[1]=m(e,l[1]),h[1]=v(a,h[1]),l[1]=m(a,l[1])},e.fromQuadratic=function(t,e,i,n,o,r,s,a){var h=y.quadraticExtremum,l=y.quadraticAt,c=m(v(h(t,i,o),1),0),u=m(v(h(e,n,r),1),0),d=l(t,i,o,c),p=l(e,n,r,u);s[0]=v(t,o,d),s[1]=v(e,r,p),a[0]=m(t,o,d),a[1]=m(e,r,p)},e.fromArc=function(t,e,i,n,o,r,s,a,h){var l=f.min,c=f.max,u=Math.abs(o-r);if(u%_<1e-4&&1e-4<u)return a[0]=t-i,a[1]=e-n,h[0]=t+i,void(h[1]=e+n);if(b[0]=x(o)*i+t,b[1]=g(o)*n+e,w[0]=x(r)*i+t,w[1]=g(r)*n+e,l(a,b,w),c(h,b,w),(o%=_)<0&&(o+=_),(r%=_)<0&&(r+=_),r<o&&!s?r+=_:o<r&&s&&(o+=_),s){var d=r;r=o,o=d}for(var p=0;p<r;p+=Math.PI/2)o<p&&(P[0]=x(p)*i+t,P[1]=g(p)*n+e,l(a,P,a),c(h,P,h))}},function(t,e,i){var n=i(30),w=i(34),P=i(35),C=i(36),N=i(37),g=i(38).normalizeRadian,x=i(31),T=i(39),S=n.CMD,y=2*Math.PI,M=1e-4;var _=[-1,-1,-1],b=[-1,-1];function R(t,e,i,n,o,r,s,a,h,l){if(e<l&&n<l&&r<l&&a<l||l<e&&l<n&&l<r&&l<a)return 0;var c,u=x.cubicRootAt(e,n,r,a,l,_);if(0===u)return 0;for(var d,p,f=0,g=-1,y=0;y<u;y++){var v=_[y],m=0===v||1===v?.5:1;x.cubicAt(t,i,o,s,v)<h||(g<0&&(g=x.cubicExtrema(e,n,r,a,b),b[1]<b[0]&&1<g&&(void 0,c=b[0],b[0]=b[1],b[1]=c),d=x.cubicAt(e,n,r,a,b[0]),1<g&&(p=x.cubicAt(e,n,r,a,b[1]))),2==g?v<b[0]?f+=d<e?m:-m:v<b[1]?f+=p<d?m:-m:f+=a<p?m:-m:v<b[0]?f+=d<e?m:-m:f+=a<d?m:-m)}return f}function A(t,e,i,n,o,r,s,a){if(e<a&&n<a&&r<a||a<e&&a<n&&a<r)return 0;var h=x.quadraticRootAt(e,n,r,a,_);if(0===h)return 0;var l=x.quadraticExtremum(e,n,r);if(0<=l&&l<=1){for(var c=0,u=x.quadraticAt(e,n,r,l),d=0;d<h;d++){var p=0===_[d]||1===_[d]?.5:1;x.quadraticAt(t,i,o,_[d])<s||(_[d]<l?c+=u<e?p:-p:c+=r<u?p:-p)}return c}p=0===_[0]||1===_[0]?.5:1;return x.quadraticAt(t,i,o,_[0])<s?0:r<e?p:-p}function E(t,e,i,n,o,r,s,a){if(i<(a-=e)||a<-i)return 0;var h=Math.sqrt(i*i-a*a);_[0]=-h,_[1]=h;var l=Math.abs(n-o);if(l<1e-4)return 0;if(l%y<1e-4){o=y;var c=r?1:-1;return s>=_[n=0]+t&&s<=_[1]+t?c:0}if(r){h=n;n=g(o),o=g(h)}else n=g(n),o=g(o);o<n&&(o+=y);for(var u=0,d=0;d<2;d++){var p=_[d];if(s<p+t){var f=Math.atan2(a,p);c=r?1:-1;f<0&&(f=y+f),(n<=f&&f<=o||n<=f+y&&f+y<=o)&&(f>Math.PI/2&&f<1.5*Math.PI&&(c=-c),u+=c)}}return u}function o(t,e,i,n,o){for(var r=0,s=0,a=0,h=0,l=0,c=0;c<t.length;){var u=t[c++];switch(u===S.M&&1<c&&(i||(r+=T(s,a,h,l,n,o))),1==c&&(h=s=t[c],l=a=t[c+1]),u){case S.M:s=h=t[c++],a=l=t[c++];break;case S.L:if(i){if(w.containStroke(s,a,t[c],t[c+1],e,n,o))return!0}else r+=T(s,a,t[c],t[c+1],n,o)||0;s=t[c++],a=t[c++];break;case S.C:if(i){if(P.containStroke(s,a,t[c++],t[c++],t[c++],t[c++],t[c],t[c+1],e,n,o))return!0}else r+=R(s,a,t[c++],t[c++],t[c++],t[c++],t[c],t[c+1],n,o)||0;s=t[c++],a=t[c++];break;case S.Q:if(i){if(C.containStroke(s,a,t[c++],t[c++],t[c],t[c+1],e,n,o))return!0}else r+=A(s,a,t[c++],t[c++],t[c],t[c+1],n,o)||0;s=t[c++],a=t[c++];break;case S.A:var d=t[c++],p=t[c++],f=t[c++],g=t[c++],y=t[c++],v=t[c++],m=(t[c++],1-t[c++]),x=Math.cos(y)*f+d,_=Math.sin(y)*g+p;1<c?r+=T(s,a,x,_,n,o):(h=x,l=_);var b=(n-d)*g/f+d;if(i){if(N.containStroke(d,p,g,y,y+v,m,e,b,o))return!0}else r+=E(d,p,g,y,y+v,m,b,o);s=Math.cos(y+v)*f+d,a=Math.sin(y+v)*g+p;break;case S.R:h=s=t[c++],l=a=t[c++];x=h+t[c++],_=l+t[c++];if(i){if(w.containStroke(h,l,x,l,e,n,o)||w.containStroke(x,l,x,_,e,n,o)||w.containStroke(x,_,h,_,e,n,o)||w.containStroke(h,_,h,l,e,n,o))return!0}else r+=T(x,l,x,_,n,o),r+=T(h,_,h,l,n,o);break;case S.Z:if(i){if(w.containStroke(s,a,h,l,e,n,o))return!0}else r+=T(s,a,h,l,n,o);s=h,a=l}}return i||function(t,e){return Math.abs(t-e)<M}(a,l)||(r+=T(s,a,h,l,n,o)||0),0!==r}e.contain=function(t,e,i){return o(t,0,!1,e,i)},e.containStroke=function(t,e,i,n){return o(t,e,!0,i,n)}},function(t,e){e.containStroke=function(t,e,i,n,o,r,s){if(0===o)return!1;var a=o,h=0;if(e+a<s&&n+a<s||s<e-a&&s<n-a||t+a<r&&i+a<r||r<t-a&&r<i-a)return!1;if(t===i)return Math.abs(r-t)<=a/2;var l=(h=(e-n)/(t-i))*r-s+(t*n-i*e)/(t-i);return l*l/(h*h+1)<=a/2*a/2}},function(t,e,i){var d=i(31);e.containStroke=function(t,e,i,n,o,r,s,a,h,l,c){if(0===h)return!1;var u=h;return!(e+u<c&&n+u<c&&r+u<c&&a+u<c||c<e-u&&c<n-u&&c<r-u&&c<a-u||t+u<l&&i+u<l&&o+u<l&&s+u<l||l<t-u&&l<i-u&&l<o-u&&l<s-u)&&d.cubicProjectPoint(t,e,i,n,o,r,s,a,l,c,null)<=u/2}},function(t,e,i){var c=i(31).quadraticProjectPoint;e.containStroke=function(t,e,i,n,o,r,s,a,h){if(0===s)return!1;var l=s;return!(e+l<h&&n+l<h&&r+l<h||h<e-l&&h<n-l&&h<r-l||t+l<a&&i+l<a&&o+l<a||a<t-l&&a<i-l&&a<o-l)&&c(t,e,i,n,o,r,a,h,null)<=l/2}},function(t,e,i){var p=i(38).normalizeRadian,f=2*Math.PI;e.containStroke=function(t,e,i,n,o,r,s,a,h){if(0===s)return!1;var l=s;a-=t,h-=e;var c=Math.sqrt(a*a+h*h);if(i<c-l||c+l<i)return!1;if(Math.abs(n-o)%f<1e-4)return!0;if(r){var u=n;n=p(o),o=p(u)}else n=p(n),o=p(o);o<n&&(o+=f);var d=Math.atan2(h,a);return d<0&&(d+=f),n<=d&&d<=o||n<=d+f&&d+f<=o}},function(t,e){var i=2*Math.PI;e.normalizeRadian=function(t){return(t%=i)<0&&(t+=i),t}},function(t,e){t.exports=function(t,e,i,n,o,r){if(e<r&&n<r||r<e&&r<n)return 0;if(n===e)return 0;var s=n<e?1:-1,a=(r-e)/(n-e);return 1!=a&&0!=a||(s=n<e?.5:-.5),o<a*(i-t)+t?s:0}},function(t,e){function i(t,e){this.image=t,this.repeat=e,this.type="pattern"}i.prototype.getCanvasPattern=function(t){return t.createPattern(this.image,this.repeat||"repeat")};var n=i;t.exports=n},function(t,e,i){var n=i(30),_=i(15).applyTransform,b=n.CMD,w=[[],[],[]],P=Math.sqrt,C=Math.atan2;t.exports=function(t,e){var i,n,o,r,s,a=t.data,h=b.M,l=b.C,c=b.L,u=b.R,d=b.A,p=b.Q;for(r=o=0;o<a.length;){switch(i=a[o++],r=o,n=0,i){case h:case c:n=1;break;case l:n=3;break;case p:n=2;break;case d:var f=e[4],g=e[5],y=P(e[0]*e[0]+e[1]*e[1]),v=P(e[2]*e[2]+e[3]*e[3]),m=C(-e[1]/v,e[0]/y);a[o]*=y,a[o++]+=f,a[o]*=v,a[o++]+=g,a[o++]*=y,a[o++]*=v,a[o++]+=m,a[o++]+=m,r=o+=2;break;case u:x[0]=a[o++],x[1]=a[o++],_(x,x,e),a[r++]=x[0],a[r++]=x[1],x[0]+=a[o++],x[1]+=a[o++],_(x,x,e),a[r++]=x[0],a[r++]=x[1]}for(s=0;s<n;s++){var x;(x=w[s])[0]=a[o++],x[1]=a[o++],_(x,x,e),a[r++]=x[0],a[r++]=x[1]}}}},function(t,e){function i(t){this.colorStops=t||[]}i.prototype={constructor:i,addColorStop:function(t,e){this.colorStops.push({offset:t,color:e})}};var n=i;t.exports=n},function(t,e){function i(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this)}function h(t,e){return{target:t,topTarget:e&&e.topTarget}}i.prototype={constructor:i,_dragStart:function(t){var e=t.target;e&&e.draggable&&((this._draggingTarget=e).dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(h(e,t),"dragstart",t.event))},_drag:function(t){var e=this._draggingTarget;if(e){var i=t.offsetX,n=t.offsetY,o=i-this._x,r=n-this._y;this._x=i,this._y=n,e.drift(o,r,t),this.dispatchToElement(h(e,t),"drag",t.event);var s=this.findHover(i,n,e).target,a=this._dropTarget;e!==(this._dropTarget=s)&&(a&&s!==a&&this.dispatchToElement(h(a,t),"dragleave",t.event),s&&s!==a&&this.dispatchToElement(h(s,t),"dragenter",t.event))}},_dragEnd:function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(h(e,t),"dragend",t.event),this._dropTarget&&this.dispatchToElement(h(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null}};var n=i;t.exports=n},function(t,e,i){function r(t){for(var e in t=t||{},n.call(this,t),t)t.hasOwnProperty(e)&&(this[e]=t[e]);this._children=[],this.__storage=null,this.__dirty=!0}var s=i(5),n=i(10),l=i(27);r.prototype={constructor:r,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},childOfName:function(t){for(var e=this._children,i=0;i<e.length;i++)if(e[i].name===t)return e[i]},childCount:function(){return this._children.length},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},addBefore:function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var i=this._children,n=i.indexOf(e);0<=n&&(i.splice(n,0,t),this._doAdd(t))}return this},_doAdd:function(t){t.parent&&t.parent.remove(t);var e=(t.parent=this).__storage,i=this.__zr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof r&&t.addChildrenToStorage(e)),i&&i.refresh()},remove:function(t){var e=this.__zr,i=this.__storage,n=this._children,o=s.indexOf(n,t);return o<0||(n.splice(o,1),t.parent=null,i&&(i.delFromStorage(t),t instanceof r&&t.delChildrenFromStorage(i)),e&&e.refresh()),this},removeAll:function(){var t,e,i=this._children,n=this.__storage;for(e=0;e<i.length;e++)t=i[e],n&&(n.delFromStorage(t),t instanceof r&&t.delChildrenFromStorage(n)),t.parent=null;return i.length=0,this},eachChild:function(t,e){for(var i=this._children,n=0;n<i.length;n++){var o=i[n];t.call(e,o,n)}return this},traverse:function(t,e){for(var i=0;i<this._children.length;i++){var n=this._children[i];t.call(e,n),"group"===n.type&&n.traverse(t,e)}return this},addChildrenToStorage:function(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.addToStorage(i),i instanceof r&&i.addChildrenToStorage(t)}},delChildrenFromStorage:function(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.delFromStorage(i),i instanceof r&&i.delChildrenFromStorage(t)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(t){for(var e=null,i=new l(0,0,0,0),n=t||this._children,o=[],r=0;r<n.length;r++){var s=n[r];if(!s.ignore&&!s.invisible){var a=s.getBoundingRect(),h=s.getLocalTransform(o);h?(i.copy(a),i.applyTransform(h),(e=e||i.clone()).union(i)):(e=e||a.clone()).union(a)}}return e||i}},s.inherits(r,n);var o=r;t.exports=o},function(t,e,i){var n=i(8),o=i(27),r=i(5),f=i(28);function s(t){n.call(this,t)}s.prototype={constructor:s,type:"image",brush:function(t,e){var i=this.style,n=i.image;i.bind(t,this,e);var o=this._image=f.createOrUpdateImage(n,this._image,this,this.onload);if(o&&f.isImageReady(o)){var r=i.x||0,s=i.y||0,a=i.width,h=i.height,l=o.width/o.height;if(null==a&&null!=h?a=h*l:null==h&&null!=a?h=a/l:null==a&&null==h&&(a=o.width,h=o.height),this.setTransform(t),i.sWidth&&i.sHeight){var c=i.sx||0,u=i.sy||0;t.drawImage(o,c,u,i.sWidth,i.sHeight,r,s,a,h)}else if(i.sx&&i.sy){var d=a-(c=i.sx),p=h-(u=i.sy);t.drawImage(o,c,u,d,p,r,s,a,h)}else t.drawImage(o,r,s,a,h);this.restoreTransform(t),null!=i.text&&this.drawRectText(t,this.getBoundingRect())}},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new o(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect}},r.inherits(s,n);var a=s;t.exports=a},function(t,e,i){function n(t){o.call(this,t)}var o=i(8),r=i(5),s=i(26),a=i(25);n.prototype={constructor:n,type:"text",brush:function(t,e){var i=this.style;this.__dirty&&a.normalizeTextStyle(i,!0),i.fill=i.stroke=i.shadowBlur=i.shadowColor=i.shadowOffsetX=i.shadowOffsetY=null;var n=i.text;null!=n&&(n+=""),i.bind(t,this,e),a.needDrawText(n,i)&&(this.setTransform(t),a.renderText(this,t,n,i),this.restoreTransform(t))},getBoundingRect:function(){var t=this.style;if(this.__dirty&&a.normalizeTextStyle(t,!0),!this._rect){var e=t.text;null!=e?e+="":e="";var i=s.getBoundingRect(t.text+"",t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.rich);if(i.x+=t.x||0,i.y+=t.y||0,a.getStroke(t.textStroke,t.textStrokeWidth)){var n=t.textStrokeWidth;i.x-=n/2,i.y-=n/2,i.width+=n,i.height+=n}this._rect=i}return this._rect}},r.inherits(n,o);var h=n;t.exports=h},function(t,e,i){var n=i(7).extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(t,e,i){i&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}});t.exports=n},function(t,e,i){var n=i(7),o=i(49),r=n.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:o(n.prototype.brush),buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r0||0,0),r=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,h=e.clockwise,l=Math.cos(s),c=Math.sin(s);t.moveTo(l*o+i,c*o+n),t.lineTo(l*r+i,c*r+n),t.arc(i,n,r,s,a,!h),t.lineTo(Math.cos(a)*o+i,Math.sin(a)*o+n),0!==o&&t.arc(i,n,o,a,s,h),t.closePath()}});t.exports=r},function(t,e,i){var n=i(50),l=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]];t.exports=function(h){return n.browser.ie&&11<=n.browser.version?function(){var t,e=this.__clipPaths,i=this.style;if(e)for(var n=0;n<e.length;n++){var o=e[n],r=o&&o.shape,s=o&&o.type;if(r&&("sector"===s&&r.startAngle===r.endAngle||"rect"===s&&(!r.width||!r.height))){for(var a=0;a<l.length;a++)l[a][2]=i[l[a][0]],i[l[a][0]]=l[a][1];t=!0;break}}if(h.apply(this,arguments),t)for(a=0;a<l.length;a++)i[l[a][0]]=l[a][2]}:h}},function(t,e){var i="undefined"==typeof navigator?{browser:{},os:{},node:!0,canvasSupported:!0,svgSupported:!0}:function(t){var e={},i=t.match(/Firefox\/([\d.]+)/),n=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),o=t.match(/Edge\/([\d.]+)/),r=/micromessenger/i.test(t);i&&(e.firefox=!0,e.version=i[1]);n&&(e.ie=!0,e.version=n[1]);o&&(e.edge=!0,e.version=o[1]);r&&(e.weChat=!0);return{browser:e,os:{},node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!e.ie&&!e.edge,pointerEventsSupported:"onpointerdown"in window&&(e.edge||e.ie&&11<=e.version)}}(navigator.userAgent);t.exports=i},function(t,e,i){var n=i(7).extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,o,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,o,!0)}});t.exports=n},function(t,e,i){var n=i(7),o=i(53),r=n.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){o.buildPath(t,e,!0)}});t.exports=r},function(t,e,i){var d=i(54),p=i(55);e.buildPath=function(t,e,i){var n=e.points,o=e.smooth;if(n&&2<=n.length){if(o&&"spline"!==o){var r=p(n,o,i,e.smoothConstraint);t.moveTo(n[0][0],n[0][1]);for(var s=n.length,a=0;a<(i?s:s-1);a++){var h=r[2*a],l=r[2*a+1],c=n[(a+1)%s];t.bezierCurveTo(h[0],h[1],l[0],l[1],c[0],c[1])}}else{"spline"===o&&(n=d(n,i)),t.moveTo(n[0][0],n[0][1]);a=1;for(var u=n.length;a<u;a++)t.lineTo(n[a][0],n[a][1])}i&&t.closePath()}}},function(t,e,i){var y=i(15).distance;function v(t,e,i,n,o,r,s){var a=.5*(i-t),h=.5*(n-e);return(2*(e-i)+a+h)*s+(-3*(e-i)-2*a-h)*r+a*o+e}t.exports=function(t,e){for(var i=t.length,n=[],o=0,r=1;r<i;r++)o+=y(t[r-1],t[r]);var s=o/2;for(s=s<i?i:s,r=0;r<s;r++){var a,h,l,c=r/(s-1)*(e?i:i-1),u=Math.floor(c),d=c-u,p=t[u%i];l=e?(a=t[(u-1+i)%i],h=t[(u+1)%i],t[(u+2)%i]):(a=t[0===u?u:u-1],h=t[i-2<u?i-1:u+1],t[i-3<u?i-1:u+2]);var f=d*d,g=d*f;n.push([v(a[0],p[0],h[0],l[0],d,f,g),v(a[1],p[1],h[1],l[1],d,f,g)])}return n}},function(t,e,i){var n=i(15),_=n.min,b=n.max,w=n.scale,P=n.distance,C=n.add,N=n.clone,T=n.sub;t.exports=function(t,e,i,n){var o,r,s,a,h=[],l=[],c=[],u=[];if(n){s=[1/0,1/0],a=[-1/0,-1/0];for(var d=0,p=t.length;d<p;d++)_(s,s,t[d]),b(a,a,t[d]);_(s,s,n[0]),b(a,a,n[1])}for(d=0,p=t.length;d<p;d++){var f=t[d];if(i)o=t[d?d-1:p-1],r=t[(d+1)%p];else{if(0===d||d===p-1){h.push(N(t[d]));continue}o=t[d-1],r=t[d+1]}T(l,r,o),w(l,l,e);var g=P(f,o),y=P(f,r),v=g+y;0!==v&&(g/=v,y/=v),w(c,l,-g),w(u,l,y);var m=C([],f,c),x=C([],f,u);n&&(b(m,m,s),_(m,m,a),b(x,x,s),_(x,x,a)),h.push(m),h.push(x)}return i&&h.push(h.shift()),h}},function(t,e,i){var n=i(7),o=i(53),r=n.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){o.buildPath(t,e,!1)}});t.exports=r},function(t,e,i){var n=i(7),s=i(29),o=n.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,n=e.y,o=e.width,r=e.height;e.r?s.buildPath(t,e):t.rect(i,n,o,r),t.closePath()}});t.exports=o},function(t,e,i){var n=i(7).extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,s=e.percent;0!==s&&(t.moveTo(i,n),s<1&&(o=i*(1-s)+o*s,r=n*(1-s)+r*s),t.lineTo(o,r))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]}});t.exports=n},function(t,e,i){var n=i(7),o=i(15),r=i(31),u=r.quadraticSubdivide,d=r.cubicSubdivide,s=r.quadraticAt,a=r.cubicAt,h=r.quadraticDerivativeAt,l=r.cubicDerivativeAt,p=[];function c(t,e,i){var n=t.cpx2,o=t.cpy2;return null===n||null===o?[(i?l:a)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?l:a)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?h:s)(t.x1,t.cpx1,t.x2,e),(i?h:s)(t.y1,t.cpy1,t.y2,e)]}var f=n.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,s=e.cpx1,a=e.cpy1,h=e.cpx2,l=e.cpy2,c=e.percent;0!==c&&(t.moveTo(i,n),null==h||null==l?(c<1&&(u(i,s,o,c,p),s=p[1],o=p[2],u(n,a,r,c,p),a=p[1],r=p[2]),t.quadraticCurveTo(s,a,o,r)):(c<1&&(d(i,s,h,o,c,p),s=p[1],h=p[2],o=p[3],d(n,a,l,r,c,p),a=p[1],l=p[2],r=p[3]),t.bezierCurveTo(s,a,h,l,o,r)))},pointAt:function(t){return c(this.shape,t,!1)},tangentAt:function(t){var e=c(this.shape,t,!0);return o.normalize(e,e)}});t.exports=f},function(t,e,i){var n=i(7).extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r,0),r=e.startAngle,s=e.endAngle,a=e.clockwise,h=Math.cos(r),l=Math.sin(r);t.moveTo(h*o+i,l*o+n),t.arc(i,n,o,r,s,!a)}});t.exports=n},function(t,e,i){function n(t,e,i,n,o,r){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==i?1:i,this.y2=null==n?0:n,this.type="linear",this.global=r||!1,s.call(this,o)}var o=i(5),s=i(42);n.prototype={constructor:n},o.inherits(n,s);var r=n;t.exports=r},function(t,e,i){function n(t,e,i,n,o){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==i?.5:i,this.type="radial",this.global=o||!1,r.call(this,n)}var o=i(5),r=i(42);n.prototype={constructor:n},o.inherits(n,r);var s=n;t.exports=s},function(t,e,i){function n(t){"string"==typeof t?this._fromStr(t):t&&(t.property&&(this.property=t.property),null!=t.duration&&(this.duration=t.duration),t.easing&&(this.easing=t.easing),t.delay&&(this.delay=t.delay)),"*"!==this.property?this.property=this.property.split(","):this.property=o}var d=i(5),a=i(9),h=i(15).copy,o=["position","rotation","scale","style","shape"];n.prototype={constructor:n,property:"*",easing:"Linear",duration:500,delay:0,_fromStr:function(t){var e=t.split(/\s+/g);this.property=e[0],this.duration=+e[1],this.delay=+e[2],this.easing=e[3]}};function r(t){t=t||{},this._states={},this._el=t.el,this._subStates=[],this._transitionAnimators=[],t.initialState&&(this._initialState=t.initialState);var e=t.states;if(e)for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];this._addState(i,n)}this.setState(this._initialState)}r.prototype={constructor:r,_initialState:"normal",_currentState:"",el:function(){return this._el},_addState:function(t,e){if((this._states[t]=e).transition&&(e.transition=new n(e.transition)),t!==this._initialState)this._extendFromInitial(e);else{var i=this._el;for(var t in d.merge(e.style,i.style,!1,!1),e.shape?d.merge(e.shape,i.shape,!1,!0):e.shape=d.clone(i.shape,!0),this._states)this._states.hasOwnProperty(t)&&this._extendFromInitial(this._states[t])}},_extendFromInitial:function(t){var e=this._states[this._initialState];e&&t!==e&&d.merge(t,e,!1,!0)},setState:function(t,e){if(t!==this._currentState||this.transiting()){var i=this._states[t];if(i){if(this._stopTransition(),!e){var n=this._states[this._currentState];n&&n.onleave&&n.onleave.call(this),i.onenter&&i.onenter.call(this)}if(this._currentState=t,this._el){var o=this._el;if(null!=i.zlevel&&(o.zlevel=i.zlevel),null!=i.z&&(o.z=i.z),i.position&&h(o.position,i.position),i.scale&&h(o.scale,i.scale),null!=i.rotation&&(o.rotation=i.rotation),i.style){var r=this._states[this._initialState];o.style=new a,r&&o.style.extendFrom(r.style,!1),t!=this._initialState&&r.style!==i.style&&o.style.extendFrom(i.style,!0)}i.shape&&(o.shape=d.clone(i.shape,!0)),o.dirty()}}for(var s=0;s<this._subStates.length;s++)this._subStates.setState(t)}},getState:function(){return this._currentState},transitionState:function(t,e){if(t!==this._currentState||this.transiting()){var i=this._states[t],n=/$[style|shape]\./,o=this,r={};if(i){o._stopTransition();var s=o._el;if(i.transition&&s&&s.__zr){function a(){0===--c&&(o.setState(t),e&&e())}for(var h=i.transition,l=h.property,c=0,u=0;u<l.length;u++){var d=l[u];if("style"===d||"shape"===d){if(i[d])for(var p in i[d])if(i[d].hasOwnProperty(p)){var f=d+"."+p;r[f]||(r[f]=1,c+=o._animProp(i,d,p,h,a))}}else{if(r[d])continue;if(r[d]=1,d.match(n)){var g=d.slice(0,5);d=d.slice(6),c+=o._animProp(i,g,d,h,a)}else c+=o._animProp(i,"",d,h,a)}}0===c&&(o.setState(t),e&&e())}else o.setState(t),e&&e()}var y=o._subStates;for(u=0;u<y.length;u++)y.transitionState(t)}},_animProp:function(t,e,i,n,o){var r=this._el,s=e?t[e]:t,a=e?r[e]:r,h=s&&i in s&&a&&i in a,l=this._transitionAnimators;if(h){var c={};if(s[i]===a[i])return 0;c[i]=s[i];var u=r.animate(e).when(n.duration,c).delay(n.dealy).done(function(){var t=d.indexOf(l,1);0<t&&l.splice(t,1),o()}).start(n.easing);return l.push(u),1}return 0},_stopTransition:function(){for(var t=this._transitionAnimators,e=0;e<t.length;e++)t[e].stop();t.length=0},transiting:function(){return 0<this._transitionAnimators.length},addSubStates:function(t){this._subStates.push(t)},removeSubStates:function(t){0<=d.indexOf(this._subStates,t)&&this._subStates.splice(t,1)}};var s=r;t.exports=s},function(t,e,i){var s=i(5);i(27);function n(t,e,i,n,o,r){this.bigCanvas=t,this.eagleEyeNode=n,this.distance=o,this.imgSrc=r,this.ratio,this.groupRatio,this.group=i,this.img=document.createElement("img"),this.selection=document.createElement("div"),this.groupPosition=s.clone(e),this.selectPosition=[0,0],this.render()}n.prototype.render=function(){var t=this;t.ratio=.12;var e=t.group.width*t.ratio,i=t.group.height*t.ratio;t.eagleEyeNode.style.width=e+"px",t.eagleEyeNode.style.height=i+"px",t.eagleEyeNode.style.marginTop=-i+"px",t.eagleEyeNode.style.marginLeft=t.bigCanvas.getWidth()-e+"px",t.eagleEyeNode.style.position="relative",t.eagleEyeNode.style.background="url("+t.imgSrc+") no-repeat",t.eagleEyeNode.style.backgroundSize=e/(t.group.width*t.distance[2]/t.bigCanvas.getWidth())+"px",t.backgroundSize=s.clone(t.eagleEyeNode.style.backgroundSize),t.eagleEyeNode.innerHTML="",t.selection.style.border="1px solid #ff0000",t.selection.style.cursor="pointer",t.selection.style.width=t.bigCanvas.getWidth()/t.group.width*e+"px",t.selection.style.height=t.bigCanvas.getHeight()/t.group.height*i+"px",t.selectWidth=t.selection.style.width,t.selectHeight=t.selection.style.height,t.selection.style.position="absolute",t.selection.style.top="0px",t.selection.style.left="0px",t.eagleEyeNode.appendChild(this.selection)},n.prototype.updataSelection=function(t,e,i,n){this.zoomScale=i,this.selection.style.width=this.selection.style.width.replace("px","")/i+"px",this.selection.style.height=this.selection.style.height.replace("px","")/i+"px",this.selectPosition[0]=s.clone(t)*this.ratio/n,this.selectPosition[1]=s.clone(e)*this.ratio/n,this.selection.style.left=-this.selectPosition[0]+"px",this.selection.style.top=-this.selectPosition[1]+"px"},n.prototype.updataMap=function(t,e){this.eagleEyeNode.style.backgroundImage="url("+t+")";var i=e.width*this.ratio,n=e.height*this.ratio;this.eagleEyeNode.style.width=i+"px",this.eagleEyeNode.style.height=n+"px",this.eagleEyeNode.style.marginTop=-n+"px",this.eagleEyeNode.style.marginLeft=this.bigCanvas.getWidth()-i+"px"},n.prototype.updataSelectionPosition=function(t,e){this.selectPosition[0]=s.clone(t[0])*this.ratio/e,this.selectPosition[1]=s.clone(t[1])*this.ratio/e,this.selection.style.left=-this.selectPosition[0]+"px",this.selection.style.top=-this.selectPosition[1]+"px"},n.prototype.updataGroupPosition=function(t,e){var i=-Number(this.selection.style.left.substring(0,this.selection.style.left.length-2))/this.ratio*e,n=-Number(this.selection.style.top.substring(0,this.selection.style.top.length-2))/this.ratio*e;t.attr("position",[i,n])},t.exports=n},function(t,e,i){var d=i(66),l=i(67),c=i(27),p=i(5);function o(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function u(t,e){if(t.startPoint.x==t.endPoint.x&&e.startPoint.x==e.endPoint.x)return t.startPoint.x==e.startPoint.x&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y));if(t.startPoint.x==t.endPoint.x||e.startPoint.x==e.endPoint.x){if(t.startPoint.x==t.endPoint.x){var i=t;t=e,e=i}var n=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),o=t.startPoint.y-n*t.startPoint.x,r=e.startPoint.x,s=n*r+o;return t.contains(r,s)&&e.contains(r,s)}var a=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),h=t.startPoint.y-a*t.startPoint.x,l=(e.endPoint.y-e.startPoint.y)/(e.endPoint.x-e.startPoint.x),c=e.startPoint.y-l*e.startPoint.x;return a==l?h==c&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y)):(s=a*(r=(c-h)/(a-l))+h,t.contains(r,s)&&e.contains(r,s))}function n(t){return 0<t?1:t<0?-1:0}function r(t,e){return[[1,0,t],[0,1,e],[0,0,1]]}function s(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function f(t,e,i){return e=e||"type",i=i||"GroupNode",t.parent&&t.parent[e]===i?t.position[0]+f(t.parent):t.position[0]}function g(t,e,i){return e=e||"type",i=i||"GroupNode",t.parent&&t.parent[e]===i?t.position[1]+g(t.parent):t.position[1]}function a(t,e){var i=t.clipPath,n=t.getBoundingRect();i&&(n=i.getBoundingRect());var o=[];o[0]=[-n.width/2,-n.height/2],o[1]=[n.width/2,-n.height/2],o[2]=[n.width/2,n.height/2],o[3]=[-n.width/2,n.height/2],o[4]=[-n.width/2,-n.height/2];var r=t.position[0],s=t.position[1];t.parent&&e&&("GroupNode"!==t.parent.type&&"SubProcess"!==t.parent.nodeType||(r+=f(t.parent),s+=g(t.parent)));var a=new c(Number(r+n.x),Number(s+n.y),Number(n.width),Number(n.height)),h=Number(r)+Number(n.width)/2+Number(n.x),l=Number(s)+Number(n.height)/2+Number(n.y);return{x:Number(h),y:Number(l),width:Number(n.width),height:Number(n.height),points:o,boundingRect:a}}var h={createNew:function(){var o=[];return{add:function(t,e){this.get(t).push(e)},getsimilar:function(t){var i=[],n=t.split(",");return o.forEach(function(t){var e=t.key.split(",");-1<e[0].indexOf(n[0])&&-1<e[1].indexOf(n[1])&&(i=i.concat(t.value))}),i.length<=0&&o.push({key:t,value:i}),i},get:function(t){for(var e=0;e<o.length;e++)if(t==o[e].key)return o[e].value;var i=[];return o.push({key:t,value:i}),i},keys:function(){for(var t=[],e=0;e<o.length;e++)t.push(o[e].key);return t},top:function(){return o[o.length-1]},remove:function(t){for(var e=-1,i=0;i<o.length;i++)if(t==o[i].key){e=i;break}return o.splice(e,1)[0]},removeItem:function(t,e){var i=this.get(t),n=p.indexOf(i,e);i.splice(n,1)},removeTop:function(){return o.splice(o.length-1,1)[0]},length:function(){return o.length},clear:function(){o.splice(0,o.length)}}}};function y(t){return"\\"+x[t]}var v={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},m=/(.)^/,x={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},_=/\\|'|\r|\n|\u2028|\u2029/g;function b(){}b.extend=function(t){function e(){}var i,n,o=this,r=t&&t.init?t.init:function(){o.apply(this,arguments)};for(i in e.prototype=o.prototype,n=r.fn=r.prototype=new e,t)null!=t[i]&&t[i].constructor===Object?n[i]=p.mergeAll([{},e.prototype[i],t[i]],!0):n[i]=t[i];return(n.constructor=r).extend=o.extend,r},t.exports={inherits:function(t,e){var i=t.prototype;function n(){}for(var o in n.prototype=e.prototype,t.prototype=new n,i)t.prototype[o]=i[o];(t.prototype.constructor=t).superClass=e},getUUID:function(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?i[o]="-":14==o?i[o]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[o]=e[19==o?3&t|8:t]);return"sid-"+i.join("")},distance:o,getPolylineLength:function(t){for(var e=0,i=0;i<t.length-1;i++)e+=o(t[i],t[i+1]);return e},max:function(t){if(0==t.lenght)return NaN;for(var e=t[0],i=0;i<t.length;i++)e<t[i]&&(e=t[i]);return e},min:function(t){if(0==t.lenght)return NaN;for(var e=t[0],i=0;i<t.length;i++)e>t[i]&&(e=t[i]);return e},isEmpty:function(t){return null==t||(p.isArrayLike(t)&&(p.isArray(t)||p.isString(t))?0===t.length:void 0)},mergeOpt:function t(e,i,n,o){if(!p.isObject(i)||!p.isObject(e))return n?p.clone(i):e;for(var r in i)if(i.hasOwnProperty(r)){var s=e[r],a=i[r];!p.isObject(a)||!p.isObject(s)||p.isArray(a)||p.isArray(s)||p.isDom(a)||p.isDom(s)||p.isBuiltInObject(a)||p.isBuiltInObject(s)||p.isPrimitive(a)||p.isPrimitive(s)?!n&&r in e||r!==o&&(e[r]=p.clone(i[r],!0)):t(s,a,n,o)}return e},orthogonalPath:function(t){if(t.length<=1)return!0;for(var e=0;e<t.length-1;e++)if(t[e].x!=t[e+1].x&&t[e].y!=t[e+1].y)return!1;return!0},polylineIntersectsRectangle:function(t,e,i){var n=[];n.push(new l(new d(e[0],e[1]),new d(e[2],e[1]))),n.push(new l(new d(e[2],e[1]),new d(e[2],e[3]))),n.push(new l(new d(e[2],e[3]),new d(e[0],e[3]))),n.push(new l(new d(e[0],e[3]),new d(e[0],e[1])));for(var o=0;o<t.length-1;o++)for(var r=new l(t[o],t[o+1]),s=0;s<n.length;s++)if(u(r,n[s]))return!0;if(i)for(var a=new l(t[t.length-1],t[0]),h=0;h<n.length;h++)if(u(a,n[h]))return!0;return!1},scorePath:function(t){if(t.length<=2)return-1;for(var e=0,i=1;i<t.length-1;i++)if(t[i-1].x==t[i].x&&t[i].x==t[i+1].x){if(n(t[i+1].y-t[i].y)!=n(t[i].y-t[i-1].y))return-1;e++}else if(t[i-1].y==t[i].y&&t[i].y==t[i+1].y){if(n(t[i+1].x-t[i].x)!=n(t[i].x-t[i-1].x))return-1;e++}else e--;return e},forwardPath:function(t){if(t.length<=2)return!0;for(var e=0;e<t.length-2;e++)if(t[e].x==t[e+1].x&&t[e+1].x==t[e+2].x){if(0!=n(t[e+1].y-t[e].y)&&n(t[e+1].y-t[e].y)==-1*n(t[e+2].y-t[e+1].y))return!1}else if(t[e].y==t[e+1].y&&t[e+1].y==t[e+2].y&&0!=n(t[e+1].x-t[e].x)&&n(t[e+1].x-t[e].x)==-1*n(t[e+2].x-t[e+1].x))return!1;return!0},traslatePoints:function(t,e){var i=[];if(e){for(var n=0;n<t.length;n++){var o=t[n];i.push(new d(o[0],o[1]))}return i}for(var r=0;r<t.length;r++){var s=t[r];i.push([s.x,s.y])}return i},getEndPoint:function(t,e,i){var n=t.clone();return n.transform(r(-t.x,-t.y)),n.y-=e,n.transform(function(t){return[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]}(i)),n.transform(r(t.x,t.y)),n},getConnectorPoints:function(t,e){e=e||{};var i=p.clone(t.boundingRect||t),h=e.rotation,l={left:new d(i.x,i.y+i.height/2),top:new d(i.x+i.width/2,i.y),right:new d(i.x+i.width,i.y+i.height/2),bottom:new d(i.x+i.width/2,i.y+i.height),center:new d(i.x+i.width/2,i.y+i.height/2)};if(0<Object.keys(e).length&&0<Math.abs(h)){var n=t.boundingRect?t:a(e),c=n.x,u=n.y;Object.keys(l).forEach(function(t){var e=l[t],i=c-e.x,n=u-e.y,o=Math.sin(-h),r=Math.cos(-h),s=c-(i*r-n*o),a=u-(i*o+n*r);l[t].x=s,l[t].y=a})}return l},getConnectorControls:function(t,e){e=e||{};var i=p.clone(t.boundingRect),h=e.rotation,l={tl:new d(i.x,i.y),tc:new d(i.x+i.width/2,i.y-4),tr:new d(i.x+i.width,i.y),bl:new d(i.x,i.y+i.height),br:new d(i.x+i.width,i.y+i.height),mtr:new d(i.x+i.width/2,i.y-20)};if(0<Object.keys(e).length&&0<Math.abs(h)){var n=t,c=n.x,u=n.y;Object.keys(l).forEach(function(t){var e=l[t],i=c-e.x,n=u-e.y,o=Math.sin(-h),r=Math.cos(-h),s=c-(i*r-n*o),a=u-(i*o+n*r);l[t].x=s,l[t].y=a})}return l},calculatePoints:function(t,e,i){var n=Array.isArray(t)?t[0]:t.x,o=Array.isArray(t)?t[1]:t.y,r=e.x-n,s=e.y-o,a=Math.sin(-i),h=Math.cos(-i),l=e.x-(r*h-s*a),c=e.y-(r*a+s*h);return Array.isArray(t)?[l,c]:{x:l,y:c}},tangentRotation:function(t,e){return-Math.PI/2-Math.atan2(e.y-t.y,e.x-t.x)},collinearity:function(t,e,i,n){var o=t.x*e.y+t.y*i.x+e.x*i.y-(e.y*i.x+t.y*e.x+t.x*i.y);return n?Math.abs(o)<=n:0==o},translationMatrix:r,scaleMatrix:function(t,e){return null==e&&(e=t),[[t,0,0],[0,e,0],[0,0,1]]},round:s,getLength:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},getAngle:function(t,e,i){t.x=s(t.x,5),t.y=s(t.y,5),e.x=s(e.x,5),e.y=s(e.y,5);var n=Math.atan((e.x-t.x)/(e.y-t.y));for(n=-n,e.x>=t.x&&e.y>=t.y?n+=Math.PI:e.x<=t.x&&e.y>=t.y?n+=Math.PI:e.x<=t.x&&e.y<=t.y&&(n+=2*Math.PI);n>=2*Math.PI;)n-=2*Math.PI;return isNaN(n)&&(n=0),i&&(n=Math.round(n/i)*i),n},getParentX:f,getParentY:g,getRect:a,StackedMap:h,getMaxLineLength:function(t){for(var e=o(t[0],t[1]),i=[t[0],t[1]],n=1;n<t.length-1;n++)e<o(t[n],t[n+1])&&(e=o(t[n],t[n+1]),i=[t[n],t[n+1]]);return i},randomColor:function(){for(var t=["0","2","3","4","5","6","7","8","9","a","b","c","d"],e="#",i=0;i<6;i++)e+=t[Math.round(15*Math.random())];return e},template:function(r,t,e){!t&&e&&(t=e),t=t||{},t=p.defaults(t,v,!0);var i=RegExp([(t.escape||m).source,(t.interpolate||m).source,(t.evaluate||m).source].join("|")+"|$","g"),s=0,a="__p+='";r.replace(i,function(t,e,i,n,o){return a+=r.slice(s,o).replace(_,y),s=o+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":i?a+="'+\n((__t=("+i+"))==null?'':__t)+\n'":n&&(a+="';\n"+n+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var n=new Function(t.variable||"obj",a)}catch(t){throw t.source=a,t}function o(t){return n.call(this,t)}var h=t.variable||"obj";return o.source="function("+h+"){\n"+a+"}",o},isUndefined:function(t){return void 0===t},getSoltPoints:function(t){return[[10*Math.round(t.getRect().width/3/10),0],[10*Math.round(2*t.getRect().width/3/10),0],[t.getRect().width,10*Math.round(t.getRect().height/3/10)],[t.getRect().width,10*Math.round(2*t.getRect().height/3/10)],[10*Math.round(t.getRect().width/3/10),t.getRect().height],[10*Math.round(2*t.getRect().width/3/10),t.getRect().height],[0,10*Math.round(t.getRect().height/3/10)],[0,10*Math.round(2*t.getRect().height/3/10)]]},collinearReduction:function(t){var e=[];if(t.length<3)return d.cloneArray(t);e.push(t[0].clone());for(var i=1;i<t.length-1;i++)t[i-1].x==t[i].x&&t[i].x==t[i+1].x||t[i-1].y==t[i].y&&t[i].y==t[i+1].y||e.push(t[i].clone());return e.push(t[t.length-1].clone()),e},Class:b}},function(t,e){function n(t,e){this.x=t,this.y=e}n.load=function(t){return new n(Number(t.x),Number(t.y))},n.loadArray=function(t){for(var e=[],i=0;i<t.length;i++)e.push(n.load(t[i]));return e},n.cloneArray=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].clone());return e},n.prototype={constructor:n,transform:function(t){var e=this.x,i=this.y;this.x=t[0][0]*e+t[0][1]*i+t[0][2],this.y=t[1][0]*e+t[1][1]*i+t[1][2]},equals:function(t){return t instanceof n&&(this.x==t.x&&this.y==t.y)},clone:function(){return new n(this.x,this.y)},add:function(t){return this.x=this.x+t.x,this.y=this.y+t.y,this},near:function(t,e,i){return Math.sqrt(Math.pow(this.x-t,2)+Math.pow(this.y-e,2))<=i},contains:function(t,e){return this.x==t&&this.y==e},toString:function(){return"["+this.x+","+this.y+"]"},getPoints:function(){return[this]}},t.exports=n},function(t,e){function i(t,e){this.startPoint=t,this.endPoint=e,this.oType="Line"}i.load=function(t){return new i(Point.load(t.startPoint),Point.load(t.endPoint))},i.prototype={contructor:i,clone:function(){return new i(this.startPoint.clone(),this.endPoint.clone())},equals:function(t){return!(!t instanceof i)&&(this.startPoint.equals(t.startPoint)&&this.endPoint.equals(t.endPoint))},contains:function(t,e){if(Math.min(this.startPoint.x,this.endPoint.x)<=t&&t<=Math.max(this.startPoint.x,this.endPoint.x)&&Math.min(this.startPoint.y,this.endPoint.y)<=e&&e<=Math.max(this.startPoint.y,this.endPoint.y)){if(this.startPoint.x==this.endPoint.x)return t==this.startPoint.x;var i=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x);return e==i*t+(this.startPoint.y-i*this.startPoint.x)}return!1},near:function(t,e,i){if(this.endPoint.x===this.startPoint.x)return(this.startPoint.y-i<=e&&this.endPoint.y+i>=e||this.endPoint.y-i<=e&&this.startPoint.y+i>=e)&&t>this.startPoint.x-i&&t<this.startPoint.x+i;if(this.startPoint.y===this.endPoint.y)return(this.startPoint.x-i<=t&&this.endPoint.x+i>=t||this.endPoint.x-i<=t&&this.startPoint.x+i>=t)&&e>this.startPoint.y-i&&e<this.startPoint.y+i;var n=Math.min(this.endPoint.x,this.startPoint.x),o=Math.min(this.endPoint.y,this.startPoint.y),r=Math.max(this.endPoint.x,this.startPoint.x),s=Math.max(this.endPoint.y,this.startPoint.y),a=this.endPoint.y-this.startPoint.y,h=this.startPoint.x-this.endPoint.x,l=-(this.startPoint.x*this.endPoint.y-this.endPoint.x*this.startPoint.y),c=Math.abs((a*t+h*e+l)/Math.sqrt(Math.pow(a,2)+Math.pow(h,2))),u=(h*(h*t-a*e)-a*l)/(Math.pow(a,2)+Math.pow(h,2)),d=(a*(-h*t+a*e)-h*l)/(Math.pow(a,2)+Math.pow(h,2));return c<=i&&u<=r&&n<=u&&d<=s&&o<=d||this.startPoint.near(t,e,i)||this.endPoint.near(t,e,i)},getPoints:function(){var t=[];return t.push(this.startPoint),t.push(this.endPoint),t},getPoint:function(t){var e=t*(this.endPoint.x-this.startPoint.x)+this.startPoint.x,i=t*(this.endPoint.y-this.startPoint.y)+this.startPoint.y;return new Point(e,i)},toString:function(){return"line("+this.startPoint+","+this.endPoint+")"}},t.exports=i},function(t,e,i){"use strict";var n=i(5),o=["getDom","getZr","getWidth","getHeight","dispatchAction","on","off","trigger","getDataURL","getConnectedDataURL","getModel","getOption","remove","_getParentZr","changeSelectConnectorType","_addGroupNode"];t.exports=function(e){n.each(o,function(t){this[t]=n.bind(e[t],e)},this)}},function(t,e,i){var n=i(11),c=i(50),u=i(5),d=i(70),p=i(71),o=i(73),f=i(76),g=i(78),y=!c.canvasSupported,v={canvas:o},r={};function s(t,e,i){i=i||{},this.dom=e,this.id=t;var n=this,o=new p,r=i.renderer;if(y){if(!v.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");r="vml"}else r&&v[r]||(r="canvas");var s=new v[r](e,o,i);this.storage=o,this.painter=s;var a=c.node?null:new g(s.getViewportRoot());this.handler=new d(o,s,a,s.root),this.animation=new f({stage:{update:u.bind(this.flush,this)}}),this.animation.start(),this._needsRefresh;var h=o.delFromStorage,l=o.addToStorage;o.delFromStorage=function(t){h.call(o,t),t&&t.removeSelfFromZr(n)},o.addToStorage=function(t){l.call(o,t),t.addSelfToZr(n)}}s.prototype={constructor:s,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0},configLayer:function(t,e){this.painter.configLayer(t,e),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},flush:function(){this._needsRefresh&&this.refreshImmediately(),this._needsRefreshHover&&this.refreshHoverImmediately()},addHover:function(t,e){this.painter.addHover&&(this.painter.addHover(t,e),this.refreshHover())},removeHover:function(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(t,e){return this.painter.pathToImage(t,e)},setCursorStyle:function(t){this.handler.setCursorStyle(t)},findHover:function(t,e){return this.handler.findHover(t,e)},on:function(t,e,i){this.handler.on(t,e,i)},off:function(t,e){this.handler.off(t,e)},trigger:function(t,e){this.handler.trigger(t,e)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,function(t){delete r[t]}(this.id)}},e.version="3.7.4",e.init=function(t,e){var i=new s(n(),t,e);return r[i.id]=i},e.dispose=function(t){if(t)t.dispose();else{for(var e in r)r.hasOwnProperty(e)&&r[e].dispose();r={}}return this},e.getInstance=function(t){return r[t]},e.registerPainter=function(t,e){v[t]=e}},function(t,e,i){var o=i(5),r=i(15),s=i(43),a=i(12),h="silent";function l(){}l.prototype.dispose=function(){};function c(t,e,i,n){a.call(this),this.storage=t,this.painter=e,this.painterRoot=n,i=i||new l,((this.proxy=i).handler=this)._hovered={},this._lastTouchMoment,this._lastX,this._lastY,s.call(this),o.each(u,function(t){i.on&&i.on(t,this[t],this)},this)}var u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"];function d(t,e,i){if(t[t.rectHover?"rectContain":"contain"](e,i)){for(var n,o=t;o;){if(o.clipPath&&!o.clipPath.contain(e,i))return!1;o.silent&&(n=!0),o=o.parent}return!n||h}return!1}c.prototype={constructor:c,mousemove:function(t){var e=t.zrX,i=t.zrY,n=this._hovered,o=n.target;o&&!o.__zr&&(o=(n=this.findHover(n.x,n.y)).target);var r=this._hovered=this.findHover(e,i),s=r.target,a=this.proxy;a.setCursor&&a.setCursor(s?s.cursor:"default"),o&&s!==o&&this.dispatchToElement(n,"mouseout",t),this.dispatchToElement(r,"mousemove",t),s&&s!==o&&this.dispatchToElement(r,"mouseover",t)},mouseout:function(t){this.dispatchToElement(this._hovered,"mouseout",t);for(var e,i=t.toElement||t.relatedTarget;(i=i&&i.parentNode)&&9!=i.nodeType&&!(e=i===this.painterRoot););e||this.trigger("globalout",{event:t})},resize:function(t){this._hovered={}},dispatch:function(t,e){var i=this[t];i&&i.call(this,e)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},dispatchToElement:function(t,e,i){var n=(t=t||{}).target;if(!n||!n.silent){for(var o="on"+e,r=function(t,e,i){return{type:t,event:i,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:i.zrX,offsetY:i.zrY,gestureEvent:i.gestureEvent,pinchX:i.pinchX,pinchY:i.pinchY,pinchScale:i.pinchScale,wheelDelta:i.zrDelta,zrByTouch:i.zrByTouch,which:i.which}}(e,t,i);n&&(n[o]&&(r.cancelBubble=n[o].call(n,r)),n.trigger(e,r),n=n.parent,!r.cancelBubble););r.cancelBubble||(this.trigger(e,r),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[o]&&t[o].call(t,r),t.trigger&&t.trigger(e,r)}))}},findHover:function(t,e,i){for(var n=this.storage.getDisplayList(),o={x:t,y:e},r=n.length-1;0<=r;r--){var s;if(n[r]!==i&&!n[r].ignore&&(s=d(n[r],t,e))&&(o.topTarget||(o.topTarget=n[r]),s!==h)){o.target=n[r];break}}return o}},o.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){c.prototype[n]=function(t){var e=this.findHover(t.zrX,t.zrY),i=e.target;if("mousedown"===n)this._downEl=i,this._downPoint=[t.zrX,t.zrY],this._upEl=i;else if("mosueup"===n)this._upEl=i;else if("click"===n){if(this._downEl!==this._upEl||!this._downPoint||4<r.dist(this._downPoint,[t.zrX,t.zrY]))return;this._downPoint=null}this.dispatchToElement(e,n,t)}}),o.mixin(c,a),o.mixin(c,s);var n=c;t.exports=n},function(t,e,i){var r=i(5),s=i(50),a=i(44),h=i(72);function l(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}function n(){this._roots=[],this._displayList=[],this._displayListLen=0}n.prototype={constructor:n,traverse:function(t,e){for(var i=0;i<this._roots.length;i++)this._roots[i].traverse(t,e)},getDisplayList:function(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList},updateDisplayList:function(t){this._displayListLen=0;for(var e=this._roots,i=this._displayList,n=0,o=e.length;n<o;n++)this._updateAndAddDisplayable(e[n],null,t);i.length=this._displayListLen,s.canvasSupported&&h(i,l)},_updateAndAddDisplayable:function(t,e,i){if(!t.ignore||i){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var n=t.clipPath;if(n){e=e?e.slice():[];for(var o=n,r=t;o;)o.parent=r,o.updateTransform(),e.push(o),o=(r=o).clipPath}if(t.isGroup){for(var s=t._children,a=0;a<s.length;a++){var h=s[a];t.__dirty&&(h.__dirty=!0),this._updateAndAddDisplayable(h,e,i)}t.__dirty=!1}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t}},addRoot:function(t){t.__storage!==this&&(t instanceof a&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t){for(var e=0;e<this._roots.length;e++){var i=this._roots[e];i instanceof a&&i.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(t instanceof Array){e=0;for(var n=t.length;e<n;e++)this.delRoot(t[e])}else{var o=r.indexOf(this._roots,t);0<=o&&(this.delFromStorage(t),this._roots.splice(o,1),t instanceof a&&t.delChildrenFromStorage(this))}},addToStorage:function(t){return t.__storage=this,t.dirty(!1),this},delFromStorage:function(t){return t&&(t.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:l};var o=n;t.exports=o},function(t,e){var l=32,m=7;function c(t,e,i,n){var o=e+1;if(o===i)return 1;if(n(t[o++],t[e])<0){for(;o<i&&n(t[o],t[o-1])<0;)o++;!function(t,e,i){i--;for(;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n}}(t,e,o)}else for(;o<i&&0<=n(t[o],t[o-1]);)o++;return o-e}function u(t,e,i,n,o){for(n===e&&n++;n<i;n++){for(var r,s=t[n],a=e,h=n;a<h;)o(s,t[r=a+h>>>1])<0?h=r:a=1+r;var l=n-a;switch(l){case 3:t[a+3]=t[a+2];case 2:t[a+2]=t[a+1];case 1:t[a+1]=t[a];break;default:for(;0<l;)t[a+l]=t[a+l-1],l--}t[a]=s}}function x(t,e,i,n,o,r){var s=0,a=0,h=1;if(0<r(t,e[i+o])){for(a=n-o;h<a&&0<r(t,e[i+o+h]);)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a),s+=o,h+=o}else{for(a=o+1;h<a&&r(t,e[i+o-h])<=0;)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a);var l=s;s=o-h,h=o-l}for(s++;s<h;){var c=s+(h-s>>>1);0<r(t,e[i+c])?s=c+1:h=c}return h}function _(t,e,i,n,o,r){var s=0,a=0,h=1;if(r(t,e[i+o])<0){for(a=o+1;h<a&&r(t,e[i+o-h])<0;)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a);var l=s;s=o-h,h=o-l}else{for(a=n-o;h<a&&0<=r(t,e[i+o+h]);)(h=1+((s=h)<<1))<=0&&(h=a);a<h&&(h=a),s+=o,h+=o}for(s++;s<h;){var c=s+(h-s>>>1);r(t,e[i+c])<0?h=c:s=c+1}return h}function d(f,g){var t,s,a,y=m,h=0;t=f.length;var v=[];function e(t){var e=s[t],i=a[t],n=s[t+1],o=a[t+1];a[t]=i+o,t===h-3&&(s[t+1]=s[t+2],a[t+1]=a[t+2]),h--;var r=_(f[n],f,e,i,0,g);e+=r,0!==(i-=r)&&0!==(o=x(f[e+i-1],f,n,o,o-1,g))&&(i<=o?function(t,e,i,n){var o=0;for(o=0;o<e;o++)v[o]=f[t+o];var r=0,s=i,a=t;if(f[a++]=f[s++],0==--n){for(o=0;o<e;o++)f[a+o]=v[r+o];return}if(1===e){for(o=0;o<n;o++)f[a+o]=f[s+o];return f[a+n]=v[r]}var h,l,c,u=y;for(;;){l=h=0,c=!1;do{if(g(f[s],v[r])<0){if(f[a++]=f[s++],l++,(h=0)==--n){c=!0;break}}else if(f[a++]=v[r++],h++,l=0,1==--e){c=!0;break}}while((h|l)<u);if(c)break;do{if(0!==(h=_(f[s],v,r,e,0,g))){for(o=0;o<h;o++)f[a+o]=v[r+o];if(a+=h,r+=h,(e-=h)<=1){c=!0;break}}if(f[a++]=f[s++],0==--n){c=!0;break}if(0!==(l=x(v[r],f,s,n,0,g))){for(o=0;o<l;o++)f[a+o]=f[s+o];if(a+=l,s+=l,0===(n-=l)){c=!0;break}}if(f[a++]=v[r++],1==--e){c=!0;break}u--}while(m<=h||m<=l);if(c)break;u<0&&(u=0),u+=2}if((y=u)<1&&(y=1),1===e){for(o=0;o<n;o++)f[a+o]=f[s+o];f[a+n]=v[r]}else{if(0===e)throw new Error;for(o=0;o<e;o++)f[a+o]=v[r+o]}}(e,i,n,o):function(t,e,i,n){var o=0;for(o=0;o<n;o++)v[o]=f[i+o];var r=t+e-1,s=n-1,a=i+n-1,h=0,l=0;if(f[a--]=f[r--],0==--e){for(h=a-(n-1),o=0;o<n;o++)f[h+o]=v[o];return}if(1===n){for(l=(a-=e)+1,h=(r-=e)+1,o=e-1;0<=o;o--)f[l+o]=f[h+o];return f[a]=v[s]}var c=y;for(;;){var u=0,d=0,p=!1;do{if(g(v[s],f[r])<0){if(f[a--]=f[r--],u++,(d=0)==--e){p=!0;break}}else if(f[a--]=v[s--],d++,u=0,1==--n){p=!0;break}}while((u|d)<c);if(p)break;do{if(0!==(u=e-_(v[s],f,t,e,e-1,g))){for(e-=u,l=(a-=u)+1,h=(r-=u)+1,o=u-1;0<=o;o--)f[l+o]=f[h+o];if(0===e){p=!0;break}}if(f[a--]=v[s--],1==--n){p=!0;break}if(0!==(d=n-x(f[r],v,0,n,n-1,g))){for(n-=d,l=(a-=d)+1,h=(s-=d)+1,o=0;o<d;o++)f[l+o]=v[h+o];if(n<=1){p=!0;break}}if(f[a--]=f[r--],0==--e){p=!0;break}c--}while(m<=u||m<=d);if(p)break;c<0&&(c=0),c+=2}(y=c)<1&&(y=1);if(1===n){for(l=(a-=e)+1,h=(r-=e)+1,o=e-1;0<=o;o--)f[l+o]=f[h+o];f[a]=v[s]}else{if(0===n)throw new Error;for(h=a-(n-1),o=0;o<n;o++)f[h+o]=v[o]}}(e,i,n,o))}s=[],a=[],this.mergeRuns=function(){for(;1<h;){var t=h-2;if(1<=t&&a[t-1]<=a[t]+a[t+1]||2<=t&&a[t-2]<=a[t]+a[t-1])a[t-1]<a[t+1]&&t--;else if(a[t]>a[t+1])break;e(t)}},this.forceMergeRuns=function(){for(;1<h;){var t=h-2;0<t&&a[t-1]<a[t+1]&&t--,e(t)}},this.pushRun=function(t,e){s[h]=t,a[h]=e,h+=1}}t.exports=function(t,e,i,n){i=i||0;var o=(n=n||t.length)-i;if(!(o<2)){var r=0;if(o<l)u(t,i,n,i+(r=c(t,i,n,e)),e);else{var s=new d(t,e),a=function(t){for(var e=0;l<=t;)e|=1&t,t>>=1;return t+e}(o);do{if((r=c(t,i,n,e))<a){var h=o;a<h&&(h=a),u(t,i,i+h,i+r,e),r=h}s.pushRun(i,r),s.mergeRuns(),o-=r,i+=r}while(0!==o);s.forceMergeRuns()}}}},function(t,e,i){var u=i(23).devicePixelRatio,m=i(5),x=i(22),n=i(27),a=i(72),y=i(74),o=i(75),_=i(45);function h(t){return parseInt(t,10)}function r(t){t.__unusedCount++}function s(t){1==t.__unusedCount&&t.clear()}var l=new n(0,0,0,0),c=new n(0,0,0,0);function d(t,e,i){this.type="canvas";var n=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=i=m.extend({},i||{}),this.dpr=i.devicePixelRatio||u,this._singleCanvas=n;var o=(this.root=t).style;o&&(o["-webkit-tap-highlight-color"]="transparent",o["-webkit-user-select"]=o["user-select"]=o["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var r=this._zlevelList=[],s=this._layers={};if(this._layerConfig={},n){null!=i.width&&(t.width=i.width),null!=i.height&&(t.height=i.height);var a=t.width,h=t.height;this._width=a,this._height=h;var l=new y(t,this,1);l.initContext(),s[0]=l,r.push(0),this._domRoot=t}else{this._width=this._getSize(0),this._height=this._getSize(1);var c=this._domRoot=function(t,e){var i=document.createElement("div");return i.style.cssText=["position:relative","overflow:hidden","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",i}(this._width,this._height);t.appendChild(c)}this._progressiveLayers=[],this._hoverlayer,this._hoverElements=[]}d.prototype={constructor:d,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(t){var e=this.storage.getDisplayList(!0),i=this._zlevelList;this._paintList(e,t);for(var n=0;n<i.length;n++){var o=i[n],r=this._layers[o];!r.__builtin__&&r.refresh&&r.refresh()}return this.refreshHover(),this._progressiveLayers.length&&this._startProgessive(),this},addHover:function(t,e){if(!t.__hoverMir){var i=new t.constructor({style:t.style,shape:t.shape});((i.__from=t).__hoverMir=i).setStyle(e),this._hoverElements.push(i)}},removeHover:function(t){var e=t.__hoverMir,i=this._hoverElements,n=m.indexOf(i,e);0<=n&&i.splice(n,1),t.__hoverMir=null},clearHover:function(t){for(var e=this._hoverElements,i=0;i<e.length;i++){var n=e[i].__from;n&&(n.__hoverMir=null)}e.length=0},refreshHover:function(){var t=this._hoverElements,e=t.length,i=this._hoverlayer;if(i&&i.clear(),e){a(t,this.storage.displayableSortFunc);var n={};(i=i||(this._hoverlayer=this.getLayer(1e5))).ctx.save();for(var o=0;o<e;){var r=t[o],s=r.__from;s&&s.__zr?(o++,s.invisible||(r.transform=s.transform,r.invTransform=s.invTransform,r.__clipPaths=s.__clipPaths,this._doPaintEl(r,i,!0,n))):(t.splice(o,1),s.__hoverMir=null,e--)}i.ctx.restore()}},_startProgessive:function(){var e=this;if(e._furtherProgressive){var i=e._progressiveToken=+new Date;e._progress++,o(function t(){i===e._progressiveToken&&e.storage&&(e._doPaintList(e.storage.getDisplayList()),e._furtherProgressive?(e._progress++,o(t)):e._progressiveToken=-1)})}},_clearProgressive:function(){this._progressiveToken=-1,this._progress=0,m.each(this._progressiveLayers,function(t){t.__dirty&&t.clear()})},_paintList:function(t,e){null==e&&(e=!1),this._updateLayerStatus(t),this._clearProgressive(),this.eachBuiltinLayer(r),this._doPaintList(t,e),this.eachBuiltinLayer(s)},_doPaintList:function(t,e){var i,n,o,r,s,a,h=0,l=this._width,c=this._height,u=this._progress;function d(t){var e=o.dpr||1;o.save(),o.globalAlpha=1,o.shadowBlur=0,i.__dirty=!0,o.setTransform(1,0,0,1,0,0),o.drawImage(t.dom,0,0,l*e,c*e),o.restore()}for(var p=0,f=t.length;p<f;p++){var g=t[p],y=this._singleCanvas?0:g.zlevel,v=g.__frame;if(v<0&&s&&(d(s),s=null),n!==y&&(o&&o.restore(),r={},n=y,(i=this.getLayer(n)).__builtin__||x("ZLevel "+n+" has been used by unkown layer "+i.id),(o=i.ctx).save(),i.__unusedCount=0,(i.__dirty||e)&&i.clear()),i.__dirty||e){if(0<=v){if(!s){if((s=this._progressiveLayers[Math.min(h++,4)]).ctx.save(),s.renderScope={},s&&s.__progress>s.__maxProgress){p=s.__nextIdxNotProg-1;continue}a=s.__progress,s.__dirty||(u=a),s.__progress=u+1}v===u&&this._doPaintEl(g,s,!0,s.renderScope)}else this._doPaintEl(g,i,e,r);g.__dirty=!1}}s&&d(s),o&&o.restore(),this._furtherProgressive=!1,m.each(this._progressiveLayers,function(t){t.__maxProgress>=t.__progress&&(this._furtherProgressive=!0)},this)},_doPaintEl:function(t,e,i,n){var o=e.ctx,r=t.transform;if((e.__dirty||i)&&!t.invisible&&0!==t.style.opacity&&(!r||r[0]||r[3])&&(!t.culling||!function(t,e,i){return l.copy(t.getBoundingRect()),t.transform&&l.applyTransform(t.transform),c.width=e,c.height=i,!l.intersect(c)}(t,this._width,this._height))){var s=t.__clipPaths;n.prevClipLayer===e&&!function(t,e){if(t==e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!0}(s,n.prevElClipPaths)||(n.prevElClipPaths&&(n.prevClipLayer.ctx.restore(),n.prevClipLayer=n.prevElClipPaths=null,n.prevEl=null),s&&(o.save(),function(t,e){for(var i=0;i<t.length;i++){var n=t[i];n.setTransform(e),e.beginPath(),n.buildPath(e,n.shape),e.clip(),n.restoreTransform(e)}}(s,o),n.prevClipLayer=e,n.prevElClipPaths=s)),t.beforeBrush&&t.beforeBrush(o),t.brush(o,n.prevEl||null),(n.prevEl=t).afterBrush&&t.afterBrush(o)}},getLayer:function(t){if(this._singleCanvas)return this._layers[0];var e=this._layers[t];return e||((e=new y("zr_"+t,this,this.dpr)).__builtin__=!0,this._layerConfig[t]&&m.merge(e,this._layerConfig[t],!0),this.insertLayer(t,e),e.initContext()),e},insertLayer:function(t,e){var i=this._layers,n=this._zlevelList,o=n.length,r=null,s=-1,a=this._domRoot;if(i[t])x("ZLevel "+t+" has been used already");else if(function(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh)}(e)){if(0<o&&t>n[0]){for(s=0;s<o-1&&!(n[s]<t&&n[s+1]>t);s++);r=i[n[s]]}if(n.splice(s+1,0,t),!(i[t]=e).virtual)if(r){var h=r.dom;h.nextSibling?a.insertBefore(e.dom,h.nextSibling):a.appendChild(e.dom)}else a.firstChild?a.insertBefore(e.dom,a.firstChild):a.appendChild(e.dom)}else x("Layer of zlevel "+t+" is not valid")},eachLayer:function(t,e){var i,n,o=this._zlevelList;for(n=0;n<o.length;n++)i=o[n],t.call(e,this._layers[i],i)},eachBuiltinLayer:function(t,e){var i,n,o,r=this._zlevelList;for(o=0;o<r.length;o++)n=r[o],(i=this._layers[n]).__builtin__&&t.call(e,i,n)},eachOtherLayer:function(t,e){var i,n,o,r=this._zlevelList;for(o=0;o<r.length;o++)n=r[o],(i=this._layers[n]).__builtin__||t.call(e,i,n)},getLayers:function(){return this._layers},_updateLayerStatus:function(t){var e=this._layers,i=this._progressiveLayers,n={},o={};this.eachBuiltinLayer(function(t,e){n[e]=t.elCount,t.elCount=0,t.__dirty=!1}),m.each(i,function(t,e){o[e]=t.elCount,t.elCount=0,t.__dirty=!1});for(var r,s,a=0,h=0,l=0,c=t.length;l<c;l++){var u=t[l],d=e[this._singleCanvas?0:u.zlevel],p=u.progressive;if(d&&(d.elCount++,d.__dirty=d.__dirty||u.__dirty),0<=p){s!==p&&(s=p,h++);var f=u.__frame=h-1;if(!r){var g=Math.min(a,4);(r=i[g])||(r=i[g]=new y("progressive",this,this.dpr)).initContext(),r.__maxProgress=0}r.__dirty=r.__dirty||u.__dirty,r.elCount++,r.__maxProgress=Math.max(r.__maxProgress,f),r.__maxProgress>=r.__progress&&(d.__dirty=!0)}else u.__frame=-1,r&&(r.__nextIdxNotProg=l,a++,r=null)}r&&(a++,r.__nextIdxNotProg=l),this.eachBuiltinLayer(function(t,e){n[e]!==t.elCount&&(t.__dirty=!0)}),i.length=Math.min(a,5),m.each(i,function(t,e){o[e]!==t.elCount&&(u.__dirty=!0),t.__dirty&&(t.__progress=0)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(t){t.clear()},configLayer:function(t,e){if(e){var i=this._layerConfig;i[t]?m.merge(i[t],e,!0):i[t]=e;var n=this._layers[t];n&&m.merge(n,i[t],!0)}},delLayer:function(t){var e=this._layers,i=this._zlevelList,n=e[t];n&&(n.dom.parentNode.removeChild(n.dom),delete e[t],i.splice(m.indexOf(i,t),1))},resize:function(e,i){var t=this._domRoot;t.style.display="none";var n=this._opts;if(null!=e&&(n.width=e),null!=i&&(n.height=i),e=this._getSize(0),i=this._getSize(1),t.style.display="",this._width!=e||i!=this._height){for(var o in t.style.width=e+"px",t.style.height=i+"px",this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(e,i);m.each(this._progressiveLayers,function(t){t.resize(e,i)}),this.refresh(!0)}return this._width=e,this._height=i,this},clearLayer:function(t){var e=this._layers[t];e&&e.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(t){if(t=t||{},this._singleCanvas)return this._layers[0].dom;var a=new y("image",this,t.pixelRatio||this.dpr);a.initContext(),a.clearColor=t.backgroundColor,a.clear();var e,i=this.storage.getDisplayList(!0),n={},h=this;function o(t,e){var i,n=h._zlevelList;null==t&&(t=-1/0);for(var o=0;o<n.length;o++){var r=n[o],s=h._layers[r];if(!s.__builtin__&&t<r&&r<e){i=s;break}}i&&i.renderToCanvas&&(a.ctx.save(),i.renderToCanvas(a.ctx),a.ctx.restore())}for(var r=0;r<i.length;r++){var s=i[r];s.zlevel!==e&&(o(e,s.zlevel),e=s.zlevel),this._doPaintEl(s,a,!0,n)}return o(e,1/0),a.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,i=["width","height"][t],n=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],r=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var s=this.root,a=document.defaultView.getComputedStyle(s);return(s[n]||h(a[i])||h(s.style[i]))-(h(a[o])||0)-(h(a[r])||0)|0},pathToImage:function(t,e){e=e||this.dpr;var i=document.createElement("canvas"),n=i.getContext("2d"),o=t.getBoundingRect(),r=t.style,s=r.shadowBlur,a=r.shadowOffsetX,h=r.shadowOffsetY,l=r.hasStroke()?r.lineWidth:0,c=Math.max(l/2,-a+s),u=Math.max(l/2,a+s),d=Math.max(l/2,-h+s),p=Math.max(l/2,h+s),f=o.width+c+u,g=o.height+d+p;i.width=f*e,i.height=g*e,n.scale(e,e),n.clearRect(0,0,f,g),n.dpr=e;var y={position:t.position,rotation:t.rotation,scale:t.scale};t.position=[c-o.x,d-o.y],t.rotation=0,t.scale=[1,1],t.updateTransform(),t&&t.brush(n);var v=new _({style:{x:0,y:0,image:i}});return null!=y.position&&(v.position=t.position=y.position),null!=y.rotation&&(v.rotation=t.rotation=y.rotation),null!=y.scale&&(v.scale=t.scale=y.scale),v}};var p=d;t.exports=p},function(t,e,i){var a=i(5),r=i(23).devicePixelRatio,u=i(9),d=i(40);function s(){return!1}function h(t,e,i){var n=a.createCanvas(),o=e.getWidth(),r=e.getHeight(),s=n.style;return s.position="absolute",s.left=0,s.top=0,s.width=o+"px",s.height=r+"px",n.width=o*i,n.height=r*i,n.setAttribute("data-zr-dom-id",t),n}function n(t,e,i){var n;i=i||r,"string"==typeof t?n=h(t,e,i):a.isObject(t)&&(t=(n=t).id),this.id=t;var o=(this.dom=n).style;o&&(n.onselectstart=s,o["-webkit-user-select"]="none",o["user-select"]="none",o["-webkit-touch-callout"]="none",o["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",o.padding=0,o.margin=0,o["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=i}n.prototype={constructor:n,elCount:0,__dirty:!0,initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.__currentValues={},this.ctx.dpr=this.dpr},createBackBuffer:function(){var t=this.dpr;this.domBack=h("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),this.ctxBack.__currentValues={},1!=t&&this.ctxBack.scale(t,t)},resize:function(t,e){var i=this.dpr,n=this.dom,o=n.style,r=this.domBack;o.width=t+"px",o.height=e+"px",n.width=t*i,n.height=e*i,r&&(r.width=t*i,r.height=e*i,1!=i&&this.ctxBack.scale(i,i))},clear:function(t){var e,i=this.dom,n=this.ctx,o=i.width,r=i.height,s=this.clearColor,a=this.motionBlur&&!t,h=this.lastFrameAlpha,l=this.dpr;a&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(i,0,0,o/l,r/l)),n.clearRect(0,0,o,r),s&&(s.colorStops?(e=s.__canvasGradient||u.getGradient(n,s,{x:0,y:0,width:o,height:r}),s.__canvasGradient=e):s.image&&(e=d.prototype.getCanvasPattern.call(s,n)),n.save(),n.fillStyle=e||s,n.fillRect(0,0,o,r),n.restore());if(a){var c=this.domBack;n.save(),n.globalAlpha=h,n.drawImage(c,0,0,o,r),n.restore()}}};var o=n;t.exports=o},function(t,e){var i="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16)};t.exports=i},function(t,e,i){function n(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,r.call(this)}var o=i(5),r=i(77).Dispatcher,s=i(75),a=i(17);n.prototype={constructor:n,addClip:function(t){this._clips.push(t)},addAnimator:function(t){t.animation=this;for(var e=t.getClips(),i=0;i<e.length;i++)this.addClip(e[i])},removeClip:function(t){var e=o.indexOf(this._clips,t);0<=e&&this._clips.splice(e,1)},removeAnimator:function(t){for(var e=t.getClips(),i=0;i<e.length;i++)this.removeClip(e[i]);t.animation=null},_update:function(){for(var t=(new Date).getTime()-this._pausedTime,e=t-this._time,i=this._clips,n=i.length,o=[],r=[],s=0;s<n;s++){var a=i[s],h=a.step(t,e);h&&(o.push(h),r.push(a))}for(s=0;s<n;)i[s]._needsRemove?(i[s]=i[n-1],i.pop(),n--):s++;n=o.length;for(s=0;s<n;s++)r[s].fire(o[s]);this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update()},_startLoop:function(){var e=this;this._running=!0,s(function t(){e._running&&(s(t),e._paused||e._update())})},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},animate:function(t,e){var i=new a(t,(e=e||{}).loop,e.getter,e.setter);return this.addAnimator(i),i}},o.mixin(n,r);var h=n;t.exports=h},function(t,e,i){var n=i(12);e.Dispatcher=n;var o=i(50),r="undefined"!=typeof window&&!!window.addEventListener,s=/^(?:mouse|pointer|contextmenu|drag|drop)|click/;function a(t,e,i,n){return i=i||{},n||!o.canvasSupported?h(t,e,i):o.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX?(i.zrX=e.layerX,i.zrY=e.layerY):null!=e.offsetX?(i.zrX=e.offsetX,i.zrY=e.offsetY):h(t,e,i),i}function h(t,e,i){var n=function(t){return t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0}}(t);i.zrX=e.clientX-n.left,i.zrY=e.clientY-n.top}var l=r?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0};e.clientToLocal=a,e.normalizeEvent=function(t,e,i){if(null!=(e=e||window.event).zrX)return e;var n=e.type;if(n&&0<=n.indexOf("touch")){var o="touchend"!=n?e.targetTouches[0]:e.changedTouches[0];o&&a(t,o,e,i)}else a(t,e,e,i),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;var r=e.button;return null==e.which&&void 0!==r&&s.test(e.type)&&(e.which=1&r?1:2&r?3:4&r?2:0),e},e.addEventListener=function(t,e,i){r?t.addEventListener(e,i):t.attachEvent("on"+e,i)},e.removeEventListener=function(t,e,i){r?t.removeEventListener(e,i):t.detachEvent("on"+e,i)},e.stop=l,e.notLeftMouse=function(t){return 1<t.which}},function(t,e,i){var n=i(77),o=n.addEventListener,r=n.removeEventListener,s=n.normalizeEvent,a=i(5),h=i(12),l=i(50),c=i(79),u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],d=["touchstart","touchend","touchmove"],p={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},f=a.map(u,function(t){var e=t.replace("mouse","pointer");return p[e]?e:t});function g(t){return"mousewheel"===t&&l.browser.firefox?"DOMMouseScroll":t}function y(t,e,i){var n=t._gestureMgr;"start"===i&&n.clear();var o=n.recognize(e,t.handler.findHover(e.zrX,e.zrY,null).target,t.dom);if("end"===i&&n.clear(),o){var r=o.type;e.gestureEvent=r,t.handler.dispatchToElement({target:o.target},r,o.event)}}function v(t){t._touching=!0,clearTimeout(t._touchTimer),t._touchTimer=setTimeout(function(){t._touching=!1},700)}var m={mousemove:function(t){t=s(this.dom,t),this.trigger("mousemove",t)},mouseout:function(t){var e=(t=s(this.dom,t)).toElement||t.relatedTarget;if(e!=this.dom)for(;e&&9!=e.nodeType;){if(e===this.dom)return;e=e.parentNode}this.trigger("mouseout",t)},touchstart:function(t){(t=s(this.dom,t)).zrByTouch=!0,this._lastTouchMoment=new Date,y(this,t,"start"),m.mousemove.call(this,t),m.mousedown.call(this,t),v(this)},touchmove:function(t){(t=s(this.dom,t)).zrByTouch=!0,y(this,t,"change"),m.mousemove.call(this,t),v(this)},touchend:function(t){(t=s(this.dom,t)).zrByTouch=!0,y(this,t,"end"),m.mouseup.call(this,t),+new Date-this._lastTouchMoment<300&&m.click.call(this,t),v(this)},pointerdown:function(t){m.mousedown.call(this,t)},pointermove:function(t){x(t)||m.mousemove.call(this,t)},pointerup:function(t){m.mouseup.call(this,t)},pointerout:function(t){x(t)||m.mouseout.call(this,t)}};function x(t){var e=t.pointerType;return"pen"===e||"touch"===e}function _(e){a.each(d,function(t){e._handlers[t]=a.bind(m[t],e)}),a.each(f,function(t){e._handlers[t]=a.bind(m[t],e)}),a.each(u,function(t){e._handlers[t]=function(t,e){return function(){if(!e._touching)return t.apply(e,arguments)}}(m[t],e)})}function b(i){function t(t,e){a.each(t,function(t){o(i,g(t),e._handlers[t])},e)}h.call(this),this.dom=i,this._touching=!1,this._touchTimer,this._gestureMgr=new c,this._handlers={},_(this),l.pointerEventsSupported?t(f,this):(l.touchEventsSupported&&t(d,this),t(u,this))}a.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){m[e]=function(t){t=s(this.dom,t),this.trigger(e,t)}});var w=b.prototype;w.dispose=function(){for(var t=u.concat(d),e=0;e<t.length;e++){var i=t[e];r(this.dom,g(i),this._handlers[i])}},w.setCursor=function(t){this.dom.style.cursor=t||"default"},a.mixin(b,h);var P=b;t.exports=P},function(t,e,i){function n(){this._track=[]}var l=i(77);function a(t){var e=t[1][0]-t[0][0],i=t[1][1]-t[0][1];return Math.sqrt(e*e+i*i)}n.prototype={constructor:n,recognize:function(t,e,i){return this._doTrack(t,e,i),this._recognize(t)},clear:function(){return this._track.length=0,this},_doTrack:function(t,e,i){var n=t.touches;if(n){for(var o={points:[],touches:[],target:e,event:t},r=0,s=n.length;r<s;r++){var a=n[r],h=l.clientToLocal(i,a,{});o.points.push([h.zrX,h.zrY]),o.touches.push(a)}this._track.push(o)}},_recognize:function(t){for(var e in o)if(o.hasOwnProperty(e)){var i=o[e](this._track,t);if(i)return i}}};var o={pinch:function(t,e){var i=t.length;if(i){var n=(t[i-1]||{}).points,o=(t[i-2]||{}).points||n;if(o&&1<o.length&&n&&1<n.length){var r=a(n)/a(o);isFinite(r)||(r=1),e.pinchScale=r;var s=function(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]}(n);return e.pinchX=s[0],e.pinchY=s[1],{type:"pinch",target:t[0].target,event:e}}}}},r=n;t.exports=r},function(t,e,i){var o=i(81),a=i(5),h=i(65),r=i(4),s=i(82),n=(i(50),i(89)),l=i(83);function c(t,e,i,n){o.call(this),this.node=t,this.zr=e,this.forbidEdit=n,this._api=i,this.render()}c.ARROW_DRAGEND="OperationNode:dragendArrow",c.ARROW_DRAG="OperationNode:dragArrow",c.ARROW_DRAGSTART="OperationNode:dragstartArrow",c.DELETE_CLICK="OperationNode:deleteClick",c.DEL="DEL",c.COMMENT_CLICK="OperationNode:commentClick",c.COMMENT="COMMENT",c.opicons={STRAIGHT:n.STRAIGHT_SVG,JAGGED:n.JAGGED_SVG,CURVE:n.CURVE_SVG,DEL:n.DEL_SVG,COMMENT:n.COMMENT_SVG},c.prototype.render=function(){this.renderBase(),this.forbidEdit||this.renderOther()},c.prototype.renderBase=function(){this.createOperation()},c.prototype.createOperation=function(){var o=this,t=this.node.operationIcons;this.node.parent&&"dragSelect"===this.node.parent.type&&(t=!1),this.node.selectStyle?"ZPath"===this.node.type?(this.node._zCloneStyle=this.node.style.clone(),this.node.setStyle(this.node.selectStyle)):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!0):this._api.getZr().addHover(this.node,this.node.selectStyle):(this.virtualRect=new r.Polyline({style:{lineDash:[2]}}),this.virtualRect.isSelfComputePos=!0,this.add(this.virtualRect)),t&&a.each(this.node.operationIcons,function(n){var t=null,e=c.opicons[n.name.toUpperCase()+""];if(e){if(this.forbidEdit)return;if(n.hidden)return;if(n.name==c.DEL)t=r.makePath(e,{style:{fill:"#aaaaac"},z:o.node.z+1,rectHover:!0},{x:0,y:0,width:10,height:15}),n.callback?t.on("click",function(t){t.data=n,t.node=o.node,n.callback&&n.callback(t)}):t.on("click",function(t){var e={};e.event=t,e.target=this,e.type=c.DELETE_CLICK,o.trigger(e.type,e)});else if(n.name==c.COMMENT){(t=r.makePath(e,{style:{fill:"#aaaaac"},z:o.node.z+2,rectHover:!0},{x:0,y:0,width:16,height:16})).on("click",function(t){var e={};e.event=t,e.target=this,e.type=c.COMMENT_CLICK,o.trigger(e.type,e)})}else{t=r.makePath(e,{style:{fill:"#aaaaac"},draggable:!0,z:o.node.z+2,lineType:s["TYPE_"+n.name.toUpperCase()],rectHover:!0},{x:0,y:0,width:15,height:15});a.each(["dragstart","drag","dragend"],function(i){t.on(i,function(t){var e={};e.event=t,e.data=n.options,e.type="OperationNode:"+i+"Arrow",o.trigger(e.type,e)})})}}else(t=l.createSymbol(n.iconPath,0,0,n.width||15,n.height||15,o.node.z+1,n.color||"#000")).on("click",function(t){t.data=n,t.node=o.node,n.callback&&n.callback(t);var e={event:t,type:"OperationNode:"+n.name+"Click"};o._api.trigger(e.type,e)});t.name=n.name,o.add(t)})},c.prototype.refreshPostion=function(t,e){var i=0,n=a.clone(e.points[2]),o=t.rotation,r=o/(Math.PI/180);if(0<Math.abs(o)){var s=h.getConnectorControls(e,t).br;n=[s.x-e.x,s.y-e.y]}this.virtualRect&&(this.virtualRect.setShape({points:e.points}),t.parent&&t.parent.childDraggable&&this.virtualRect.attr("z",t.parent.z+1),this.virtualRect.attr("rotation",o)),this.eachChild(function(t){t.isSelfComputePos||t.attr("position",[0<=r?n[0]+8+20*i++:n[0]-20-20*i++,n[1]-10])}),this.refreshPositionOther(t,e)},c.prototype.renderOther=function(){},c.prototype.refreshPositionOther=function(t,e){if(t.parent&&t.parent.isBg&&1==t.parent.isBg||"GroupNode"===t.parent.type)this.attr("position",[e.x,e.y]);else{var i=t.shape?t.shape.x:0,n=t.shape?t.shape.y:0;this.attr("position",[e.x+t.parent.position[0]+i,e.y+t.parent.position[1]+n])}},c.prototype.cleanup=function(){this.node.selectStyle&&("ZPath"===this.node.type?this.node.setStyle(this.node._zCloneStyle):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!1):this._api.getZr().removeHover(this.node))},a.inherits(c,o),t.exports=c},function(t,e,i){var a=i(4),n=i(65);function o(){this.resourceId=n.getUUID(),a.Group.call(this)}o.prototype.render=function(){},o.prototype.getRect=function(t){},o.prototype.drawText=function(t,e,i){var n,o,r=this.bpmnInfo.name;null!=t&&(r=t);var s=new a.Text({style:{text:r,color:e||this.options.text.color,textFont:"12px Microsoft YaHei"},zlevel:20});switch(i=i||"init"){case"init":n=this.getRect().x-this.position[0]-s.getBoundingRect().width/2,o=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":n=this.getRect().x-this.position[0]-s.getBoundingRect().width/2,o=this.getRect().y-this.position[1]-6;break;case"left":n=this.getRect().x-this.position[0]-s.getBoundingRect().width+6,o=this.getRect().y-this.position[1]-6}return s.attr("style",{x:n,y:o}),{text:s,rect:s.getBoundingRect()}},o.prototype.refreshText=function(t){var e,i,n=this.childOfName("Title");switch(t=t||"init"){case"init":e=this.getRect().x-this.position[0]-n.getBoundingRect().width/2,i=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":e=this.getRect().x-this.position[0]-n.getBoundingRect().width/2,i=this.getRect().y-this.position[1]-6;break;case"left":e=2,i=this.getRect().y-this.position[1]-6}n.attr("style",{x:e,y:i})},o.prototype.toJSON=function(){},a.Util.inherits(o,a.Group),t.exports=o},function(t,e,i){var b=i(65),w=i(5),a=i(15),d=i(4),n=i(81),s=i(83),c=i(84),h=i(85),o=i(86),P=i(66),r=i(87);function C(t){n.call(this),this.opt=t||{},this.opt.model?(this.resourceId=this.opt.model.get("resourceId"),this.model=this.opt.model,this.opt=this.opt.model.option):(this.resourceId=b.getUUID(),this.model=new r({}));var e={symbol:{type:"arrow",size:10,color:C.NORMAL_COLOR,both:!1,offset:0},style:{lineWidth:1,stroke:C.NORMAL_COLOR,lineType:C.TYPE_STRAIGHT},hoverStyle:{lineWidth:2,stroke:C.SELECTED_COLOR},arrowHoverStyle:{fill:C.SELECTED_COLOR},shape:{points:null,smooth:!1,smoothConstraint:null},position:{startPos:null,endPos:null,startOffset:[0,0],endOffset:[0,0],escapeDistance:[30,30],points:null},autoChangePosition:!1,textContextMenu:null,isEdit:!0,text:{text:null,textFill:"#000000",textFont:"12px Microsoft YaHei",textPos:"center",textRotateable:!0},image:{image:null,width:50,height:50,imagePos:"center",imageRotateable:!0},z:0};this.options=b.mergeOpt(e,this.opt,!0,"textContextMenu"),this.handles=[],this.conPointsGroup=new d.Group,this.startNode=null,this.endNode=null,this.line=null,this.groupCurve=new d.Group,this.icons=[],this.render()}C.TYPE_STRAIGHT="straight",C.TYPE_JAGGED="jagged",C.TYPE_CURVE="curve",C.TYPE_CHAIN="chain",C.RADIUS=3,C.START_NODE="startNode",C.END_NODE="endNode",C.LEFT="left",C.RIGHT="right",C.TOP="top",C.BOTTOM=C.BOTTOM="bottom",C.SEPERATOR="-",C.NORMAL_COLOR="#000",C.SELECTED_COLOR="#74B7E0",C.CHILD_NAME=["lineText","lineImage"],C.prototype.createLineNode=function(t,o){var r=this,e=null;o=o||"text";var s=w.find(C.CHILD_NAME,function(t){return-1<t.toLocaleLowerCase().indexOf(o)});w.isArray(t[o])&&this.options.style.lineType==C.TYPE_CHAIN?t[o].forEach(function(t,e){var i=r.drawText(s+"-"+e,t,0,0,o);if(w.isString(t)){var n={};n[o]=t,n[o+"Id"]=i.text.id,r.options[o][o][e]=n}else r.options[o][o][e].textId=i.text.id;r.add(i.text),r.createNodeContextMenu(i.text)}):(e=this.drawText(s,t,0,0,o),this.add(e.text)),e&&r.createNodeContextMenu(e.text)},C.prototype.ifLineNodeRotateable=function(t){return t=t||"text",!(this.options.style.lineType!=C.TYPE_STRAIGHT||!("text"===t&&this.options.text.textRotateable||"image"===t&&this.options.image.imageRotateable))},C.prototype.refreshLineNode=function(t,l,c){var u=this,i=[],n=C.CHILD_NAME[0];if(c=c||"text",n=w.find(C.CHILD_NAME,function(t){return-1<t.toLocaleLowerCase().indexOf(c)}),this.options.style.lineType==C.TYPE_CHAIN&&w.isArray(l[c]))l[c].forEach(function(t,e){i.push(u.childOfName(n+"-"+e))});else if(!t&&l[c]){var e=this.drawText(n,l,0,0,c);this.add(e.text),t=this.childOfName(n)}if(0<i.length){var o=i.length,r=this.turningPoints[1].x-this.turningPoints[0].x,d=parseInt(r/o),p=-d*parseInt(o/2);i.forEach(function(t,e){var i=u.getTextPostion(l,t),n="",o=u.getTextRotation(i,t);0===Math.abs(o)?o=0:n=0<o?"plus":"minus";var r=180*(o=Math.abs(o))/Math.PI,s=null,a=null;if("text"===c){t.setStyle("text",w.isString(l[c][e])?l[c][e]:l[c][e].text);var h=u.getTextBoundingRect(t.style);t.setShape({width:h.width,height:h.height})}s=n?(s=90<r?(r-45)*Math.PI/180:(45+r)*Math.PI/180,"minus"===n?-s:s):45*Math.PI/180,t.attr("rotation",s),90==r?i[1]-=p:(i[0]+=p,0!==o&&(a=Math.tan(r*Math.PI/180)*p,0<p?i[1]-="plus"===n?a:-a:i[1]+="plus"===n?-a:a)),t.attr("position",i),p+=d})}if(t){if("text"===c){t.setStyle("text",l[c]);var s=this.getTextBoundingRect(l);t.setShape({width:s.width,height:s.height})}var a=this.getTextPostion(l,t);this.ifLineNodeRotateable(c)&&t.attr("rotation",this.getTextRotation(a,t)),t.attr("position",a)}},C.prototype.refresh=function(t){var n=this;t&&(this.turningPoints=t);var e=b.traslatePoints(this.turningPoints);this.options.style.lineType==C.TYPE_CURVE&&2<e.length?this.modifyCurve(this.turningPoints):this.line.attr("shape",{points:e}),C.CHILD_NAME.forEach(function(t){var e=n.childOfName(t),i=t===C.CHILD_NAME[0]?"text":"image";n.refreshLineNode(e,n.options[i],i)}),this.refreshFromToSymbol(e),this.refreshHandles()},C.prototype.createNodeContextMenu=function(t){if(t&&this.opt.textContextMenu){var e=this.opt.textContextMenu;t.on("contextmenu",function(t){t.event.preventDefault(),t.event.stopPropagation(),e.buildMenu(t.event,this)})}},C.prototype.render=function(){var n=this;this.renderFromToSymbol(),this.curveLine=new d.BezierCurve({style:this.options.style,z:this.options.z}),this.groupCurve.add(this.curveLine),this.add(this.groupCurve),this.add(this.conPointsGroup),this.polyLine=new d.Polyline({shape:this.options.shape,style:this.options.style,z:this.options.z}),this.add(this.polyLine),this.options.style.lineType==C.TYPE_CURVE?(this.line=this.groupCurve,this.createHoverStyle(this.curveLine),this.polyLine.hide()):(this.line=this.polyLine,this.createHoverStyle(this.polyLine),this.curveLine.hide());w.each(["dblclick","click"],function(i){this.line.on(i,w.bind(function(t){t.cancelBubble=!0;var e={};e.event=t,e.type="Connector:"+i,e.target=n,this.trigger(e.type,e),0!=this.options.isEdit&&(n.setSelectedStyle(this),this.handles.length<1&&this.shapeSetHandle())},this))},this),this.options.text.text&&this.createLineNode(this.options.text,"text"),this.options.image.image&&this.createLineNode(this.options.image,"image")},C.prototype.renderFromToSymbol=function(t){var e=this.createSymbol("toSymbol",this.options);if(e&&this.add(e),this.options.symbol.both){var i=this.createSymbol("fromSymbol",this.options);i&&this.add(i)}},C.prototype.refreshFromToSymbol=function(t){var e=this.childOfName("toSymbol"),i=this.childOfName("fromSymbol"),n=[],o=this.options.symbol.offset;if(e)if(this.options.effect&&this.options.effect.show)new h(e,this.options,this.groupCurve,this.polyLine);else{if(n=t[t.length-1],this.options.style.lineType!==C.TYPE_CURVE){var r=a.distance(t[t.length-1],t[t.length-2]);n=o<=r?a.lerp([],t[t.length-1],t[t.length-2],o/r):t[t.length-1]}e.attr("position",n),e.attr("rotation",b.tangentRotation(this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]))}if(i){if(n=t[0],this.options.style.lineType!==C.TYPE_CURVE){var s=a.distance(t[0],t[1]);n=o<=s?a.lerp([],t[0],t[1],o/s):t[0]}i.attr("position",n),i.attr("rotation",b.tangentRotation(this.turningPoints[1],this.turningPoints[0]))}},C.prototype.setStyle=function(e,t){var i={},n=null,o=["text","image","symbol"];if(e.text){var r=this.childOfName(C.CHILD_NAME[0]);if(!r&&e.text.text){var s=this.drawText(C.CHILD_NAME[0],e.text,0,0);this.add(s.text),r=this.childOfName(C.CHILD_NAME[0])}!e.text.text&&""!=e.text.text||(r.setStyle("text",e.text.text),this.options.text.text=e.text.text);var a=this.getTextPostion(e.text);r.attr("position",a),e.text.textPos&&(this.options.text.textPos=e.text.textPos),e.text.offset&&(this.options.text.offset=e.text.offset),e.text.color&&(r.attr("style",{textFill:e.text.color}),this.options.text.textFill=e.text.color),e.text.textFont&&(r.attr("style",{textFont:e.text.textFont}),this.options.text.textFont=e.text.textFont),e.text.textFill&&(r.attr("style",{textFill:e.text.textFill}),this.options.text.textFill=e.text.textFill),this.model.set("options.text",e.text)}if(e.image){var h=this.childOfName(C.CHILD_NAME[1]);if(!h&&e.image.image){var l=this.drawText(C.CHILD_NAME[1],e.image,0,0,"image");this.add(l.text),h=this.childOfName(C.CHILD_NAME[1])}var c=this.getTextPostion(e.image,h);h.attr("position",c),Object.keys(e).forEach(function(t){this.options.image[t]=e[t]}.bind(this)),e.image.offset&&(this.options.image.offset=e.image.offset),this.model.set("options.image",e.image)}if(e.symbol){e.symbol.type&&(this.options.symbol.type=e.symbol.type,this.model.set("options.symbol.type",e.symbol.type)),e.symbol.size&&(this.options.symbol.size=e.symbol.size,this.model.set("options.symbol.size",e.symbol.size)),e.symbol.color&&(this.options.symbol.color=e.symbol.color,this.model.set("options.symbol.color",e.symbol.color)),e.symbol.z&&(this.options.symbol.z=e.symbol.z,this.model.set("options.symbol.z",e.symbol.z)),(n=this.childOfName("toSymbol"))&&this.remove(n);var u=this.createSymbol("toSymbol",this.model.get("options"));u&&this.add(u)}Object.keys(e).forEach(function(t){o.indexOf(t)<0&&(i[t]=e[t])}),"{}"!==JSON.stringify(i)&&(i.color&&(i.stroke=i.color),i.stroke&&(i.color=i.stroke),this.options.style.lineType==C.TYPE_CURVE?this.groupCurve.eachChild(function(t){t.attr("style",i),d.setNormalStyle(t,i)}):(this.polyLine.attr("style",i),d.setNormalStyle(this.polyLine,i)),(n=this.childOfName("toSymbol"))&&i.color&&(n.attr("style",{fill:i.color}),d.setNormalStyle(n,{fill:i.color})),t||(Object.keys(i).forEach(function(t){this.options.style[t]=i[t],this.model.set("options.style"+t,i[t])}.bind(this)),i.color&&(this.options.symbol.color=i.color))),this.refresh()},C.prototype.setSelectedStyle=function(){var t;this.setStyle(this.options.hoverStyle,!0),this.options.style.lineType==C.TYPE_CURVE?this.groupCurve.eachChild(function(t){t.attr("z",this.options.z+2)}.bind(this)):this.polyLine.attr("z",this.options.z+2),(t=this.childOfName("toSymbol"))&&t.attr("z",this.options.z+2)},C.prototype.removeSelectedStyle=function(){var t;this.setStyle({color:this.options.style.stroke,lineWidth:this.options.style.lineWidth},!0),this.options.style.lineType==C.TYPE_CURVE?this.groupCurve.eachChild(function(t){t.attr("z",this.options.z)}.bind(this)):this.polyLine.attr("z",this.options.z),(t=this.childOfName("toSymbol"))&&t.attr("z",this.options.z)},C.prototype.getTextPostion=function(t,e){var i,n=[],o=t.image&&e?e.getBoundingRect():this.getTextBoundingRect(t),r=o.width,s=o.height||12;if(t&&(t.textPos||t.imagePos)){var a=t.offset||0,h=a;i=t.textPos||t.imagePos,w.isArray(a)||(h=[a,0]);var l,c,u=b.getMaxLineLength([this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]]),d=[],p=[],f=b.getAngle(u[0],u[1]);switch(this.options.style.lineType==C.TYPE_CURVE&&(p=this.getPointsFromCurve()),u.forEach(function(t){var e=new P(t.x,u[1].x>=u[0].x?t.y-s/2:t.y+s/2);d.push(e)}),i){case"start":n=this.options.style.lineType===C.TYPE_STRAIGHT?(l=h[0],[(c=b.getEndPoint(d[0],l,f)).x,c.y+h[1]]):[this.turningPoints[0].x-r/2+h[0],this.turningPoints[0].y+h[1]-s/2];break;case"end":n=this.options.style.lineType!==C.TYPE_STRAIGHT||this.options.text.textRotateable?(l=b.distance(d[0],d[1])-r+h[0],[(c=b.getEndPoint(d[0],l,f)).x,c.y+h[1]]):(l=b.distance(d[0],d[1]),[(c=b.getEndPoint(d[0],l,f)).x-r+h[0],c.y+h[1]]);break;default:var g=this.middle(t);if(this.ifLineNodeRotateable(t.image?"image":"text")){var y=this.getTextRotation(t),v=[g[0]-r/2,g[1]-s/2];n=b.calculatePoints(v,{x:g[0],y:g[1]},y)}else if(this.options.style.lineType==C.TYPE_CURVE){var m=[];p.forEach(function(t){m=m.concat(t)});var x=Math.round(m.length/2);n=[m[x].x-r/2,m[x].y-s/2]}else n=[g[0]+h[0],g[1]+h[1]],this.options.style.lineType!==C.TYPE_CHAIN&&(n=[n[0]-r/2,n[1]-s/2])}}else{var _=this.middle(t);n=[_[0]-r/2,_[1]]}return n},C.prototype.getTextRotation=function(t){var e=b.getMaxLineLength(this.turningPoints),i=this.middle(t);return-Math.atan2(e[1].y-i[1],e[1].x-i[0])},C.prototype.createHoverStyle=function(r){if(this.options.hoverStyle&&this.options.isEdit){d.setElementHoverStl(r,this.options.hoverStyle);var t=this.childOfName("toSymbol");t&&d.setElementHoverStl(t,this.options.arrowHoverStyle),r.on("mouseover",w.bind(function(){d.doEnterHover(r),t&&d.doEnterHover(t),this.groupCurve.eachChild(function(t){d.doEnterHover(t)})},this)).on("mousemove",w.bind(function(t){var e=this.turningPoints[0],i=this.turningPoints[this.turningPoints.length-1],n=Math.abs(t.event.offsetX-e.x)+Math.abs(t.event.offsetY-e.y),o=Math.abs(t.event.offsetX-i.x)+Math.abs(t.event.offsetY-i.y);n<=15||o<=15?(r.cursor="move",r.draggable=!0):(r.cursor="pointer",r.draggable=!1)},this)).on("mouseout",w.bind(function(){d.doLeaveHover(r),t&&d.doLeaveHover(t),this.groupCurve.eachChild(function(t){d.doLeaveHover(t)})},this))}},C.prototype.createAllconnectionPoint=function(){this.connectionPointCreate(this,this.turningPoints[0].clone(),o.TYPE_CONNECTOR),this.connectionPointCreate(this,this.turningPoints[this.turningPoints.length-1].clone(),o.TYPE_CONNECTOR)},C.prototype.connectionPointCreate=function(t,e,i){var n=new o(this,e,i,this.options);this.conPointsGroup.add(n.shape)},C.prototype.clearHandles=function(){for(var t=0;t<this.handles.length;t++)this.remove(this.handles[t].handleShape);this.handles=[],this.conPointsGroup&&this.conPointsGroup.removeAll(),this.removeSelectedStyle()},C.prototype.refreshHandles=function(){var i,n,o,t=this.turningPoints,e=[];if(0<this.handles.length){this.options.style.lineType==C.TYPE_CURVE&&(e=this.getPointsFromCurve());for(var r=0;r<this.handles.length;r++){var s=this.handles[r].associatedPoint;o=this.handles[r].type;var a=t.findIndex(function(t){return t.x==s.x&&t.y==s.y});if(1<a){if("h"==o?(i=t[a-1].x,n=(t[a-1].y+t[a].y)/2):"v"==o&&(i=(t[a-1].x+t[a].x)/2,n=t[a-1].y),this.options.style.lineType==C.TYPE_CURVE&&0<e.length){var h=w.find(e[a-2],function(t){var e;return"h"===o?e=Math.abs(t.y-n):"v"===o&&(e=Math.abs(t.x-i)),e<1});h&&(i=h.x,n=h.y)}this.handles[r].update(i,n)}}}},C.prototype.shapeSetHandle=function(){for(var i,t=this.turningPoints,e=this.getPointsFromCurve(),n=1;n<t.length-2;n++){var o,r,s,a=b.collinearity(t[n-1],t[n],t[n+1]),h=b.collinearity(t[n],t[n+1],t[n+2]);if(!a&&(!h||t[n+1].equals(t[n+2]))||(!a||t[n-1].equals(t[n]))&&!h){if(t[n].x===t[n+1].x?(r=t[n].x,s=(t[n].y+t[n+1].y)/2,i="h"):t[n].y===t[n+1].y&&(r=(t[n].x+t[n+1].x)/2,s=t[n].y,i="v"),r&&s){if(this.options.style.lineType==C.TYPE_CURVE&&0<e.length){var l=w.find(e[n-1],function(t){var e;return"h"===i?e=Math.abs(t.y-s):"v"===i&&(e=Math.abs(t.x-r)),e<1});l&&(r=l.x,s=l.y)}(o=new c(i,r,s,this)).associatedPoint=t[n+1]}o&&(this.add(o.handleShape),this.handles.push(o))}}},C.prototype.createSymbol=function(t,e){var i=e.symbol.type,n=e.symbol.size;if("none"!==i){w.isArray(n)||(n=[n,n]);var o=e.z;e.symbol.z&&(o=e.symbol.z);var r=s.createSymbol(i,-n[0]/2,-n[1]/2,n[0],n[1],o,e.symbol.color);return r.name=t,r}},C.prototype.draw=function(t,e){},C.prototype.drawText=function(t,e,i,n,o){o=o||"text";var r,s=w.isString(e)?"text"===o?{text:e,x:i,y:n}:{image:e,x:i,y:n}:w.defaults({x:i,y:n},e,!0),a=w.defaults(w.clone(this.options.text),s,!0);if("text"===o){var h=this.getTextBoundingRect(a);a=w.defaults(a,{fill:"#F9F9F9",transformText:!0},!0),r=new d.Rect({shape:{width:h.width,height:h.height},style:a,zlevel:20,name:t})}else r=new d.Image({type:"LinkImage",style:a,zlevel:20,name:t});return{text:r,rect:r.getBoundingRect()}},C.prototype.getTextBoundingRect=function(t){var e=d.textContain.getBoundingRect(t.text,t.textFont);return{width:d.textContain.getWidth(t.text,t.textFont),height:e.height||12}},C.prototype.middle=function(){if(this.options.style.lineType==C.TYPE_STRAIGHT||this.options.style.lineType==C.TYPE_CHAIN){var t=b.getMaxLineLength(this.turningPoints);return[(t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2]}if(this.options.style.lineType==C.TYPE_JAGGED){for(var e=this.getLength(),i=-1,n=0,o=0;o<this.turningPoints.length-1;o++){i=o;var r=b.getLength(this.turningPoints[o],this.turningPoints[o+1]);if(!(n+r<e/2))break;n+=r}if(-1!=i){var s=e/2-n;if(b.round(this.turningPoints[i].x,3)==b.round(this.turningPoints[i+1].x,3))return[this.turningPoints[i].x,Math.min(this.turningPoints[i].y,this.turningPoints[i+1].y)+s];if(b.round(this.turningPoints[i].y,3)==b.round(this.turningPoints[i+1].y,3))return[Math.min(this.turningPoints[i].x,this.turningPoints[i+1].x)+s,this.turningPoints[i].y];console.error("Connector:middle() - this should never happen "+this.turningPoints[i]+" "+this.turningPoints[i+1]+" nr of points "+this.turningPoints.length)}}else if(this.options.style.lineType==C.TYPE_CURVE){for(var a=this.getLength(),h=0,l=0;l<this.turningPoints.length-1&&!(h+b.distance(this.turningPoints[l],this.turningPoints[l+1])>.5*a);l++)h+=b.distance(this.turningPoints[l],this.turningPoints[l+1]);var c=(.5*a-h)/b.distance(this.turningPoints[l],this.turningPoints[l+1]);return[c*(this.turningPoints[l+1].x-this.turningPoints[l].x)+this.turningPoints[l].x,c*(this.turningPoints[l+1].y-this.turningPoints[l].y)+this.turningPoints[l].y]}return null},C.prototype.getLength=function(){for(var t=0,e=0;e<this.turningPoints.length-1;e++)t+=b.getLength(this.turningPoints[e],this.turningPoints[e+1]);return t},C.prototype.toJSON=function(){return this.model.set("resourceId",this.resourceId),this.model.set("properties.type",14),this.model.set("bounds.upperLeft.x",this.position[0]),this.model.set("bounds.upperLeft.y",this.position[1]),this.model.set("bounds.lowerRight.x",parseInt(this.position[0]+this.getBoundingRect().width)),this.model.set("bounds.lowerRight.y",parseInt(this.position[1]+this.getBoundingRect().height)),this.model.set("style.sPos",this.options.position.startPos),this.model.set("style.ePos",this.options.position.endPos),this.model.set("style.lineDash",this.options.style.lineDash),this.model.set("style.stroke",this.options.style.stroke),this.model.set("symbol.type",this.options.symbol.type),this.model.set("dockers",this.turningPoints),this.model.option},C.prototype.refreshModel=function(){this.model.set("options",w.clone(this.options)),this.model.set("options.dockers",this.turningPoints);for(var t=[],e=0;e<this.icons.length;e++){var i=this.icons[e],n=[i.key,{icon:i.style.image,width:i.style.width,height:i.style.height}];t.push(n)}this.model.set("icons",t)},C.prototype.modifyCurve=function(t){for(var e=this.getCurvePoint(t),i=[],n=e.length,o=this.groupCurve.childCount();n<o;n++)i.push(this.groupCurve.childAt(n));w.each(i,function(t){this.groupCurve.remove(t)},this);for(var r=0;r<e.length;r++){var s=this.groupCurve.childAt(r);if(s)s.attr("shape",e[r]);else{var a=new d.BezierCurve({style:this.options.style,shape:e[r],z:this.options.z});this.groupCurve.add(a),this.createHoverStyle(a)}}},C.prototype.getBezierPoints=function(t,e){var i=[],n=null,o=t.start,r=t.cp1,s=t.cp2,a=t.end;(!e||e<=50)&&(e=50),r||s?r&&!s?n=this.twoBezier:r&&s&&(n=this.threeBezier):n=this.oneBezier;for(var h=0;h<e;h++)i.push(n(h/e,o,r,s,a));return i.push(a),i},C.prototype.oneBezier=function(t,e,i,n,o){var r=e.x1,s=e.y1;return{x:r+(o.x2-r)*t,y:s+(o.y2-s)*t}},C.prototype.twoBezier=function(t,e,i,n,o){var r=e.x1,s=e.y1,a=o.x2,h=o.y2;return{x:(1-t)*(1-t)*r+2*t*(1-t)*i.cpx1+t*t*a,y:(1-t)*(1-t)*s+2*t*(1-t)*i.cpy1+t*t*h}},C.prototype.threeBezier=function(t,e,i,n,o){var r=e.x1,s=e.y1,a=o.x2,h=o.y2,l=i.cpx1,c=i.cpy1;return{x:r*(1-t)*(1-t)*(1-t)+3*l*t*(1-t)*(1-t)+3*n.cpx2*t*t*(1-t)+a*t*t*t,y:s*(1-t)*(1-t)*(1-t)+3*c*t*(1-t)*(1-t)+3*n.cpy2*t*t*(1-t)+h*t*t*t}},C.prototype.getPointsFromCurve=function(){var e,i=this,t=this.turningPoints,n=b.getMaxLineLength(t),o=[];if(e=parseInt(n[0].x-n[1].x),this.options.style.lineType==C.TYPE_CURVE&&2<t.length){var r=this.transformCurvePoint(this.getCurvePoint(t));0<r.length&&r.forEach(function(t){o.push(i.getBezierPoints(t,e))})}return o},C.prototype.transformCurvePoint=function(t){var i=[];return t.forEach(function(t){var e={};t.x1&&t.y1&&(e.start={x1:t.x1,y1:t.y1}),t.cpx1&&t.cpy1&&(e.cp1={cpx1:t.cpx1,cpy1:t.cpy1}),t.cpx2&&t.cpy2&&(e.cp2={cpx2:t.cpx2,cpy2:t.cpy2}),t.x2&&t.y2&&(e.end={x2:t.x2,y2:t.y2}),i.push(e)}),i},C.prototype.getCurvePoint=function(t){var e=t.length,i=[];if(3===e)return i.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,x2:t[2].x,y2:t[2].y}),i;if(4===e)return i.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,cpx2:t[2].x,cpy2:t[2].y,x2:t[3].x,y2:t[3].y}),i;function n(t,e){return new P(t.x+e.x,t.y+e.y)}function o(t,e){if(0==e)throw"Division by zero not allowed (yet :) "+this.callee;return new P(t.x/e,t.y/e)}function r(t,e){return new P(t.x*e,t.y*e)}var s,a=[0,0,0];for(s=0;s<=e-3;s++)a.push(s);a.push(e-3,e-3);for(var h=1;h<=e-3;h++){var l=o(n(r(t[h],a[h+4]-a[h+2]),r(t[h+1],a[h+2]-a[h+1])),a[h+4]-a[h+1]),c=(a[h+3]-a[h+2])/(a[h+3]-a[h+1]),u=o(n(r(t[h-1],a[h+3]-a[h+2]),r(t[h],a[h+2]-a[h])),a[h+3]-a[h]),d=r(l,(a[h+2]-a[h+1])/(a[h+3]-a[h+1])),p=n(r(u,c),d),f=o(n(r(t[h],a[h+4]-a[h+3]),r(t[h+1],a[h+3]-a[h+1])),a[h+4]-a[h+1]),g=(a[h+3]-a[h+2])/(a[h+4]-a[h+2]),y=o(n(r(t[h+1],a[h+5]-a[h+3]),r(t[h+2],a[h+3]-a[h+2])),a[h+5]-a[h+2]),v=r(f,(a[h+4]-a[h+3])/(a[h+4]-a[h+2])),m=n(r(y,g),v);i.push({x1:p.x,y1:p.y,cpx1:l.x,cpy1:l.y,cpx2:f.x,cpy2:f.y,x2:m.x,y2:m.y})}return i},b.inherits(C,n),t.exports=C},function(t,e,i){"use strict";var l=i(4),c=i(27),n=l.extendShape({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width/2,r=e.height/2;t.moveTo(i,n-r),t.lineTo(i+o,n+r),t.lineTo(i-o,n+r),t.closePath()}}),o=l.extendShape({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width/2,r=e.height/2;t.moveTo(i,n-r),t.lineTo(i+o,n),t.lineTo(i,n+r),t.lineTo(i-o,n),t.closePath()}}),r=l.extendShape({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,n=e.y,o=e.width/5*3,r=Math.max(o,e.height),s=o/2,a=s*s/(r-s),h=n-r+s+a,l=Math.asin(a/s),c=Math.cos(l)*s,u=Math.sin(l),d=Math.cos(l);t.arc(i,h,s,Math.PI-l,2*Math.PI+l);var p=.6*s,f=.7*s;t.bezierCurveTo(i+c-u*p,h+a+d*p,i,n-f,i,n),t.bezierCurveTo(i,n-f,i-c+u*p,h+a+d*p,i-c,h+a),t.closePath()}}),s=l.extendShape({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.height,n=e.width,o=e.x,r=e.y,s=n/3*2;t.moveTo(o,r),t.lineTo(o+s,r+i),t.lineTo(o,r+i/4*3),t.lineTo(o-s,r+i),t.lineTo(o,r),t.closePath()}}),a={line:l.Line,rect:l.Rect,roundRect:l.Rect,square:l.Rect,circle:l.Circle,diamond:o,pin:r,arrow:s,triangle:n},h={line:function(t,e,i,n,o){o.x1=t,o.y1=e+n/2,o.x2=t+i,o.y2=e+n/2},rect:function(t,e,i,n,o){o.x=t,o.y=e,o.width=i,o.height=n},roundRect:function(t,e,i,n,o){o.x=t,o.y=e,o.width=i,o.height=n,o.r=Math.min(i,n)/4},square:function(t,e,i,n,o){var r=Math.min(i,n);o.x=t,o.y=e,o.width=r,o.height=r},circle:function(t,e,i,n,o){o.cx=t+i/2,o.cy=e+n/2,o.r=Math.min(i,n)/2},diamond:function(t,e,i,n,o){o.cx=t+i/2,o.cy=e+n/2,o.width=i,o.height=n},pin:function(t,e,i,n,o){o.x=t+i/2,o.y=e+n/2,o.width=i,o.height=n},arrow:function(t,e,i,n,o){o.x=t+i/2,o.y=e+n/2,o.width=i,o.height=n},triangle:function(t,e,i,n,o){o.cx=t+i/2,o.cy=e+n/2,o.width=i,o.height=n}},u={};for(var d in a)u[d]=new a[d];function p(t){if("image"!==this.type){var e=this.style,i=this.shape;i&&"line"===i.symbolType?e.stroke=t:this.__isEmptyBrush?(e.stroke=t,e.fill="#fff"):(e.fill&&(e.fill=t),e.stroke&&(e.stroke=t)),this.dirty()}}var f=l.extendShape({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function(){var t=this.style;"pin"===this.shape.symbolType&&"inside"===t.textPosition&&(t.textPosition=["50%","40%"],t.textAlign="center",t.textVerticalAlign="middle")},buildPath:function(t,e){var i=e.symbolType,n=u[i];"none"!==e.symbolType&&(n=n||u[i="rect"],h[i](e.x,e.y,e.width,e.height,n.shape),n.buildPath(t,n.shape))}}),g={createSymbol:function(t,e,i,n,o,r,s){var a,h=0===t.indexOf("empty");return h&&(t=t.substr(5,1).toLowerCase()+t.substr(6)),(a=0===t.indexOf("image://")?new l.Image({style:{image:t.slice(8),x:e,y:i,width:n,height:o},z:r}):0===t.indexOf("path://")?l.makePath(t.slice(7),{z:r,rectHover:!0},new c(e,i,n,o)):new f({shape:{symbolType:t,x:e,y:i,width:n,height:o},z:r})).__isEmptyBrush=h,a.setColor=p,a.setColor(s),a}};t.exports=g},function(t,e,i){var r=i(4),a=i(65);function s(t,e,i,n){this.type=t,this.x=e,this.y=i,this.visible=!0,this.connector=n,this.handleShape=new r.Circle({shape:{cx:e,cy:i,r:s.RADIUS},style:{fill:"rgb(0,255,0)",stroke:"rgb(0,0,0)"},zlevel:n.options.z+2,draggable:!0});var o=this;this.handleShape.on("drag",function(t){o.actionConnector(t.offsetX,t.offsetY)})}s.RADIUS=4,s.prototype={constructor:s,equals:function(t){return!(!t instanceof s)&&(this.type==t.type&&this.x==t.x&&this.y==t.y&&this.visible==t.visible)},update:function(t,e){this.handleShape.attr("position",[0,0]),this.x=t,this.y=e,this.handleShape.setShape({cx:t,cy:e})},actionConnector:function(t,e){switch(this.type){case"v":for(var i=1;i<this.connector.turningPoints.length-1;i++){if(this.associatedPoint&&this.connector.turningPoints[i].x==this.associatedPoint.x&&this.connector.turningPoints[i].y==this.associatedPoint.y){r=i;break}this.connector.turningPoints[i-1].y==this.connector.turningPoints[i].y&&this.connector.turningPoints[i].y==this.y&&Math.min(this.connector.turningPoints[i].x,this.connector.turningPoints[i-1].x)<=this.x&&Math.max(this.connector.turningPoints[i].x,this.connector.turningPoints[i-1].x)>=this.x&&(r=i)}var n=e-this.y,o=a.translationMatrix(0,n);this.connector.turningPoints[r-1].transform(o),this.connector.turningPoints[r].transform(o),this.connector.refresh();break;case"h":var r;for(i=1;i<this.connector.turningPoints.length-1;i++){if(this.associatedPoint&&this.connector.turningPoints[i].x==this.associatedPoint.x&&this.connector.turningPoints[i].y==this.associatedPoint.y){r=i;break}this.connector.turningPoints[i-1].x==this.connector.turningPoints[i].x&&this.connector.turningPoints[i].x==this.x&&Math.min(this.connector.turningPoints[i].y,this.connector.turningPoints[i-1].y)<=this.y&&Math.max(this.connector.turningPoints[i].y,this.connector.turningPoints[i-1].y)>=this.y&&(r=i)}var s=t-this.x;o=a.translationMatrix(s,0);this.connector.turningPoints[r-1].transform(o),this.connector.turningPoints[r].transform(o),this.connector.refresh()}}},t.exports=s},function(t,e,i){i(5);var a=i(15),d=i(31);i(83);function n(t,e,i,n){this._lastFrame=0,this._lastFramePercent=0,this.symbol=t,this.groupCurve=i,this.initSymbol(e,n)}var o=n.prototype;o.initSymbol=function(t,e){var i=this;this.symbol.z2=100,this.symbol.culling=!0;var n=1e3*t.effect.period;if(this.symbol.__t=0,this.symbol.stopAnimation(),"curve"==t.style.lineType){if(this.groupCurve){n/=this.groupCurve._children.length,this.groupCurveAnimate(this.groupCurve._children[0],0,n)}}else this.symbol.animate("",!0).when(n,{__t:1}).delay(0).during(function(){i.updateSymbolPositionPolyline()}).start(),this.setAnimationPointsPolyline(e.shape.points)},o.groupCurveAnimate=function(t,e,i){var n,o=this;null==t&&(t=this.groupCurve._children[0],e=0);var r=t.shape;n=[[r.x1,r.y1],[r.x2,r.y2],[r.cpx1,r.cpy1],[r.cpx2,r.cpy2]],this.setAnimationPointsBezierCurve(n),this.symbol.animate("").when(i,{__t:1}).delay(0).during(function(){o.updateSymbolPositionBezierCurve()}).done(function(){o.symbol.__t=0,o.groupCurveAnimate(o.groupCurve._children[e+1],e+1,i)}).start()},o.setAnimationPointsBezierCurve=function(t){this.symbol.__p1=t[0],this.symbol.__p2=t[1],this.symbol.__cp1=t[2]||[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],this.symbol.__cp2=t[3]},o.updateSymbolPositionBezierCurve=function(){var t,e,i=this.symbol.__p1,n=this.symbol.__p2,o=this.symbol.__cp1,r=this.symbol.__cp2,s=this.symbol.__t,a=this.symbol.position;if(null!=r[0]){var h=d.cubicAt,l=d.cubicDerivativeAt;a[0]=h(i[0],o[0],r[0],n[0],s),a[1]=h(i[1],o[1],r[1],n[1],s),t=l(i[0],o[0],r[0],n[0],s),e=l(i[1],o[1],r[1],n[1],s)}else{var c=d.quadraticAt,u=d.quadraticDerivativeAt;a[0]=c(i[0],o[0],n[0],s),a[1]=c(i[1],o[1],n[1],s),t=u(i[0],o[0],n[0],s),e=u(i[1],o[1],n[1],s)}this.symbol.rotation=-Math.atan2(e,t)-Math.PI/2,this.symbol.ignore=!1},o.setAnimationPointsPolyline=function(t){this._points=t;for(var e=[0],i=0,n=1;n<t.length;n++){var o=t[n-1],r=t[n];i+=a.dist(o,r),e.push(i)}if(0!==i){for(var s=0;s<e.length;s++)e[s]/=i;this._offsets=e,this._length=i,this.symbol._lastFrame=0,this.symbol.__lastFramePercent=0}},o.updateSymbolPositionPolyline=function(){var t=this.symbol.__t,e=this._points,i=this._offsets,n=e.length;if(i){var o=this._lastFrame;if(t<this._lastFramePercent){for(r=Math.min(o+1,n-1);0<=r&&!(i[r]<=t);r--);r=Math.min(r,n-2)}else{for(var r=o;r<n&&!(i[r]>t);r++);r=Math.min(r-1,n-2)}a.lerp(this.symbol.position,e[r],e[r+1],(t-i[r])/(i[r+1]-i[r])),this._lastFrame=r,this._lastFramePercent=t;var s=-Math.atan2(e[r+1][1]-e[r][1],e[r+1][0]-e[r][0]);this.symbol.rotation=s-Math.PI/2,this.symbol.ignore=!1}},t.exports=n},function(t,e,i){var o=i(4);function r(t,e,i,n){this.connector=t,this.point=e.clone(),this.type=i,this.color=r.NORMAL_COLOR,this.oType="ConnectionPoint",this.shape=new o.Circle({shape:{cx:this.point.x,cy:this.point.y,r:r.RADIUS},style:{fill:this.color,stroke:"#000000"},z:n.z+2}),this.shape.type=this.type,this.shape.connector=t}r.NORMAL_COLOR="#FFFF33",r.OVER_COLOR="#FF9900",r.CONNECTED_COLOR="#ff0000",r.RADIUS=4,r.TYPE_FIGURE="figure",r.TYPE_CONNECTOR="connector",r.prototype={constructor:r,equals:function(t){return this.point.equals(t.point)&&this.connector==t.connector&&this.type==t.type&&this.color==t.color&&this.radius==t.radius}},t.exports=r},function(t,e,i){var r=i(5),n=i(88);function o(t,e,i){this.parentModel=e,this.option=t,this.init&&(arguments.length<=3?this.init(t,e,i):this.init.apply(this,arguments))}o.prototype={constructor:o,init:function(t){r.merge(t,this.getDefaultOption())},getDefaultOption:function(){if(!this.hasOwnProperty("__defaultOption")){for(var t=[],e=this.constructor;e;){var i=e.prototype.defaultOption;i&&t.push(i),e=e.superClass}for(var n={},o=t.length-1;0<=o;o--)n=r.merge(n,t[o],!0);this.__defaultOption=n}return this.__defaultOption},mergeOption:function(t){r.merge(this.option,t,!0)},get:function(t,e){if(!t)return this.option;"string"==typeof t&&(t=t.split("."));for(var i=this.option,n=this.parentModel,o=0;o<t.length&&null!=(i=i&&"object"==typeof i?i[t[o]]:null);o++);return null==i&&n&&!e&&(i=n.get(t)),i},set:function(t,e){var i=this.option;if(-1==t.indexOf("."))i[t]=e;else{for(var n,o=t.split("."),r=o.length,s=i,a=0;a<r-1;a++)null==s[n=o[a]]&&(s[n]={}),s=s[n];s[n=o[r-1]]=e}},getShallow:function(t,e){var i=this.option,n=i&&i[t],o=this.parentModel;return null==n&&o&&!e&&(n=o.getShallow(t)),n},getModel:function(t,e){var i=this.get(t,!0),n=this.parentModel;return new o(i,e||n&&n.getModel(t))},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){return new this.constructor(r.clone(this.option))}},n.enableClassExtend(o),t.exports=o},function(t,e,i){var r=i(5),n={},s="___FT__COMPONENT__CONTAINER___",a=n.parseClassType=function(t){var e={main:"",sub:""};return t&&(t=t.split("."),e.main=t[0]||"",e.sub=t[1]||""),e};function o(t,e){var i=r.slice(arguments,2);return this.superClass.prototype[e].apply(t,i)}function h(t,e,i){return this.superClass.prototype[e].apply(t,i)}n.enableClassExtend=function(i,n){i.extend=function(t){function e(){n&&n.apply(this,arguments),i.apply(this,arguments)}return r.extend(e.prototype,t),e.extend=this.extend,e.superCall=o,e.superApply=h,r.inherits(e,this),e.superClass=this,e}},n.enableClassManagement=function(i,t){t=t||{};var o={};if(i.registerClass=function(t,e){if(e)if((e=a(e)).sub){if(e.sub!==s){(function(t){var e=o[t.main];e&&e[s]||((e=o[t.main]={})[s]=!0);return e})(e)[e.sub]=t}}else{if(o[e.main])return;o[e.main]=t}return t},i.getClass=function(t,e,i){var n=o[t];if(n&&n[s]&&(n=e?n[e]:null),i&&!n)throw new Error("Component "+t+"."+(e||"")+" not exists. Load it first.");return n},i.getClassesByMainType=function(t){t=a(t);var i=[],e=o[t.main];return e&&e[s]?r.each(e,function(t,e){e!==s&&i.push(t)}):i.push(e),i},i.hasClass=function(t){return t=a(t),!!o[t.main]},i.getAllClassMainTypes=function(){var i=[];return r.each(o,function(t,e){i.push(e)}),i},i.hasSubTypes=function(t){t=a(t);var e=o[t.main];return e&&e[s]},i.parseClassType=a,t.registerWhenExtend){var n=i.extend;n&&(i.extend=function(t){var e=n.call(this,t);return i.registerClass(e,t.type)})}return i},t.exports=n},function(t,e){t.exports={STRAIGHT_SVG:"M937.353846 724.676923C882.215385 669.538462 795.569231 661.661538 732.553846 701.046154L362.338462 330.830769C401.723077 267.815385 393.846154 181.169231 338.707692 126.030769 267.815385 55.138462 165.415385 55.138462 94.523077 126.030769 23.630769 196.923077 23.630769 299.323077 94.523077 370.215385 149.661538 425.353846 236.307692 433.230769 299.323077 393.846154L669.538462 764.061538C630.153846 827.076923 638.030769 913.723077 693.169231 968.861538 764.061538 1039.753846 866.461538 1039.753846 937.353846 968.861538 1000.369231 897.969231 1000.369231 795.569231 937.353846 724.676923L937.353846 724.676923ZM275.692308 307.2C244.184615 338.707692 189.046154 338.707692 157.538462 307.2 126.030769 275.692308 126.030769 220.553846 157.538462 189.046154 189.046154 157.538462 244.184615 157.538462 275.692308 189.046154 307.2 220.553846 307.2 267.815385 275.692308 307.2L275.692308 307.2ZM874.338462 913.723077C842.830769 945.230769 787.692308 945.230769 756.184615 913.723077 724.676923 882.215385 724.676923 827.076923 756.184615 795.569231 787.692308 764.061538 842.830769 764.061538 874.338462 795.569231 905.846154 827.076923 905.846154 874.338462 874.338462 913.723077L874.338462 913.723077Z",JAGGED_SVG:"M204.8 819.2l-51.2-102.4 204.8-307.2 51.2 102.4-204.8 307.2zM409.6 512l51.2-102.4 153.6 204.8-51.2 102.4-153.6-204.8zM819.2 204.8l51.2 102.4-204.8 409.6-51.2-102.4 204.8-409.6z                                    M153.6 716.8c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H102.4v-102.4h102.4v102.4zM409.6 204.8C322.56 204.8 256 271.36 256 358.4s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H358.4V307.2h102.4v102.4zM614.4 614.4c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4v-102.4h102.4v102.4zM870.4 0c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4V102.4h102.4v102.4z",CURVE_SVG:"M1014.285039 824.024234l-145.168428-144.37205c-12.969593-12.855825-37.543559-14.505466-44.597197 2.332252-1.877178 4.550734-2.275367 17.179022-2.275368 17.179022v97.556369H330.935383a118.319095 118.319095 0 0 1-118.546632-117.920905A118.319095 118.319095 0 0 1 330.992267 560.878016h445.516899c121.561493 0 220.426198-98.352747 220.426198-219.23163s-98.864705-219.174746-220.426198-219.174746H340.491925A174.236244 174.236244 0 0 0 174.105698 0 173.78117 173.78117 0 0 0 0.040107 173.09856a173.78117 173.78117 0 0 0 174.065591 173.09856 174.236244 174.236244 0 0 0 166.386227-122.471639h436.017241c65.416807 0 118.603516 52.902288 118.603515 117.920905A118.319095 118.319095 0 0 1 776.509166 459.624176H330.992267c-121.504609 0-220.369314 98.352747-220.369314 219.23163s98.864705 219.174746 220.369314 219.174746h491.194895v92.550561s0 14.221045 2.332252 19.795695c7.053638 16.894602 31.627604 17.577212 44.597197 4.664502l145.111543-144.315165a32.879056 32.879056 0 0 0 0-46.645027zM174.105698 244.94328c-39.818926 0-72.242909-32.25333-72.242909-71.84472s32.423983-71.787835 72.242909-71.787835c39.818926 0 72.186025 32.196446 72.186025 71.787835 0 39.591389-32.423983 71.787835-72.242909 71.787836z",DEL_SVG:"M980.992 256h-84.992v683.008c0 47.104-37.888 84.992-84.992 84.992H212.992c-47.104 0-84.992-37.888-84.992-84.992V256H43.008C19.456 256 0 236.544 0 212.992c0-23.552 19.456-43.008 43.008-43.008H256V84.992C256 37.888 293.888 0 340.992 0h340.992C730.112 0 768 37.888 768 84.992v84.992h214.016c23.552 0 43.008 19.456 43.008 43.008-1.024 23.552-20.48 43.008-44.032 43.008zM683.008 84.992H340.992v84.992h340.992V84.992zM212.992 939.008h596.992V256H212.992v683.008z m171.008-470.016v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-23.552 19.456-43.008 43.008-43.008 23.552 1.024 43.008 19.456 43.008 43.008zM512 427.008c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z m171.008 0c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z",COMMENT_SVG:"M209.92 152.064l572.416 1.536c12.8 0 23.04 10.24 23.04 23.04v237.568c0 12.8 10.24 23.04 23.04 23.04s23.04-10.24 23.04-23.04V125.44c0-12.8-10.24-23.04-23.04-23.04H158.72c-12.8 0-23.04 10.24-23.04 23.04v773.12c0 12.8 10.24 23.04 23.04 23.04h236.032c12.8 0 23.04-10.24 23.04-23.04s-10.24-22.528-22.528-23.04l-185.856-1.536c-12.8 0-22.528-10.24-22.528-23.04V174.592c0-12.288 10.24-22.528 23.04-22.528z                                            M268.8 570.368h159.232c13.312 0 24.064 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.064-10.752-24.576-24.064v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0-312.32h441.344c13.312 0 24.576 10.752 24.576 24.576v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.576-10.752-24.576-24.576v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0.512 155.648h269.312c13.312 0 24.576 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H269.312c-13.312 0-24.576-10.752-24.576-24.064v-2.56c0-13.824 10.752-24.576 24.576-24.576z m471.04 13.312l-246.784 339.456c-1.536 2.56-2.56 5.632-2.56 8.704l-1.536 132.096c0 9.728 9.728 16.896 18.944 14.336l122.88-37.888c3.072-1.024 5.632-3.072 7.68-5.632l246.784-338.944c4.608-6.144 3.584-15.36-2.56-19.968l-121.344-94.72c-7.168-5.632-16.896-4.096-21.504 2.56z m23.04 67.584l51.2 39.936c2.048 1.536 2.56 5.12 1.024 7.168l-26.112 35.84c-1.536 2.56-5.12 3.072-7.68 1.024l-51.712-38.912c-2.048-1.536-2.56-4.608-1.024-7.168l26.624-37.376c2.048-1.536 5.632-2.048 7.68-0.512z m-165.888 341.504l-35.328 10.752c-9.216 3.072-18.944-4.096-18.944-13.824l0.512-40.96c0-3.072 1.024-6.144 2.56-8.704l137.216-187.904c1.536-2.56 5.12-2.56 7.168-1.024l51.2 38.4c2.56 2.048 3.072 5.12 1.024 7.68l-137.728 189.952c-2.048 2.56-4.608 4.608-7.68 5.632z",CHANGE_LINE_TYPE_SVG:"M1008 335.2 1008 335.2l-160 144 0 0c-8.8 8-20 12.8-32 12.8-26.4 0-48-21.6-48-48 0-14.4 6.4-26.4 16-35.2l0 0 67.2-60L560 348.8c0 0 0 0 0 0L464 348.8l0 0L352 348.8 48 348.8c-26.4 0-48-21.6-48-48 0-26.4 21.6-48 48-48l124.8 0 0 0L416 252.8l0 0 208 0 0 0 227.2 0L784 192l0 0c-9.6-8.8-16-21.6-16-35.2 0-26.4 21.6-48 48-48 12 0 23.2 4.8 32 12.8l0 0 160 144 0 0c9.6 8.8 16 21.6 16 35.2C1024 314.4 1017.6 326.4 1008 335.2zM16 680.8 16 680.8l160-144 0 0c8.8-8 20-12.8 32-12.8 26.4 0 48 21.6 48 48 0 14.4-6.4 26.4-16 35.2l0 0-67.2 60L400 667.2l0 0 208 0 0 0 243.2 0 0 0L976 667.2c26.4 0 48 21.6 48 48 0 26.4-21.6 48-48 48L672 763.2 560 763.2c0 0 0 0 0 0L464 763.2l0 0L172.8 763.2 240 824l0 0c9.6 8.8 16 21.6 16 35.2 0 26.4-21.6 48-48 48-12 0-23.2-4.8-32-12.8l0 0L16 752l0 0c-9.6-8.8-16-21.6-16-35.2C0 701.6 6.4 689.6 16 680.8z"}},function(t,e,i){var u=i(5),n=i(91),o=i(82),_=i(65),s=i(66),r=i(93);function a(t){n.call(this),this.bundleOffset=30,this.bundleGap=20,this.connectorMap=_.StackedMap.createNew(),this._api=t}a.prototype.add=function(t){if(this.connectors.push(t),this.handleConnectorEvent(t),t.startNode&&t.endNode){var e=this.getTwoNodeId(t.startNode,t.endNode,t.options.position);this.connectorMap.add(e,t),this.handleConnectorShrink(t),this.bundleOffset=t.options.bundleOffset||this.bundleOffset,this.bundleGap=t.options.bundleGap||this.bundleGap;var i=this.connectorMap.get(e);if(1==i.length){var n=t.options.dockers,o=[];if(n&&2<=n.length)o=s.loadArray(n),t.refresh(o);else if(t.options.position.points){var r=this.getStartEndPoint(t);(o=t.options.position.points).unshift(r[0]),o.push(r[1]),t.refresh(o)}else this.refreshConnector(i[0],!0)}else 1<i.length&&this.refreshCons(i)}else this.handleConnectorPoints(t);return this.handleConnectorModel(t),t},a.prototype.handleConnectorEvent=function(t){t.conPointsGroup&&t.conPointsGroup.on("click",function(t){var e=t.target.type.split(o.SEPERATOR),i=t.target.connector;e[0]===o.START_NODE?i.options.position.startPos=e[1]:e[0]===o.END_NODE&&(i.options.position.endPos=e[1]),this.refreshConnector(i,!0),t.cancelBubble=!0;var n={};n.event=t,n.type="conPointsGroup:click",n.lineNode=this.selConnector,this._api.trigger(n.type,n)}.bind(this));u.each(["click","dblclick"],function(n){t.on("Connector:"+n,function(t){var e=t.target;this.selConnector!==e&&(this.selConnector&&this.refreshConnector(this.selConnector),this.selConnector=e),t.cancelBubble=!0;var i={};i.event=t,i.type=n,i.target=this.selConnector,this._api.trigger(i.type,i)}.bind(this))}.bind(this))},a.prototype.handleConnectorModel=function(t){t.model.set(r.ELEMENT_TYPE,r.CONNECTION),t.startNode&&t.endNode&&(t.model.set(r.START_ID,t.startNode.id),t.model.set(r.END_ID,t.endNode.id)),t.model.set(r.OPTIONS,u.clone(t.options))},a.prototype.handleConnectorShrink=function(l){var c=this;l.line.on("dblclick",function(){if(0!=l.options.isShrink){var t,e=this.parent,i=e.startNode,n=e.endNode,o=u.clone(l.options.position);-1<o.startPos.indexOf("-")&&(t="-"),-1<o.startPos.indexOf("+")&&(t="+"),o.startPos=o.startPos.split(t)[0],-1<o.endPos.indexOf("-")&&(t="-"),-1<o.endPos.indexOf("+")&&(t="+"),o.endPos=o.endPos.split(t)[0];var r=c.getTwoNodeId(i,n,o),s=c.connectorMap.getsimilar(r);if(1!=s.length)for(var a=parseInt(s.length/2),h=0;h<s.length;h++)h!=a&&(s[h].ignore?s[h].show():s[h].hide())}})},a.prototype.handleConnectorPoints=function(t){var e=t.options,i=t.options.dockers;if(i&&2<=i.length){var n=s.loadArray(i);t.refresh(n)}else if(e.position&&e.position.points){var o=e.position.points;t.refresh(o)}},a.prototype.getTwoNodeId=function(t,e,i){return t.id+"-"+i.startPos+","+e.id+"-"+i.endPos},a.prototype.refreshCons=function(t){if(t[0].options.style.lineType==o.TYPE_JAGGED)for(var e=0;e<t.length;e++)this.refreshConnector(t[e],!0);else this.refreshConsStraight(t)},a.prototype.refreshConsStraight=function(t){var e=parseInt(t.length/2),i=[],n=t[0].startNode,o=t[0].endNode,r=_.getRect(n,!0),s=_.getRect(o,!0),a=_.getConnectorPoints(r,n),h=_.getConnectorPoints(s,o),l=t[0].options.position;l.startPos&&l.endPos||(r.x<s.x?(l.startPos="right",l.endPos="left"):(l.startPos="left",l.endPos="right"));for(var c=a[l.startPos],u=h[l.endPos],d=Math.atan2(u.y-c.y,u.x-c.x),p=[],f=e;1<=f;f--){(p=[]).push(c);var g=c.clone();g.transform(_.translationMatrix(0,this.bundleGap*f)),g.x=g.x+this.bundleOffset*Math.cos(d),g.y=g.y+this.bundleOffset*Math.sin(d),p.push(g);var y=u.clone();y.transform(_.translationMatrix(0,this.bundleGap*f)),y.x=y.x-this.bundleOffset*Math.cos(d),y.y=y.y-this.bundleOffset*Math.sin(d),p.push(y),p.push(u),i.push(p)}i.push([c,u]);var v=Math.ceil(t.length/2);for(f=1;f<v;f++){(p=[]).push(c);var m=c.clone();m.transform(_.translationMatrix(0,-this.bundleGap*f)),m.x=m.x+this.bundleOffset*Math.cos(d),m.y=m.y+this.bundleOffset*Math.sin(d),p.push(m);var x=u.clone();x.transform(_.translationMatrix(0,-this.bundleGap*f)),x.x=x.x-this.bundleOffset*Math.cos(d),x.y=x.y-this.bundleOffset*Math.sin(d),p.push(x),p.push(u),i.push(p)}for(f=0;f<i.length;f++)t[f].refresh(i[f])},a.prototype.boundOffsetXY=function(t,e){var i=t.clone(),n=Math.atan2(i.y,i.x),o=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2));return e?o+=this.bundleOffset:o-=this.bundleOffset,i.x=o*Math.cos(n),i.y=o*Math.sin(n),i},a.prototype.setModel=function(t,e){var i=t.model.get("style.lineType");t.model.mergeOption(e),u.merge(t.model.get("options"),e,!0),i!==e.style.lineType&&this.refreshConnector(t,!0)},n.prototype.deleteByLine=function(t,e){if(t.startNode){var i=t.startNode.model.get("outgoing");if(-1!=(o=u.indexOf(i,t.resourceId))&&i.splice(o,1),this.connectorMap){var n=this.getTwoNodeId(t.startNode,t.endNode,t.options.position);this.connectorMap.removeItem(n,t)}}e.remove(t);var o=u.indexOf(this.connectors,t);-1!=o&&this.connectors.splice(o,1),this.selConnector===t&&(this.selConnector=null)},a.prototype.refreshLineByNode=function(t){for(var e=this.connectorMap.keys(),i=0;i<e.length;i++){var n=e[i];if(-1!=n.indexOf(t.id)){var o=this.connectorMap.get(n);this.countLinePos(o),1==o.length?this.refreshConnector(o[0],!0):1<o.length&&this.refreshCons(o)}}},a.prototype.toggleLineByNode=function(t,e){for(var i=this.connectorMap.keys(),n=0;n<i.length;n++){var o=i[n];if(-1!=o.indexOf(t.id)){var r=this.connectorMap.get(o);u.each(r,function(t){e?t.show():t.hide()})}}},a.prototype.countLinePos=function(t){u.each(t,function(t){var e=t.options;if(1==e.autoChangePosition){var i=_.getRect(t.startNode).boundingRect,n=_.getRect(t.endNode).boundingRect,o=e.position.startPos,r=e.position.endPos,s=this.posIsChange(o,i,n,"startNode"),a=this.posIsChange(r,i,n,"endNode");o==s&&r==a||(e.position.startPos=s,e.position.endPos=a)}},this)},a.prototype.posIsChange=function(t,e,i,n){return-1!=t.indexOf("top")||-1!=t.indexOf("bottom")?e.y+e.height<i.y?"startNode"==n?t.replace(/(top|bottom)/g,"bottom"):t.replace(/(top|bottom)/g,"top"):i.y+i.height<e.y?"endNode"==n?t.replace(/(top|bottom)/g,"bottom"):t.replace(/(top|bottom)/g,"top"):e.x+e.width<i.x?"startNode"==n?t.replace(/(top|bottom)/g,"right"):t.replace(/(top|bottom)/g,"left"):i.x+i.width<e.x?"endNode"==n?t.replace(/(top|bottom)/g,"right"):t.replace(/(top|bottom)/g,"left"):t:-1!=t.indexOf("left")||-1!=t.indexOf("right")?e.x+e.width<i.x?"startNode"==n?t.replace(/(right|left)/g,"right"):t.replace(/(right|left)/g,"left"):i.x+i.width<e.x?"endNode"==n?t.replace(/(right|left)/g,"right"):t.replace(/(right|left)/g,"left"):e.y+e.height<i.y?"startNode"==n?t.replace(/(right|left)/g,"bottom"):t.replace(/(right|left)/g,"top"):i.y+i.height<e.y?"endNode"==n?t.replace(/(right|left)/g,"bottom"):t.replace(/(right|left)/g,"top"):t:t},u.inherits(a,n),t.exports=a},function(t,e,i){var it=i(65),nt=i(66),ot=i(82),rt=i(92),st=i(5);function n(){this.connectors=[],this.selConnector=null,this.tempConnector=null}n.prototype.connectorForbidEdit=function(t){for(var e=0;e<this.connectors.length;e++)this.connectors[e].options.isEdit=!t;t&&this.removeConnectorEventListener()},n.prototype.removeConnectorEventListener=function(){0<this.connectors.length&&this.connectors.forEach(function(t){t.polyLine.off("mouseover"),t.polyLine.off("mousemove"),t.polyLine.off("mouseout"),t.curveLine.off("mouseover"),t.curveLine.off("mousemove"),t.curveLine.off("mouseout")})},n.prototype.clearSelectCon=function(){null!=this.selConnector&&this.refreshConnector(this.selConnector)},n.prototype.deleteSelectCon=function(t,e){for(var i=0;i<this.connectors.length;i++)if(this.connectors[i].startNode==t||this.connectors[i].endNode==t){var n=this.connectors[i].startNode.model.get("outgoing"),o=st.indexOf(n,this.connectors[i].resourceId);-1!=o&&n.splice(o,1),e.remove(this.connectors[i]),this.connectors.splice(i,1),i--,this.selConnector=null}},n.prototype.removeLine=function(t,e){this.selConnector=t,this.deleteLine(e)},n.prototype.deleteLine=function(t){if(this.selConnector.startNode){var e=this.selConnector.startNode.model.get("outgoing");if(-1!=(n=st.indexOf(e,this.selConnector.resourceId))&&e.splice(n,1),this.connectorMap){var i=this.getTwoNodeId(this.selConnector.startNode,this.selConnector.endNode,this.selConnector.options.position);this.connectorMap.removeItem(i,this.selConnector)}}t.remove(this.selConnector);var n=st.indexOf(this.connectors,this.selConnector);-1!=n&&this.connectors.splice(n,1),this.selConnector=null},n.prototype.refreshConnector=function(t,e){if(e||!t.turningPoints||t.turningPoints.length<2){t.model&&t.model.get("style.lineType")&&(t.options.style.lineType=t.model.get("style.lineType"));var i=this.getStartEndPoint(t),n=null;t.options.position&&t.options.position.escapeDistance&&(n=t.options.position.escapeDistance);var o=this.connector2Points(t.options.style.lineType,i[0],i[1],i[2],i[3],n);t.refresh(o[0][2])}t.clearHandles()},n.prototype.getStartEndPoint=function(t){var e,i=t.startNode,n=t.endNode;e=i.parent!==n.parent;var o=it.getRect(i,e).boundingRect,r=[Number(o.x),Number(o.y),Number(o.x)+Number(o.width),Number(o.y)+Number(o.height)],s=it.getRect(n,e).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)],h=it.getConnectorPoints(o,i),l=it.getConnectorPoints(s,n),c=t.options.position;if(c.direction){var u=c.direction.split(",");c.startPos=u[0],c.endPos=u[1]}c.startPos&&c.endPos||(o.x<s.x?(c.startPos="right",c.endPos="left"):(c.startPos="left",c.endPos="right"));var d=this.calcPointExpression(c.startPos,h),p=this.calcPointExpression(c.endPos,l);return d.add(new nt(c.startOffset[0],c.startOffset[1])),p.add(new nt(c.endOffset[0],c.endOffset[1])),[d,p,r,a]},n.prototype.calcPointExpression=function(t,e){var i={top:e.top.x,left:e.left.y,right:e.right.y,bottom:e.bottom.x,center:e.center.x},n="<% print("+t+") %>",o=parseInt(it.template(n)(i));if(-1!=t.indexOf("top"))return new nt(o,e.top.y);if(-1!=t.indexOf("left"))return new nt(e.left.x,o);if(-1!=t.indexOf("right"))return new nt(e.right.x,o);if(-1!=t.indexOf("bottom"))return new nt(o,e.bottom.y);if(-1!=t.indexOf("center"))return new nt(o,e.bottom.y);throw new Error("pos")},n.prototype.manageTempConnector=function(t,e,i,n,o,r){var s=null,a=null,h=it.getRect(t,!0).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)],c=it.getConnectorPoints(h,t);this.tempConnector||(this.tempConnector=new ot({isEdit:!1,style:{lineType:i}}));var u=this.tempConnector,d=u.options.position;d.startPos=n||(h.x<e.x?"right":"left"),d.endPos=o||(h.x<e.x?"left":"right"),u.options.style.lineType=i,r&&(s=it.getRect(r,!0).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)]);var p=this.connector2Points(i,c[d.startPos],e,l,a);return u.refresh(p[0][2]),u},n.prototype.manageReverseTempConnector=function(t,e,i,n,o,r){var s=null,a=null,h=it.getRect(e,!0).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)],c=it.getConnectorPoints(h,e);this.tempConnector||(this.tempConnector=new ot({isEdit:!1,style:{lineType:i}}));var u=this.tempConnector,d=u.options.position;d.endPos=n||(h.x<t.x?"right":"left"),d.startPos=o||(h.x<t.x?"left":"right"),u.options.style.lineType=i,r&&(s=it.getRect(r,!0).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)]);var p=this.connector2Points(i,t,c[d.endPos],a,l);return u.refresh(p[0][2]),u},n.prototype.removeTempConnector=function(t){this.tempConnector&&(t.remove(this.tempConnector),this.tempConnector=null)},n.prototype.connector2Points=function(t,e,i,n,o,r){var s=[30,30];r&&(s=st.isArray(r)?r:[r,r]),rt.group("connectionManager: connector2Points"),rt.info("ConnectionManager: connector2Points ("+t+", "+e+", "+i+", "+n+", "+o+")");var a=[];switch(t){case ot.TYPE_CHAIN:case ot.TYPE_STRAIGHT:var h=[e.clone(),i.clone()];a.push(["straight","straight",h]);break;case ot.TYPE_CURVE:case ot.TYPE_JAGGED:var l=null,c=null;if(null!=n){(d=[]).push(new nt(e.x,n[1]-s[0])),d.push(new nt(n[2]+s[0],e.y)),d.push(new nt(e.x,n[3]+s[0])),d.push(new nt(n[0]-s[0],e.y)),l=d[0];for(var u=1;u<d.length;u++)it.distance(e,d[u])<it.distance(e,l)&&(l=d[u])}if(null!=o){var d;(d=[]).push(new nt(i.x,o[1]-s[1])),d.push(new nt(o[2]+s[1],i.y)),d.push(new nt(i.x,o[3]+s[1])),d.push(new nt(o[0]-s[1],i.y)),c=d[0];for(u=1;u<d.length;u++)it.distance(i,d[u])<it.distance(i,c)&&(c=d[u])}var p=[e],f=0;l&&(p.push(l),f=1),c&&p.push(c),p.push(i);var g=nt.cloneArray(p);a.push(["s0","s0",g]);var y=nt.cloneArray(p),v=nt.cloneArray(y);v.splice(f+1,0,new nt(v[f].x,v[f+1].y)),a.push(["s1","s1_1",v]);var m=nt.cloneArray(y);m.splice(f+1,0,new nt(m[f+1].x,m[f].y)),a.push(["s1","s1_2",m]);var x=nt.cloneArray(p),_=new nt((x[f].x+x[f+1].x)/2,x[f].y),b=new nt((x[f].x+x[f+1].x)/2,x[f+1].y);x.splice(f+1,0,_,b),a.push(["s2","s2_1",x]);var w=nt.cloneArray(p),P=new nt(w[f].x,(w[f].y+w[f+1].y)/2),C=new nt(w[f+1].x,(w[f].y+w[f+1].y)/2);w.splice(f+1,0,P,C),a.push(["s2","s2_2",w]);var N=nt.cloneArray(p),T=[N[f].x+20,N[f+1].x+20];n&&T.push(n[2]+20),o&&T.push(o[2]+20);var S=it.max(T),M=new nt(S,N[f].y),R=new nt(S,N[f+1].y);N.splice(f+1,0,M,R),a.push(["s2","s2_3",N]);var A=nt.cloneArray(p),E=[A[f].y-20,A[f+1].y-20];n&&E.push(n[1]-20),o&&E.push(o[1]-20);var L=it.min(E),k=new nt(A[f].x,L),O=new nt(A[f+1].x,L);A.splice(f+1,0,k,O),a.push(["s2","s2_4",A]);var I=nt.cloneArray(p),z=[I[f].x-20,I[f+1].x-20];n&&z.push(n[0]-20),o&&z.push(o[0]-20);var B=it.min(z),D=new nt(B,I[f].y),H=new nt(B,I[f+1].y);I.splice(f+1,0,D,H),a.push(["s2","s2_5",I]);var G=nt.cloneArray(p),F=[G[f].y+20,G[f+1].y+20];n&&F.push(n[3]+20),o&&F.push(o[3]+20);var Y=it.max(F),W=new nt(G[f].x,Y),V=new nt(G[f+1].x,Y);G.splice(f+1,0,W,V),a.push(["s2","s2_6",G]),rt.info("Filter orthogonal solutions. Initial number of solutions = "+a.length);for(var U=[],j=0;j<a.length;j++){var q=a[j][2];it.orthogonalPath(q)&&U.push(a[j])}if(a=U,rt.info("\n\tOrthogonalSolutions = "+a.length),e.equals(i))rt.info("Start and end point coincide...skip backward solution. I think we will just fall on s0 :)");else{rt.info("Filter backward solutions. Initial number of solutions = "+a.length);var X=[],Z="";for(j=0;j<a.length;j++){q=a[j][2];it.forwardPath(q)?X.push(a[j]):Z=Z+"\n\t"+q}a=X,rt.info("\n\t ForwardSolutions = "+a.length),0==a.length&&rt.info("Discarded solutions: "+Z)}rt.info("Filter non intersecting solutions. Initial number of solutions = "+a.length);var J=[];for(j=0;j<a.length;j++){var Q=!1,K=(q=a[j][2]).slice();(o||n)&&(K=K.slice(1,K.length-1)),n&&(Q=Q||it.polylineIntersectsRectangle(K,n)),o&&(Q=Q||it.polylineIntersectsRectangle(K,o)),Q||J.push(a[j])}0!=J.length&&(a=J),rt.info("\n\t nonIntersectionSolutions = "+a.length),rt.info("Get first class of solutions with same nr of points"),0==a.length&&rt.info("This is not possible");var $=a[0][2].length,tt=[];for(j=0;j<a.length;j++){(q=a[j][2]).length==$&&tt.push(a[j])}a=tt,rt.info("pick the first solution with 90 degree angles (less turnarounds)");var et=0;for(j=0;j<a.length;j++){q=a[j][2];it.scorePath(a[et][2])<it.scorePath(a[j][2])&&(et=j)}a=[a[et]]}return t===ot.TYPE_CURVE&&this.smoothCurve(a),rt.groupEnd(),a},n.prototype.smoothCurve=function(t){st.each(t,function(t){if("s1"==t[0]){var e=t[2],i=it.collinearReduction(e);t[2]=i}})},t.exports=n},function(t,e){var i={LOG_LEVEL_NONE:0,LOG_LEVEL_DEBUG:1,LOG_LEVEL_INFO:2,LOG_LEVEL_ERROR:3,level:this.LOG_LEVEL_ERROR,debug:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_DEBUG&&"function"==typeof console.debug&&console.debug(t)},info:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_INFO&&console.info(t)},error:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_ERROR&&console.error(t)},group:function(t){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.group&&console.group(t)},groupEnd:function(){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.groupEnd&&console.groupEnd()}};i.level=i.LOG_LEVEL_ERROR,t.exports=i},function(t,e){t.exports={ELEMENT_TYPE:"elementType",MODE:"mode",BACKGROUND:"backgroud",OPTIONS:"options",USERDATA:"userData",ID:"id",START_ID:"startNodeId",END_ID:"endNodeId",ALARM:"Alarm",RELATIONID:"relationId",RELATION_IMAGE:"relationImage",GROUP:"Group",GROUP_NODE:"GroupNode",CONNECTION:"connection",CHILDS:"childs",TREE_ROOT:"treeRoot",DOCKERS:"options.dockers",STYLE_LINETYPE:"style.lineType",LINEOPERATIONICON:"LineOperationIcon",DEL:"DEL",LINK:"straight",FOLD:"jagged",CURVE:"curve"}},function(t,e,i){var f=i(93),g=i(5),o=i(95),n=i(97),r=i(98),s=i(99),a=i(100),h=i(101),l=i(102),c=i(103),u=i(104),d=i(105),p=i(106),y=i(107),v=i(108),m=i(109),x=i(110),_=i(111),b=i(112),w=i(113),P=i(114),C=i(115),N=i(116),T=i(82),S=i(117);function M(t,e){var i=null;return t.forEach(function(t){t.id===e&&(i=t)}),i}function R(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function A(t,e){return"{"+t+(null==e?"":e)+"}"}var E,L=(E=0,function(){var e="\0__topo_prop_getter_"+E++;return function(t){return t[e]||(t[e]={})}}),k=["a","b","c","d","e","f","g"];t.exports={toJson:function(t,e){var i=[];e.eachChild(function(t){if(t.model){if(t instanceof o){var e=[];t.eachChild(function(t){t.model&&(t instanceof T?t.refreshModel():t.model.set("options.position",t.position),e.push(t.model.option))}),t.model.set(f.CHILDS,e)}t instanceof T&&t.refreshModel(),i.push(t.model.option)}}),t.set(f.CHILDS,i);var n=Object.assign({},t.option);return n.childs.forEach(function(t){t.options&&t.options.style&&t.options.style.host&&delete t.options.style.host}),n},fromJson:function t(r,s,e,a,i,h){for(var n=[],o=0;o<e.length;o++){var l=e[o];if(l.elementType===f.CONNECTION)n.push(l);else if(l.elementType===f.ALARM){var c=M(r.allNodes,l.relationId);r.createAlarm(c,l.options)}else if(l.elementType===f.GROUP_NODE||l.elementType===f.GROUP){var u=r.createNode(f.GROUP,l.options,l.userData);l.childs&&t(r,u,l.childs,!0,i,h),a?s.add(u):r.addNode(u,{},h)}else{var d=r.createNode(l.elementType,l.options,l.userData);if(a?s.add(d):r.addNode(d,{},h),l.options.layout&&l.options.layout.layout===f.TREE_ROOT){var p=M(r.allNodes,l.id);i.push(p)}}}g.each(n,function(t){var e=M(r.allNodes,t.startNodeId),i=M(r.allNodes,t.endNodeId);if(e&&i){var n=r.createLink(e,i,t.options,t.userData);a?s.add(n):r.addNode(n,{},h)}else{var o=S.Link.createByPoint(t.options,t.userData);a?s.add(o):r.addNode(o,{},h)}})},toDataURL:function(t,e){var i=function(t,e){(e=e||{}).pixelRatio=e.pixelRatio||1,e.backgroundColor=e.backgroundColor||"#FFFFFF";var i=t.storage.getDisplayList();return g.each(i,function(t){for(var e=t.animators,i=e.length,n=0;n<i;n++)e[n].stop(!1)}),t.painter.getRenderedCanvas(e)}(t,e=e||{}).toDataURL("image/"+(e&&e.type||"png")),n=t.storage.getDisplayList();return g.each(n,function(t){for(var e=t.animators,i=e.length,n=0;n<i;n++)e[n].start()}),i},truncPosition:function(t){var e=parseInt(t[0],10),i=parseInt(t[1],10);return e<0&&(e=0),i<0&&(i=0),[e,i]},registerFlowNode:function(t){var e={Rect:n,Circle:r,Image:s,Text:a,Sector:h,Ring:l,Ellipse:c,Heart:u,Droplet:d,Rose:p,Isogon:y,Polygon:v,Line:m,Polyline:x,BezierCurve:_,Arc:b,Star:w,Trochoid:P,Path:C,Group:o,IconButton:N};for(var i in e)t[i]=e[i];return t},normalizeCssArray:function(t){var e=t.length;return"number"==typeof t?[t,t,t,t]:2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t},parsePercent:function(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return"string"==typeof t?function(t){return t.replace(/^\s+/,"").replace(/\s+$/,"")}(t).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t},toCamelCase:function(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t},makeGetter:L,formatTpl:function(t,e,i){g.isArray(e)||(e=[e]);var n=e.length;if(!n)return"";for(var o=e[0].$vars||[],r=0;r<o.length;r++){var s=k[r],a=A(s,0);t=t.replace(A(s),i?R(a):a)}for(var h=0;h<n;h++)for(var l=0;l<o.length;l++){var c=e[h][o[l]];t=t.replace(A(k[l],h),i?R(c):c)}return t},findNodeById:M}},function(t,e,i){var _=i(5),o=i(27),n=i(4),s=i(65),b=i(82),r=i(96);function w(t){this.model=r.genModel("GroupNode",t),n.Group.call(this,t);this.options=_.merge({shape:{width:5,height:5,r:5},style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)"},position:[0,0]},t,!0),this.options.layout=t.layout,this.max=[1024,960],this.render(this.options)}w.RECT_NAME="GROUP_RECT_NAME",w.prototype={constructor:w,type:"GroupNode",render:function(t){var e=new n.Rect({shape:t.shape,style:t.style,z:1});e.name=w.RECT_NAME,this.add(e),this.position=t.position,this.mergedImage=t.mergedImage},rectContain:function(t,e){return s.getRect(this).boundingRect.contain(t,e)},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this._api&&this._api._addGroupNode(this,t),this},each:function(t,e){for(var i=this._children,n=0;n<i.length;n++){var o=i[n];o.name!=w.RECT_NAME&&t.call(e,o,n)}return this},willRender:function(t){this.options.layout&&this.setLayout(this.options.layout),this.setProperties({shape:{width:this.getBoundingRect().width,height:this.getBoundingRect().height}}),this._api=t},setLayout:function(t){t.run(this)},getRect:function(){var t=this.getBoundingRect(),e=this.clipPath;e&&(t=e.getBoundingRect());var i=[];i[0]=[-t.width/2,-t.height/2],i[1]=[t.width/2,-t.height/2],i[2]=[t.width/2,t.height/2],i[3]=[-t.width/2,t.height/2],i[4]=[-t.width/2,-t.height/2];var n=new o(this.position[0],this.position[1],t.width,t.height);return{x:this.position[0]+t.width/2,y:this.position[1]+t.height/2,width:t.width,height:t.height,points:i,boundingRect:n}},modifyGroupRect:function(t){var e=this.options.shape.r;this.setProperties({shape:{width:e,height:e,r:e}});var i=_.clone(t.position),n=this.getBoundingRect(),o=n.width,r=n.height,s={x:0,y:0};t.node instanceof w&&(s=t.node.childOfName(w.RECT_NAME).shape);for(var a=(i=[i[0]+s.x,i[1]+s.y])[0],h=i[1],l=i[0],c=i[1],u=t.node,d=t.node,p=1;p<this._children.length;p++)if(!(this._children[p]instanceof b||1==this._children[p].isIcon||this._children[p].name===w.RECT_NAME)){var f=_.clone(this._children[p].position);if(this._children[p]instanceof w){var g=_.clone(this._children[p].childOfName(w.RECT_NAME).shape);f=[f[0]+g.x,f[1]+g.y]}a>this._children[p].position[0]&&(a=this._children[p].position[0]),l<this._children[p].position[0]&&(l=this._children[p].position[0],u=this._children[p]),h>this._children[p].position[1]&&(h=this._children[p].position[1]),c<this._children[p].position[1]&&(c=this._children[p].position[1],d=this._children[p])}if(this.shape&&this.shape.width&&this.shape.height){var y=t.node.getBoundingRect();if(o=this.shape.width,r=this.shape.height,a<0){o+=Math.abs(a),i[0]=a;var v=u.getBoundingRect();l+v.width+Math.abs(a)>o&&(o+=l+v.width+Math.abs(a)-o)}if(h<0){r+=Math.abs(h),i[1]=h;var m=d.getBoundingRect();c+m.height+Math.abs(h)>r&&(r+=c+m.height+Math.abs(h)-r)}o<l&&(o=l+u.getBoundingRect().width),r<c&&(r=c+d.getBoundingRect().height),y.width+i[0]>o&&(o=y.width+i[0]),y.height+i[1]>r&&(r=y.height+i[1])}if(t.node.alarm){var x=[i[0]+t.node.getBoundingRect().width-(t.node.alarm.getBoundingRect().width-6),i[1]-t.node.alarm.getBoundingRect().height-3];t.node.alarm.attr("position",x)}this.setProperties({shape:{width:o,height:r,x:i[0]<0?i[0]:0,y:i[1]<0?i[1]:0}})},setProperties:function(t){this.childOfName(w.RECT_NAME).setShape(t.shape),this.attr("position",t.position)},getparentIgnore:function(t){return!!t.parent&&(!1!==t.parent.ignore||this.getparentIgnore(t.parent))},showChildrenRelationImage:function(t){var e=this;t._children.forEach(function(t){t._relationImage&&!0===t.ignore&&!e.getparentIgnore(t)&&t._relationImage.show(),t instanceof w&&e.showChildrenRelationImage(t)})},hideChildrenRelationImage:function(t){var e=this;t._children.forEach(function(t){t._relationImage&&t._relationImage.hide(),t instanceof w&&e.hideChildrenRelationImage(t)})},calculateRelationImage:function(t){var e=t._relationImage.getRect?t._relationImage.getBoundingRect():s.getRect(t._relationImage),i=e.width||30,n=e.height||30,o=_.clone(t.position),r=_.clone(t.childOfName(w.RECT_NAME).shape);return t.parent&&t.parent instanceof w&&(o[0]+=s.getParentX(t.parent),o[1]+=s.getParentY(t.parent)),{width:i,height:n,position:[o[0]+r.x+(r.width/2-i/2),o[1]+r.y+(r.height/2-n/2)]}},calculateGroupNode:function(){var t=_.clone(this._relationImage.position),e=this._relationImage.getRect?this._relationImage.getBoundingRect():s.getRect(this._relationImage),i=_.clone(this.childOfName(w.RECT_NAME).shape),n=e.width||30,o=e.height||30,r=[];return r=[t[0]-i.x-(i.width/2-n/2),t[1]-i.y-(i.height/2-o/2)],this.parent&&this.parent instanceof w&&(r[0]-=s.getParentX(this.parent),r[1]-=s.getParentY(this.parent)),r},refreshRelationImage:function(){var i=this,n=function(t){t instanceof w&&t._children.forEach(function(t){if(t instanceof w){if(t.ignore&&t._relationImage){var e=i.calculateRelationImage(t);t._relationImage.attr("position",e.position)}n(t)}})};n(this)},merged:function(t){var e=this,i=this.calculateRelationImage(this),n=i.width,o=i.height,r=i.position;return this._relationImage.attr("style",{image:this.mergedImage,width:n,height:o}),this._relationImage.attr("position",r),0<n&&0<o&&(this.hide(),this.hideChildrenRelationImage(this),this._relationImage.show(),t&&t._createRelationImageLine(this._relationImage,this)),this._relationImage.on("dblclick",function(){e.attr("position",e.calculateGroupNode()),this.hide(),e.show(),e.showChildrenRelationImage(e),t&&(t._removeRelationImageLine(this),t.toggleAllConNodeLine(e,"show"),t._recureRefreshLine(e))}),this._relationImage},updateShape:function(n,o){var r=Number(n),t=this.options.shape,e=Number(t.width*r),i=Number(e*t.height/t.width);o&&(e=parseInt(e,10),i=parseInt(i,10)),this.setProperties({shape:{width:e,height:i}}),this.children().forEach(function(t){var e=t.position;if(t.name===w.RECT_NAME||t instanceof b||"ZPath"===t.type){if("ZPath"===t.type){var i=t.rect;i.height=i.height*r,i.width=i.width*r,t.attr({position:[e[0]*r,e[1]*r],rect:i})}}else t.updateShape(n,o),t.attr("position",[e[0]*r,e[1]*r])})}},_.inherits(w,n.Group),t.exports=w},function(t,e,i){"use strict";var r=i(7),n=i(93),s=i(5),o=i(65),a=i(87),h={genModel:function(t,e){var i=new a({});return e.id||(e.id=o.getUUID()),e.style&&0!==e.style.textLineHeight&&!e.style.rich&&(e.style.rich={}),i.set(n.ELEMENT_TYPE,t),e.style&&e.style.host&&delete e.style.host,i.set(n.OPTIONS,s.clone(e)),"draggable"in e&&(e.isdraggable=e.draggable,delete e.draggable),e.z||(e.z=1),o.isUndefined(e.hoverAnimation)&&(e.hoverAnimation=!1),o.isUndefined(e.selectable)&&(e.selectable=!0),i},addHoverAnimation:function(t){function e(){this.animateTo({scale:[1.1*n[0],1.1*n[1]]},400,"elasticOut")}function i(){this.animateTo({scale:n},400,"elasticOut")}var n=s.clone(t.scale)||[1,1];t.on("mouseover",e).on("mouseout",i).on("emphasis",e).on("normal",i)}};h.extend=function(o){function t(t){this.model=h.genModel(o.type,t),r.call(this,t),o.style&&this.style.extendFrom(o.style,!1);var e=o.shape;if(e){this.shape=this.shape||{};var i=this.shape;for(var n in e)!i.hasOwnProperty(n)&&e.hasOwnProperty(n)&&(i[n]=e[n])}o.init&&o.init.call(this,t)}for(var e in s.inherits(t,r),o)"style"!==e&&"shape"!==e&&(t.prototype[e]=o[e]);return t.prototype.setStyle=function(t,e){var i={};return"string"==typeof t&&e?i[t]=e:i=t,this.style.set(t,e),this.dirty(!1),s.merge(this.model.get("options.style"),i,!0),this},t},t.exports=h},function(t,e,i){var o=i(29);t.exports=i(96).extend({type:"Rect",shape:{x:0,y:0,r:0,width:50,height:50},buildPath:function(t,e){var i=e.width,n=e.height;e.r?o.buildPath(t,e):t.rect(0,0,i,n),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({width:o,height:r})}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Circle",shape:{r:20},buildPath:function(t,e,i){i&&t.moveTo(e.r,0),t.arc(0,0,e.r,0,2*Math.PI,!0)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){var n=i(8),o=i(27),r=i(5),s=i(96),v=new(i(21))(50);function a(t){this.model=s.genModel("Image",t),n.call(this,t),window.jQuery&&(this.resultDeferrd=jQuery.Deferred(),this.result=this.resultDeferrd.promise())}a.prototype={constructor:a,type:"Image",brush:function(t,e){var i,n=this.style,o=n.image;if(n.bind(t,this,e),"string"==typeof o?(i=this._image)&&i.src!==o&&(i=null):(i=o).isLoaded=!0,!i&&o){var r=v.get(o);if(!r)return(i=new Image).isLoaded=!1,i.onload=function(){i.isLoaded=!0,i.onload=null;for(var t=0;t<r.pending.length;t++)r.pending[t].dirty()},r={image:i,pending:[this]},i.src=o,v.put(o,r),void(this._image=i);if(i=r.image,!((this._image=i).width&&i.height||i.src.endsWith("svg")))return void r.pending.push(this)}if(i){var s=n.x||0,a=n.y||0;if(!i.isLoaded)return void(window.jQuery&&this.resultDeferrd.reject(i));var h=n.width,l=n.height,c=i.width/i.height;if(null==h&&null!=l?h=l*c:null==l&&null!=h?l=h/c:null==h&&null==l&&(h=i.width,l=i.height),this.setTransform(t),n.sWidth&&n.sHeight){var u=n.sx||0,d=n.sy||0;t.drawImage(i,u,d,n.sWidth,n.sHeight,s,a,h,l)}else if(n.sx&&n.sy){var p=n.sx,f=n.sy,g=h-p,y=l-f;t.drawImage(i,p,f,g,y,s,a,h,l)}else t.drawImage(i,s,a,h,l);null==n.width&&(n.width=h),null==n.height&&(n.height=l),this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect()),window.jQuery&&this.resultDeferrd.resolve(i)}},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new o(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect},updateShape:function(t,e){var i=Number(t),n=this.style,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setStyle({width:o,height:r})},setStyle:function(t,e){var i={};return"string"==typeof t&&e?i[t]=e:i=t,this.style.set(t,e),this.dirty(!1),r.merge(this.model.get("options.style"),i,!0),this}},r.inherits(a,n),t.exports=a},function(t,e,i){var n=i(46),o=i(5),r=i(96);function s(t){var e=o.merge({style:{textBaseline:"top"}},t,!0);this.model=r.genModel("Text",e),n.call(this,e)}s.prototype={constructor:s,type:"Text",updateShape:function(){}},o.inherits(s,n),t.exports=s},function(t,e,i){var n=i(50),a=i(7),h=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]];t.exports=i(96).extend({type:"Sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:n.browser.ie&&11<=n.browser.version?function(){var t,e=this.__clipPaths,i=this.style;if(e)for(var n=0;n<e.length;n++){var o=e[n]&&e[n].shape;if(o&&o.startAngle===o.endAngle){for(var r=0;r<h.length;r++)h[r][2]=i[h[r][0]],i[h[r][0]]=h[r][1];t=!0;break}}if(a.prototype.brush.apply(this,arguments),t)for(var s=0;s<h.length;s++)i[h[s][0]]=h[s][2]}:a.prototype.brush,buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r0||0,0),r=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,h=e.clockwise,l=Math.cos(s),c=Math.sin(s);t.moveTo(l*o+i,c*o+n),t.lineTo(l*r+i,c*r+n),t.arc(i,n,r,s,a,!h),t.lineTo(Math.cos(a)*o+i,Math.sin(a)*o+n),0!==o&&t.arc(i,n,o,a,s,h),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i),r=Number(n.r0*i);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({r:o,r0:r})}})},function(t,e,i){t.exports=i(96).extend({type:"Ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,o,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,o,!0)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i),r=Number(n.r0*i);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({r:o,r0:r})}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Ellipse",shape:{rx:0,ry:0},buildPath:function(t,e){var i=e.rx,n=e.ry,o=.5522848*i,r=.5522848*n;t.moveTo(0-i,0),t.bezierCurveTo(0-i,0-r,0-o,0-n,0,0-n),t.bezierCurveTo(0+o,0-n,0+i,0-r,0+i,0),t.bezierCurveTo(0+i,0+r,0+o,0+n,0,0+n),t.bezierCurveTo(0-o,0+n,0-i,0+r,0-i,0),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.rx*i),r=Number(o*n.ry/n.rx);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({rx:o,ry:r})}})},function(t,e,i){t.exports=i(96).extend({type:"Heart",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width,r=e.height;t.moveTo(i,n),t.bezierCurveTo(i+o/2,n-2*r/3,i+2*o,n+r/3,i,n+r),t.bezierCurveTo(i-2*o,n+r/3,i-o/2,n-2*r/3,i,n)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({width:o,height:r})}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Droplet",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width,r=e.height;t.moveTo(i,n+o),t.bezierCurveTo(i+o,n+o,i+3*o/2,n-o/3,i,n-r),t.bezierCurveTo(i-3*o/2,n-o/3,i-o,n+o,i,n+o),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({width:o,height:r})}})},function(t,e,i){var p=Math.sin,f=Math.cos,g=Math.PI/180;t.exports=i(96).extend({type:"Rose",shape:{cx:0,cy:0,r:[],k:0,n:1},style:{stroke:"#000",fill:null,lineWidth:2},buildPath:function(t,e){var i,n,o,r=e.r,s=e.k,a=e.n,h=e.cx,l=e.cy;t.moveTo(h,l);for(var c=0,u=r.length;c<u;c++){o=r[c];for(var d=0;d<=360*a;d++)i=o*p(s/a*d%360*g)*f(d*g)+h,n=o*p(s/a*d%360*g)*p(d*g)+l,t.lineTo(i,n)}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=[];n.r.forEach(function(t){o.push(Number(t*i))}),e&&o.forEach(function(t){t=parseInt(t,10)}),this.setShape({r:o})}})},function(t,e,i){var c=Math.PI,u=Math.sin,d=Math.cos;t.exports=i(96).extend({type:"Isogon",shape:{x:0,y:0,r:0,n:0},buildPath:function(t,e){var i=e.n;if(i&&!(i<2)){var n=e.x,o=e.y,r=e.r,s=2*c/i,a=-c/2;t.moveTo(n+r*d(a),o+r*u(a));for(var h=0,l=i-1;h<l;h++)a+=s,t.lineTo(n+r*d(a),o+r*u(a));t.closePath()}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){var n=i(53);t.exports=i(96).extend({type:"Polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){n.buildPath(t,e,!0)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=[];n.points.forEach(function(t){o.push([Number(t[0]*i),Number(t[1]*i)])}),e&&o.forEach(function(t){t[0]=parseInt(t[0],10),t[1]=parseInt(t[1],10)}),this.setShape({points:o})}})},function(t,e,i){t.exports=i(96).extend({type:"Line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,s=e.percent;0!==s&&(t.moveTo(i,n),s<1&&(o=i*(1-s)+o*s,r=n*(1-s)+r*s),t.lineTo(o,r))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.x1*i),r=Number(n.x2*i),s=Number(n.y1*i),a=Number(n.y2*i);e&&(o=parseInt(o,10)),this.setShape({x1:o,y1:s,x2:r,y2:a})}})},function(t,e,i){"use strict";var n=i(53);t.exports=i(96).extend({type:"Polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){n.buildPath(t,e,!1)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=[];n.points.forEach(function(t){o.push([Number(t[0]*i),Number(t[1]*i)])}),e&&o.forEach(function(t){t[0]=parseInt(t[0],10),t[1]=parseInt(t[1],10)}),this.setShape({points:o})}})},function(t,e,i){"use strict";var n=i(31),o=i(15),u=n.quadraticSubdivide,d=n.cubicSubdivide,r=n.quadraticAt,s=n.cubicAt,a=n.quadraticDerivativeAt,h=n.cubicDerivativeAt,p=[];function l(t,e,i){var n=t.cpx2,o=t.cpy2;return null===n||null===o?[(i?h:s)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?h:s)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?a:r)(t.x1,t.cpx1,t.x2,e),(i?a:r)(t.y1,t.cpy1,t.y2,e)]}t.exports=i(96).extend({type:"BezierCurve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,s=e.cpx1,a=e.cpy1,h=e.cpx2,l=e.cpy2,c=e.percent;0!==c&&(t.moveTo(i,n),null==h||null==l?(c<1&&(u(i,s,o,c,p),s=p[1],o=p[2],u(n,a,r,c,p),a=p[1],r=p[2]),t.quadraticCurveTo(s,a,o,r)):(c<1&&(d(i,s,h,o,c,p),s=p[1],h=p[2],o=p[3],d(n,a,l,r,c,p),a=p[1],l=p[2],r=p[3]),t.bezierCurveTo(s,a,h,l,o,r)))},pointAt:function(t){return l(this.shape,t,!1)},tangentAt:function(t){var e=l(this.shape,t,!0);return o.normalize(e,e)},updateShape:function(t,e){var i=Number(t),n=this.shape,o={};Object.keys(n).forEach(function(t){var e=n[t];o[t]="percent"!==t?Number(e*i):e}),e&&Object.keys(o).forEach(function(t){o[t]=parseInt(o[t],10)}),this.setShape(o)}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r,0),r=e.startAngle,s=e.endAngle,a=e.clockwise,h=Math.cos(r),l=Math.sin(r);t.moveTo(h*o+i,l*o+n),t.arc(i,n,o,r,s,!a)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){"use strict";var f=Math.PI,g=Math.cos,y=Math.sin;t.exports=i(96).extend({type:"Star",shape:{cx:0,cy:0,n:3,r0:null,r:0},buildPath:function(t,e){var i=e.n;if(i&&!(i<2)){var n=e.cx,o=e.cy,r=e.r,s=e.r0;null==s&&(s=4<i?r*g(2*f/i)/g(f/i):r/3);var a=f/i,h=-f/2,l=n+r*g(h),c=o+r*y(h);h+=a,t.moveTo(l,c);for(var u,d=0,p=2*i-1;d<p;d++)u=d%2==0?s:r,t.lineTo(n+u*g(h),o+u*y(h)),h+=a;t.closePath()}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){"use strict";var g=Math.cos,y=Math.sin;t.exports=i(96).extend({type:"Trochoid",shape:{cx:0,cy:0,r:0,r0:0,d:0,location:"out"},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i,n,o,r,s=e.r,a=e.r0,h=e.d,l=e.cx,c=e.cy,u="out"==e.location?1:-1;if(!(e.location&&s<=a)){var d,p=0,f=1;for(i=(s+u*a)*g(0)-u*h*g(0)+l,n=(s+u*a)*y(0)-h*y(0)+c,t.moveTo(i,n);a*++p%(s+u*a)!=0;);for(;d=Math.PI/180*f,o=(s+u*a)*g(d)-u*h*g((s/a+u)*d)+l,r=(s+u*a)*y(d)-h*y((s/a+u)*d)+c,t.lineTo(o,r),++f<=a*p/(s+u*a)*360;);}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i),r=Number(n.r0*i),s=Number(n.d*i);o=parseInt(o,10),r=parseInt(r,10),s=parseInt(s,10),this.setShape({r:o,r0:r,d:s})}})},function(t,e,i){var d=i(6),p=i(43),f=i(5),g=i(96);function n(t){var e=t.pathData,i=g.genModel("Path",t);delete t.pathData,this.options=f.merge({style:{fill:"none",stroke:"#2c2c2c"},rect:{x:0,y:0,width:0,height:0},rectHover:!0},t,!0);var n=d.createFromString(e,this.options);n.model=i,p.call(n);var o=n.getBoundingRect(),r=this.options.rect,s=t.layout;if(r){var a=o.width/o.height;if("center"===s){var h,l=r.height*a;h=l<=r.width?r.height:(l=r.width)/a;var c=r.x+r.width/2,u=r.y+r.height/2;r.x=c-l/2,r.y=u-h/2,r.width=l,r.height=h}this.resizePath(n,r)}return n.type="ZPath",n}n.prototype={constructor:n,type:"ZPath",resizePath:function(t,e){if(t.applyTransform){var i=t.getBoundingRect().calculateTransform(e);t.applyTransform(i)}},updateShape:function(t,e){var i=Number(t),n=this.rect,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),n.width=o,n.height=r,this.attr("rect",n)}},f.inherits(n,p),t.exports=n},function(t,e,i){var n=i(5),s=i(4),o=i(96);function r(t){this.options=n.merge({backgroundColor:"transparent",borderColor:"#ccc",draggable:!1,selectable:!1,borderWidth:0,itemSize:15,showTitle:!0,icon:"",iconStyle:{normal:{stroke:"#666",fill:"none"},emphasis:{stroke:"#3E98c5"}}},t,!0),this.model=o.genModel("IconButton",this.options),s.Group.call(this,this.options),this.render()}r.prototype={constructor:r,type:"IconButton",render:function(){var t=this.options.iconStyle.normal,e=this.options.iconStyle.emphasis,i=this.options.itemSize,n=this.options.icon,o={x:-i/2,y:-i/2,width:i,height:i},r=0===n.indexOf("image://")?(o.image=n.slice(8),new s.Image({style:o})):s.makePath(n.replace("path://",""),{style:t,hoverStyle:e,rectHover:!0},o,"center");s.setHoverStyle(r),this.options.showTitle&&(r.__title=this.options.title,r.on("mouseover",function(){r.setStyle({text:this.options.title,textPosition:e.textPosition||"bottom",textFill:e.fill||e.stroke||"#000",textAlign:e.textAlign||"center"})}.bind(this)).on("mouseout",function(){r.setStyle({textFill:null})})),r.trigger("normal"),this.add(r)}},n.inherits(r,s.Group),t.exports=r},function(t,e,i){"use strict";var n=i(118),o=i(120),r=i(121),s=i(122),a=i(82),h={};h.Link=h[a.TYPE_STRAIGHT]=n,h.Fold=h[a.TYPE_JAGGED]=o,h.Curve=h[a.TYPE_CURVE]=r,h.Chain=h[a.TYPE_CHAIN]=s,t.exports=h},function(t,e,i){var r=i(82),s=i(119);function n(t,e,i){var n=s.translateLinkOptions(i),o=new r(n);return o.startNode=t,o.endNode=e,o}n.createByPoint=function(t){var e=s.translateLinkOptions(t);return new r(e)},t.exports=n},function(t,e,i){var n=i(93),o=i(95),r=i(65),s={FLOW_TYPE:"elementType",LINK:"connection",RECT:"Rect",Group:"Group",IMAGE:"Image",TEXT:"Text",CIRCLE:"Circle",SECTOR:"Sector",RING:"Ring",POLYGON:"Polygon",POLYLINE:"Polyline",LINE:"Line",BEZIERCURVE:"Beziercurve",ARC:"Arc",SCENE:"scene",setUserData:function(t,e){t.model.set(n.USERDATA,e)},getUserData:function(t){var e=t.model.get(n.USERDATA);return r.isUndefined(e)&&(e={}),e},isLink:function(t){return t.get(s.FLOW_TYPE)==s.LINK},isNode:function(t){var e=t.get(s.FLOW_TYPE);return e!=s.LINK&&e!=s.SCENE},isInGroup:function(t){return t.parent&&t.parent instanceof o},isGroupNode:function(t){return t instanceof o},parentX:function(t){return t.parent&&s.isGroupNode(t.parent)?t.position[0]+s.parentX(t.parent):t.position[0]},parentY:function(t){return t.parent&&s.isGroupNode(t.parent)?t.position[1]+s.parentY(t.parent):t.position[1]},isRect:function(t){return t.get(s.FLOW_TYPE)==s.RECT},isImage:function(t){return t.get(s.FLOW_TYPE)==s.IMAGE},isText:function(t){return t.get(s.FLOW_TYPE)==s.TEXT},isCircle:function(t){return t.get(s.FLOW_TYPE)==s.CIRCLE},getType:function(t){return t.get(s.FLOW_TYPE)},translateLinkOptions:function(t){if(t){if(t.pos){var e=t.pos.split(",");2<=e.length&&(t.position||(t.position={}),t.position.startPos=e[0],t.position.endPos=e[1])}t.text&&t.text.color&&(t.text.textFill=t.text.color)}return t}};t.exports=s},function(t,e,i){var r=i(82),s=i(5),a=i(119);function n(t,e,i){var n=s.merge({style:{lineType:r.TYPE_JAGGED}},i,!0);n=a.translateLinkOptions(n);var o=new r(n);return o.startNode=t,o.endNode=e,o}n.createByPoint=function(t){var e=s.merge({style:{lineType:r.TYPE_JAGGED}},t,!0);return e=a.translateLinkOptions(e),new r(e)},t.exports=n},function(t,e,i){var r=i(82),s=i(5),a=i(119);function n(t,e,i){var n=s.merge({style:{lineType:r.TYPE_CURVE}},i,!0);n=a.translateLinkOptions(n);var o=new r(n);return o.startNode=t,o.endNode=e,o}n.createByPoint=function(t){var e=s.merge({style:{lineType:r.TYPE_CURVE}},t,!0);return e=a.translateLinkOptions(e),new r(e)},t.exports=n},function(t,e,i){var r=i(82),s=i(119);function n(t,e,i){i.style.lineType=r.TYPE_CHAIN;var n=s.translateLinkOptions(i),o=new r(n);return o.startNode=t,o.endNode=e,o}n.createByPoint=function(t){var e=s.translateLinkOptions(t);return new r(e)},t.exports=n},function(t,e,i){var n=i(83),l=i(5),o=i(89);function r(t,e){this.lineOperations=[],this.isEdit=!0,this.connectionManager=t,this._api=e}r.prototype.addIcon=function(e,t){if(!l.find(t.lineNode.icons,function(t){return t.key===e})){var i=this.creatOperation(e,t);return this._api._getParentZr().add(i),this.bindOperation(t.lineNode),i}this.bindOperation(t.lineNode)},r.prototype.creatOperation=function(t,i){var e=n.createSymbol(i.iconPath,0,0,i.width||15,i.height||15,0,i.color||"#aaaaac");return e.key=t,e._width=i.width||15,e._isLineOperationIcon=!0,e.hide(),i.lineNode.icons.push(e),this.lineOperations.push(e),e.on("click",function(t){if(i.callback)t.data=i,t.lineNode=i.lineNode,i.callback(t);else{var e={};e.event=t,e.type="click",e.elementType="LineOperationIcon",this._api.trigger(e.type,e)}}.bind(this)),e},r.prototype.bindOperation=function(o){if(0!=this.isEdit){var r,s,t=o.middle();s=o.parent&&"SubProcess"==o.parent.nodeType?(r=t[0]+function t(e){return e.parent&&"SubProcess"==e.parent.nodeType?e.position[0]+t(e.parent):e.position[0]}(o.parent),t[1]+function t(e){return e.parent&&"SubProcess"==e.parent.nodeType?e.position[1]+t(e.parent):e.position[1]}(o.parent)):(r=t[0],t[1]);var a=l.map(o.icons,function(t){return t._width}),h=l.reduce(a,function(t,e){return t+e+10},0);l.each(o.icons,function(t,e){for(var i=0,n=0;n<e;n++)i+=a[n]+10;t.attr("position",[r+i-h/2,s+5]),t.show(),t.attachLine=o})}},r.prototype.hideAllLineOperation=function(){l.each(this.lineOperations,function(t){t.hide()})},r.prototype.addDeleteIcon=function(t,e){var i=l.defaults({iconPath:"path://"+o.DEL_SVG,width:12,height:14,lineNode:t,callback:function(t){this._api.remove(t.target.attachLine)}.bind(this)},e,!0);this.addIcon("delete",i)},r.prototype.addChangeLineTypeIcon=function(t,e){var i=l.defaults({iconPath:"path://"+o.CHANGE_LINE_TYPE_SVG,width:15,height:15,lineNode:t,callback:function(){this._api.changeSelectConnectorType()}.bind(this)},e,!0);this.addIcon("change",i)},t.exports=r},function(t,e,i){"use strict";var g=i(27),p=i(5),y=i(94),n=i(125),o=i(126),r=i(127),s=i(130),v=y.parsePercent,a=i(128),f={};f.HLayout=n,f.VLayout=o,f.TreeLayout=r,f.ForceLayout=s,f.Tree=a,f.addCustomLayout=function(t){f.customLayout=t},f.getLayoutRect=function(t,e,i){i=y.normalizeCssArray(i||0);var n=e.width,o=e.height,r=v(t.left,n),s=v(t.top,o),a=v(t.right,n),h=v(t.bottom,o),l=v(t.width,n),c=v(t.height,o),u=i[2]+i[0],d=i[1]+i[3],p=t.aspect;switch(isNaN(l)&&(l=n-a-d-r),isNaN(c)&&(c=o-h-u-s),isNaN(l)&&isNaN(c)&&(n/o<p?l=.8*n:c=.8*o),null!=p&&(isNaN(l)&&(l=p*c),isNaN(c)&&(c=l/p)),isNaN(r)&&(r=n-a-l-d),isNaN(s)&&(s=o-h-c-u),t.left||t.right){case"center":r=n/2-l/2-i[3];break;case"right":r=n-l-d}switch(t.top||t.bottom){case"middle":case"center":s=o/2-c/2-i[0];break;case"bottom":s=o-c-u}r=r||0,s=s||0,isNaN(l)&&(l=n-r-(a||0)),isNaN(c)&&(c=o-s-(h||0));var f=new g(r+i[3],s+i[0],l,c);return f.margin=i,f},f.positionElement=function(t,e,i,n,o){var r=!o||!o.hv||o.hv[0],s=!o||!o.hv||o.hv[1],a=o&&o.boundingMode||"all";if(r||s){var h;if("raw"===a)h="group"===t.type||"GroupNode"===t.type?new g(0,0,+e.width||0,+e.height||0):t.getBoundingRect();else if(h=t.getBoundingRect(),t.needLocalTransform()){var l=t.getLocalTransform();(h=h.clone()).applyTransform(l)}e=f.getLayoutRect(p.defaults({width:h.width,height:h.height},e),i,n);var c=t.position,u=r?e.x-h.x:0,d=s?e.y-h.y:0;t.attr("position","raw"===a?[u,d]:[c[0]+u,c[1]+d])}},t.exports=f},function(t,e,i){var n=i(5),d=i(82);function o(t){var e={gap:5,maxWidth:1/0};this.options=n.merge(e,t,!0)}o.prototype.run=function(h){var l=0,c=0,u=0;return h.each(function(t,e){if(!(t instanceof d)){var i,n=t.position,o=t.getBoundingRect(),r=h.childAt(e+1),s=r&&r.getBoundingRect(),a=o.width+(s?-s.x+o.x:0);u=(i=l+a)>this.options.maxWidth||t.newline?(l=0,i=a,c+=u+parseInt(this.options.gap,10),o.height):Math.max(u,o.height),t.newline||(n[0]=l,n[1]=c,l=i+this.options.gap)}},this),o},t.exports=o},function(t,e,i){var n=i(5),d=i(82);function o(t){var e={gap:5,maxHeight:1/0};this.options=n.merge(e,t,!0)}o.prototype.run=function(h){var l=0,c=0,u=0;return h.each(function(t,e){if(!(t instanceof d)){var i,n=t.position,o=t.getBoundingRect(),r=h.childAt(e+1),s=r&&r.getBoundingRect(),a=o.height+(s?-s.y+o.y:0);u=(i=c+a)>this.options.maxHeight||t.newline?(l+=u+parseInt(this.options.gap,10),c=0,i=a,o.width):Math.max(u,o.width),t.newline||(n[0]=l,n[1]=c,c=i+this.options.gap)}},this),o},t.exports=o},function(t,e,i){var u=i(5),n=i(27),d=i(94).parsePercent,r=i(128),p=i(129);function o(t){var e={orient:"vertical",nodePadding:30,layerPadding:100,rootLocation:{x:100,y:230},animateTime:500,lineStyle:{pos:"bottom,top",symbol:{type:"none"}}};"horizontal"===t.orient&&(e.lineStyle.pos="right,left"),this.options=u.defaults(e,t,!0),this.nodePadding=this.options.nodePadding,this.layerPadding=this.options.layerPadding,this.fishTopo=this.options.fishTopo,this._layerOffsets=[],this._layers=[],this._hideNodes=[]}o.prototype.layoutByRootNode=function(t){var r=this.fishTopo.connectionManager.connectors;var e={name:t.id,node:t};return function i(e,t){var n=[],o=[];u.each(r,function(t){t.startNode===e&&(t.endNode.exclude||o.push(t.endNode))}),0<o.length&&u.each(o,function(t){var e={name:t.id,node:t};n.push(e),i(t,e)}),0<n.length&&(t.children=n)}(t,e),this.doLayout({data:[e]},!0)},o.prototype.doLayout=function(t,e){var i=t.data[0];return this.treeData=t,this.tree=r.fromOptionData(i.name,i.children),this.tree.root.data=i,this._buildNode(t),this._setTreeShape(function(){this._buildAllLink(e)}.bind(this)),this.getBoundingRect()},o.prototype._buildAllLink=function(e){this.tree.traverse(function(t){0<t.children.length&&!e?this._buildLinkByParent(t,this.treeData.createLinkFunction):this.fishTopo.connectionManager.refreshLineByNode(t.data.node)},this)},o.prototype.getBoundingRect=function(){var i=null;return this.tree.traverse(function(t){var e=n.create({x:t.layout.position[0],y:t.layout.position[1],width:t.layout.width,height:t.layout.height});(i=i||e.clone()).union(e)},this),i},o.prototype._setTreeShape=function(e){var i=0,t=new p({nodePadding:this.nodePadding,layerPadding:this.layerPadding});this.tree.traverse(function(t){if(-1==u.indexOf(this._hideNodes,t)){var e=t.data.node.getBoundingRect();t.layout={width:t.data.node._width||e.width,height:t.data.node._height||e.height}}},this),t._hideNodes=this._hideNodes,t.run(this.tree);var n=this.options.orient,o=this.options.rootLocation.x,r=this.options.rootLocation.y,s=this.fishTopo.getWidth(),a=this.fishTopo.getHeight();o="center"===o?.5*s:d(o,s),r="center"===r?.5*a:d(r,a),r=d(r,a),r="horizontal"===n?(o=isNaN(o)?10:o,isNaN(r)?.5*a:r):(o=isNaN(o)?.5*s:o,isNaN(r)?10:r);var h=this.tree.root.layout.position[0],l=t.count(this.tree)-this._hideNodes.length,c=1/0;this.tree.traverse(function(t){var e,i;-1==u.indexOf(this._hideNodes,t)&&("vertical"===n&&"inverse"===this.options.direction?(e=t.layout.position[0]-h+o,i=r-t.layout.position[1]):"vertical"===n?(e=t.layout.position[0]-h+o,i=t.layout.position[1]+r):"horizontal"===n&&"inverse"===this.options.direction?(i=t.layout.position[0]-h+r,e=o-t.layout.position[1]):"horizontal"===n&&(i=t.layout.position[0]-h+r,e=t.layout.position[1]+o),t.layout.__x=e,(t.layout.__y=i)<c&&(c=i))},this),this.tree.traverse(function(t){-1==u.indexOf(this._hideNodes,t)&&(0<c?(t.layout.position[0]=t.layout.__x,t.layout.position[1]=t.layout.__y):(t.layout.position[0]=t.layout.__x,t.layout.position[1]=t.layout.__y-c),t.data.node.animateTo({position:[t.layout.position[0],t.layout.position[1]]},this.options.animateTime,function(){++i==l&&e()}.bind(this)),0==this._hideNodes.length&&0<t.children.length&&t.data.node._toggleShrink&&t.data.node._toggleShrink(!0))},this)},o.prototype._buildNode=function(i){i.createNodeFunction||(i.createNodeFunction=this._defaultCreateNodeFunction),this.tree.traverse(function(t){if(!t.data.node){var e=(t.data.createNodeFunction||i.createNodeFunction)(t.data,this);e._childShow=!0,this.fishTopo.add(e),t.data.node=e}},this)},o.prototype._defaultCreateNodeFunction=function(t){return this.fishTopo.createNode("Circle",{shape:{r:15},style:{fill:"#4883b4"},name:t.lable||t.name})},o.prototype._buildLinkByParent=function(t,e){for(var i=0,n=t.children.length;i<n;i++)this._buildLink(t,t.children[i],e)},o.prototype._buildLink=function(t,e,i){var n=null,o=t.data.node,r=e.data.node;if(i){var s=e.data;s.startNode=o,s.endNode=r,n=i(s)}else{var a=this.options.lineStyle;e.data.lineStyle&&(a=u.merge(u.clone(a),e.data.lineStyle,!0)),n=this.fishTopo.createLink(o,r,a)}this.fishTopo.add(n)},o.prototype.addChild=function(t,e,i){var n=new r(e.name).root;n.data=e;var o=this.treeData.createNodeFunction(n.data,this);return o._childShow=!0,1<=t.children.length?o.attr("position",u.clone(t.children[t.children.length-1].layout.position)):o.attr("position",u.clone(t.layout.position)),this.fishTopo.add(o),n.data.node=o,setTimeout(function(){this._buildLink(t,n,this.treeData.createLinkFunction)}.bind(this),this.options.animateTime),t.add(n),this.refreshPositionAndLine(i),o},o.prototype.toggleChild=function(e){var t=this.findTreeNodeByNode(e);e._childShow?(t.traverse(function(t){t.data.node!==e&&(t.data.node.hide(),-1==u.indexOf(this._hideNodes,t)&&this._hideNodes.push(t),this.fishTopo.connectionManager.toggleLineByNode(t.data.node,!1),0<t.children.length&&(t.data.node._childShow=!1,t.data.node._toggleShrink&&t.data.node._toggleShrink(!1)))},this),e._childShow=!1,e._toggleShrink&&e._toggleShrink(!1)):(t.traverse(function(t){t.data.node!==e&&(t.data.node.show(),this._hideNodes.splice(u.indexOf(this._hideNodes,t),1),this.fishTopo.connectionManager.toggleLineByNode(t.data.node,!0),0<t.children.length&&(t.data.node._childShow=!0,t.data.node._toggleShrink&&t.data.node._toggleShrink(!0)))},this),e._childShow=!0,e._toggleShrink&&e._toggleShrink(!0)),this.refreshPositionAndLine()},o.prototype.findTreeNodeByNode=function(e){var i=null;return this.tree.traverse(function(t){t.data.node===e&&(i=t)}),i},o.prototype.removeNode=function(t){var e=this.findTreeNodeByNode(t),i=e.parent;return!!i&&(e.traverse(function(t){this.fishTopo.remove(t.data.node)},this),i.remove(e),0===i.children.length&&i.data.node._hideToggle&&i.data.node._hideToggle(),this.refreshPositionAndLine(),!0)},o.prototype.removeChildren=function(t){var e=this.findTreeNodeByNode(t);return e.traverse(function(t){t!==e&&this.fishTopo.remove(t.data.node)},this),e.removeAllChildren(),t._hideToggle&&t._hideToggle(),this.refreshPositionAndLine(),!0},o.prototype.refreshPositionAndLine=function(t){this.tree.root.updateDepthAndHeight(0),this._setTreeShape(function(){this.tree.traverse(function(t){this.fishTopo.connectionManager.refreshLineByNode(t.data.node)},this),t&&t()}.bind(this))},o.prototype.changePosition=function(t,e){var i,n=t.parent,o=u.indexOf(n.children,t);"next"==e?i=o+1:"prev"==e&&(i=o-1);var r=n.children[i];if(r){var s=r;n.children[i]=t,n.children[o]=s}this.refreshPositionAndLine(),this.fishTopo.trigger("treeLayout:changePosition",{node:t,parentNode:n,targetNode:r})},t.exports=o},function(t,e,i){var h=i(5);function l(t,e){this.id=t,this.depth=0,this.height=0,this.children=[],this.parent=null,this.data=e||null}function c(t){this.root=new l(t)}l.prototype.add=function(t){var e=this.children;t.parent!==this&&(e.push(t),t.parent=this)},l.prototype.remove=function(t){var e=this.children,i=h.indexOf(e,t);0<=i&&(e.splice(i,1),t.parent=null)},l.prototype.removeAllChildren=function(){for(var t=this.children,e=0;e<t.length;e++){t[e].parent=null}this.children=[]},l.prototype.traverse=function(t,e){t.call(e,this);for(var i=0;i<this.children.length;i++)this.children[i].traverse(t,e)},l.prototype.count=function(){var t=0;return this.traverse(function(){t++}),t},l.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var i=0;i<this.children.length;i++){var n=this.children[i];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height)}this.height=e+1},l.prototype.getNodeById=function(t){if(this.id===t)return this;for(var e=0;e<this.children.length;e++){var i=this.children[e].getNodeById(t);if(i)return i}},c.prototype.traverse=function(t,e){this.root.traverse(t,e)},c.prototype.getSubTree=function(t){var e=this.getNodeById(t);if(e){var i=new c(e.id);return i.root=e,i}},c.prototype.getNodeById=function(t){return this.root.getNodeById(t)},c.fromOptionData=function(t,e){var i=new c(t),n=i.root;function r(t,e){var i=new l(t.name,t);e.add(i);var n=t.children;if(n)for(var o=0;o<n.length;o++)r(n[o],i)}n.data={name:t,children:e};for(var o=0;o<e.length;o++)r(e[o],n);return i.root.updateDepthAndHeight(0),i},c.fromDataSource=function(s,t){for(var a={},e=0;e<s.node.length;e++){var i=s.node[e],n=new l(i.name,i);a[i.name]=n}var o=new c(t.name);return o.root.data=t,function t(e){for(var i=function(e){return h.filter(s.link,function(t){if(t.from===e&&!t.pos)return t})}(e.id),n=0;n<i.length;n++){var o=i[n],r=a[o.to];e.children.push(r),t(r)}}(o.root),o.root.updateDepthAndHeight(0),o},t.exports=c},function(t,e,i){var l=i(15),c=i(5);function n(t){t=t||{},this.nodePadding=t.nodePadding||30,this.layerPadding=t.layerPadding||100,this._layerOffsets=[],this._layers=[],this._hideNodes=[]}n.prototype.count=function(t){var e=0;return t.traverse(function(){e++}),e},n.prototype.run=function(t){for(var e=this._layerOffsets.length=0;e<t.root.height+1;e++)this._layerOffsets[e]=0,this._layers[e]=[];this._updateNodeXPosition(t.root);var i=t.root;this._updateNodeYPosition(i,0,i.layout.height)},n.prototype._updateNodeXPosition=function(t){var e=1/0,i=-1/0;t.layout.position=t.layout.position||l.create();for(var n=0;n<t.children.length;n++){var o=t.children[n];if(-1==c.indexOf(this._hideNodes,o)){this._updateNodeXPosition(o);var r=o.layout.position[0];r<e&&(e=r),i<r&&(i=r)}}0<t.children.length&&-1==c.indexOf(this._hideNodes,t.children[0])?t.layout.position[0]=(e+i)/2:(t.layout.position[0]=0,t.height=0);var s=this._layerOffsets[t.depth]||0;if(s>t.layout.position[0]){var a=s-t.layout.position[0];this._shiftSubtree(t,a);for(var h=t.depth+1;h<t.height+t.depth;h++)this._layerOffsets[h]+=a}this._layerOffsets[t.depth]=t.layout.position[0]+t.layout.width+this.nodePadding,-1==c.indexOf(this._layers[t.depth],t)&&this._layers[t.depth].push(t)},n.prototype._shiftSubtree=function(t,e){t.layout.position[0]+=e;for(var i=0;i<t.children.length;i++)-1==c.indexOf(this._hideNodes,t.children[i])&&this._shiftSubtree(t.children[i],e)},n.prototype._updateNodeYPosition=function(t,e,i){if(-1==c.indexOf(this._hideNodes,t)){t.layout.position[1]=e;for(var n=0,o=0;o<t.children.length;o++)n=Math.max(t.children[o].layout.height,n);var r=this.layerPadding;"function"==typeof r&&(r=r(t.depth));for(var s=0;s<t.children.length;s++)this._updateNodeYPosition(t.children[s],e+r+i,n)}},t.exports=n},function(t,e,i){var o=i(131),h=i(15),l=i(5);function n(t){this.fishTopo=t.fishTopo;var e={repulsion:100,gravity:.1,edgeLength:30,once:!0,layoutAnimation:!0,rect:{x:0,y:0,width:this.fishTopo.getWidth(),height:this.fishTopo.getHeight()},lineStyle:{symbol:{type:"none"}},preservedPoints:{}};this.options=l.defaults(e,t,!0)}n.prototype.doLayout=function(t){var e=t.data[0];this.allNodes=this._buildNode(e.nodes,t.createNodeFunction),this.allLinks=this._buildLinks(e.links,t.createLinkFunction),this._forceIns(),this._startForceLayoutIteration()},n.prototype.autoLayout=function(){this.allNodes=this.fishTopo.allNodes,this.allLinks=this.fishTopo.connectionManager.connectors,this._forceIns(),this._startForceLayoutIteration()},n.prototype._buildNode=function(t,n){fish.isFunction(n)||(n=this._defaultCreateNodeFunction.bind(this));var o=[];return l.each(t,function(t,e){if(!t.node){var i=(t.createNodeFunction||n)(t);this.fishTopo.add(i),this._addNodeEvent(i,e),o.push(i)}},this),o},n.prototype._addNodeEvent=function(t,e){this.options.once||t.on("drag",function(){this.options.forceLayout&&(this.options.forceLayout.warmUp(),this._layouting||this._startForceLayoutIteration(),this.options.forceLayout.setFixed(e))},this).on("dragend",function(){this.options.forceLayout&&this.options.forceLayout.setUnfixed(e)},this)},n.prototype._defaultCreateNodeFunction=function(t){return this.fishTopo.createNode("Circle",{shape:{r:15},style:{fill:"#4883b4"},name:t.lable||t.name})},n.prototype._buildLinks=function(t,s){var a=[];return l.each(t,function(t){var e=this.fishTopo.childOfName(t.source),i=this.fishTopo.childOfName(t.target);if(e&&i){var n=null;if(s){var o=t;o.startNode=e,o.endNode=i,n=s(o)}else{var r=this.options.lineStyle;t.style&&(r=l.merge(l.clone(r),t.style,!0)),n=this.fishTopo.createLink(e,i,r)}this.fishTopo.add(n),a.push(n)}},this),a},n.prototype._forceIns=function(){var t=this.options.rect,s=this,a=this.options.preservedPoints,e=l.map(this.allNodes,function(t){var e=this.options.repulsion;return t.w=e,{w:t.rep=e,rep:e,p:t.p=null}},this);a&&l.each(this.allNodes,function(t,e){t.attr("position",a[e])}),l.each(this.allLinks,function(t){t.n1=t.startNode,t.n2=t.endNode,t.d=this.options.edgeLength,t.curveness=0},this);var i=o(this.allNodes,this.allLinks,{rect:t,gravity:this.options.gravity}),n=i.step;i.step=function(r){l.each(this.allNodes,function(t){e.fixed&&h.copy(e.p,e.position)}),n(function(t,e,i){for(var n=0,o=t.length;n<o;n++)t[n].fixed||t[n].attr("position",t[n].p),a[n]=t[n].p;l.each(e,function(t){s.fishTopo.connectionManager.refreshConnector(t,!0)}),r&&r(i)})},this.options.forceLayout=i,this.options.preservedPoints=a,i.step()},n.prototype._startForceLayoutIteration=function(){var i=this,n=this.options.layoutAnimation;!function e(){i.options.forceLayout.step(function(t){i._layouting=!t,i._layouting?n?i._layoutTimeout=setTimeout(e,16):e():i.fishTopo.trigger("forceLayoutEnd")})}()},t.exports=n},function(t,e,i){var m=i(15),x=m.scaleAndAdd;t.exports=function(p,f,t){for(var e=t.rect,i=e.width,n=e.height,g=[e.x+i/2,e.y+n/2],y=null==t.gravity?.1:t.gravity,o=0;o<p.length;o++){var r=p[o];r.p||(r.p=m.create(i*(Math.random()-.5)+g[0],n*(Math.random()-.5)+g[1])),r.pp=m.clone(r.p),r.edges=null}var v=.6;return{warmUp:function(){v=.5},setFixed:function(t){p[t].fixed=!0},setUnfixed:function(t){p[t].fixed=!1},step:function(t){for(var e=[],i=p.length,n=0;n<f.length;n++){var o=f[n],r=o.n1,s=o.n2;m.sub(e,s.p,r.p);var a=m.len(e)-o.d,h=s.w/(r.w+s.w);m.normalize(e,e),r.fixed||x(r.p,r.p,e,h*a*v),s.fixed||x(s.p,s.p,e,-(1-h)*a*v)}for(n=0;n<i;n++){(d=p[n]).fixed||(m.sub(e,g,d.p),m.scaleAndAdd(d.p,d.p,e,y*v))}for(n=0;n<i;n++){r=p[n];for(var l=n+1;l<i;l++){s=p[l];m.sub(e,s.p,r.p),0===(a=m.len(e))&&(m.set(e,Math.random()-.5,Math.random()-.5),a=1);var c=(r.rep+s.rep)/a/a;r.fixed||x(r.pp,r.pp,e,c),s.fixed||x(s.pp,s.pp,e,-c)}}var u=[];for(n=0;n<i;n++){var d;(d=p[n]).fixed||(m.sub(u,d.p,d.pp),m.scaleAndAdd(d.p,d.p,u,v),m.copy(d.pp,d.p))}v*=.992,t&&t(p,f,v<.01)}}}},function(t,e){function l(){}var i=5,o=2,r={setAttr:(new Image).dataset?function(t,e,i){return t.dataset[e]=i}:function(t,e,i){return t.setAttribute("data-"+e,i),i},getAttr:(new Image).dataset?function(t,e){return t.dataset[e]?t.dataset[e]:t.getAttribute("data-"+e)}:function(t,e){return t.getAttribute("data-"+e)}};function n(t){this.max=t||i,this.linkHead=null,this.linkNode=null,this.pool=[]}n.prototype.initPool=function(){var t,e,i,n;for(n=this,t=0;t<this.max;t++)i={},e=new Image,r.setAttr(e,"id",t),e.onload=function(){n.notice(n.getNode(this),"success",this),n.executeLink(this)},e.onerror=function(){var t=n.getNode(this);t.tries<o?(t.tries=t.tries+1,n.appendNode(n.createNode(t.src,t.options,t.notice,t.group,t.tries))):n.notice(t,"error",this),n.executeLink(this)},i.img=e,i.free=!0,this.pool.push(i)},n.prototype.notice=function(t,e,i){t.notice(e,i)},n.prototype.executeLink=function(t){this.linkHead?(this.setSrc(t,this.linkHead),this.shiftNode()):this.status(t,!0)},n.prototype.getFree=function(){var t,e;for(e=0,t=this.pool.length;e<t;e++)if(this.pool[e].free)return this.pool[e];return null},n.prototype.setSrc=function(t,e){this.status(t,!1),this.setNode(t,e),t.src=e.src},n.prototype.status=function(t,e){var i=r.getAttr(t,"id");i&&(this.pool[i].free=e),e&&(this.pool[i].node=null)},n.prototype.setNode=function(t,e){var i=r.getAttr(t,"id");if(i)return this.pool[i].node=e,this.pool[i].node===e},n.prototype.getNode=function(t){var e=r.getAttr(t,"id");if(e)return this.pool[e].node},n.prototype._load=function(t,e){var i,n=[],o=null,r=0,s=e.once?function(t,e){var i=this.group,n=this.options;i[t].push(e),i.success.length+i.error.length===i.count&&setTimeout(function(){n.success.call(null,i.success,i.error,i.count)},1)}:function(t,e){var i=this.options;setTimeout(function(){i[t].call(null,e)},1)},a={count:0,success:[],error:[]},h=null;for((e=e||{}).success=e.success||l,e.error=e.error||l,n=n.concat(t),a.count=n.length,r=0,i=n.length;r<i;r++)h=this.createNode(n[r],e,s,a),(o=this.getFree())?this.setSrc(o.img,h):this.appendNode(h)},n.prototype._info=function(){var t,e={},i=0,n=null;for(e.thread={},e.thread.count=this.pool.length,e.thread.free=0,e.task={},i=e.task.count=0,t=this.pool.length;i<t;i++)this.pool[i].free&&(e.thread.free=e.thread.free+1);if(n=this.linkHead)for(e.task.count=e.task.count+1;n.next;)e.task.count=e.task.count+1,n=n.next;return e},n.prototype.createNode=function(t,e,i,n,o){var r={};return r.src=t,r.options=e,r.notice=i,r.group=n,r.tries=o||0,r},n.prototype.appendNode=function(t){this.linkHead?this.linkNode.next=t:this.linkHead=t,this.linkNode=t},n.prototype.shiftNode=function(){this.linkHead&&(this.linkHead=this.linkHead.next||null)};t.exports={initImagePool:function(t){var e=new n(t);return e.initPool(),{load:function(){e._load.apply(e,arguments)},info:function(){return e._info.call(e)}}}}},function(t,e,i){var n=i(134),o=i(135),s=i(87),v=i(5),r=i(50),m=i(94),x=i(124);function a(t,e){this._tooltipContent=new n(e.getDom(),e),this._api=e,this._tooltipModel=t,this._alwaysShowContent=t.get("alwaysShowContent"),this._initGloablListener()}function _(t){return"center"===t||"middle"===t}a.prototype._initGloablListener=function(){var n=this._tooltipModel.get("triggerOn");o.register("itemTooltip",this._api,function(t,e,i){"none"!==n&&(0<=n.indexOf(t)?this._tryShow(e,i):"leave"===t&&this._hide(i))}.bind(this))},a.prototype._tryShow=function(t,e){var i=t.target;this._tooltipModel&&(this._lastX=t.offsetX,this._lastY=t.offsetY,i&&i.tooltip?this._showComponentItemTooltip(t,i):this._hide(e))},a.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid}),this.manuallyHideTip()},a.prototype.dispose=function(){r.node||(this._tooltipContent.hide(),o.unregister("itemTooltip",this._api))},a.prototype.manuallyHideTip=function(){var t=this._tooltipContent;this._alwaysShowContent||t.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null},a.prototype._showComponentItemTooltip=function(t,e){var i=e.tooltip;if("string"==typeof i){i={content:i,formatter:i}}var n=new s(i,this._tooltipModel),o=n.get("content"),r=Math.random();this._showOrMove(n,function(){this._showTooltipContent(n,o,n.get("formatterParams")||{},r,t.offsetX,t.offsetY,t.position,e)})},a.prototype._showOrMove=function(t,e){var i=t.get("showDelay");e=v.bind(e,this),clearTimeout(this._showTimout),0<i?this._showTimout=setTimeout(e,i):e()},a.prototype._showTooltipContent=function(i,t,n,e,o,r,s,a){if(this._ticket="",i.get("showContent")&&i.get("show")){var h=this._tooltipContent,l=i.get("formatter");s=s||i.get("position");var c=t;if(l&&"string"==typeof l)c=m.formatTpl(l,n,!0);else if("function"==typeof l){var u=function(t,e){t===this._ticket&&(h.setContent(e),this._updatePosition(i,s,o,r,h,n,a))}.bind(this);this._ticket=e,c=l(n,e,u)}h.setContent(c),h.show(i),this._updatePosition(i,s,o,r,h,n,a)}},a.prototype._updatePosition=function(t,e,i,n,o,r,s){var a=this._api.getWidth(),h=this._api.getHeight();e=e||t.get("position");var l=o.getSize(),c=t.get("align"),u=t.get("verticalAlign"),d=s&&s.getBoundingRect().clone();if(s&&d.applyTransform(s.transform),"function"==typeof e&&(e=e([i,n],r,o.el,d,{viewSize:[a,h],contentSize:l.slice()})),v.isArray(e))i=m.parsePercent(e[0],a),n=m.parsePercent(e[1],h);else if(v.isObject(e)){e.width=l[0],e.height=l[1];var p=x.getLayoutRect(e,{width:a,height:h});i=p.x,n=p.y,u=c=null}else if("string"==typeof e&&s){var f=function(t,e,i){var n=i[0],o=i[1],r=0,s=0,a=e.width,h=e.height;switch(t){case"inside":r=e.x+a/2-n/2,s=e.y+h/2-o/2;break;case"top":r=e.x+a/2-n/2,s=e.y-o-5;break;case"bottom":r=e.x+a/2-n/2,s=e.y+h+5;break;case"left":r=e.x-n-5,s=e.y+h/2-o/2;break;case"right":r=e.x+a+5,s=e.y+h/2-o/2}return[r,s]}(e,d,l);i=f[0],n=f[1]}else{var g=function(t,e,i,n,o,r,s){var a=i.clientWidth,h=i.clientHeight;n<t+a+r?t-=a+r:t+=r;o<e+h+s?e-=h+s:e+=s;return[t,e]}(i,n,o.el,a,h,c?0:20,u?0:20);i=g[0],n=g[1]}if(c&&(i-=_(c)?l[0]/2:"right"===c?l[0]:0),u&&(n-=_(u)?l[1]/2:"bottom"===u?l[1]:0),t.get("confine")){var y=function(t,e,i,n,o){var r=i.clientWidth,s=i.clientHeight;return t=Math.min(t+r,n)-r,e=Math.min(e+s,o)-s,t=Math.max(t,0),e=Math.max(e,0),[t,e]}(i,n,o.el,a,h);i=y[0],n=y[1]}o.moveTo(i,n)},t.exports=a},function(t,e,i){var s=i(5),a=i(20),h=i(50),r=i(77),n=i(94),l=n.toCamelCase,c=n.normalizeCssArray,u=s.each,d=["","-webkit-","-moz-","-o-"];function o(o){var r=[],t=o.get("transitionDuration"),e=o.get("backgroundColor"),i=o.getModel("textStyle"),n=o.get("padding");return t&&r.push(function(t){var e="cubic-bezier(0.23, 1, 0.32, 1)",i="left "+t+"s "+e+",top "+t+"s "+e;return s.map(d,function(t){return t+"transition:"+i}).join(";")}(t)),e&&(h.canvasSupported?r.push("background-Color:"+e):(r.push("background-Color:#"+a.toHex(e)),r.push("filter:alpha(opacity=70)"))),u(["width","color","radius"],function(t){var e="border-"+t,i=l(e),n=o.get(i);null!=n&&r.push(e+":"+n+("color"===t?"":"px"))}),r.push(function(i){var n=[],t=i.get("fontSize"),e=i.get("color");e&&n.push("color:"+e);var o=i.get("font");return o&&n.push("font:"+o),t&&n.push("line-height:"+Math.round(3*t/2)+"px"),u(["decoration","align"],function(t){var e=i.get(t);e&&n.push("text-"+t+":"+e)}),n.join(";")}(i)),null!=n&&r.push("padding:"+c(n).join("px ")+"px"),r.join(";")+";"}function p(i,t){var e=document.createElement("div"),n=this._zr=t.getZr();this.el=e,this._x=t.getWidth()/2,this._y=t.getHeight()/2,i.appendChild(e),this._container=i,this._show=!1,this._hideTimeout;var o=this;e.onmouseenter=function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0},e.onmousemove=function(t){if(t=t||window.event,!o._enterable){var e=n.handler;r.normalizeEvent(i,t,!0),e.dispatch("mousemove",t)}},e.onmouseleave=function(){o._enterable&&o._show&&o.hideLater(o._hideDelay),o._inContent=!1}}p.prototype={constructor:p,_enterable:!0,update:function(){var t=this._container,e=t.currentStyle||document.defaultView.getComputedStyle(t),i=t.style;"absolute"!==i.position&&"absolute"!==e.position&&(i.position="relative")},show:function(t){clearTimeout(this._hideTimeout);var e=this.el;e.style.cssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:999;"+o(t)+";left:"+this._x+"px;top:"+this._y+"px;"+(t.get("extraCssText")||""),e.style.display=e.innerHTML?"block":"none",this._show=!0},setContent:function(t){this.el.innerHTML=t},setEnterable:function(t){this._enterable=t},getSize:function(){var t=this.el;return[t.clientWidth,t.clientHeight]},moveTo:function(t,e){var i,n=this._zr;n&&n.painter&&(i=n.painter.getViewportRoot())&&(t+=i.offsetLeft||0,e+=i.offsetTop||0);var o=this.el.style;o.left=t+"px",o.top=e+"px",this._x=t,this._y=e},hide:function(){this.el.style.display="none",this._show=!1},hideLater:function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(s.bind(this.hide,this),t)):this.hide())},isShow:function(){return this._show}},t.exports=p},function(t,e,i){var o=i(50),s=i(5),a=i(94).makeGetter(),h=s.each,n={};function l(t,e,i){t.handler("leave",null,i)}function c(t,e,i,n){e.handler(t,i,n)}n.register=function(t,e,i){if(!o.node){var n=e.getZr();a(n).records||(a(n).records={}),function(o,r){if(a(o).initialized)return;function t(t,n){o.on(t,function(e){var i=function(i){var n={showTip:[],hideTip:[]},o=function(t){var e=n[t.type];e?e.push(t):(t.dispatchAction=o,i.dispatchAction(t))};return{dispatchAction:o,pendings:n}}(r);h(a(o).records,function(t){t&&n(t,e,i.dispatchAction)}),function(t,e){var i,n=t.showTip.length,o=t.hideTip.length;n?i=t.showTip[n-1]:o&&(i=t.hideTip[o-1]);i&&(i.dispatchAction=null,e.dispatchAction(i))}(i.pendings,r)})}a(o).initialized=!0,t("click",s.curry(c,"click")),t("mousemove",s.curry(c,"mousemove")),t("globalout",l)}(n,e),(a(n).records[t]||(a(n).records[t]={})).handler=i}},n.unregister=function(t,e){if(!o.node){var i=e.getZr();(a(i).records||{})[t]&&(a(i).records[t]=null)}},t.exports=n},function(t,e,i){var n=i(87);t.exports=n.extend({type:"tooltip",defaultOption:{zlevel:0,z:8,show:!0,showContent:!0,triggerOn:"mousemove",alwaysShowContent:!1,displayMode:"single",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",textStyle:{color:"#fff",fontSize:14}}})},function(t,e,i){i(138),(0,i(69).registerPainter)("vml",i(140))},function(t,e,i){var n=i(50),F=i(15).applyTransform,o=i(27),O=i(20),M=i(26),R=i(25),r=i(24),s=i(8),a=i(45),h=i(46),l=i(7),c=i(30),I=i(42),H=i(139),Y=c.CMD,W=Math.round,V=Math.sqrt,u=Math.abs,U=Math.cos,j=Math.sin,G=Math.max;if(!n.canvasSupported){function q(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=Q+","+Q,t.coordorigin="0,0"}function z(t,e,i){return"rgb("+[t,e,i].join(",")+")"}function X(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e)}function d(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)}function Z(t,e,i){return 1e5*(parseFloat(t)||0)+1e3*(parseFloat(e)||0)+i}function A(t,e){return"string"==typeof t?0<=t.lastIndexOf("%")?parseFloat(t)/100*e:parseFloat(t):t}function B(t,e,i){var n=O.parse(e);i=+i,isNaN(i)&&(i=1),n&&(t.color=z(n[0],n[1],n[2]),t.opacity=i*n[3])}function E(t,e,i,n){var o="fill"==e,r=t.getElementsByTagName(e)[0];null!=i[e]&&"none"!==i[e]&&(o||!o&&i.lineWidth)?(t[o?"filled":"stroked"]="true",i[e]instanceof I&&d(t,r),r=r||H.createNode(e),o?function(t,e,i){var n,o,r=e.fill;if(null!=r)if(r instanceof I){var s,a=0,h=[0,0],l=0,c=1,u=i.getBoundingRect(),d=u.width,p=u.height;if("linear"===r.type){s="gradient";var f=i.transform,g=[r.x*d,r.y*p],y=[r.x2*d,r.y2*p];f&&(F(g,g,f),F(y,y,f));var v=y[0]-g[0],m=y[1]-g[1];(a=180*Math.atan2(v,m)/Math.PI)<0&&(a+=360),a<1e-6&&(a=0)}else{s="gradientradial";g=[r.x*d,r.y*p],f=i.transform;var x=i.scale,_=d,b=p;h=[(g[0]-u.x)/_,(g[1]-u.y)/b],f&&F(g,g,f),_/=x[0]*Q,b/=x[1]*Q;var w=G(_,b);l=0/w,c=2*r.r/w-l}var P=r.colorStops.slice();P.sort(function(t,e){return t.offset-e.offset});for(var C=P.length,N=[],T=[],S=0;S<C;S++){var M=P[S],R=(n=M.color,void 0,o=O.parse(n),[z(o[0],o[1],o[2]),o[3]]);T.push(M.offset*c+l+" "+R[0]),0!==S&&S!==C-1||N.push(R)}if(2<=C){var A=N[0][0],E=N[1][0],L=N[0][1]*e.opacity,k=N[1][1]*e.opacity;t.type=s,t.method="none",t.focus="100%",t.angle=a,t.color=A,t.color2=E,t.colors=T.join(","),t.opacity=k,t.opacity2=L}"radial"===s&&(t.focusposition=h.join(","))}else B(t,r,e.opacity)}(r,i,n):function(t,e){null!=e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof I||B(t,e.stroke,e.opacity)}(r,i),X(t,r)):(t[o?"filled":"stroked"]="false",d(t,r))}var J="progid:DXImageTransform.Microsoft",Q=21600,K=10800,$=[[],[],[]];l.prototype.brushVML=function(t){var e=this.style,i=this._vmlEl;i||(i=H.createNode("shape"),q(i),this._vmlEl=i),E(i,"fill",e,this),E(i,"stroke",e,this);var n=this.transform,o=null!=n,r=i.getElementsByTagName("stroke")[0];if(r){var s=e.lineWidth;if(o&&!e.strokeNoScale){var a=n[0]*n[3]-n[1]*n[2];s*=V(u(a))}r.weight=s+"px"}var h=this.path||(this.path=new c);this.__dirtyPath&&(h.beginPath(),this.buildPath(h,this.shape),h.toStatic(),this.__dirtyPath=!1),i.path=function(t,e){var i,n,o,r,s,a,h=Y.M,l=Y.C,c=Y.L,u=Y.A,d=Y.Q,p=[],f=t.data,g=t.len();for(r=0;r<g;){switch(n="",i=0,o=f[r++]){case h:n=" m ",i=1,s=f[r++],a=f[r++],$[0][0]=s,$[0][1]=a;break;case c:n=" l ",i=1,s=f[r++],a=f[r++],$[0][0]=s,$[0][1]=a;break;case d:case l:n=" c ",i=3;var y,v,m=f[r++],x=f[r++],_=f[r++],b=f[r++];o===d?(_=((y=_)+2*m)/3,b=((v=b)+2*x)/3,m=(s+2*m)/3,x=(a+2*x)/3):(y=f[r++],v=f[r++]),$[0][0]=m,$[0][1]=x,$[1][0]=_,$[1][1]=b,s=$[2][0]=y,a=$[2][1]=v;break;case u:var w=0,P=0,C=1,N=1,T=0;e&&(w=e[4],P=e[5],C=V(e[0]*e[0]+e[1]*e[1]),N=V(e[2]*e[2]+e[3]*e[3]),T=Math.atan2(-e[1]/N,e[0]/C));var S=f[r++],M=f[r++],R=f[r++],A=f[r++],E=f[r++]+T,L=f[r++]+E+T;r++;var k=f[r++],O=S+U(E)*R,I=M+j(E)*A,z=(m=S+U(L)*R,x=M+j(L)*A,k?" wa ":" at ");Math.abs(O-m)<1e-4&&(.01<Math.abs(L-E)?k&&(O+=.0125):Math.abs(I-M)<1e-4?k&&O<S||!k&&S<O?x-=.0125:x+=.0125:k&&I<M||!k&&M<I?m+=.0125:m-=.0125),p.push(z,W(((S-R)*C+w)*Q-K),",",W(((M-A)*N+P)*Q-K),",",W(((S+R)*C+w)*Q-K),",",W(((M+A)*N+P)*Q-K),",",W((O*C+w)*Q-K),",",W((I*N+P)*Q-K),",",W((m*C+w)*Q-K),",",W((x*N+P)*Q-K)),s=m,a=x;break;case Y.R:var B=$[0],D=$[1];B[0]=f[r++],B[1]=f[r++],D[0]=B[0]+f[r++],D[1]=B[1]+f[r++],e&&(F(B,B,e),F(D,D,e)),B[0]=W(B[0]*Q-K),D[0]=W(D[0]*Q-K),B[1]=W(B[1]*Q-K),D[1]=W(D[1]*Q-K),p.push(" m ",B[0],",",B[1]," l ",D[0],",",B[1]," l ",D[0],",",D[1]," l ",B[0],",",D[1]);break;case Y.Z:p.push(" x ")}if(0<i){p.push(n);for(var H=0;H<i;H++){var G=$[H];e&&F(G,G,e),p.push(W(G[0]*Q-K),",",W(G[1]*Q-K),H<i-1?",":"")}}}return p.join("")}(h,this.transform),i.style.zIndex=Z(this.zlevel,this.z,this.z2),X(t,i),null!=e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t)},l.prototype.onRemove=function(t){d(t,this._vmlEl),this.removeRectText(t)},l.prototype.onAdd=function(t){X(t,this._vmlEl),this.appendRectText(t)};a.prototype.brushVML=function(t){var e,i,n=this.style,o=n.image;if(function(t){return"object"==typeof t&&t.tagName&&"IMG"===t.tagName.toUpperCase()}(o)){var r=o.src;if(r===this._imageSrc)e=this._imageWidth,i=this._imageHeight;else{var s=o.runtimeStyle,a=s.width,h=s.height;s.width="auto",s.height="auto",e=o.width,i=o.height,s.width=a,s.height=h,this._imageSrc=r,this._imageWidth=e,this._imageHeight=i}o=r}else o===this._imageSrc&&(e=this._imageWidth,i=this._imageHeight);if(o){var l=n.x||0,c=n.y||0,u=n.width,d=n.height,p=n.sWidth,f=n.sHeight,g=n.sx||0,y=n.sy||0,v=p&&f,m=this._vmlEl;m||(m=H.doc.createElement("div"),q(m),this._vmlEl=m);var x,_=m.style,b=!1,w=1,P=1;if(this.transform&&(x=this.transform,w=V(x[0]*x[0]+x[1]*x[1]),P=V(x[2]*x[2]+x[3]*x[3]),b=x[1]||x[2]),b){var C=[l,c],N=[l+u,c],T=[l,c+d],S=[l+u,c+d];F(C,C,x),F(N,N,x),F(T,T,x),F(S,S,x);var M=G(C[0],N[0],T[0],S[0]),R=G(C[1],N[1],T[1],S[1]),A=[];A.push("M11=",x[0]/w,",","M12=",x[2]/P,",","M21=",x[1]/w,",","M22=",x[3]/P,",","Dx=",W(l*w+x[4]),",","Dy=",W(c*P+x[5])),_.padding="0 "+W(M)+"px "+W(R)+"px 0",_.filter=J+".Matrix("+A.join("")+", SizingMethod=clip)"}else x&&(l=l*w+x[4],c=c*P+x[5]),_.filter="",_.left=W(l)+"px",_.top=W(c)+"px";var E=this._imageEl,L=this._cropEl;E||(E=H.doc.createElement("div"),this._imageEl=E);var k=E.style;if(v){if(e&&i)k.width=W(w*e*u/p)+"px",k.height=W(P*i*d/f)+"px";else{var O=new Image,I=this;O.onload=function(){O.onload=null,e=O.width,i=O.height,k.width=W(w*e*u/p)+"px",k.height=W(P*i*d/f)+"px",I._imageWidth=e,I._imageHeight=i,I._imageSrc=o},O.src=o}L||((L=H.doc.createElement("div")).style.overflow="hidden",this._cropEl=L);var z=L.style;z.width=W((u+g*u/p)*w),z.height=W((d+y*d/f)*P),z.filter=J+".Matrix(Dx="+-g*u/p*w+",Dy="+-y*d/f*P+")",L.parentNode||m.appendChild(L),E.parentNode!=L&&L.appendChild(E)}else k.width=W(w*u)+"px",k.height=W(P*d)+"px",m.appendChild(E),L&&L.parentNode&&(m.removeChild(L),this._cropEl=null);var B="",D=n.opacity;D<1&&(B+=".Alpha(opacity="+W(100*D)+") "),B+=J+".AlphaImageLoader(src="+o+", SizingMethod=scale)",k.filter=B,m.style.zIndex=Z(this.zlevel,this.z,this.z2),X(t,m),null!=n.text&&this.drawRectText(t,this.getBoundingRect())}},a.prototype.onRemove=function(t){d(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t)},a.prototype.onAdd=function(t){X(t,this._vmlEl),this.appendRectText(t)};var p,L="normal",k={},D=0,tt=document.createElement("div");M.$override("measureText",function(t,e){var i=H.doc;p||((p=i.createElement("div")).style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",H.doc.body.appendChild(p));try{p.style.font=e}catch(t){}return p.innerHTML="",p.appendChild(i.createTextNode(t)),{width:p.offsetWidth}});function f(t,e,i,n){var o=this.style;this.__dirty&&R.normalizeTextStyle(o,!0);var r=o.text;if(null!=r&&(r+=""),r){if(o.rich){var s=M.parseRichText(r,o);r=[];for(var a=0;a<s.lines.length;a++){for(var h=s.lines[a].tokens,l=[],c=0;c<h.length;c++)l.push(h[c].text);r.push(l.join(""))}r=r.join("\n")}var u,d,p=o.textAlign,f=o.textVerticalAlign,g=function(t){var e=k[t];if(!e){100<D&&(D=0,k={});var i,n=tt.style;try{n.font=t,i=n.fontFamily.split(",")[0]}catch(t){}e={style:n.fontStyle||L,variant:n.fontVariant||L,weight:n.fontWeight||L,size:0|parseFloat(n.fontSize||12),family:i||"Microsoft YaHei"},k[t]=e,D++}return e}(o.font),y=g.style+" "+g.variant+" "+g.weight+" "+g.size+'px "'+g.family+'"';i=i||M.getBoundingRect(r,y,p,f);var v=this.transform;if(v&&!n&&(et.copy(e),et.applyTransform(v),e=et),n)u=e.x,d=e.y;else{var m=o.textPosition,x=o.textDistance;if(m instanceof Array)u=e.x+A(m[0],e.width),d=e.y+A(m[1],e.height),p=p||"left";else{var _=M.adjustTextPositionOnRect(m,e,x);u=_.x,d=_.y,p=p||_.textAlign,f=f||_.textVerticalAlign}}u=M.adjustTextX(u,i.width,p),d=M.adjustTextY(d,i.height,f),d+=i.height/2;var b,w,P,C=H.createNode,N=this._textVmlEl;N?w=(b=(P=N.firstChild).nextSibling).nextSibling:(N=C("line"),b=C("path"),w=C("textpath"),P=C("skew"),w.style["v-text-align"]="left",q(N),b.textpathok=!0,w.on=!0,N.from="0 0",N.to="1000 0.05",X(N,P),X(N,b),X(N,w),this._textVmlEl=N);var T=[u,d],S=N.style;v&&n?(F(T,T,v),P.on=!0,P.matrix=v[0].toFixed(3)+","+v[2].toFixed(3)+","+v[1].toFixed(3)+","+v[3].toFixed(3)+",0,0",P.offset=(W(T[0])||0)+","+(W(T[1])||0),P.origin="0 0",S.left="0px",S.top="0px"):(P.on=!1,S.left=W(u)+"px",S.top=W(d)+"px"),w.string=function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}(r);try{w.style.font=y}catch(t){}E(N,"fill",{fill:o.textFill,opacity:o.opacity},this),E(N,"stroke",{stroke:o.textStroke,opacity:o.opacity,lineDash:o.lineDash},this),N.style.zIndex=Z(this.zlevel,this.z,this.z2),X(t,N)}}function g(t){d(t,this._textVmlEl),this._textVmlEl=null}function y(t){X(t,this._textVmlEl)}for(var et=new o,v=[r,s,a,l,h],m=0;m<v.length;m++){var x=v[m].prototype;x.drawRectText=f,x.removeRectText=g,x.appendRectText=y}h.prototype.brushVML=function(t){var e=this.style;null!=e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t)},h.prototype.onRemove=function(t){this.removeRectText(t)},h.prototype.onAdd=function(t){this.appendRectText(t)}}},function(t,e,i){var n,o=i(50),r="urn:schemas-microsoft-com:vml",s="undefined"==typeof window?null:window,a=!1,h=s&&s.document;if(h&&!o.canvasSupported)try{h.namespaces.zrvml||h.namespaces.add("zrvml",r),n=function(t){return h.createElement("<zrvml:"+t+' class="zrvml">')}}catch(t){n=function(t){return h.createElement("<"+t+' xmlns="'+r+'" class="zrvml">')}}e.doc=h,e.createNode=function(t){return n(t)},e.initVML=function(){if(!a&&h){a=!0;var t=h.styleSheets;t.length<31?h.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)")}}},function(t,e,i){var n=i(22),s=i(139),o=i(5).each;function r(t){return parseInt(t,10)}function a(t,e){s.initVML(),this.root=t,this.storage=e;var i=document.createElement("div"),n=document.createElement("div");i.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",n.style.cssText="position:absolute;left:0;top:0;",t.appendChild(i),this._vmlRoot=n,this._vmlViewport=i,this.resize();var o=e.delFromStorage,r=e.addToStorage;e.delFromStorage=function(t){o.call(e,t),t&&t.onRemove&&t.onRemove(n)},e.addToStorage=function(t){t.onAdd&&t.onAdd(n),r.call(e,t)},this._firstPaint=!0}a.prototype={constructor:a,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t)},_paintList:function(t){for(var e=this._vmlRoot,i=0;i<t.length;i++){var n=t[i];n.invisible||n.ignore?(n.__alreadyNotVisible||n.onRemove(e),n.__alreadyNotVisible=!0):(n.__alreadyNotVisible&&n.onAdd(e),n.__alreadyNotVisible=!1,n.__dirty&&(n.beforeBrush&&n.beforeBrush(),(n.brushVML||n.brush).call(n,e),n.afterBrush&&n.afterBrush())),n.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1)},resize:function(t,e){t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;if(this._width!=t||this._height!=e){this._width=t,this._height=e;var i=this._vmlViewport.style;i.width=t+"px",i.height=e+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var t=this.root,e=t.currentStyle;return(t.clientWidth||r(e.width))-r(e.paddingLeft)-r(e.paddingRight)|0},_getHeight:function(){var t=this.root,e=t.currentStyle;return(t.clientHeight||r(e.height))-r(e.paddingTop)-r(e.paddingBottom)|0}},o(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){a.prototype[t]=function(t){return function(){n('In IE8.0 VML mode painter not support method "'+t+'"')}}(t)});var h=a;t.exports=h}],i.c=o,i.p="",i(0);function i(t){if(o[t])return o[t].exports;var e=o[t]={exports:{},id:t,loaded:!1};return n[t].call(e.exports,e,e.exports,i),e.loaded=!0,e.exports}var n,o});
//# sourceMappingURL=fish-topo-flow.min.js.map
